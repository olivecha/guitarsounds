<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 12.3.1"/>
    <title>guitarsounds.analysis API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../guitarsounds.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;guitarsounds</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



        <h2>API Documentation</h2>
            <ul class="memberlist">
            <li>
                    <a class="class" href="#SoundPack">SoundPack</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SoundPack.__init__">SoundPack</a>
                        </li>
                        <li>
                                <a class="function" href="#SoundPack.sounds_from_files">sounds_from_files</a>
                        </li>
                        <li>
                                <a class="function" href="#SoundPack.equalize_time">equalize_time</a>
                        </li>
                        <li>
                                <a class="function" href="#SoundPack.normalize">normalize</a>
                        </li>
                        <li>
                                <a class="function" href="#SoundPack.plot">plot</a>
                        </li>
                        <li>
                                <a class="function" href="#SoundPack.compare_plot">compare_plot</a>
                        </li>
                        <li>
                                <a class="function" href="#SoundPack.freq_bin_plot">freq_bin_plot</a>
                        </li>
                        <li>
                                <a class="function" href="#SoundPack.fundamentals">fundamentals</a>
                        </li>
                        <li>
                                <a class="function" href="#SoundPack.integral_plot">integral_plot</a>
                        </li>
                        <li>
                                <a class="function" href="#SoundPack.bin_power_table">bin_power_table</a>
                        </li>
                        <li>
                                <a class="function" href="#SoundPack.bin_power_hist">bin_power_hist</a>
                        </li>
                        <li>
                                <a class="function" href="#SoundPack.listen">listen</a>
                        </li>
                        <li>
                                <a class="function" href="#SoundPack.compare_peaks">compare_peaks</a>
                        </li>
                        <li>
                                <a class="function" href="#SoundPack.fft_mirror">fft_mirror</a>
                        </li>
                        <li>
                                <a class="function" href="#SoundPack.fft_diff">fft_diff</a>
                        </li>
                        <li>
                                <a class="function" href="#SoundPack.integral_compare">integral_compare</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Sound">Sound</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Sound.__init__">Sound</a>
                        </li>
                        <li>
                                <a class="function" href="#Sound.condition">condition</a>
                        </li>
                        <li>
                                <a class="function" href="#Sound.use_raw_signal">use_raw_signal</a>
                        </li>
                        <li>
                                <a class="function" href="#Sound.bin_divide">bin_divide</a>
                        </li>
                        <li>
                                <a class="function" href="#Sound.trim_signal">trim_signal</a>
                        </li>
                        <li>
                                <a class="function" href="#Sound.listen_freq_bins">listen_freq_bins</a>
                        </li>
                        <li>
                                <a class="function" href="#Sound.plot_freq_bins">plot_freq_bins</a>
                        </li>
                        <li>
                                <a class="function" href="#Sound.peak_damping">peak_damping</a>
                        </li>
                        <li>
                                <a class="function" href="#Sound.bin_hist">bin_hist</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Signal">Signal</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Signal.__init__">Signal</a>
                        </li>
                        <li>
                                <a class="function" href="#Signal.time">time</a>
                        </li>
                        <li>
                                <a class="function" href="#Signal.listen">listen</a>
                        </li>
                        <li>
                                <a class="function" href="#Signal.old_plot">old_plot</a>
                        </li>
                        <li>
                                <a class="function" href="#Signal.fft">fft</a>
                        </li>
                        <li>
                                <a class="function" href="#Signal.spectral_centroid">spectral_centroid</a>
                        </li>
                        <li>
                                <a class="function" href="#Signal.peaks">peaks</a>
                        </li>
                        <li>
                                <a class="function" href="#Signal.time_damping">time_damping</a>
                        </li>
                        <li>
                                <a class="function" href="#Signal.peak_damping">peak_damping</a>
                        </li>
                        <li>
                                <a class="function" href="#Signal.fundamental">fundamental</a>
                        </li>
                        <li>
                                <a class="function" href="#Signal.cavity_peak">cavity_peak</a>
                        </li>
                        <li>
                                <a class="function" href="#Signal.cavity_frequency">cavity_frequency</a>
                        </li>
                        <li>
                                <a class="function" href="#Signal.fft_frequencies">fft_frequencies</a>
                        </li>
                        <li>
                                <a class="function" href="#Signal.fft_bins">fft_bins</a>
                        </li>
                        <li>
                                <a class="function" href="#Signal.envelope">envelope</a>
                        </li>
                        <li>
                                <a class="function" href="#Signal.log_envelope">log_envelope</a>
                        </li>
                        <li>
                                <a class="function" href="#Signal.find_onset">find_onset</a>
                        </li>
                        <li>
                                <a class="function" href="#Signal.trim_onset">trim_onset</a>
                        </li>
                        <li>
                                <a class="function" href="#Signal.trim_time">trim_time</a>
                        </li>
                        <li>
                                <a class="function" href="#Signal.normalize">normalize</a>
                        </li>
                        <li>
                                <a class="function" href="#Signal.make_freq_bins">make_freq_bins</a>
                        </li>
                        <li>
                                <a class="function" href="#Signal.save_wav">save_wav</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Plot">Plot</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Plot.__init__">Plot</a>
                        </li>
                        <li>
                                <a class="function" href="#Plot.sanitize_kwargs">sanitize_kwargs</a>
                        </li>
                        <li>
                                <a class="function" href="#Plot.set_bin_ticks">set_bin_ticks</a>
                        </li>
                        <li>
                                <a class="function" href="#Plot.signal">signal</a>
                        </li>
                        <li>
                                <a class="function" href="#Plot.envelope">envelope</a>
                        </li>
                        <li>
                                <a class="function" href="#Plot.log_envelope">log_envelope</a>
                        </li>
                        <li>
                                <a class="function" href="#Plot.fft">fft</a>
                        </li>
                        <li>
                                <a class="function" href="#Plot.fft_hist">fft_hist</a>
                        </li>
                        <li>
                                <a class="function" href="#Plot.peaks">peaks</a>
                        </li>
                        <li>
                                <a class="function" href="#Plot.peak_damping">peak_damping</a>
                        </li>
                        <li>
                                <a class="function" href="#Plot.time_damping">time_damping</a>
                        </li>
                        <li>
                                <a class="function" href="#Plot.integral">integral</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../guitarsounds.html">guitarsounds</a><wbr>.analysis    </h1>

                
                        <input id="mod-analysis-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-analysis-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="kn">from</span> <span class="nn">soundfile</span> <span class="kn">import</span> <span class="n">write</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a><span class="kn">import</span> <span class="nn">IPython.display</span> <span class="k">as</span> <span class="nn">ipd</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="kn">import</span> <span class="nn">matplotlib.ticker</span> <span class="k">as</span> <span class="nn">ticker</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="kn">import</span> <span class="nn">matplotlib.cm</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="kn">import</span> <span class="nn">os</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="kn">import</span> <span class="nn">scipy</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a><span class="kn">import</span> <span class="nn">scipy.optimize</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="kn">import</span> <span class="nn">scipy.integrate</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a><span class="kn">import</span> <span class="nn">scipy.interpolate</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">trapezoid</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span> <span class="k">as</span> <span class="n">sig</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a><span class="kn">from</span> <span class="nn">guitarsounds.parameters</span> <span class="kn">import</span> <span class="n">sound_parameters</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="kn">import</span> <span class="nn">guitarsounds.utils</span> <span class="k">as</span> <span class="nn">utils</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a><span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a><span class="kn">import</span> <span class="nn">wave</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a><span class="sd">Classes</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a><span class="k">class</span> <span class="nc">SoundPack</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a><span class="sd">    A class to store and analyse multiple sounds</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="sd">    Some methods are only available for the case with two sounds</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">sounds</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fundamentals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">SoundParams</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">equalize_time</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a><span class="sd">        The SoundPack can be instantiated from existing Sound class instances, either in a list or as</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a><span class="sd">        multiple arguments</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a><span class="sd">        The class can also handle the creation of Sound class instances if the arguments are filenames,</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a><span class="sd">        either a list or multiple arguments.</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a><span class="sd">        If the number of Sound contained is equal to two, the SoundPack will be &#39;dual&#39; and the associated methods</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a><span class="sd">        will be available</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a><span class="sd">        If it contains multiple sounds the SoundPack will be multiple and a reduced number of methods will work</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a><span class="sd">        A list of names as strings and fundamental frequencies can be specified when creating the SoundPack</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a><span class="sd">        If equalize_time is set to False, the contained sounds will not be trimmed to the same length.</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a><span class="sd">        Examples :</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a><span class="sd">        ```</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a><span class="sd">        Sound_Test = SoundPack(&#39;sounds/test1.wav&#39;, &#39;sounds/test2.wav&#39;, names=[&#39;A&#39;, &#39;B&#39;], fundamentals = [134, 134])</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a><span class="sd">        sounds = [sound1, sound2, sound3, sound4, sound5] # instances of the Sound class</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a><span class="sd">        large_Test = SoundPack(sounds, names=[&#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;])</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a><span class="sd">        ```</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a>        <span class="c1"># create a copy of the sound parameters</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a>        <span class="k">if</span> <span class="n">SoundParams</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">SP</span> <span class="o">=</span> <span class="n">sound_parameters</span><span class="p">()</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">SP</span> <span class="o">=</span> <span class="n">SoundParams</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a>        <span class="c1"># Check if the sounds argument is a list</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a>            <span class="n">sounds</span> <span class="o">=</span> <span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># unpack the list</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a>        <span class="c1"># Check for special case</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sounds</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a>            <span class="c1"># special case to compare two sounds</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;dual&#39;</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a>        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sounds</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a>            <span class="c1"># general case for multiple sounds</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;multiple&#39;</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a>        <span class="c1"># If filenames are supplied</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sounds_from_files</span><span class="p">(</span><span class="n">sounds</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span> <span class="n">fundamentals</span><span class="o">=</span><span class="n">fundamentals</span><span class="p">)</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a>        <span class="c1"># Else sound instances are supplied</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span> <span class="o">=</span> <span class="n">sounds</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a>            <span class="c1"># sound name defined in constructor</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a>            <span class="k">if</span> <span class="n">names</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">)):</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a>                <span class="k">for</span> <span class="n">sound</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">,</span> <span class="n">names</span><span class="p">):</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a>                    <span class="n">sound</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">n</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a>                <span class="c1"># names obtained from the supplied sounds</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a>                <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">sound</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span> <span class="k">if</span> <span class="n">sound</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a>                <span class="c1"># all sounds have a name</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">sounds</span><span class="p">):</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="n">names</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a>                <span class="c1"># Assign a default value to names</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a>                    <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sounds</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a>                    <span class="k">for</span> <span class="n">sound</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">,</span> <span class="n">names</span><span class="p">):</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a>                        <span class="n">sound</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">n</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a>            <span class="c1"># If the sounds are not conditionned condition them</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a>            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a>                <span class="k">if</span> <span class="o">~</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s1">&#39;signal&#39;</span><span class="p">):</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a>                    <span class="n">s</span><span class="o">.</span><span class="n">condition</span><span class="p">()</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a>        <span class="k">if</span> <span class="n">equalize_time</span><span class="p">:</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">equalize_time</span><span class="p">()</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a>        <span class="c1"># Define bin strings</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bin_strings</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">1</span><span class="p">:],</span> <span class="s1">&#39;brillance&#39;</span><span class="p">]</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a>        <span class="c1"># Sort according to fundamental</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a>        <span class="n">key</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">([</span><span class="n">sound</span><span class="o">.</span><span class="n">fundamental</span> <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">])</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">)[</span><span class="n">key</span><span class="p">]</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a>    <span class="k">def</span> <span class="nf">sounds_from_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sound_files</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fundamentals</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a><span class="sd">        Create Sound class instances and assign them to the SoundPack </span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a><span class="sd">        from a list of files</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a><span class="sd">        :param sound_files: sound filenames</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a><span class="sd">        :param names: sound names</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a><span class="sd">        :param fundamentals: user specified fundamental frequencies</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a><span class="sd">        :return: None</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a>        <span class="c1"># Make the default name list from sound filenames if none is supplied</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sound_files</span><span class="p">)):</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">file</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">sound_files</span><span class="p">]</span>  <span class="c1"># remove the .wav</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a>        <span class="c1"># If the fundamentals are not supplied or mismatch in number None is used</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">fundamentals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fundamentals</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sound_files</span><span class="p">)):</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a>            <span class="n">fundamentals</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sound_files</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a>        <span class="c1"># Create Sound instances from files</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a>        <span class="k">for</span> <span class="n">file</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fundamental</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sound_files</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">fundamentals</span><span class="p">):</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Sound</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">fundamental</span><span class="o">=</span><span class="n">fundamental</span><span class="p">,</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a>                                     <span class="n">SoundParams</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">))</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a>    <span class="k">def</span> <span class="nf">equalize_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a><span class="sd">        Trim the sounds so that they all have the length of the shortest sound, </span>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a><span class="sd">        trimming is done at the end of the sounds.</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a><span class="sd">        :return: None</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a>        <span class="n">trim_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">sound</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">signal</span><span class="p">)</span> <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">])</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a>        <span class="n">trimmed_sounds</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a>        <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a>            <span class="n">new_sound</span> <span class="o">=</span> <span class="n">sound</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a>            <span class="n">new_sound</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="n">new_sound</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">trim_time</span><span class="p">(</span><span class="n">trim_index</span> <span class="o">/</span> <span class="n">sound</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">sr</span><span class="p">)</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a>            <span class="n">new_sound</span><span class="o">.</span><span class="n">bin_divide</span><span class="p">()</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a>            <span class="n">trimmed_sounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_sound</span><span class="p">)</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span> <span class="o">=</span> <span class="n">trimmed_sounds</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a>    <span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a><span class="sd">        Normalize all the signals in the SoundPack and returns a normalized</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a><span class="sd">        instance of itself. See `Signal.normalize` for more information.</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a><span class="sd">        :return: SoundPack with normalized signals</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>        <span class="n">new_sounds</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">sound</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">]</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>        <span class="n">fundamentals</span> <span class="o">=</span> <span class="p">[</span><span class="n">sound</span><span class="o">.</span><span class="n">fundamental</span> <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">]</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a>        <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>            <span class="n">sound</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>            <span class="n">new_sounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sound</span><span class="p">)</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span> <span class="o">=</span> <span class="n">new_sounds</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a><span class="sd">    Methods for all SoundPacks</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a><span class="sd">        Superimposed plot of all the sounds on one figure for a specific kind</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a><span class="sd">        __ Multiple SoundPack Method __</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a><span class="sd">        Plots a specific signal.plot for all sounds on the same figure</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a><span class="sd">        Ex : SoundPack.plot(&#39;fft&#39;) plots the fft of all sounds on a single figure</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a><span class="sd">        The color argument is set to none so that the plots have different colors</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a><span class="sd">        :param kind: feature name passed to the `signal.plot()` method</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a><span class="sd">        :param kwargs: keywords arguments to pass to the `matplotlib.plot()` </span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a><span class="sd">        method</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a><span class="sd">        :return: None</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>        <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">name</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>            <span class="n">sound</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">method_dict</span><span class="p">[</span><span class="n">kind</span><span class="p">](</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">kind</span> <span class="o">+</span> <span class="s1">&#39; plot&#39;</span><span class="p">)</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>        <span class="k">return</span> <span class="n">ax</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a>    <span class="k">def</span> <span class="nf">compare_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a><span class="sd">        Plots all the sounds on different figures to compare them for a specific kind</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a><span class="sd">        __ Multiple SoundPack Method __</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a><span class="sd">        Draws the same kind of plot on a different axis for each sound</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a><span class="sd">        Example : `SoundPack.compare_plot(&#39;peaks&#39;)` with 4 Sounds will plot a </span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a><span class="sd">        figure with 4 axes, with each a different &#39;peak&#39; plot.</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a><span class="sd">        :param kind: kind argument passed to `Signal.plot()`</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a><span class="sd">        :param kwargs: key word arguments passed to `matplotlib.plot()`</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a><span class="sd">        :return: None</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a>        <span class="c1"># if a dual SoundPack : only plot two big plots</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;dual&#39;</span><span class="p">:</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a>            <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a>            <span class="k">for</span> <span class="n">sound</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">,</span> <span class="n">axs</span><span class="p">):</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a>                <span class="n">sound</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">method_dict</span><span class="p">[</span><span class="n">kind</span><span class="p">](</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">kind</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">sound</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a>        <span class="c1"># If a multiple SoundPack : plot on a grid of axes</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;multiple&#39;</span><span class="p">:</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a>            <span class="c1"># find the n, m values for the subplots line and columns</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a>            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">)</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a>            <span class="n">cols</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a>            <span class="k">if</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">4</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a>                <span class="c1"># a lot of sounds</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>                <span class="n">cols</span> <span class="o">=</span> <span class="mi">4</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a>            <span class="k">elif</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">3</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a>                <span class="c1"># many sounds</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a>                <span class="n">cols</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a>            <span class="k">elif</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a>                <span class="c1"># a few sounds</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a>                <span class="n">cols</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a>            <span class="n">remainder</span> <span class="o">=</span> <span class="n">n</span> <span class="o">%</span> <span class="n">cols</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a>            <span class="k">if</span> <span class="n">remainder</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a>                <span class="n">rows</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="n">cols</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a>                <span class="n">rows</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="n">cols</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a>            <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">rows</span><span class="p">))</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a>            <span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>            <span class="k">for</span> <span class="n">sound</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">,</span> <span class="n">axs</span><span class="p">):</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a>                <span class="n">sound</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">method_dict</span><span class="p">[</span><span class="n">kind</span><span class="p">](</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a>                <span class="n">title</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_title</span><span class="p">()</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a>                <span class="n">title</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">title</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a>            <span class="k">if</span> <span class="n">remainder</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a>                <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">cols</span> <span class="o">-</span> <span class="n">remainder</span><span class="p">):]:</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a>                    <span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>            <span class="k">raise</span> <span class="ne">Exception</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a>        <span class="k">return</span> <span class="n">axs</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a>    <span class="k">def</span> <span class="nf">freq_bin_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f_bin</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">):</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a><span class="sd">        Plots the log envelope of specified frequency bins</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a><span class="sd">        __ Multiple SoundPack Method __</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a><span class="sd">        A function to compare signals decomposed frequency wise in the time </span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a><span class="sd">        domain on a logarithm scale. The methods plot all the sounds and plots </span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a><span class="sd">        their frequency bins according to the frequency bin argument f_bin.</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a><span class="sd">        Example : SoundPack.freq_bin_plot(f_bin=&#39;mid&#39;) will plot the log-scale </span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a><span class="sd">        envelope of the &#39;mid&#39; signal of every sound in the SoundPack.</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a><span class="sd">        f_bin: frequency bins to compare, Supported arguments are :</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a><span class="sd">        &#39;all&#39;, &#39;bass&#39;, &#39;mid&#39;, &#39;highmid&#39;, &#39;uppermid&#39;, &#39;presence&#39;, &#39;brillance&#39;</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a>        <span class="k">if</span> <span class="n">f_bin</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a>            <span class="c1"># Create one plot per bin</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a>            <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a>            <span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">1</span><span class="p">:],</span> <span class="s1">&#39;brillance&#39;</span><span class="p">],</span> <span class="n">axs</span><span class="p">):</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>                <span class="c1"># plot every sound for a frequency bin</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a>                <span class="n">norm_factors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">norm_factor</span> <span class="k">for</span> <span class="n">son</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">])</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">son</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">):</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a>                    <span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">old_plot</span><span class="p">(</span><span class="s1">&#39;log envelope&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">son</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>                <span class="n">son</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>                <span class="n">title0</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s1">&#39; : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>                         <span class="nb">int</span><span class="p">(</span><span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; Hz, &#39;</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a>                <span class="n">title1</span> <span class="o">=</span> <span class="s1">&#39;Norm. Factors : &#39;</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>                <span class="n">title2</span> <span class="o">=</span> <span class="s1">&#39;x, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">norm_factor</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="k">for</span> <span class="n">norm_factor</span> <span class="ow">in</span> <span class="n">norm_factors</span><span class="p">)</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title0</span> <span class="o">+</span> <span class="n">title1</span> <span class="o">+</span> <span class="n">title2</span><span class="p">)</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a>        <span class="k">elif</span> <span class="n">f_bin</span> <span class="ow">in</span> <span class="p">[</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="n">sound_parameters</span><span class="p">()</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">1</span><span class="p">:],</span> <span class="s1">&#39;brillance&#39;</span><span class="p">]:</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a>            <span class="c1"># Plot every envelope for a single frequency bin</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a>            <span class="n">norm_factors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">norm_factor</span> <span class="k">for</span> <span class="n">son</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">])</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">son</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">):</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a>                <span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">old_plot</span><span class="p">(</span><span class="s1">&#39;log envelope&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;. &#39;</span> <span class="o">+</span> <span class="n">son</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a>            <span class="n">son</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a>            <span class="n">title0</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">f_bin</span> <span class="o">+</span> <span class="s1">&#39; : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a>                <span class="nb">int</span><span class="p">(</span><span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; Hz, &#39;</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a>            <span class="n">title1</span> <span class="o">=</span> <span class="s1">&#39;Norm. Factors : &#39;</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a>            <span class="n">title2</span> <span class="o">=</span> <span class="s1">&#39;x, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">norm_factor</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="k">for</span> <span class="n">norm_factor</span> <span class="ow">in</span> <span class="n">norm_factors</span><span class="p">)</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title0</span> <span class="o">+</span> <span class="n">title1</span> <span class="o">+</span> <span class="n">title2</span><span class="p">)</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;invalid frequency bin&#39;</span><span class="p">)</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a>    <span class="k">def</span> <span class="nf">fundamentals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a><span class="sd">        __ Multiple Soundpack Method __</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a><span class="sd">        Displays the fundamentals of every sound in the SoundPack</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a><span class="sd">        :return: None</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">sound</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">])</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a>        <span class="n">fundamentals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">sound</span><span class="o">.</span><span class="n">fundamental</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">])</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a>        <span class="n">key</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">fundamentals</span><span class="p">)</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a>        <span class="n">table_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">names</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">fundamentals</span><span class="p">[</span><span class="n">key</span><span class="p">]]</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a>        <span class="n">table_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">table_data</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table_data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Fundamental (Hz)&#39;</span><span class="p">]))</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a>    <span class="k">def</span> <span class="nf">integral_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f_bin</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">):</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a><span class="sd">        Normalized cumulative bin power plot for the frequency bins.</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a><span class="sd">        See `Plot.integral` for more information.</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a><span class="sd">        __ Multiple SoundPack Method __</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a><span class="sd">        Plots the cumulative integral plot of specified frequency bins</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a><span class="sd">        see help(Plot.integral)</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a><span class="sd">        :param f_bin: frequency bins to compare, Supported arguments are </span>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a><span class="sd">        &#39;all&#39;, &#39;bass&#39;, &#39;mid&#39;, &#39;highmid&#39;, &#39;uppermid&#39;, &#39;presence&#39;, &#39;brillance&#39;</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a>        <span class="k">if</span> <span class="n">f_bin</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a>            <span class="c1"># create a figure with 6 axes</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a>            <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a>            <span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bin_strings</span><span class="p">,</span> <span class="n">axs</span><span class="p">):</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a>                <span class="n">norm_factors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">norm_factor</span> <span class="k">for</span> <span class="n">son</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">])</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a>                <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a>                    <span class="n">sound</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">sound</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a>                <span class="n">sound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a>                <span class="n">title0</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s1">&#39; : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sound</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a>                    <span class="nb">int</span><span class="p">(</span><span class="n">sound</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; Hz, &#39;</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a>                <span class="n">title1</span> <span class="o">=</span> <span class="s1">&#39;Norm. Factors : &#39;</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a>                <span class="n">title2</span> <span class="o">=</span> <span class="s1">&#39;x, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">norm_factor</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="k">for</span> <span class="n">norm_factor</span> <span class="ow">in</span> <span class="n">norm_factors</span><span class="p">)</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title0</span> <span class="o">+</span> <span class="n">title1</span> <span class="o">+</span> <span class="n">title2</span><span class="p">)</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title0</span> <span class="o">+</span> <span class="n">title1</span> <span class="o">+</span> <span class="n">title2</span><span class="p">)</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a>        <span class="k">elif</span> <span class="n">f_bin</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_strings</span><span class="p">:</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a>            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a>            <span class="n">norm_factors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">norm_factor</span> <span class="k">for</span> <span class="n">son</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">])</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a>            <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a>                <span class="n">sound</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">sound</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a>            <span class="n">sound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a>            <span class="n">title0</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">f_bin</span> <span class="o">+</span> <span class="s1">&#39; : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sound</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a>                <span class="nb">int</span><span class="p">(</span><span class="n">sound</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; Hz, &#39;</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a>            <span class="n">title1</span> <span class="o">=</span> <span class="s1">&#39;Norm. Factors : &#39;</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a>            <span class="n">title2</span> <span class="o">=</span> <span class="s1">&#39;x, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">norm_factor</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="k">for</span> <span class="n">norm_factor</span> <span class="ow">in</span> <span class="n">norm_factors</span><span class="p">)</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title0</span> <span class="o">+</span> <span class="n">title1</span> <span class="o">+</span> <span class="n">title2</span><span class="p">)</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;invalid frequency bin&#39;</span><span class="p">)</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a>            
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a>    <span class="k">def</span> <span class="nf">bin_power_table</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a><span class="sd">        Displays a table with the signal power contained in every frequency bin</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a><span class="sd">        </span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a><span class="sd">        The power is computed as the time integral of the signal, such as :</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a><span class="sd">            $ P = \int_0^{t_{max}} sig(t) dt $</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a>        <span class="c1"># Bin power distribution table</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a>        <span class="n">bin_strings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_strings</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>        <span class="n">integrals</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a>        <span class="c1"># for every sound in the SoundPack</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a>        <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a>            <span class="n">integral</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a>            <span class="c1"># for every frequency bin in the sound</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a>            <span class="k">for</span> <span class="n">f_bin</span> <span class="ow">in</span> <span class="n">bin_strings</span><span class="p">:</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>                <span class="n">log_envelope</span><span class="p">,</span> <span class="n">log_time</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>                <span class="n">integral</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">log_envelope</span><span class="p">,</span> <span class="n">log_time</span><span class="p">))</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a>            <span class="c1"># a list of dict for every sound</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a>            <span class="n">integrals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a>        <span class="c1"># make the table</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a>        <span class="n">table_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="n">bin_strings</span><span class="p">),</span> <span class="o">*</span><span class="n">integrals</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a>        <span class="n">sound_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">sound</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">]</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;___ Signal Power Frequency Bin Distribution ___ </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table_data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bin&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">sound_names</span><span class="p">]))</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a>    <span class="k">def</span> <span class="nf">bin_power_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a><span class="sd">        Histogram of the frequency bin power for multiple sounds</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a><span class="sd">        frequency bin power is computed as the integral of the bin envelope, </span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a><span class="sd">        such as </span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a><span class="sd">            $ P = \int_0^{t_{max}} env(t) dt $</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a>        <span class="c1"># Compute the bin powers</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a>        <span class="n">bin_strings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_strings</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a>        <span class="n">integrals</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a>        <span class="c1"># for every sound in the SoundPack</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a>        <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a>            <span class="n">integral</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a>            <span class="c1"># for every frequency bin in the sound</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a>            <span class="k">for</span> <span class="n">f_bin</span> <span class="ow">in</span> <span class="n">bin_strings</span><span class="p">:</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a>                <span class="n">log_envelope</span><span class="p">,</span> <span class="n">log_time</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a>                <span class="n">integral</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">log_envelope</span><span class="p">,</span> <span class="n">log_time</span><span class="p">))</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a>            <span class="c1"># a list of dict for every sound</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a>            <span class="n">integral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a>            <span class="n">integral</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a>            <span class="n">integrals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>        <span class="c1"># create the bar plotting vectors</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>        <span class="c1"># make the bar plot</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">)</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>        <span class="n">width</span> <span class="o">=</span> <span class="mf">0.8</span> <span class="o">/</span> <span class="n">n</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>        <span class="c1"># get nice colors</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a>        <span class="n">cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;Set2&#39;</span><span class="p">)</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sound</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">):</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">width</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">bin_strings</span><span class="p">)</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">width</span><span class="p">)</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">integrals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a>            <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a>                <span class="n">color</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>                <span class="n">color</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">tick_label</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">bin_strings</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">sound</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">sound</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;frequency bin name&#39;</span><span class="p">)</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;normalized power&#39;</span><span class="p">)</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>    
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a>    <span class="k">def</span> <span class="nf">listen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a><span class="sd">        Listen to all the sounds in the SoundPack inside the Jupyter Notebook </span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a><span class="sd">        environment</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>        <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>            <span class="n">sound</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">listen</span><span class="p">()</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a><span class="w">        </span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a><span class="sd">    Methods for dual SoundPacks</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a>    <span class="k">def</span> <span class="nf">compare_peaks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a><span class="sd">        Plot to compare the FFT peaks values of two sounds</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a><span class="sd">        __ Dual SoundPack Method __</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a><span class="sd">        Compares the peaks in the Fourier Transform of two Sounds,</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a><span class="sd">        the peaks having the highest difference are highlighted. If no peaks</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a><span class="sd">        are found to have a significant difference, only the two normalized </span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a><span class="sd">        Fourier transform are plotted in a mirror configuration to visualize</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a><span class="sd">        them.</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;dual&#39;</span><span class="p">:</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a>            <span class="n">son1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a>            <span class="n">son2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a>            <span class="n">index1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">son1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">fft_range</span><span class="o">.</span><span class="n">value</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>            <span class="n">index2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">son2</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">fft_range</span><span class="o">.</span><span class="n">value</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>            <span class="c1"># Get the peak data from the sounds</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>            <span class="n">peaks1</span> <span class="o">=</span> <span class="n">son1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">peaks</span><span class="p">()</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a>            <span class="n">peaks2</span> <span class="o">=</span> <span class="n">son2</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">peaks</span><span class="p">()</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>            <span class="n">freq1</span> <span class="o">=</span> <span class="n">son1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[:</span><span class="n">index1</span><span class="p">]</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>            <span class="n">freq2</span> <span class="o">=</span> <span class="n">son2</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[:</span><span class="n">index2</span><span class="p">]</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a>            <span class="n">fft1</span> <span class="o">=</span> <span class="n">son1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft</span><span class="p">()[:</span><span class="n">index1</span><span class="p">]</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>            <span class="n">fft2</span> <span class="o">=</span> <span class="n">son2</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft</span><span class="p">()[:</span><span class="n">index2</span><span class="p">]</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a>            <span class="n">short_peaks_1</span> <span class="o">=</span> <span class="p">[</span><span class="n">peak</span> <span class="k">for</span> <span class="n">peak</span> <span class="ow">in</span> <span class="n">peaks1</span> <span class="k">if</span> <span class="n">peak</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">freq1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a>            <span class="n">short_peaks_2</span> <span class="o">=</span> <span class="p">[</span><span class="n">peak</span> <span class="k">for</span> <span class="n">peak</span> <span class="ow">in</span> <span class="n">peaks2</span> <span class="k">if</span> <span class="n">peak</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">freq1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>            <span class="n">peak_distance1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">freq1</span><span class="p">[</span><span class="n">peaks1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">-</span> <span class="n">freq1</span><span class="p">[</span><span class="n">peaks1</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">short_peaks_1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)])</span> <span class="o">/</span> <span class="mi">4</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a>            <span class="n">peak_distance2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">freq2</span><span class="p">[</span><span class="n">peaks2</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">-</span> <span class="n">freq2</span><span class="p">[</span><span class="n">peaks2</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">short_peaks_2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)])</span> <span class="o">/</span> <span class="mi">4</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a>            <span class="n">peak_distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">peak_distance1</span><span class="p">,</span> <span class="n">peak_distance2</span><span class="p">]))</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>            <span class="c1"># Align  the two peak vectors</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a>            <span class="n">new_peaks1</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>            <span class="n">new_peaks2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a>            <span class="k">for</span> <span class="n">peak1</span> <span class="ow">in</span> <span class="n">short_peaks_1</span><span class="p">:</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>                <span class="k">for</span> <span class="n">peak2</span> <span class="ow">in</span> <span class="n">short_peaks_2</span><span class="p">:</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">freq1</span><span class="p">[</span><span class="n">peak1</span><span class="p">]</span> <span class="o">-</span> <span class="n">freq2</span><span class="p">[</span><span class="n">peak2</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">peak_distance</span><span class="p">:</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>                        <span class="n">new_peaks1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">peak1</span><span class="p">)</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>                        <span class="n">new_peaks2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">peak2</span><span class="p">)</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>            <span class="n">new_peaks1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">new_peaks1</span><span class="p">))</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>            <span class="n">new_peaks2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">new_peaks2</span><span class="p">))</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a>            <span class="n">different_peaks1</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a>            <span class="n">different_peaks2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a>            <span class="n">difference_threshold</span> <span class="o">=</span> <span class="mf">0.5</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a>            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">different_peaks1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a>                <span class="k">for</span> <span class="n">peak1</span><span class="p">,</span> <span class="n">peak2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">new_peaks1</span><span class="p">,</span> <span class="n">new_peaks2</span><span class="p">):</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a>                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fft1</span><span class="p">[</span><span class="n">peak1</span><span class="p">]</span> <span class="o">-</span> <span class="n">fft2</span><span class="p">[</span><span class="n">peak2</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">difference_threshold</span><span class="p">:</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a>                        <span class="n">different_peaks1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">peak1</span><span class="p">)</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a>                        <span class="n">different_peaks2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">peak2</span><span class="p">)</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a>                <span class="n">difference_threshold</span> <span class="o">-=</span> <span class="mf">0.01</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a>                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">difference_threshold</span><span class="p">,</span> <span class="mf">0.</span><span class="p">):</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a>                    <span class="k">break</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a>            <span class="c1"># Plot the output</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;symlog&#39;</span><span class="p">,</span> <span class="n">linthresh</span><span class="o">=</span><span class="mf">10e-1</span><span class="p">)</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a>            <span class="c1"># Sound 1</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq1</span><span class="p">,</span> <span class="n">fft1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#919191&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">son1</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">freq1</span><span class="p">[</span><span class="n">new_peaks1</span><span class="p">],</span> <span class="n">fft1</span><span class="p">[</span><span class="n">new_peaks1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;peaks&#39;</span><span class="p">)</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">different_peaks1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">freq1</span><span class="p">[</span><span class="n">different_peaks1</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">fft1</span><span class="p">[</span><span class="n">different_peaks1</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;diff peaks&#39;</span><span class="p">)</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a>                <span class="n">annotation_string</span> <span class="o">=</span> <span class="s1">&#39;Peaks with &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">difference_threshold</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; difference&#39;</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">annotation_string</span><span class="p">,</span> <span class="p">(</span><span class="n">freq1</span><span class="p">[</span><span class="n">different_peaks1</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">peak_distance</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">fft1</span><span class="p">[</span><span class="n">different_peaks1</span><span class="p">[</span><span class="mi">0</span><span class="p">]]))</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a>            <span class="c1"># Sound2</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq2</span><span class="p">,</span> <span class="o">-</span><span class="n">fft2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#3d3d3d&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">son2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">freq2</span><span class="p">[</span><span class="n">new_peaks2</span><span class="p">],</span> <span class="o">-</span><span class="n">fft2</span><span class="p">[</span><span class="n">new_peaks2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">different_peaks2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">freq2</span><span class="p">[</span><span class="n">different_peaks2</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="o">-</span><span class="n">fft2</span><span class="p">[</span><span class="n">different_peaks2</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Fourier Transform Peak Analysis for &#39;</span> <span class="o">+</span> <span class="n">son1</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; and &#39;</span> <span class="o">+</span> <span class="n">son2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a>            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;mirror amplitude (0-1)&#39;</span><span class="p">)</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Unsupported for multiple sounds SoundPacks&#39;</span><span class="p">)</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a>    <span class="k">def</span> <span class="nf">fft_mirror</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a><span class="sd">        Plot the Fourier Transforms of two sounds on opposed axis to compare the spectral content</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a><span class="sd">        __ Dual SoundPack Method __</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a><span class="sd">        The fourier transforms are plotted normalized between 0 and 1. </span>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a><span class="sd">        The y scale is symmetric logarithmic, so that a signal is plotted </span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a><span class="sd">        between 0 and -1, and the other is plotted between 0 and 1. </span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a><span class="sd">        :return: None</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;dual&#39;</span><span class="p">:</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a>            <span class="n">son1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a>            <span class="n">son2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a>            <span class="n">fft_range_value</span> <span class="o">=</span> <span class="n">sound_parameters</span><span class="p">()</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">fft_range</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a>            <span class="n">fft_freq_value</span> <span class="o">=</span> <span class="n">son1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fft_freq_value</span> <span class="o">&gt;</span> <span class="n">fft_range_value</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;symlog&#39;</span><span class="p">)</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">son1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[:</span><span class="n">index</span><span class="p">],</span> <span class="n">son1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft</span><span class="p">()[:</span><span class="n">index</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">son1</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">son2</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[:</span><span class="n">index</span><span class="p">],</span> <span class="o">-</span><span class="n">son2</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft</span><span class="p">()[:</span><span class="n">index</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">son2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;mirror amplitude (normalized)&#39;</span><span class="p">)</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Mirror Fourier Transform for &#39;</span> <span class="o">+</span> <span class="n">son1</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; and &#39;</span> <span class="o">+</span> <span class="n">son2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Unsupported for multiple sounds SoundPacks&#39;</span><span class="p">)</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>    <span class="k">def</span> <span class="nf">fft_diff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a><span class="sd">        Plot the difference between the spectral distribution in the two sounds</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a><span class="sd">        __ Dual SoundPack Method __</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a><span class="sd">        Compare the Fourier Transform of two sounds by computing the differences of the octave bins heights.</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a><span class="sd">        The two FTs are superimposed on the first plot to show differences</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a><span class="sd">        The difference between the two FTs is plotted on the second plot</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a><span class="sd">        :param fraction: octave fraction value used to compute the frequency bins A higher number will show</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a><span class="sd">        a more precise comparison, but conclusions may be harder to draw.</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a><span class="sd">        :param ticks:  If equal to &#39;bins&#39; the frequency bins intervals are used as X axis ticks</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a><span class="sd">        :return: None</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;dual&#39;</span><span class="p">:</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a>            <span class="c1"># Separate the sounds</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>            <span class="n">son1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>            <span class="n">son2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a>            <span class="c1"># Compute plotting bins</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a>            <span class="n">x_values</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">octave_values</span><span class="p">(</span><span class="n">fraction</span><span class="p">)</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>            <span class="n">hist_bins</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">octave_histogram</span><span class="p">(</span><span class="n">fraction</span><span class="p">)</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>            <span class="n">bar_widths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">hist_bins</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">hist_bins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">hist_bins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)])</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a>            <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a>            <span class="n">plot1</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">son1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_bins</span><span class="p">(),</span> <span class="n">utils</span><span class="o">.</span><span class="n">octave_histogram</span><span class="p">(</span><span class="n">fraction</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a>                             <span class="n">label</span><span class="o">=</span><span class="n">son1</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a>            <span class="n">plot2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">son2</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_bins</span><span class="p">(),</span> <span class="n">utils</span><span class="o">.</span><span class="n">octave_histogram</span><span class="p">(</span><span class="n">fraction</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a>                             <span class="n">label</span><span class="o">=</span><span class="n">son2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a>            <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;FT Histogram for &#39;</span> <span class="o">+</span> <span class="n">son1</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; and &#39;</span> <span class="o">+</span> <span class="n">son2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a>            <span class="n">ax1</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a>            <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a>            <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;amplitude&#39;</span><span class="p">)</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a>            <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a>            <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a>            <span class="n">diff</span> <span class="o">=</span> <span class="n">plot1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">plot2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>            <span class="n">n_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">diff</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>            <span class="n">p_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">diff</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a>            <span class="c1"># Negative difference corresponding to sound 2</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>            <span class="n">ax2</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x_values</span><span class="p">[</span><span class="n">n_index</span><span class="p">],</span> <span class="n">diff</span><span class="p">[</span><span class="n">n_index</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="n">bar_widths</span><span class="p">[</span><span class="n">n_index</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a>            <span class="c1"># Positive difference corresponding to sound1</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a>            <span class="n">ax2</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x_values</span><span class="p">[</span><span class="n">p_index</span><span class="p">],</span> <span class="n">diff</span><span class="p">[</span><span class="n">p_index</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="n">bar_widths</span><span class="p">[</span><span class="n">p_index</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a>            <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Difference &#39;</span> <span class="o">+</span> <span class="n">son1</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="n">son2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a>            <span class="n">ax2</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a>            <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a>            <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&lt;- sound 2 : sound 1 -&gt;&#39;</span><span class="p">)</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>            <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a>            <span class="k">if</span> <span class="n">ticks</span> <span class="o">==</span> <span class="s1">&#39;bins&#39;</span><span class="p">:</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a>                <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">label</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="vm">__dict__</span> <span class="k">if</span> <span class="n">label</span> <span class="o">!=</span> <span class="s1">&#39;name&#39;</span><span class="p">]</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a>                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;brillance&#39;</span><span class="p">)</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a>                <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">param</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">param</span> <span class="o">!=</span> <span class="s1">&#39;bins&#39;</span><span class="p">]</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a>                <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">11250</span><span class="p">)</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a>                <span class="n">x_formatter</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FixedFormatter</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a>                <span class="n">x_locator</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a>                <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">x_locator</span><span class="p">)</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a>                <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">x_formatter</span><span class="p">)</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a>                <span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelrotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a>                <span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">x_locator</span><span class="p">)</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>                <span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">x_formatter</span><span class="p">)</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>                <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelrotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Unsupported for multiple sounds SoundPacks&#39;</span><span class="p">)</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a>    <span class="k">def</span> <span class="nf">integral_compare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f_bin</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">):</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a><span class="sd">          Cumulative bin envelope integral comparison for two signals</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a><span class="sd">          __ Dual SoundPack Method __</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a><span class="sd">          Plots the cumulative integral plot of specified frequency bins</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a><span class="sd">          and their difference as surfaces</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a><span class="sd">          f_bin: frequency bins to compare, Supported arguments are :</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a><span class="sd">          &#39;all&#39;, &#39;bass&#39;, &#39;mid&#39;, &#39;highmid&#39;, &#39;uppermid&#39;, &#39;presence&#39;, &#39;brillance&#39;</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a><span class="sd">          &quot;&quot;&quot;</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a>        <span class="c1"># Case when plotting all the frequency bins</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a>        <span class="k">if</span> <span class="n">f_bin</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a>            <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a>            <span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a>            <span class="c1"># get the bins frequency values</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">bin_strings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>            <span class="n">bins1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a>            <span class="n">bins2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>            <span class="k">for</span> <span class="n">signal1</span><span class="p">,</span> <span class="n">signal2</span><span class="p">,</span> <span class="n">bin_string</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bins1</span><span class="p">,</span> <span class="n">bins2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_strings</span><span class="p">,</span> <span class="n">axs</span><span class="p">):</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a>                <span class="c1"># Compute the log time and envelopes integrals</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a>                <span class="n">log_envelope1</span><span class="p">,</span> <span class="n">log_time1</span> <span class="o">=</span> <span class="n">signal1</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a>                <span class="n">log_envelope2</span><span class="p">,</span> <span class="n">log_time2</span> <span class="o">=</span> <span class="n">signal2</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a>                <span class="n">env_range1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">log_envelope1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a>                <span class="n">env_range2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">log_envelope2</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a>                <span class="n">integral1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">log_envelope1</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">log_time1</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">env_range1</span><span class="p">])</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a>                <span class="n">integral2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">log_envelope2</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">log_time2</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">env_range2</span><span class="p">])</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a>                <span class="n">time1</span> <span class="o">=</span> <span class="n">log_time1</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">log_time1</span><span class="p">):</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a>                <span class="n">time2</span> <span class="o">=</span> <span class="n">log_time2</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">log_time2</span><span class="p">):</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a>                <span class="c1"># resize arrays to match shape</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a>                <span class="n">common_len</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">time2</span><span class="p">))</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a>                <span class="n">time1</span> <span class="o">=</span> <span class="n">time1</span><span class="p">[:</span><span class="n">common_len</span><span class="p">]</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a>                <span class="n">time2</span> <span class="o">=</span> <span class="n">time2</span><span class="p">[:</span><span class="n">common_len</span><span class="p">]</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a>                <span class="n">integral1</span> <span class="o">=</span> <span class="n">integral1</span><span class="p">[:</span><span class="n">common_len</span><span class="p">]</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a>                <span class="n">integral2</span> <span class="o">=</span> <span class="n">integral2</span><span class="p">[:</span><span class="n">common_len</span><span class="p">]</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a>                <span class="c1"># Normalize</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a>                <span class="n">max_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">integral1</span><span class="p">,</span> <span class="n">integral2</span><span class="p">]))</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a>                <span class="n">integral1</span> <span class="o">/=</span> <span class="n">max_value</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a>                <span class="n">integral2</span> <span class="o">/=</span> <span class="n">max_value</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a>                <span class="c1"># plot the integral area curves</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">time1</span><span class="p">,</span> <span class="n">integral1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">time2</span><span class="p">,</span> <span class="o">-</span><span class="n">integral2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">time2</span><span class="p">,</span> <span class="n">integral1</span> <span class="o">-</span> <span class="n">integral2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;int diff&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;mirror cumulative power (normalized)&#39;</span><span class="p">)</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">bin_string</span><span class="p">)</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a>        <span class="k">elif</span> <span class="n">f_bin</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_strings</span><span class="p">:</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a>            <span class="c1"># Compute the log envelopes and areau curves</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a>            <span class="n">signal1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a>            <span class="n">signal2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a>            <span class="n">log_envelope1</span><span class="p">,</span> <span class="n">log_time1</span> <span class="o">=</span> <span class="n">signal1</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>            <span class="n">log_envelope2</span><span class="p">,</span> <span class="n">log_time2</span> <span class="o">=</span> <span class="n">signal2</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a>            <span class="n">integral1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">log_envelope1</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">log_time1</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">log_envelope1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)])</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a>            <span class="n">integral2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">log_envelope2</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">log_time2</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">log_envelope2</span><span class="p">),</span> <span class="mi">1</span><span class="p">)])</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a>            <span class="n">time1</span> <span class="o">=</span> <span class="n">log_time1</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">log_time1</span><span class="p">):</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a>            <span class="n">time2</span> <span class="o">=</span> <span class="n">log_time2</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">log_time2</span><span class="p">):</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>            <span class="c1"># resize arrays to match shape</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a>            <span class="n">common_len</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">time2</span><span class="p">))</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a>            <span class="n">time1</span> <span class="o">=</span> <span class="n">time1</span><span class="p">[:</span><span class="n">common_len</span><span class="p">]</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a>            <span class="n">time2</span> <span class="o">=</span> <span class="n">time2</span><span class="p">[:</span><span class="n">common_len</span><span class="p">]</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a>            <span class="n">integral1</span> <span class="o">=</span> <span class="n">integral1</span><span class="p">[:</span><span class="n">common_len</span><span class="p">]</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a>            <span class="n">integral2</span> <span class="o">=</span> <span class="n">integral2</span><span class="p">[:</span><span class="n">common_len</span><span class="p">]</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a>            <span class="c1"># Normalize</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a>            <span class="n">max_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">integral1</span><span class="p">,</span> <span class="n">integral2</span><span class="p">]))</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a>            <span class="n">integral1</span> <span class="o">/=</span> <span class="n">max_value</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a>            <span class="n">integral2</span> <span class="o">/=</span> <span class="n">max_value</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a>            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">time1</span><span class="p">,</span> <span class="n">integral1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">time2</span><span class="p">,</span> <span class="o">-</span><span class="n">integral2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">time2</span><span class="p">,</span> <span class="n">integral1</span> <span class="o">-</span> <span class="n">integral2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;int diff&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;mirror cumulative power (normalized)&#39;</span><span class="p">)</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">f_bin</span><span class="p">)</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;invalid frequency bin&#39;</span><span class="p">)</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a><span class="k">class</span> <span class="nc">Sound</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a><span class="sd">    A class to store audio signals obtained from a sound and compare them</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">condition</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">auto_trim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a>                 <span class="n">use_raw_signal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">normalize_raw_signal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a>                 <span class="n">fundamental</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">SoundParams</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a><span class="sd">        Creates a Sound instance from a .wav file, name as a string and </span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a><span class="sd">        fundamental frequency value can be user specified.</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a><span class="sd">        :param data: data path to the .wav data</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a><span class="sd">        :param name: Sound instance name to use in plot legend and titles</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a><span class="sd">        :param condition: Bool, whether to condition or not the Sound instance </span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a><span class="sd">        if `True`, the `Sound` instance is conditioned in the constructor</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a><span class="sd">        :param auto_trim: Bool, whether to trim the end of the sound or not </span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a><span class="sd">        according to predefined sound length correlated to the fundamental.</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a><span class="sd">        :param use_raw_signal: Do not condition the `Sound` and instead </span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a><span class="sd">        use the raw signal</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a><span class="sd">        :param normalize_raw_signal: If `use_raw_signal` is `True`, setting </span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a><span class="sd">        `normalize_raw_signal` to `True` will normalize the raw signal before it</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a><span class="sd">        is used in the `Sound` class</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a><span class="sd">        :param fundamental: Fundamental frequency value if None the value is </span>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a><span class="sd">        estimated</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a><span class="sd">        from the FFT (see `Signal.fundamental`).</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a><span class="sd">        :param SoundParams: SoundParameters to use in the Sound instance</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a>        <span class="c1"># create a reference of the parameters</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a>        <span class="k">if</span> <span class="n">SoundParams</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">SP</span> <span class="o">=</span> <span class="n">sound_parameters</span><span class="p">()</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">SP</span> <span class="o">=</span> <span class="n">SoundParams</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a>            <span class="c1"># Load the sound data using librosa</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;wav&#39;</span><span class="p">:</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Only .wav are supported&#39;</span><span class="p">)</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a>                <span class="n">signal</span><span class="p">,</span> <span class="n">sr</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">load_wav</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>            <span class="n">signal</span><span class="p">,</span> <span class="n">sr</span> <span class="o">=</span> <span class="n">data</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a>        <span class="c1"># create a Signal class from the signal and sample rate</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">raw_signal</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">)</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a>        <span class="c1"># create an empty plot attribute</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a>        <span class="c1"># Allow user specified fundamental</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fundamental</span> <span class="o">=</span> <span class="n">fundamental</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>        <span class="c1"># create an empty signal attribute</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trimmed_signal</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bins</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bass</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mid</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">highmid</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">uppermid</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">presence</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">brillance</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a>        <span class="k">if</span> <span class="n">condition</span><span class="p">:</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a>                           <span class="n">return_self</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a>                           <span class="n">auto_trim</span><span class="o">=</span><span class="n">auto_trim</span><span class="p">,</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a>                           <span class="n">resample</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a>            <span class="k">if</span> <span class="n">use_raw_signal</span><span class="p">:</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">use_raw_signal</span><span class="p">(</span><span class="n">normalized</span><span class="o">=</span><span class="n">normalize_raw_signal</span><span class="p">,</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a>                                    <span class="n">return_self</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a>    <span class="k">def</span> <span class="nf">condition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_self</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">auto_trim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">resample</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a><span class="sd">        A method conditioning the Sound instance.</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a><span class="sd">        - Trimming to just before the onset</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a><span class="sd">        :param verbose: if True problem with trimming are reported</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a><span class="sd">        :param return_self: If True the method returns the conditioned Sound instance</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a><span class="sd">        :param auto_trim: If True, the sound is trimmed to a fixed length according to its fundamental</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a><span class="sd">        :param resample: If True, the signal is resampled to 22050 Hz</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a><span class="sd">        :return: a conditioned Sound instance if `return_self = True`</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a>        <span class="c1"># Resample only if the sample rate is not 22050</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a>        <span class="k">if</span> <span class="n">resample</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_signal</span><span class="o">.</span><span class="n">sr</span> <span class="o">!=</span> <span class="mi">22050</span><span class="p">):</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a>            <span class="n">signal</span><span class="p">,</span> <span class="n">sr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_signal</span><span class="o">.</span><span class="n">signal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_signal</span><span class="o">.</span><span class="n">sr</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">raw_signal</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="mi">22050</span><span class="p">),</span> <span class="mi">22050</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">)</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trim_signal</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trimmed_signal</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fundamental</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fundamental</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fundamental</span><span class="p">()</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>        <span class="k">if</span> <span class="n">auto_trim</span><span class="p">:</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a>            <span class="n">time</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">freq2trim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fundamental</span><span class="p">)</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">trim_time</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">plot</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bin_divide</span><span class="p">()</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>        <span class="k">if</span> <span class="n">return_self</span><span class="p">:</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a>    <span class="k">def</span> <span class="nf">use_raw_signal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_self</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a><span class="sd">        Assigns the raw signal to the `signal` attribute of the Sound instance to</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a><span class="sd">        analyze it</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a><span class="sd">        :param normalized: if True, the raw signal is first normalized</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a><span class="sd">        :param return_self: if True the Sound instance is return after the signal attribute is defined</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a><span class="sd">        :return: None, self if return_self is True</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a>        <span class="k">if</span> <span class="n">normalized</span><span class="p">:</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_signal</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_signal</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bin_divide</span><span class="p">()</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a>        <span class="k">if</span> <span class="n">return_self</span><span class="p">:</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a>    <span class="k">def</span> <span class="nf">bin_divide</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a><span class="sd">        Calls the `.make_freq_bins` method of the signal to create the signals associated</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a><span class="sd">        to the frequency bins. The bins are all stored in the `.bin` attribute and also as</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a><span class="sd">        their names (Ex: `Sound.mid` contains the mid signal).</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a><span class="sd">        :return: None</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; a method to divide the main signal into frequency bins&quot;&quot;&quot;</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a>        <span class="c1"># divide in frequency bins</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">make_freq_bins</span><span class="p">()</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a>        <span class="c1"># unpack the bins</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bass</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">highmid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">uppermid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">presence</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">brillance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a>    <span class="k">def</span> <span class="nf">trim_signal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a><span class="sd">        A method to trim the signal to a specific time before the onset. The time value</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a><span class="sd">        can be changed in the SoundParameters.</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a><span class="sd">        :param verbose: if True problems encountered are printed to the terminal</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a><span class="sd">        :return: None</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a>        <span class="c1"># Trim the signal in the signal class</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trimmed_signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_signal</span><span class="o">.</span><span class="n">trim_onset</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a>    <span class="k">def</span> <span class="nf">listen_freq_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a><span class="sd">        Method to listen to all the frequency bins of a sound</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a><span class="sd">        The bins signals are obtained by filtering the sound signal</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a><span class="sd">        with band pass filters.</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a><span class="sd">        See guitarsounds.parameters.sound_parameters().bins.info() for the</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a><span class="sd">        frequency bin intervals.</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a>            <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">listen</span><span class="p">()</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a>    <span class="k">def</span> <span class="nf">plot_freq_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">):</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a><span class="sd">        Method to plot all the frequency bins logarithmic envelopes of a sound</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a><span class="sd">        The parameter `bins` allows choosing specific frequency bins to plot</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a><span class="sd">        By default the function plots all the bins</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a><span class="sd">        Supported bins arguments are :</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a><span class="sd">        &#39;all&#39;, &#39;bass&#39;, &#39;mid&#39;, &#39;highmid&#39;, &#39;uppermid&#39;, &#39;presence&#39;, &#39;brillance&#39;</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a><span class="sd">        Example :</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a><span class="sd">        `Sound.plot_freq_bins(bins=&#39;all&#39;)` plots all the frequency bins</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a><span class="sd">        `Sound.plot_freq_bins(bins=[&#39;bass&#39;, &#39;mid&#39;])` plots the bass and mid bins</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>        <span class="k">if</span> <span class="n">bins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>            <span class="n">bins</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>        <span class="k">if</span> <span class="n">bins</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a>            <span class="n">bins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">bins</span><span class="p">:</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>            <span class="n">lab</span> <span class="o">=</span> <span class="n">key</span> <span class="o">+</span> <span class="s1">&#39; : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; Hz&#39;</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">old_plot</span><span class="p">(</span><span class="s1">&#39;log envelope&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">lab</span><span class="p">)</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;x-small&quot;</span><span class="p">)</span>  <span class="c1"># using a named size</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a>    <span class="k">def</span> <span class="nf">peak_damping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a><span class="sd">        Prints a table with peak damping values and peak frequency values</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a><span class="sd">        The peaks are found with the `signal.peaks()` function and the damping</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a><span class="sd">        values are computed with the half power bandwidth method.</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a>        <span class="n">peak_indexes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">peaks</span><span class="p">()</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a>        <span class="n">frequencies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[</span><span class="n">peak_indexes</span><span class="p">]</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a>        <span class="n">damping</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">peak_damping</span><span class="p">()</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>        <span class="n">table_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">damping</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table_data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">,</span> <span class="s1">&#39;Damping ratio (%)&#39;</span><span class="p">]))</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a>    <span class="k">def</span> <span class="nf">bin_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a><span class="sd">        Histogram of the frequency bin power</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a><span class="sd">        frequency bin power is computed as the integral of the bin envelope.</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a><span class="sd">        See guitarsounds.parameters.sound_parameters().bins.info() for the</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a><span class="sd">        frequency bin intervals.</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a>        <span class="c1"># Compute the bin powers</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a>        <span class="n">bin_strings</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a>        <span class="n">integrals</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a>        <span class="k">for</span> <span class="n">f_bin</span> <span class="ow">in</span> <span class="n">bin_strings</span><span class="p">:</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a>            <span class="n">log_envelope</span><span class="p">,</span> <span class="n">log_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a>            <span class="n">integral</span> <span class="o">=</span> <span class="n">trapezoid</span><span class="p">(</span><span class="n">log_envelope</span><span class="p">,</span> <span class="n">log_time</span><span class="p">)</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>            <span class="n">integrals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a>        <span class="n">max_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">integrals</span><span class="p">)</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a>        <span class="n">integrals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">integrals</span><span class="p">)</span><span class="o">/</span><span class="n">max_value</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a>        <span class="c1"># create the bar plotting vectors</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">bin_strings</span><span class="p">))</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">integrals</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">tick_label</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">bin_strings</span><span class="p">))</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;frequency bin name&quot;</span><span class="p">)</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;frequency bin power (normalized)&quot;</span><span class="p">)</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a><span class="k">class</span> <span class="nc">Signal</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a><span class="sd">    A Class to do computations on an audio signal.</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a><span class="sd">    The signal is never changed in the class, when transformations are made, a new instance is returned.</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">SoundParam</span><span class="p">,</span> <span class="n">freq_range</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a><span class="sd">        Create a Signal class from a vector of samples and a sample rate</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a><span class="sd">        :param signal: vector containing the signal samples</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a><span class="sd">        :param sr: sample rate of the signal (Hz)</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a><span class="sd">        :param SoundParam: Sound Parameter instance to use with the signal</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a><span class="sd">        :para freq_range: Frequency range to use with the signal.</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a><span class="sd">        This is the maximum frequency used when computing Fourier transform</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a><span class="sd">        peaks and plotting Fourier transform related plots.</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">SP</span> <span class="o">=</span> <span class="n">SoundParam</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">onset</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="n">signal</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sr</span> <span class="o">=</span> <span class="n">sr</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">range</span> <span class="o">=</span> <span class="n">freq_range</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span> <span class="o">=</span> <span class="n">Plot</span><span class="p">()</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">norm_factor</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a>    <span class="k">def</span> <span class="nf">time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a><span class="sd">        Returns the time vector associated with the signal</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a><span class="sd">        :return: numpy array corresponding to the time values</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a><span class="sd">        of the signal samples in seconds</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a>                           <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">),</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a>                           <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">))</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a>    <span class="k">def</span> <span class="nf">listen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a><span class="sd">        Method to listen the sound signal in a Jupyter Notebook</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a><span class="sd">        Listening to the sounds imported in the analysis tool allows the</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a><span class="sd">        user to validate if the sound was well trimmed and filtered</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a><span class="sd">        A temporary file is created, the IPython display Audio function is</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a><span class="sd">        called on it and then the file is removed</span>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="s1">&#39;temp.wav&#39;</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a>        <span class="n">write</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">)</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a>        <span class="n">ipd</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">ipd</span><span class="o">.</span><span class="n">Audio</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a>        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a>    <span class="k">def</span> <span class="nf">old_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a><span class="sd">        Convenience function for the different signal plots</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a><span class="sd">        Calls the function corresponding to Plot.kind()</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a><span class="sd">        See help(guitarsounds.analysis.Plot) for info on the different plots</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">method_dict</span><span class="p">[</span><span class="n">kind</span><span class="p">](</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a>    <span class="k">def</span> <span class="nf">fft</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a><span class="sd">        Computes the Fast Fourier Transform of the signal and returns the vector.</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a><span class="sd">        :return: Fast Fourier Transform amplitude values in a numpy array</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a>        <span class="n">fft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">)</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a>        <span class="n">fft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fft</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fft</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)])</span>  <span class="c1"># Only the symmetric part of the absolute value</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a>        <span class="k">return</span> <span class="n">fft</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">fft</span><span class="p">)</span>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a>    <span class="k">def</span> <span class="nf">spectral_centroid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a><span class="sd">        Spectral centroid of the frequency content of the signal</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a><span class="sd">        :return: Spectral centroid of the signal (float)</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a>        <span class="n">SC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">()</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">())</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">())</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a>        <span class="k">return</span> <span class="n">SC</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a>    <span class="k">def</span> <span class="nf">peaks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">result</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a><span class="sd">        Computes the harmonic peaks indexes from the FFT of the signal</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a><span class="sd">        :param max_freq: Supply a max frequency value overriding the one in</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a><span class="sd">        guitarsounds_parameters</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a><span class="sd">        :param height: if True the height threshold is returned to be used</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a><span class="sd">        in the &#39;peaks&#39; plot</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a><span class="sd">        :param result: if True the Scipy peak finding results dictionary</span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a><span class="sd">        is returned</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a><span class="sd">        :return: peak indexes</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a>        <span class="c1"># Replace None by the default value</span>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a>        <span class="k">if</span> <span class="n">max_freq</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a>            <span class="n">max_freq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">fft_range</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a>        <span class="c1"># Get the fft and fft frequencies from the signal</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a>        <span class="n">fft</span><span class="p">,</span> <span class="n">fft_freq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a>        <span class="c1"># Find the max index</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a>            <span class="n">max_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fft_freq</span> <span class="o">&gt;=</span> <span class="n">max_freq</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a>        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a>            <span class="n">max_index</span> <span class="o">=</span> <span class="n">fft_freq</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> 
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a>        <span class="c1"># Find an approximation of the distance between peaks, this only works for harmonic signals</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a>        <span class="n">peak_distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">fft</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a>        <span class="c1"># Maximum of the signal in a small region on both ends</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a>        <span class="n">fft_max_start</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">fft</span><span class="p">[:</span><span class="n">peak_distance</span><span class="p">])</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>        <span class="n">fft_max_end</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">fft</span><span class="p">[</span><span class="n">max_index</span> <span class="o">-</span> <span class="n">peak_distance</span><span class="p">:</span><span class="n">max_index</span><span class="p">])</span>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a>        <span class="c1"># Build the curve below the peaks but above the noise</span>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a>        <span class="n">exponents</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fft_max_start</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fft_max_end</span><span class="p">),</span> <span class="n">max_index</span><span class="p">)</span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a>        <span class="n">intersect</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">exponents</span><span class="p">[</span><span class="n">peak_distance</span><span class="p">]</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a>        <span class="n">diff_start</span> <span class="o">=</span> <span class="n">fft_max_start</span> <span class="o">-</span> <span class="n">intersect</span>  <span class="c1"># offset by a small distance so that the first max is not a peak</span>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a>        <span class="n">min_height</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fft_max_start</span> <span class="o">+</span> <span class="n">diff_start</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fft_max_end</span><span class="p">),</span> <span class="n">max_index</span><span class="p">)</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a>        <span class="n">first_peak_indexes</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">find_peaks</span><span class="p">(</span><span class="n">fft</span><span class="p">[:</span><span class="n">max_index</span><span class="p">],</span> <span class="n">height</span><span class="o">=</span><span class="n">min_height</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="n">peak_distance</span><span class="p">)</span>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a>        <span class="n">number_of_peaks</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_peak_indexes</span><span class="p">)</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a>        <span class="k">if</span> <span class="n">number_of_peaks</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a>            <span class="n">average_len</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">max_index</span> <span class="o">/</span> <span class="n">number_of_peaks</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a>            <span class="n">average_len</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">max_index</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a>        <span class="k">if</span> <span class="n">average_len</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a>            <span class="n">average_len</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a>        <span class="n">average_fft</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">savgol_filter</span><span class="p">(</span><span class="n">fft</span><span class="p">[:</span><span class="n">max_index</span><span class="p">],</span> <span class="n">average_len</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;mirror&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.9</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a>        <span class="n">min_freq_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fft_freq</span> <span class="o">&gt;=</span> <span class="mi">70</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a>        <span class="n">average_fft</span><span class="p">[:</span><span class="n">min_freq_index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a>        <span class="n">peak_indexes</span><span class="p">,</span> <span class="n">res</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">find_peaks</span><span class="p">(</span><span class="n">fft</span><span class="p">[:</span><span class="n">max_index</span><span class="p">],</span> <span class="n">height</span><span class="o">=</span><span class="n">average_fft</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="n">min_freq_index</span><span class="p">)</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>        <span class="c1"># Remove noisy peaks at the low frequencies</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a>        <span class="k">while</span> <span class="n">fft</span><span class="p">[</span><span class="n">peak_indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">&lt;</span> <span class="mf">5e-2</span><span class="p">:</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a>            <span class="n">peak_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">peak_indexes</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a>        <span class="k">while</span> <span class="n">fft</span><span class="p">[</span><span class="n">peak_indexes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">&lt;</span> <span class="mf">1e-4</span><span class="p">:</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>            <span class="n">peak_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">peak_indexes</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">height</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">result</span><span class="p">:</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a>            <span class="k">return</span> <span class="n">peak_indexes</span>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a>        <span class="k">elif</span> <span class="n">height</span><span class="p">:</span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a>            <span class="k">return</span> <span class="n">peak_indexes</span><span class="p">,</span> <span class="n">average_fft</span>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a>        <span class="k">elif</span> <span class="n">result</span><span class="p">:</span>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a>            <span class="k">return</span> <span class="n">peak_indexes</span><span class="p">,</span> <span class="n">res</span>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a>        <span class="k">elif</span> <span class="n">height</span> <span class="ow">and</span> <span class="n">result</span><span class="p">:</span>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a>            <span class="k">return</span> <span class="n">peak_indexes</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">res</span>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a>    <span class="k">def</span> <span class="nf">time_damping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a><span class="sd">        Computes the time wise damping ratio of the signal by fitting a negative exponential curve</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a><span class="sd">        to the Signal envelope and computing the ratio with the Signal fundamental frequency.</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a><span class="sd">        :return: The damping ratio, a scalar.</span>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a>        <span class="c1"># Get the envelope data</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a>        <span class="n">envelope</span><span class="p">,</span> <span class="n">envelope_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">envelope</span><span class="p">()</span> 
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a>        <span class="c1"># First point is the maximum because e^-kt is strictly decreasing</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a>        <span class="n">first_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">envelope</span><span class="p">)</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a>        <span class="c1"># The second point is the first point where the signal crosses the lower_threshold line</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a>        <span class="n">second_point_thresh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">damping</span><span class="o">.</span><span class="n">lower_threshold</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a>            <span class="n">second_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flatnonzero</span><span class="p">(</span><span class="n">envelope</span><span class="p">[</span><span class="n">first_index</span><span class="p">:]</span> <span class="o">&lt;=</span> <span class="n">second_point_thresh</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a>        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a>            <span class="n">second_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flatnonzero</span><span class="p">(</span><span class="n">envelope</span><span class="p">[</span><span class="n">first_index</span><span class="p">:]</span> <span class="o">&lt;=</span> <span class="n">second_point_thresh</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a>        <span class="c1"># Function to compute the residual for the exponential curve fit</span>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a>        <span class="k">def</span> <span class="nf">residual_function</span><span class="p">(</span><span class="n">zeta_w</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a><span class="sd">            Function computing the residual to curve fit a negative exponential to the signal envelope</span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a><span class="sd">            :param zeta_w: zeta*omega constant</span>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a><span class="sd">            :param t: time vector</span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a><span class="sd">            :param s: signal</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a><span class="sd">            :return: residual</span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">zeta_w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">s</span>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a>        <span class="n">zeta_guess</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">]</span>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">least_squares</span><span class="p">(</span><span class="n">residual_function</span><span class="p">,</span> <span class="n">zeta_guess</span><span class="p">,</span>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a>                                              <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">envelope_time</span><span class="p">[</span><span class="n">first_index</span><span class="p">:</span><span class="n">second_index</span><span class="p">],</span>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a>                                                    <span class="n">envelope</span><span class="p">[</span><span class="n">first_index</span><span class="p">:</span><span class="n">second_index</span><span class="p">]))</span>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a>        <span class="c1"># Get the zeta*omega constant</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a>        <span class="n">zeta_omega</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a>        <span class="c1"># Compute the fundamental frequency in radians of the signal</span>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a>        <span class="n">wd</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fundamental</span><span class="p">()</span>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a>        <span class="k">return</span> <span class="o">-</span><span class="n">zeta_omega</span> <span class="o">/</span> <span class="n">wd</span>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a>    <span class="k">def</span> <span class="nf">peak_damping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a><span class="sd">        Computes the frequency wise damping with the half bandwidth method on the Fourier Transform peaks</span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a><span class="sd">        :return: an array containing the peak damping values</span>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a>        <span class="n">zetas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a>        <span class="n">fft_freqs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a>        <span class="n">fft</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">()[:</span><span class="nb">len</span><span class="p">(</span><span class="n">fft_freqs</span><span class="p">)]</span>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a>        <span class="k">for</span> <span class="n">peak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">():</span>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a>            <span class="n">peak_frequency</span> <span class="o">=</span> <span class="n">fft_freqs</span><span class="p">[</span><span class="n">peak</span><span class="p">]</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a>            <span class="n">peak_height</span> <span class="o">=</span> <span class="n">fft</span><span class="p">[</span><span class="n">peak</span><span class="p">]</span>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a>            <span class="n">root_height</span> <span class="o">=</span> <span class="n">peak_height</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a>            <span class="n">frequency_roots</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span><span class="n">fft_freqs</span><span class="p">,</span> <span class="n">fft</span> <span class="o">-</span> <span class="n">root_height</span><span class="p">)</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a>            <span class="n">sorted_roots_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">frequency_roots</span> <span class="o">-</span> <span class="n">peak_frequency</span><span class="p">))</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a>            <span class="n">w2</span><span class="p">,</span> <span class="n">w1</span> <span class="o">=</span> <span class="n">frequency_roots</span><span class="p">[</span><span class="n">sorted_roots_indexes</span><span class="p">[:</span><span class="mi">2</span><span class="p">]]</span>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a>            <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">])</span>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a>            <span class="n">zeta</span> <span class="o">=</span> <span class="p">(</span><span class="n">w2</span> <span class="o">-</span> <span class="n">w1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">peak_frequency</span><span class="p">)</span>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a>            <span class="n">zetas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zeta</span><span class="p">)</span>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">zetas</span><span class="p">)</span>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a>    <span class="k">def</span> <span class="nf">fundamental</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a><span class="sd">        Returns the fundamental approximated by the first peak of the fft</span>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a><span class="sd">        :return: fundamental value (Hz)</span>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a>        <span class="n">fundamental</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a>        <span class="k">return</span> <span class="n">fundamental</span>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a>    <span class="k">def</span> <span class="nf">cavity_peak</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a><span class="sd">        Finds the Hemlotz cavity frequency index from the Fourier Transform by searching for a peak in the expected</span>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a><span class="sd">        range (80 - 100 Hz), if the fundamental is too close to the expected Hemlotz frequency a comment</span>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a><span class="sd">        is printed and None is returned.</span>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a><span class="sd">        :return: The index of the cavity peak</span>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos">1201</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos">1202</span></a>        <span class="n">first_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">80</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos">1203</span></a>        <span class="n">second_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">110</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos">1204</span></a>        <span class="n">cavity_peak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">()[</span><span class="n">first_index</span><span class="p">:</span><span class="n">second_index</span><span class="p">])</span> <span class="o">+</span> <span class="n">first_index</span>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos">1205</span></a>        <span class="k">return</span> <span class="n">cavity_peak</span>
</span><span id="L-1206"><a href="#L-1206"><span class="linenos">1206</span></a>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos">1207</span></a>    <span class="k">def</span> <span class="nf">cavity_frequency</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos">1208</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos">1209</span></a><span class="sd">        Finds the Hemlotz cavity frequency from the Fourier Transform by searching for a peak in the expected</span>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos">1210</span></a><span class="sd">        range (80 - 100 Hz), if the fundamental is too close to the expected Hemlotz frequency a comment</span>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos">1211</span></a><span class="sd">        is printed and None is returned.</span>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos">1212</span></a><span class="sd">        :return: If successful, the cavity peak frequency</span>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos">1213</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos">1214</span></a>        <span class="n">cavity_peak</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cavity_peak</span><span class="p">()</span>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos">1215</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fundamental</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[</span><span class="n">cavity_peak</span><span class="p">]:</span>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos">1216</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cavity peak is obscured by the fundamental&#39;</span><span class="p">)</span>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos">1217</span></a>            <span class="k">return</span> <span class="mi">0</span>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos">1218</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos">1219</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[</span><span class="n">cavity_peak</span><span class="p">]</span>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos">1220</span></a>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos">1221</span></a>    <span class="k">def</span> <span class="nf">fft_frequencies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos">1222</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos">1223</span></a><span class="sd">        Computes the frequency vector associated with the Signal Fourier Transform</span>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos">1224</span></a><span class="sd">        :return: an array containing the frequency values.</span>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos">1225</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos">1226</span></a>        <span class="n">fft</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">()</span>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos">1227</span></a>        <span class="n">fft_frequencies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fft</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">)</span>  <span class="c1"># Frequencies corresponding to the bins</span>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos">1228</span></a>        <span class="k">return</span> <span class="n">fft_frequencies</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">fft</span><span class="p">)]</span>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos">1229</span></a>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos">1230</span></a>    <span class="k">def</span> <span class="nf">fft_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos">1231</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos">1232</span></a><span class="sd">        Transforms the Fourier transform array into a statistic distribution </span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos">1233</span></a><span class="sd">        ranging from 0 to 100. </span>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos">1234</span></a><span class="sd">        Accordingly, the maximum of the Fourier transform with value 1.0 will</span>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos">1235</span></a><span class="sd">        be equal to 100 and casted as an integer.</span>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos">1236</span></a><span class="sd">        Values below 0.001 will be equal to 0. </span>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos">1237</span></a><span class="sd">        This representation of the Fourier transform is used to construct</span>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos">1238</span></a><span class="sd">        octave bands histograms.</span>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos">1239</span></a><span class="sd">        :return : a list containing the frequency occurrences.</span>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos">1240</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos">1241</span></a>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos">1242</span></a>        <span class="c1"># Make the FT values integers</span>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos">1243</span></a>        <span class="n">fft_integers</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">sample</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">()]</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos">1244</span></a>
</span><span id="L-1245"><a href="#L-1245"><span class="linenos">1245</span></a>        <span class="c1"># Create a list of the frequency occurrences in the signal</span>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos">1246</span></a>        <span class="n">occurrences</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos">1247</span></a>        <span class="k">for</span> <span class="n">freq</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">(),</span> <span class="n">fft_integers</span><span class="p">):</span>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos">1248</span></a>            <span class="n">occurrences</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">freq</span><span class="p">]</span> <span class="o">*</span> <span class="n">count</span><span class="p">)</span>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos">1249</span></a>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos">1250</span></a>        <span class="c1"># flatten the list</span>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos">1251</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">occurrences</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
</span><span id="L-1252"><a href="#L-1252"><span class="linenos">1252</span></a>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos">1253</span></a>    <span class="k">def</span> <span class="nf">envelope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos">1254</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos">1255</span></a><span class="sd">        Method calculating the amplitude envelope of a signal as a</span>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos">1256</span></a><span class="sd">        maximum of the absolute value of the signal. </span>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos">1257</span></a><span class="sd">        The same `window` and `overlap` parameters should be used to compute </span>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos">1258</span></a><span class="sd">        the signal and time arrays so that they contain the same </span>
</span><span id="L-1259"><a href="#L-1259"><span class="linenos">1259</span></a><span class="sd">        number of points (and can be plotted together).</span>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos">1260</span></a><span class="sd">        :param window: integer, length in samples of the window used to</span>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos">1261</span></a><span class="sd">        compute the signal envelope.</span>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos">1262</span></a><span class="sd">        :param overlap: integer, overlap in samples used to overlap two</span>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos">1263</span></a><span class="sd">        subsequent windows in the computation of the signal envelope.</span>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos">1264</span></a><span class="sd">        The overlap value should be smaller than the window value.</span>
</span><span id="L-1265"><a href="#L-1265"><span class="linenos">1265</span></a><span class="sd">        :return: Amplitude envelope of the signal</span>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos">1266</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos">1267</span></a>        <span class="k">if</span> <span class="n">window</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos">1268</span></a>            <span class="n">window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">envelope</span><span class="o">.</span><span class="n">frame_size</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-1269"><a href="#L-1269"><span class="linenos">1269</span></a>        <span class="k">if</span> <span class="n">overlap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos">1270</span></a>            <span class="n">overlap</span> <span class="o">=</span> <span class="n">window</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="L-1271"><a href="#L-1271"><span class="linenos">1271</span></a>        <span class="k">elif</span> <span class="n">overlap</span> <span class="o">&gt;=</span> <span class="n">window</span><span class="p">:</span>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos">1272</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Overlap must be smaller than window&#39;</span><span class="p">)</span>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos">1273</span></a>        <span class="n">signal_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">)</span>
</span><span id="L-1274"><a href="#L-1274"><span class="linenos">1274</span></a>        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos">1275</span></a>        <span class="c1"># Empty envelope and envelope time</span>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos">1276</span></a>        <span class="n">env</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1277"><a href="#L-1277"><span class="linenos">1277</span></a>        <span class="n">env_time</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos">1278</span></a>        <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos">1279</span></a>        <span class="k">while</span> <span class="n">idx</span> <span class="o">+</span> <span class="n">window</span> <span class="o">&lt;</span> <span class="n">signal_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos">1280</span></a>            <span class="n">env</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">signal_array</span><span class="p">[</span><span class="n">idx</span><span class="p">:</span><span class="n">idx</span> <span class="o">+</span> <span class="n">window</span><span class="p">]))</span>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos">1281</span></a>            <span class="n">pt_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">signal_array</span><span class="p">[</span><span class="n">idx</span><span class="p">:</span><span class="n">idx</span> <span class="o">+</span> <span class="n">window</span><span class="p">])</span> <span class="o">+</span> <span class="n">idx</span>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos">1282</span></a>            <span class="n">env_time</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">pt_idx</span><span class="p">])</span>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos">1283</span></a>            <span class="n">idx</span> <span class="o">+=</span> <span class="n">overlap</span>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos">1284</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">unique_time_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">env_time</span><span class="p">,</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos">1285</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">env</span><span class="p">)[</span><span class="n">unique_time_index</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">env_time</span><span class="p">)</span>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos">1286</span></a>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos">1287</span></a>    <span class="k">def</span> <span class="nf">log_envelope</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos">1288</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos">1289</span></a><span class="sd">        Computes the logarithmic scale envelope of the signal.</span>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos">1290</span></a><span class="sd">        The width of the samples increases exponentially so that</span>
</span><span id="L-1291"><a href="#L-1291"><span class="linenos">1291</span></a><span class="sd">        the envelope appears having a constant window width on</span>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos">1292</span></a><span class="sd">        an X axis logarithmic scale.</span>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos">1293</span></a><span class="sd">        :return: The log envelope and the time vector associated in a tuple</span>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos">1294</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1295"><a href="#L-1295"><span class="linenos">1295</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">onset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1296"><a href="#L-1296"><span class="linenos">1296</span></a>            <span class="n">onset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">))</span>
</span><span id="L-1297"><a href="#L-1297"><span class="linenos">1297</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1298"><a href="#L-1298"><span class="linenos">1298</span></a>            <span class="n">onset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">onset</span>
</span><span id="L-1299"><a href="#L-1299"><span class="linenos">1299</span></a>
</span><span id="L-1300"><a href="#L-1300"><span class="linenos">1300</span></a>        <span class="n">start_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">log_envelope</span><span class="o">.</span><span class="n">start_time</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-1301"><a href="#L-1301"><span class="linenos">1301</span></a>        <span class="k">while</span> <span class="n">start_time</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">onset</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">):</span>
</span><span id="L-1302"><a href="#L-1302"><span class="linenos">1302</span></a>            <span class="n">start_time</span> <span class="o">/=</span> <span class="mf">10.</span>
</span><span id="L-1303"><a href="#L-1303"><span class="linenos">1303</span></a>
</span><span id="L-1304"><a href="#L-1304"><span class="linenos">1304</span></a>        <span class="n">start_exponent</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">start_time</span><span class="p">))</span>  <span class="c1"># closest 10^x value for smooth graph</span>
</span><span id="L-1305"><a href="#L-1305"><span class="linenos">1305</span></a>
</span><span id="L-1306"><a href="#L-1306"><span class="linenos">1306</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">log_envelope</span><span class="o">.</span><span class="n">min_window</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1307"><a href="#L-1307"><span class="linenos">1307</span></a>            <span class="n">min_window</span> <span class="o">=</span> <span class="mi">15</span> <span class="o">**</span> <span class="p">(</span><span class="n">start_exponent</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span>
</span><span id="L-1308"><a href="#L-1308"><span class="linenos">1308</span></a>            <span class="k">if</span> <span class="n">min_window</span> <span class="o">&lt;</span> <span class="mi">15</span><span class="p">:</span>  <span class="c1"># Value should at least be 10</span>
</span><span id="L-1309"><a href="#L-1309"><span class="linenos">1309</span></a>                <span class="n">min_window</span> <span class="o">=</span> <span class="mi">15</span>
</span><span id="L-1310"><a href="#L-1310"><span class="linenos">1310</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1311"><a href="#L-1311"><span class="linenos">1311</span></a>            <span class="n">min_window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">log_envelope</span><span class="o">.</span><span class="n">min_window</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-1312"><a href="#L-1312"><span class="linenos">1312</span></a>
</span><span id="L-1313"><a href="#L-1313"><span class="linenos">1313</span></a>        <span class="c1"># initial values</span>
</span><span id="L-1314"><a href="#L-1314"><span class="linenos">1314</span></a>        <span class="n">current_exponent</span> <span class="o">=</span> <span class="n">start_exponent</span>
</span><span id="L-1315"><a href="#L-1315"><span class="linenos">1315</span></a>        <span class="n">current_time</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">current_exponent</span>  <span class="c1"># start time on log scale</span>
</span><span id="L-1316"><a href="#L-1316"><span class="linenos">1316</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">current_time</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">)</span>  <span class="c1"># Start at the specified time</span>
</span><span id="L-1317"><a href="#L-1317"><span class="linenos">1317</span></a>        <span class="n">window</span> <span class="o">=</span> <span class="n">min_window</span>  <span class="c1"># number of samples per window</span>
</span><span id="L-1318"><a href="#L-1318"><span class="linenos">1318</span></a>        <span class="n">overlap</span> <span class="o">=</span> <span class="n">window</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="L-1319"><a href="#L-1319"><span class="linenos">1319</span></a>        <span class="n">log_envelope</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1320"><a href="#L-1320"><span class="linenos">1320</span></a>        <span class="n">log_envelope_time</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># First value for comparison</span>
</span><span id="L-1321"><a href="#L-1321"><span class="linenos">1321</span></a>
</span><span id="L-1322"><a href="#L-1322"><span class="linenos">1322</span></a>        <span class="k">while</span> <span class="n">index</span> <span class="o">+</span> <span class="n">window</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">):</span>
</span><span id="L-1323"><a href="#L-1323"><span class="linenos">1323</span></a>
</span><span id="L-1324"><a href="#L-1324"><span class="linenos">1324</span></a>            <span class="k">while</span> <span class="n">log_envelope_time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">current_exponent</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-1325"><a href="#L-1325"><span class="linenos">1325</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="n">window</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">):</span>
</span><span id="L-1326"><a href="#L-1326"><span class="linenos">1326</span></a>                    <span class="n">log_envelope</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">index</span><span class="p">:</span><span class="n">index</span> <span class="o">+</span> <span class="n">window</span><span class="p">])))</span>
</span><span id="L-1327"><a href="#L-1327"><span class="linenos">1327</span></a>                    <span class="n">pt_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">index</span><span class="p">:</span><span class="n">index</span> <span class="o">+</span> <span class="n">window</span><span class="p">]))</span>
</span><span id="L-1328"><a href="#L-1328"><span class="linenos">1328</span></a>                    <span class="n">log_envelope_time</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">()[</span><span class="n">index</span> <span class="o">+</span> <span class="n">pt_idx</span><span class="p">])</span>
</span><span id="L-1329"><a href="#L-1329"><span class="linenos">1329</span></a>                    <span class="n">index</span> <span class="o">+=</span> <span class="n">overlap</span>
</span><span id="L-1330"><a href="#L-1330"><span class="linenos">1330</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-1331"><a href="#L-1331"><span class="linenos">1331</span></a>                    <span class="k">break</span>
</span><span id="L-1332"><a href="#L-1332"><span class="linenos">1332</span></a>
</span><span id="L-1333"><a href="#L-1333"><span class="linenos">1333</span></a>            <span class="k">if</span> <span class="n">window</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">log_envelope</span><span class="o">.</span><span class="n">max_window</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
</span><span id="L-1334"><a href="#L-1334"><span class="linenos">1334</span></a>                <span class="n">window</span> <span class="o">=</span> <span class="n">window</span> <span class="o">*</span> <span class="mi">10</span>
</span><span id="L-1335"><a href="#L-1335"><span class="linenos">1335</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1336"><a href="#L-1336"><span class="linenos">1336</span></a>                <span class="n">window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">log_envelope</span><span class="o">.</span><span class="n">max_window</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-1337"><a href="#L-1337"><span class="linenos">1337</span></a>            <span class="n">overlap</span> <span class="o">=</span> <span class="n">window</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="L-1338"><a href="#L-1338"><span class="linenos">1338</span></a>            <span class="n">current_exponent</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-1339"><a href="#L-1339"><span class="linenos">1339</span></a>        <span class="n">time</span><span class="p">,</span> <span class="n">idxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">log_envelope_time</span><span class="p">,</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1340"><a href="#L-1340"><span class="linenos">1340</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">log_envelope</span><span class="p">)[</span><span class="n">idxs</span><span class="p">],</span> <span class="n">time</span>
</span><span id="L-1341"><a href="#L-1341"><span class="linenos">1341</span></a>
</span><span id="L-1342"><a href="#L-1342"><span class="linenos">1342</span></a>    <span class="k">def</span> <span class="nf">find_onset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-1343"><a href="#L-1343"><span class="linenos">1343</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1344"><a href="#L-1344"><span class="linenos">1344</span></a><span class="sd">        Finds the onset as an increase in more of 50% with the maximum normalized value above 0.5</span>
</span><span id="L-1345"><a href="#L-1345"><span class="linenos">1345</span></a><span class="sd">        :param verbose: Prints a warning if the algorithm does not converge</span>
</span><span id="L-1346"><a href="#L-1346"><span class="linenos">1346</span></a><span class="sd">        :return: the index of the onset in the signal</span>
</span><span id="L-1347"><a href="#L-1347"><span class="linenos">1347</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1348"><a href="#L-1348"><span class="linenos">1348</span></a>        <span class="c1"># Index corresponding to the onset time interval</span>
</span><span id="L-1349"><a href="#L-1349"><span class="linenos">1349</span></a>        <span class="n">window_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">onset</span><span class="o">.</span><span class="n">onset_time</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="L-1350"><a href="#L-1350"><span class="linenos">1350</span></a>        <span class="c1"># Use the normalized signal to compare against a fixed value</span>
</span><span id="L-1351"><a href="#L-1351"><span class="linenos">1351</span></a>        <span class="n">onset_signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
</span><span id="L-1352"><a href="#L-1352"><span class="linenos">1352</span></a>        <span class="n">overlap</span> <span class="o">=</span> <span class="n">window_index</span> <span class="o">//</span> <span class="mi">2</span>  <span class="c1"># overlap for algorithm progression</span>
</span><span id="L-1353"><a href="#L-1353"><span class="linenos">1353</span></a>        <span class="c1"># Initial values</span>
</span><span id="L-1354"><a href="#L-1354"><span class="linenos">1354</span></a>        <span class="n">increase</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1355"><a href="#L-1355"><span class="linenos">1355</span></a>        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1356"><a href="#L-1356"><span class="linenos">1356</span></a>        <span class="n">broke</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1357"><a href="#L-1357"><span class="linenos">1357</span></a>        <span class="k">while</span> <span class="n">increase</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">:</span>
</span><span id="L-1358"><a href="#L-1358"><span class="linenos">1358</span></a>            <span class="n">signal_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">onset_signal</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_index</span><span class="p">]))</span>
</span><span id="L-1359"><a href="#L-1359"><span class="linenos">1359</span></a>            <span class="n">signal_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">onset_signal</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_index</span><span class="p">]))</span>
</span><span id="L-1360"><a href="#L-1360"><span class="linenos">1360</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">signal_max</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">signal_min</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="L-1361"><a href="#L-1361"><span class="linenos">1361</span></a>                <span class="n">increase</span> <span class="o">=</span> <span class="n">signal_max</span> <span class="o">/</span> <span class="n">signal_min</span>
</span><span id="L-1362"><a href="#L-1362"><span class="linenos">1362</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1363"><a href="#L-1363"><span class="linenos">1363</span></a>                <span class="n">increase</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1364"><a href="#L-1364"><span class="linenos">1364</span></a>            <span class="n">i</span> <span class="o">+=</span> <span class="n">overlap</span>
</span><span id="L-1365"><a href="#L-1365"><span class="linenos">1365</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="n">window_index</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">):</span>
</span><span id="L-1366"><a href="#L-1366"><span class="linenos">1366</span></a>                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-1367"><a href="#L-1367"><span class="linenos">1367</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Onset detection did not converge </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-1368"><a href="#L-1368"><span class="linenos">1368</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Approximating onset with signal max value </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-1369"><a href="#L-1369"><span class="linenos">1369</span></a>                <span class="n">broke</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1370"><a href="#L-1370"><span class="linenos">1370</span></a>                <span class="k">break</span>
</span><span id="L-1371"><a href="#L-1371"><span class="linenos">1371</span></a>        <span class="k">if</span> <span class="n">broke</span><span class="p">:</span>
</span><span id="L-1372"><a href="#L-1372"><span class="linenos">1372</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">))</span>
</span><span id="L-1373"><a href="#L-1373"><span class="linenos">1373</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1374"><a href="#L-1374"><span class="linenos">1374</span></a>            <span class="n">i</span> <span class="o">-=</span> <span class="n">overlap</span>
</span><span id="L-1375"><a href="#L-1375"><span class="linenos">1375</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_index</span><span class="p">]))</span> <span class="o">+</span> <span class="n">i</span> 
</span><span id="L-1376"><a href="#L-1376"><span class="linenos">1376</span></a>
</span><span id="L-1377"><a href="#L-1377"><span class="linenos">1377</span></a>    <span class="k">def</span> <span class="nf">trim_onset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-1378"><a href="#L-1378"><span class="linenos">1378</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1379"><a href="#L-1379"><span class="linenos">1379</span></a><span class="sd">        Trim the signal at the onset (max) minus the delay in milliseconds as</span>
</span><span id="L-1380"><a href="#L-1380"><span class="linenos">1380</span></a><span class="sd">        Specified in the SoundParameters</span>
</span><span id="L-1381"><a href="#L-1381"><span class="linenos">1381</span></a><span class="sd">        :param verbose: if False the warning comments are not displayed</span>
</span><span id="L-1382"><a href="#L-1382"><span class="linenos">1382</span></a><span class="sd">        :return : The trimmed signal</span>
</span><span id="L-1383"><a href="#L-1383"><span class="linenos">1383</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1384"><a href="#L-1384"><span class="linenos">1384</span></a>        <span class="c1"># nb of samples to keep before the onset</span>
</span><span id="L-1385"><a href="#L-1385"><span class="linenos">1385</span></a>        <span class="n">delay_samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">onset</span><span class="o">.</span><span class="n">onset_delay</span><span class="o">.</span><span class="n">value</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">)</span>
</span><span id="L-1386"><a href="#L-1386"><span class="linenos">1386</span></a>        <span class="n">onset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_onset</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>  <span class="c1"># find the onset</span>
</span><span id="L-1387"><a href="#L-1387"><span class="linenos">1387</span></a>
</span><span id="L-1388"><a href="#L-1388"><span class="linenos">1388</span></a>        <span class="k">if</span> <span class="n">onset</span> <span class="o">&gt;</span> <span class="n">delay_samples</span><span class="p">:</span>  <span class="c1"># To make sure the index is positive</span>
</span><span id="L-1389"><a href="#L-1389"><span class="linenos">1389</span></a>            <span class="n">new_signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">onset</span> <span class="o">-</span> <span class="n">delay_samples</span><span class="p">:]</span>
</span><span id="L-1390"><a href="#L-1390"><span class="linenos">1390</span></a>            <span class="n">new_signal</span><span class="p">[:</span><span class="n">delay_samples</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_signal</span><span class="p">[:</span><span class="n">delay_samples</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">delay_samples</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> 
</span><span id="L-1391"><a href="#L-1391"><span class="linenos">1391</span></a>            <span class="n">trimmed_signal</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">(</span><span class="n">new_signal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">)</span>
</span><span id="L-1392"><a href="#L-1392"><span class="linenos">1392</span></a>            <span class="n">trimmed_signal</span><span class="o">.</span><span class="n">onset</span> <span class="o">=</span> <span class="n">trimmed_signal</span><span class="o">.</span><span class="n">find_onset</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="L-1393"><a href="#L-1393"><span class="linenos">1393</span></a>            <span class="k">return</span> <span class="n">trimmed_signal</span>
</span><span id="L-1394"><a href="#L-1394"><span class="linenos">1394</span></a>
</span><span id="L-1395"><a href="#L-1395"><span class="linenos">1395</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1396"><a href="#L-1396"><span class="linenos">1396</span></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-1397"><a href="#L-1397"><span class="linenos">1397</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Signal is too short to be trimmed before onset.&#39;</span><span class="p">)</span>
</span><span id="L-1398"><a href="#L-1398"><span class="linenos">1398</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="L-1399"><a href="#L-1399"><span class="linenos">1399</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-1400"><a href="#L-1400"><span class="linenos">1400</span></a>
</span><span id="L-1401"><a href="#L-1401"><span class="linenos">1401</span></a>    <span class="k">def</span> <span class="nf">trim_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_length</span><span class="p">):</span>
</span><span id="L-1402"><a href="#L-1402"><span class="linenos">1402</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1403"><a href="#L-1403"><span class="linenos">1403</span></a><span class="sd">        Trims the signal to the specified length and returns a new Signal instance.</span>
</span><span id="L-1404"><a href="#L-1404"><span class="linenos">1404</span></a><span class="sd">        :param time_length: desired length of the new signal in seconds.</span>
</span><span id="L-1405"><a href="#L-1405"><span class="linenos">1405</span></a><span class="sd">        :return: A trimmed Signal</span>
</span><span id="L-1406"><a href="#L-1406"><span class="linenos">1406</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1407"><a href="#L-1407"><span class="linenos">1407</span></a>        <span class="n">max_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time_length</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">)</span>
</span><span id="L-1408"><a href="#L-1408"><span class="linenos">1408</span></a>        <span class="n">new_signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[:</span><span class="n">max_index</span><span class="p">]</span>
</span><span id="L-1409"><a href="#L-1409"><span class="linenos">1409</span></a>        <span class="n">new_signal</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:]</span> <span class="o">=</span> <span class="n">new_signal</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</span><span id="L-1410"><a href="#L-1410"><span class="linenos">1410</span></a>        <span class="n">time_trimmed_signal</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">(</span><span class="n">new_signal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">)</span>
</span><span id="L-1411"><a href="#L-1411"><span class="linenos">1411</span></a>        <span class="k">return</span> <span class="n">time_trimmed_signal</span>
</span><span id="L-1412"><a href="#L-1412"><span class="linenos">1412</span></a>
</span><span id="L-1413"><a href="#L-1413"><span class="linenos">1413</span></a>    <span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1414"><a href="#L-1414"><span class="linenos">1414</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1415"><a href="#L-1415"><span class="linenos">1415</span></a><span class="sd">        Normalizes the signal to [-1, 1] and returns the normalized instance.</span>
</span><span id="L-1416"><a href="#L-1416"><span class="linenos">1416</span></a><span class="sd">        return : A normalized signal</span>
</span><span id="L-1417"><a href="#L-1417"><span class="linenos">1417</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1418"><a href="#L-1418"><span class="linenos">1418</span></a>        <span class="n">factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">))</span>
</span><span id="L-1419"><a href="#L-1419"><span class="linenos">1419</span></a>        <span class="n">normalised_signal</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">/</span> <span class="n">factor</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">)</span>
</span><span id="L-1420"><a href="#L-1420"><span class="linenos">1420</span></a>        <span class="n">normalised_signal</span><span class="o">.</span><span class="n">norm_factor</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">factor</span><span class="p">)</span>
</span><span id="L-1421"><a href="#L-1421"><span class="linenos">1421</span></a>        <span class="k">return</span> <span class="n">normalised_signal</span>
</span><span id="L-1422"><a href="#L-1422"><span class="linenos">1422</span></a>
</span><span id="L-1423"><a href="#L-1423"><span class="linenos">1423</span></a>    <span class="k">def</span> <span class="nf">make_freq_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1424"><a href="#L-1424"><span class="linenos">1424</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1425"><a href="#L-1425"><span class="linenos">1425</span></a><span class="sd">        Method to divide a signal in frequency bins using butterworth filters</span>
</span><span id="L-1426"><a href="#L-1426"><span class="linenos">1426</span></a><span class="sd">        bins are passed as a dict, default values are :</span>
</span><span id="L-1427"><a href="#L-1427"><span class="linenos">1427</span></a><span class="sd">        - bass &lt; 100 Hz</span>
</span><span id="L-1428"><a href="#L-1428"><span class="linenos">1428</span></a><span class="sd">        - mid = 100 - 700 Hz</span>
</span><span id="L-1429"><a href="#L-1429"><span class="linenos">1429</span></a><span class="sd">        - highmid = 700 - 2000 Hz</span>
</span><span id="L-1430"><a href="#L-1430"><span class="linenos">1430</span></a><span class="sd">        - uppermid = 2000 - 4000 Hz</span>
</span><span id="L-1431"><a href="#L-1431"><span class="linenos">1431</span></a><span class="sd">        - presence = 4000 - 6000 Hz</span>
</span><span id="L-1432"><a href="#L-1432"><span class="linenos">1432</span></a><span class="sd">        - brillance &gt; 6000 Hz</span>
</span><span id="L-1433"><a href="#L-1433"><span class="linenos">1433</span></a><span class="sd">        :return : A dictionary with the divided signal as values and bin names as keys</span>
</span><span id="L-1434"><a href="#L-1434"><span class="linenos">1434</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1435"><a href="#L-1435"><span class="linenos">1435</span></a>
</span><span id="L-1436"><a href="#L-1436"><span class="linenos">1436</span></a>        <span class="n">bins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="vm">__dict__</span>
</span><span id="L-1437"><a href="#L-1437"><span class="linenos">1437</span></a>
</span><span id="L-1438"><a href="#L-1438"><span class="linenos">1438</span></a>        <span class="n">bass_filter</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s2">&quot;bass&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;lp&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
</span><span id="L-1439"><a href="#L-1439"><span class="linenos">1439</span></a>        <span class="n">mid_filter</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s2">&quot;bass&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s1">&#39;mid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">],</span> <span class="s1">&#39;bp&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
</span><span id="L-1440"><a href="#L-1440"><span class="linenos">1440</span></a>        <span class="n">himid_filter</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s2">&quot;mid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s1">&#39;highmid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">],</span> <span class="s1">&#39;bp&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
</span><span id="L-1441"><a href="#L-1441"><span class="linenos">1441</span></a>        <span class="n">upmid_filter</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s2">&quot;highmid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s1">&#39;uppermid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">],</span> <span class="s1">&#39;bp&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
</span><span id="L-1442"><a href="#L-1442"><span class="linenos">1442</span></a>        <span class="n">pres_filter</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s2">&quot;uppermid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s1">&#39;presence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">],</span> <span class="s1">&#39;bp&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
</span><span id="L-1443"><a href="#L-1443"><span class="linenos">1443</span></a>        <span class="n">bril_filter</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s1">&#39;presence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;hp&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
</span><span id="L-1444"><a href="#L-1444"><span class="linenos">1444</span></a>
</span><span id="L-1445"><a href="#L-1445"><span class="linenos">1445</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="L-1446"><a href="#L-1446"><span class="linenos">1446</span></a>            <span class="s2">&quot;bass&quot;</span><span class="p">:</span> <span class="n">Signal</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">bass_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">,</span>
</span><span id="L-1447"><a href="#L-1447"><span class="linenos">1447</span></a>                           <span class="n">freq_range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s2">&quot;bass&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">]),</span>
</span><span id="L-1448"><a href="#L-1448"><span class="linenos">1448</span></a>            <span class="s2">&quot;mid&quot;</span><span class="p">:</span> <span class="n">Signal</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">mid_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">,</span>
</span><span id="L-1449"><a href="#L-1449"><span class="linenos">1449</span></a>                          <span class="n">freq_range</span><span class="o">=</span><span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s2">&quot;bass&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s2">&quot;mid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">]),</span>
</span><span id="L-1450"><a href="#L-1450"><span class="linenos">1450</span></a>            <span class="s2">&quot;highmid&quot;</span><span class="p">:</span> <span class="n">Signal</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">himid_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">,</span>
</span><span id="L-1451"><a href="#L-1451"><span class="linenos">1451</span></a>                              <span class="n">freq_range</span><span class="o">=</span><span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s2">&quot;mid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s2">&quot;highmid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">]),</span>
</span><span id="L-1452"><a href="#L-1452"><span class="linenos">1452</span></a>            <span class="s2">&quot;uppermid&quot;</span><span class="p">:</span> <span class="n">Signal</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">upmid_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">,</span>
</span><span id="L-1453"><a href="#L-1453"><span class="linenos">1453</span></a>                               <span class="n">freq_range</span><span class="o">=</span><span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s2">&quot;highmid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s2">&quot;uppermid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">]),</span>
</span><span id="L-1454"><a href="#L-1454"><span class="linenos">1454</span></a>            <span class="s2">&quot;presence&quot;</span><span class="p">:</span> <span class="n">Signal</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">pres_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">,</span>
</span><span id="L-1455"><a href="#L-1455"><span class="linenos">1455</span></a>                               <span class="n">freq_range</span><span class="o">=</span><span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s1">&#39;uppermid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s2">&quot;presence&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">]),</span>
</span><span id="L-1456"><a href="#L-1456"><span class="linenos">1456</span></a>            <span class="s2">&quot;brillance&quot;</span><span class="p">:</span> <span class="n">Signal</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">bril_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">,</span>
</span><span id="L-1457"><a href="#L-1457"><span class="linenos">1457</span></a>                                <span class="n">freq_range</span><span class="o">=</span><span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s2">&quot;presence&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">())])}</span>
</span><span id="L-1458"><a href="#L-1458"><span class="linenos">1458</span></a>
</span><span id="L-1459"><a href="#L-1459"><span class="linenos">1459</span></a>    <span class="k">def</span> <span class="nf">save_wav</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
</span><span id="L-1460"><a href="#L-1460"><span class="linenos">1460</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1461"><a href="#L-1461"><span class="linenos">1461</span></a><span class="sd">        Create a soundfile from a signal</span>
</span><span id="L-1462"><a href="#L-1462"><span class="linenos">1462</span></a><span class="sd">        :param name: the name of the saved file</span>
</span><span id="L-1463"><a href="#L-1463"><span class="linenos">1463</span></a><span class="sd">        :param path: the path were the &#39;.wav&#39; file is saved</span>
</span><span id="L-1464"><a href="#L-1464"><span class="linenos">1464</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1465"><a href="#L-1465"><span class="linenos">1465</span></a>        <span class="n">write</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;.wav&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">)</span>
</span><span id="L-1466"><a href="#L-1466"><span class="linenos">1466</span></a>
</span><span id="L-1467"><a href="#L-1467"><span class="linenos">1467</span></a>
</span><span id="L-1468"><a href="#L-1468"><span class="linenos">1468</span></a><span class="k">class</span> <span class="nc">Plot</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="L-1469"><a href="#L-1469"><span class="linenos">1469</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1470"><a href="#L-1470"><span class="linenos">1470</span></a><span class="sd">        A class to handle all the plotting functions of the Signal and to allow a nice call signature :</span>
</span><span id="L-1471"><a href="#L-1471"><span class="linenos">1471</span></a><span class="sd">        Signal.plot.envelope()</span>
</span><span id="L-1472"><a href="#L-1472"><span class="linenos">1472</span></a>
</span><span id="L-1473"><a href="#L-1473"><span class="linenos">1473</span></a><span class="sd">        Supported plots are :</span>
</span><span id="L-1474"><a href="#L-1474"><span class="linenos">1474</span></a><span class="sd">        &#39;signal&#39;, &#39;envelope&#39;, &#39;log envelope&#39;, &#39;fft&#39;, &#39;fft hist&#39;, &#39;peaks&#39;,</span>
</span><span id="L-1475"><a href="#L-1475"><span class="linenos">1475</span></a><span class="sd">        &#39;peak damping&#39;, &#39;time damping&#39;, &#39;integral&#39;</span>
</span><span id="L-1476"><a href="#L-1476"><span class="linenos">1476</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1477"><a href="#L-1477"><span class="linenos">1477</span></a>
</span><span id="L-1478"><a href="#L-1478"><span class="linenos">1478</span></a>    <span class="c1"># Illegal plot key word arguments</span>
</span><span id="L-1479"><a href="#L-1479"><span class="linenos">1479</span></a>    <span class="n">illegal_kwargs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;max_time&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="s1">&#39;normalize&#39;</span><span class="p">,</span> <span class="s1">&#39;inverse&#39;</span><span class="p">,</span>
</span><span id="L-1480"><a href="#L-1480"><span class="linenos">1480</span></a>                      <span class="s1">&#39;peak_height&#39;</span><span class="p">,</span> <span class="s1">&#39;fill&#39;</span><span class="p">]</span>
</span><span id="L-1481"><a href="#L-1481"><span class="linenos">1481</span></a>
</span><span id="L-1482"><a href="#L-1482"><span class="linenos">1482</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1483"><a href="#L-1483"><span class="linenos">1483</span></a>        <span class="c1"># define the parent attribute</span>
</span><span id="L-1484"><a href="#L-1484"><span class="linenos">1484</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1485"><a href="#L-1485"><span class="linenos">1485</span></a>
</span><span id="L-1486"><a href="#L-1486"><span class="linenos">1486</span></a>        <span class="c1"># dictionary with methods and keywords</span>
</span><span id="L-1487"><a href="#L-1487"><span class="linenos">1487</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">method_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;signal&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">,</span>
</span><span id="L-1488"><a href="#L-1488"><span class="linenos">1488</span></a>                            <span class="s1">&#39;envelope&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">envelope</span><span class="p">,</span>
</span><span id="L-1489"><a href="#L-1489"><span class="linenos">1489</span></a>                            <span class="s1">&#39;log envelope&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">,</span>
</span><span id="L-1490"><a href="#L-1490"><span class="linenos">1490</span></a>                            <span class="s1">&#39;fft&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">,</span>
</span><span id="L-1491"><a href="#L-1491"><span class="linenos">1491</span></a>                            <span class="s1">&#39;fft hist&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft_hist</span><span class="p">,</span>
</span><span id="L-1492"><a href="#L-1492"><span class="linenos">1492</span></a>                            <span class="s1">&#39;peaks&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span>
</span><span id="L-1493"><a href="#L-1493"><span class="linenos">1493</span></a>                            <span class="s1">&#39;peak damping&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_damping</span><span class="p">,</span>
</span><span id="L-1494"><a href="#L-1494"><span class="linenos">1494</span></a>                            <span class="s1">&#39;time damping&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_damping</span><span class="p">,</span>
</span><span id="L-1495"><a href="#L-1495"><span class="linenos">1495</span></a>                            <span class="s1">&#39;integral&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">integral</span><span class="p">,</span> <span class="p">}</span>
</span><span id="L-1496"><a href="#L-1496"><span class="linenos">1496</span></a>
</span><span id="L-1497"><a href="#L-1497"><span class="linenos">1497</span></a>    <span class="k">def</span> <span class="nf">sanitize_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1498"><a href="#L-1498"><span class="linenos">1498</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1499"><a href="#L-1499"><span class="linenos">1499</span></a><span class="sd">        Remove illegal keywords to supply the key word arguments to matplotlib</span>
</span><span id="L-1500"><a href="#L-1500"><span class="linenos">1500</span></a><span class="sd">        :param kwargs: a dictionary of key word arguments</span>
</span><span id="L-1501"><a href="#L-1501"><span class="linenos">1501</span></a><span class="sd">        :return: sanitized kwargs</span>
</span><span id="L-1502"><a href="#L-1502"><span class="linenos">1502</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1503"><a href="#L-1503"><span class="linenos">1503</span></a>        <span class="k">return</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">illegal_kwargs</span><span class="p">}</span>
</span><span id="L-1504"><a href="#L-1504"><span class="linenos">1504</span></a>
</span><span id="L-1505"><a href="#L-1505"><span class="linenos">1505</span></a>    <span class="k">def</span> <span class="nf">set_bin_ticks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1506"><a href="#L-1506"><span class="linenos">1506</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Applies the frequency bin ticks to the current plot &quot;&quot;&quot;</span>
</span><span id="L-1507"><a href="#L-1507"><span class="linenos">1507</span></a>        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">label</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="vm">__dict__</span> <span class="k">if</span> <span class="n">label</span> <span class="o">!=</span> <span class="s1">&#39;name&#39;</span><span class="p">]</span>
</span><span id="L-1508"><a href="#L-1508"><span class="linenos">1508</span></a>        <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;brillance&#39;</span><span class="p">)</span>
</span><span id="L-1509"><a href="#L-1509"><span class="linenos">1509</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">param</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">param</span> <span class="o">!=</span> <span class="s1">&#39;bins&#39;</span><span class="p">]</span>
</span><span id="L-1510"><a href="#L-1510"><span class="linenos">1510</span></a>        <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">11025</span><span class="p">)</span>
</span><span id="L-1511"><a href="#L-1511"><span class="linenos">1511</span></a>        <span class="n">x_formatter</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FixedFormatter</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</span><span id="L-1512"><a href="#L-1512"><span class="linenos">1512</span></a>        <span class="n">x_locator</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="L-1513"><a href="#L-1513"><span class="linenos">1513</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="L-1514"><a href="#L-1514"><span class="linenos">1514</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">x_locator</span><span class="p">)</span>
</span><span id="L-1515"><a href="#L-1515"><span class="linenos">1515</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">x_formatter</span><span class="p">)</span>
</span><span id="L-1516"><a href="#L-1516"><span class="linenos">1516</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelrotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
</span><span id="L-1517"><a href="#L-1517"><span class="linenos">1517</span></a>
</span><span id="L-1518"><a href="#L-1518"><span class="linenos">1518</span></a>    <span class="k">def</span> <span class="nf">signal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1519"><a href="#L-1519"><span class="linenos">1519</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Plots the time varying real signal as amplitude vs time. &quot;&quot;&quot;</span>
</span><span id="L-1520"><a href="#L-1520"><span class="linenos">1520</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1521"><a href="#L-1521"><span class="linenos">1521</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">signal</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="L-1522"><a href="#L-1522"><span class="linenos">1522</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
</span><span id="L-1523"><a href="#L-1523"><span class="linenos">1523</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;amplitude [-1, 1]&#39;</span><span class="p">)</span>
</span><span id="L-1524"><a href="#L-1524"><span class="linenos">1524</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="L-1525"><a href="#L-1525"><span class="linenos">1525</span></a>
</span><span id="L-1526"><a href="#L-1526"><span class="linenos">1526</span></a>    <span class="k">def</span> <span class="nf">envelope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1527"><a href="#L-1527"><span class="linenos">1527</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1528"><a href="#L-1528"><span class="linenos">1528</span></a><span class="sd">        Plots the envelope of the signal as amplitude vs time.</span>
</span><span id="L-1529"><a href="#L-1529"><span class="linenos">1529</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1530"><a href="#L-1530"><span class="linenos">1530</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1531"><a href="#L-1531"><span class="linenos">1531</span></a>        <span class="n">envelope_arr</span><span class="p">,</span> <span class="n">envelope_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">envelope</span><span class="p">()</span>
</span><span id="L-1532"><a href="#L-1532"><span class="linenos">1532</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">envelope_time</span><span class="p">,</span> <span class="n">envelope_arr</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="L-1533"><a href="#L-1533"><span class="linenos">1533</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time (s)&quot;</span><span class="p">)</span>
</span><span id="L-1534"><a href="#L-1534"><span class="linenos">1534</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;amplitude [0, 1]&quot;</span><span class="p">)</span>
</span><span id="L-1535"><a href="#L-1535"><span class="linenos">1535</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="L-1536"><a href="#L-1536"><span class="linenos">1536</span></a>
</span><span id="L-1537"><a href="#L-1537"><span class="linenos">1537</span></a>    <span class="k">def</span> <span class="nf">log_envelope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1538"><a href="#L-1538"><span class="linenos">1538</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1539"><a href="#L-1539"><span class="linenos">1539</span></a><span class="sd">        Plots the signal envelope with logarithmic window widths on a logarithmic x-axis scale.</span>
</span><span id="L-1540"><a href="#L-1540"><span class="linenos">1540</span></a><span class="sd">        :param max_time: maximum time used for the x-axis in the plot (seconds)</span>
</span><span id="L-1541"><a href="#L-1541"><span class="linenos">1541</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1542"><a href="#L-1542"><span class="linenos">1542</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1543"><a href="#L-1543"><span class="linenos">1543</span></a>        <span class="n">log_envelope</span><span class="p">,</span> <span class="n">log_envelope_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="L-1544"><a href="#L-1544"><span class="linenos">1544</span></a>
</span><span id="L-1545"><a href="#L-1545"><span class="linenos">1545</span></a>        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;max_time&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;max_time&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">log_envelope_time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-1546"><a href="#L-1546"><span class="linenos">1546</span></a>            <span class="n">max_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">log_envelope_time</span> <span class="o">&gt;=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;max_time&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1547"><a href="#L-1547"><span class="linenos">1547</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1548"><a href="#L-1548"><span class="linenos">1548</span></a>            <span class="n">max_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">log_envelope_time</span><span class="p">)</span>
</span><span id="L-1549"><a href="#L-1549"><span class="linenos">1549</span></a>
</span><span id="L-1550"><a href="#L-1550"><span class="linenos">1550</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">log_envelope_time</span><span class="p">[:</span><span class="n">max_index</span><span class="p">],</span> <span class="n">log_envelope</span><span class="p">[:</span><span class="n">max_index</span><span class="p">],</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="L-1551"><a href="#L-1551"><span class="linenos">1551</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time (s)&quot;</span><span class="p">)</span>
</span><span id="L-1552"><a href="#L-1552"><span class="linenos">1552</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;amplitude [0, 1]&quot;</span><span class="p">)</span>
</span><span id="L-1553"><a href="#L-1553"><span class="linenos">1553</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="L-1554"><a href="#L-1554"><span class="linenos">1554</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="L-1555"><a href="#L-1555"><span class="linenos">1555</span></a>
</span><span id="L-1556"><a href="#L-1556"><span class="linenos">1556</span></a>    <span class="k">def</span> <span class="nf">fft</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1557"><a href="#L-1557"><span class="linenos">1557</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1558"><a href="#L-1558"><span class="linenos">1558</span></a><span class="sd">        Plots the Fourier Transform of the Signal.</span>
</span><span id="L-1559"><a href="#L-1559"><span class="linenos">1559</span></a>
</span><span id="L-1560"><a href="#L-1560"><span class="linenos">1560</span></a><span class="sd">        If `ticks = &#39;bins&#39;` is supplied in the keyword arguments, the frequency ticks are replaced</span>
</span><span id="L-1561"><a href="#L-1561"><span class="linenos">1561</span></a><span class="sd">        with the frequency bin values.</span>
</span><span id="L-1562"><a href="#L-1562"><span class="linenos">1562</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1563"><a href="#L-1563"><span class="linenos">1563</span></a>
</span><span id="L-1564"><a href="#L-1564"><span class="linenos">1564</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1565"><a href="#L-1565"><span class="linenos">1565</span></a>
</span><span id="L-1566"><a href="#L-1566"><span class="linenos">1566</span></a>        <span class="c1"># find the index corresponding to the fft range</span>
</span><span id="L-1567"><a href="#L-1567"><span class="linenos">1567</span></a>        <span class="n">fft_frequencies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span>
</span><span id="L-1568"><a href="#L-1568"><span class="linenos">1568</span></a>        <span class="n">fft_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">fft_range</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-1569"><a href="#L-1569"><span class="linenos">1569</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fft_frequencies</span> <span class="o">&gt;=</span> <span class="n">fft_range</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1570"><a href="#L-1570"><span class="linenos">1570</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1571"><a href="#L-1571"><span class="linenos">1571</span></a>            <span class="n">last_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fft_frequencies</span><span class="p">)</span>
</span><span id="L-1572"><a href="#L-1572"><span class="linenos">1572</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1573"><a href="#L-1573"><span class="linenos">1573</span></a>            <span class="n">last_index</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1574"><a href="#L-1574"><span class="linenos">1574</span></a>
</span><span id="L-1575"><a href="#L-1575"><span class="linenos">1575</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[:</span><span class="n">last_index</span><span class="p">],</span>
</span><span id="L-1576"><a href="#L-1576"><span class="linenos">1576</span></a>                 <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fft</span><span class="p">()[:</span><span class="n">last_index</span><span class="p">],</span>
</span><span id="L-1577"><a href="#L-1577"><span class="linenos">1577</span></a>                 <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="L-1578"><a href="#L-1578"><span class="linenos">1578</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;frequency (Hz)&quot;</span><span class="p">),</span>
</span><span id="L-1579"><a href="#L-1579"><span class="linenos">1579</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;amplitude (normalized)&quot;</span><span class="p">),</span>
</span><span id="L-1580"><a href="#L-1580"><span class="linenos">1580</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="L-1581"><a href="#L-1581"><span class="linenos">1581</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="L-1582"><a href="#L-1582"><span class="linenos">1582</span></a>
</span><span id="L-1583"><a href="#L-1583"><span class="linenos">1583</span></a>        <span class="k">if</span> <span class="s1">&#39;ticks&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bins&#39;</span><span class="p">:</span>
</span><span id="L-1584"><a href="#L-1584"><span class="linenos">1584</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_bin_ticks</span><span class="p">()</span>
</span><span id="L-1585"><a href="#L-1585"><span class="linenos">1585</span></a>
</span><span id="L-1586"><a href="#L-1586"><span class="linenos">1586</span></a>    <span class="k">def</span> <span class="nf">fft_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1587"><a href="#L-1587"><span class="linenos">1587</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1588"><a href="#L-1588"><span class="linenos">1588</span></a><span class="sd">            Plots the octave based Fourier Transform Histogram.</span>
</span><span id="L-1589"><a href="#L-1589"><span class="linenos">1589</span></a><span class="sd">            Both axes are on a log scale.</span>
</span><span id="L-1590"><a href="#L-1590"><span class="linenos">1590</span></a>
</span><span id="L-1591"><a href="#L-1591"><span class="linenos">1591</span></a><span class="sd">            If `ticks = &#39;bins&#39;` is supplied in the keyword arguments, the frequency ticks are replaced</span>
</span><span id="L-1592"><a href="#L-1592"><span class="linenos">1592</span></a><span class="sd">            with the frequency bin values</span>
</span><span id="L-1593"><a href="#L-1593"><span class="linenos">1593</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="L-1594"><a href="#L-1594"><span class="linenos">1594</span></a>
</span><span id="L-1595"><a href="#L-1595"><span class="linenos">1595</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1596"><a href="#L-1596"><span class="linenos">1596</span></a>
</span><span id="L-1597"><a href="#L-1597"><span class="linenos">1597</span></a>        <span class="c1"># Histogram of frequency values occurrences in octave bins</span>
</span><span id="L-1598"><a href="#L-1598"><span class="linenos">1598</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fft_bins</span><span class="p">(),</span> <span class="n">utils</span><span class="o">.</span><span class="n">octave_histogram</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">octave_fraction</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="L-1599"><a href="#L-1599"><span class="linenos">1599</span></a>                 <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="L-1600"><a href="#L-1600"><span class="linenos">1600</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
</span><span id="L-1601"><a href="#L-1601"><span class="linenos">1601</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;amplitude (normalized)&#39;</span><span class="p">)</span>
</span><span id="L-1602"><a href="#L-1602"><span class="linenos">1602</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="L-1603"><a href="#L-1603"><span class="linenos">1603</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="L-1604"><a href="#L-1604"><span class="linenos">1604</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="L-1605"><a href="#L-1605"><span class="linenos">1605</span></a>
</span><span id="L-1606"><a href="#L-1606"><span class="linenos">1606</span></a>        <span class="k">if</span> <span class="s1">&#39;ticks&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bins&#39;</span><span class="p">:</span>
</span><span id="L-1607"><a href="#L-1607"><span class="linenos">1607</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_bin_ticks</span><span class="p">()</span>
</span><span id="L-1608"><a href="#L-1608"><span class="linenos">1608</span></a>
</span><span id="L-1609"><a href="#L-1609"><span class="linenos">1609</span></a>    <span class="k">def</span> <span class="nf">peaks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1610"><a href="#L-1610"><span class="linenos">1610</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1611"><a href="#L-1611"><span class="linenos">1611</span></a><span class="sd">            Plots the Fourier Transform of the Signal, with the peaks detected</span>
</span><span id="L-1612"><a href="#L-1612"><span class="linenos">1612</span></a><span class="sd">            with the `Signal.peaks()` method.</span>
</span><span id="L-1613"><a href="#L-1613"><span class="linenos">1613</span></a>
</span><span id="L-1614"><a href="#L-1614"><span class="linenos">1614</span></a><span class="sd">            If `peak_height = True` is supplied in the keyword arguments the</span>
</span><span id="L-1615"><a href="#L-1615"><span class="linenos">1615</span></a><span class="sd">            computed height threshold is</span>
</span><span id="L-1616"><a href="#L-1616"><span class="linenos">1616</span></a><span class="sd">            shown on the plot.</span>
</span><span id="L-1617"><a href="#L-1617"><span class="linenos">1617</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="L-1618"><a href="#L-1618"><span class="linenos">1618</span></a>
</span><span id="L-1619"><a href="#L-1619"><span class="linenos">1619</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1620"><a href="#L-1620"><span class="linenos">1620</span></a>
</span><span id="L-1621"><a href="#L-1621"><span class="linenos">1621</span></a>        <span class="n">fft_freqs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span>
</span><span id="L-1622"><a href="#L-1622"><span class="linenos">1622</span></a>        <span class="n">fft</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fft</span><span class="p">()</span>
</span><span id="L-1623"><a href="#L-1623"><span class="linenos">1623</span></a>        <span class="n">fft_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">fft_range</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-1624"><a href="#L-1624"><span class="linenos">1624</span></a>        <span class="n">max_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fft_freqs</span> <span class="o">&gt;=</span> <span class="n">fft_range</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1625"><a href="#L-1625"><span class="linenos">1625</span></a>        <span class="n">peak_indexes</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">peaks</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1626"><a href="#L-1626"><span class="linenos">1626</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
</span><span id="L-1627"><a href="#L-1627"><span class="linenos">1627</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;amplitude&#39;</span><span class="p">)</span>
</span><span id="L-1628"><a href="#L-1628"><span class="linenos">1628</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="L-1629"><a href="#L-1629"><span class="linenos">1629</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="L-1630"><a href="#L-1630"><span class="linenos">1630</span></a>
</span><span id="L-1631"><a href="#L-1631"><span class="linenos">1631</span></a>        <span class="k">if</span> <span class="s1">&#39;color&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">plot_kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-1632"><a href="#L-1632"><span class="linenos">1632</span></a>            <span class="n">plot_kwargs</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span>
</span><span id="L-1633"><a href="#L-1633"><span class="linenos">1633</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fft_freqs</span><span class="p">[:</span><span class="n">max_index</span><span class="p">],</span> <span class="n">fft</span><span class="p">[:</span><span class="n">max_index</span><span class="p">],</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="L-1634"><a href="#L-1634"><span class="linenos">1634</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">fft_freqs</span><span class="p">[</span><span class="n">peak_indexes</span><span class="p">],</span> <span class="n">fft</span><span class="p">[</span><span class="n">peak_indexes</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span><span id="L-1635"><a href="#L-1635"><span class="linenos">1635</span></a>        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;peak_height&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;peak_height&#39;</span><span class="p">]):</span>
</span><span id="L-1636"><a href="#L-1636"><span class="linenos">1636</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fft_freqs</span><span class="p">[:</span><span class="n">max_index</span><span class="p">],</span> <span class="n">height</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span><span id="L-1637"><a href="#L-1637"><span class="linenos">1637</span></a>
</span><span id="L-1638"><a href="#L-1638"><span class="linenos">1638</span></a>    <span class="k">def</span> <span class="nf">peak_damping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1639"><a href="#L-1639"><span class="linenos">1639</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1640"><a href="#L-1640"><span class="linenos">1640</span></a><span class="sd">            Plots the frequency vs damping scatter of the damping ratio computed from the</span>
</span><span id="L-1641"><a href="#L-1641"><span class="linenos">1641</span></a><span class="sd">            Fourier Transform peak shapes. A polynomial curve fit is added to help visualisation.</span>
</span><span id="L-1642"><a href="#L-1642"><span class="linenos">1642</span></a>
</span><span id="L-1643"><a href="#L-1643"><span class="linenos">1643</span></a><span class="sd">            Supported key word arguments are :</span>
</span><span id="L-1644"><a href="#L-1644"><span class="linenos">1644</span></a>
</span><span id="L-1645"><a href="#L-1645"><span class="linenos">1645</span></a><span class="sd">            `n=5` : The order of the fitted polynomial curve, default is 5,</span>
</span><span id="L-1646"><a href="#L-1646"><span class="linenos">1646</span></a><span class="sd">            if the supplied value is too high, it will be reduced until the</span>
</span><span id="L-1647"><a href="#L-1647"><span class="linenos">1647</span></a><span class="sd">            number of peaks is sufficient to fit the polynomial.</span>
</span><span id="L-1648"><a href="#L-1648"><span class="linenos">1648</span></a>
</span><span id="L-1649"><a href="#L-1649"><span class="linenos">1649</span></a><span class="sd">            `inverse=True` : Default value is True, if False, the damping ratio is shown instead</span>
</span><span id="L-1650"><a href="#L-1650"><span class="linenos">1650</span></a><span class="sd">            of its inverse.</span>
</span><span id="L-1651"><a href="#L-1651"><span class="linenos">1651</span></a>
</span><span id="L-1652"><a href="#L-1652"><span class="linenos">1652</span></a><span class="sd">            `normalize=False` : Default value is False, if True the damping values are normalized</span>
</span><span id="L-1653"><a href="#L-1653"><span class="linenos">1653</span></a><span class="sd">            from 0 to 1, to help analyze results and compare Sounds.</span>
</span><span id="L-1654"><a href="#L-1654"><span class="linenos">1654</span></a>
</span><span id="L-1655"><a href="#L-1655"><span class="linenos">1655</span></a><span class="sd">            `ticks=None` : Default value is None, if `ticks=&#39;bins&#39;` the x-axis ticks are replaced with</span>
</span><span id="L-1656"><a href="#L-1656"><span class="linenos">1656</span></a><span class="sd">            frequency bin values.</span>
</span><span id="L-1657"><a href="#L-1657"><span class="linenos">1657</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="L-1658"><a href="#L-1658"><span class="linenos">1658</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1659"><a href="#L-1659"><span class="linenos">1659</span></a>        <span class="c1"># Get the damping ratio and peak frequencies</span>
</span><span id="L-1660"><a href="#L-1660"><span class="linenos">1660</span></a>        <span class="k">if</span> <span class="s1">&#39;inverse&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;inverse&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="L-1661"><a href="#L-1661"><span class="linenos">1661</span></a>            <span class="n">zetas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">peak_damping</span><span class="p">())</span>
</span><span id="L-1662"><a href="#L-1662"><span class="linenos">1662</span></a>            <span class="n">ylabel</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;damping $\zeta$&#39;</span>
</span><span id="L-1663"><a href="#L-1663"><span class="linenos">1663</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1664"><a href="#L-1664"><span class="linenos">1664</span></a>            <span class="n">zetas</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">peak_damping</span><span class="p">())</span>
</span><span id="L-1665"><a href="#L-1665"><span class="linenos">1665</span></a>            <span class="n">ylabel</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;inverse damping $1/\zeta$&#39;</span>
</span><span id="L-1666"><a href="#L-1666"><span class="linenos">1666</span></a>
</span><span id="L-1667"><a href="#L-1667"><span class="linenos">1667</span></a>        <span class="n">peak_freqs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">peaks</span><span class="p">()]</span>
</span><span id="L-1668"><a href="#L-1668"><span class="linenos">1668</span></a>
</span><span id="L-1669"><a href="#L-1669"><span class="linenos">1669</span></a>        <span class="c1"># If a polynomial order is supplied assign it, if not default is 5</span>
</span><span id="L-1670"><a href="#L-1670"><span class="linenos">1670</span></a>        <span class="k">if</span> <span class="s1">&#39;n&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-1671"><a href="#L-1671"><span class="linenos">1671</span></a>            <span class="n">n</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span>
</span><span id="L-1672"><a href="#L-1672"><span class="linenos">1672</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1673"><a href="#L-1673"><span class="linenos">1673</span></a>            <span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="L-1674"><a href="#L-1674"><span class="linenos">1674</span></a>
</span><span id="L-1675"><a href="#L-1675"><span class="linenos">1675</span></a>        <span class="c1"># If labels are supplied the default color are used</span>
</span><span id="L-1676"><a href="#L-1676"><span class="linenos">1676</span></a>        <span class="k">if</span> <span class="s1">&#39;label&#39;</span> <span class="ow">in</span> <span class="n">plot_kwargs</span><span class="p">:</span>
</span><span id="L-1677"><a href="#L-1677"><span class="linenos">1677</span></a>            <span class="n">plot_kwargs</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1678"><a href="#L-1678"><span class="linenos">1678</span></a>            <span class="n">plot2_kwargs</span> <span class="o">=</span> <span class="n">plot_kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-1679"><a href="#L-1679"><span class="linenos">1679</span></a>            <span class="n">plot2_kwargs</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1680"><a href="#L-1680"><span class="linenos">1680</span></a>
</span><span id="L-1681"><a href="#L-1681"><span class="linenos">1681</span></a>        <span class="c1"># If not black and red are used</span>
</span><span id="L-1682"><a href="#L-1682"><span class="linenos">1682</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1683"><a href="#L-1683"><span class="linenos">1683</span></a>            <span class="n">plot_kwargs</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span>
</span><span id="L-1684"><a href="#L-1684"><span class="linenos">1684</span></a>            <span class="n">plot2_kwargs</span> <span class="o">=</span> <span class="n">plot_kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-1685"><a href="#L-1685"><span class="linenos">1685</span></a>            <span class="n">plot2_kwargs</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span>
</span><span id="L-1686"><a href="#L-1686"><span class="linenos">1686</span></a>
</span><span id="L-1687"><a href="#L-1687"><span class="linenos">1687</span></a>        <span class="k">if</span> <span class="s1">&#39;normalize&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;normalize&#39;</span><span class="p">]:</span>
</span><span id="L-1688"><a href="#L-1688"><span class="linenos">1688</span></a>            <span class="n">zetas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">zetas</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">zetas</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">initial</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1689"><a href="#L-1689"><span class="linenos">1689</span></a>
</span><span id="L-1690"><a href="#L-1690"><span class="linenos">1690</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">peak_freqs</span><span class="p">,</span> <span class="n">zetas</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="L-1691"><a href="#L-1691"><span class="linenos">1691</span></a>        <span class="n">fun</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">nth_order_polynomial_fit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">peak_freqs</span><span class="p">,</span> <span class="n">zetas</span><span class="p">)</span>
</span><span id="L-1692"><a href="#L-1692"><span class="linenos">1692</span></a>        <span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">peak_freqs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">peak_freqs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
</span><span id="L-1693"><a href="#L-1693"><span class="linenos">1693</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">fun</span><span class="p">(</span><span class="n">freq</span><span class="p">),</span> <span class="o">**</span><span class="n">plot2_kwargs</span><span class="p">)</span>
</span><span id="L-1694"><a href="#L-1694"><span class="linenos">1694</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="L-1695"><a href="#L-1695"><span class="linenos">1695</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequency vs Damping Factor with Order &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span><span id="L-1696"><a href="#L-1696"><span class="linenos">1696</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
</span><span id="L-1697"><a href="#L-1697"><span class="linenos">1697</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
</span><span id="L-1698"><a href="#L-1698"><span class="linenos">1698</span></a>
</span><span id="L-1699"><a href="#L-1699"><span class="linenos">1699</span></a>        <span class="k">if</span> <span class="s1">&#39;ticks&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bins&#39;</span><span class="p">:</span>
</span><span id="L-1700"><a href="#L-1700"><span class="linenos">1700</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_bin_ticks</span><span class="p">()</span>
</span><span id="L-1701"><a href="#L-1701"><span class="linenos">1701</span></a>
</span><span id="L-1702"><a href="#L-1702"><span class="linenos">1702</span></a>    <span class="k">def</span> <span class="nf">time_damping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1703"><a href="#L-1703"><span class="linenos">1703</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1704"><a href="#L-1704"><span class="linenos">1704</span></a><span class="sd">        Shows the signal envelope with the fitted negative exponential</span>
</span><span id="L-1705"><a href="#L-1705"><span class="linenos">1705</span></a><span class="sd">        curve used to determine the time damping ratio of the signal.</span>
</span><span id="L-1706"><a href="#L-1706"><span class="linenos">1706</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1707"><a href="#L-1707"><span class="linenos">1707</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1708"><a href="#L-1708"><span class="linenos">1708</span></a>        <span class="c1"># Get the envelope data</span>
</span><span id="L-1709"><a href="#L-1709"><span class="linenos">1709</span></a>        <span class="n">envelope</span><span class="p">,</span> <span class="n">envelope_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">envelope</span><span class="p">()</span> 
</span><span id="L-1710"><a href="#L-1710"><span class="linenos">1710</span></a>
</span><span id="L-1711"><a href="#L-1711"><span class="linenos">1711</span></a>        <span class="c1"># First point is the maximum because e^-kt is strictly decreasing</span>
</span><span id="L-1712"><a href="#L-1712"><span class="linenos">1712</span></a>        <span class="n">first_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">envelope</span><span class="p">)</span>
</span><span id="L-1713"><a href="#L-1713"><span class="linenos">1713</span></a>
</span><span id="L-1714"><a href="#L-1714"><span class="linenos">1714</span></a>        <span class="c1"># The second point is the first point where the signal crosses the lower_threshold line</span>
</span><span id="L-1715"><a href="#L-1715"><span class="linenos">1715</span></a>        <span class="n">second_point_thresh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">damping</span><span class="o">.</span><span class="n">lower_threshold</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-1716"><a href="#L-1716"><span class="linenos">1716</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-1717"><a href="#L-1717"><span class="linenos">1717</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-1718"><a href="#L-1718"><span class="linenos">1718</span></a>                <span class="n">second_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flatnonzero</span><span class="p">(</span><span class="n">envelope</span><span class="p">[</span><span class="n">first_index</span><span class="p">:]</span> <span class="o">&lt;=</span> <span class="n">second_point_thresh</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1719"><a href="#L-1719"><span class="linenos">1719</span></a>                <span class="k">break</span>
</span><span id="L-1720"><a href="#L-1720"><span class="linenos">1720</span></a>            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
</span><span id="L-1721"><a href="#L-1721"><span class="linenos">1721</span></a>                <span class="n">second_point_thresh</span> <span class="o">*=</span> <span class="mi">2</span>
</span><span id="L-1722"><a href="#L-1722"><span class="linenos">1722</span></a>                <span class="k">if</span> <span class="n">second_point_thresh</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-1723"><a href="#L-1723"><span class="linenos">1723</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid second point threshold encountered, something went wrong&quot;</span><span class="p">)</span>
</span><span id="L-1724"><a href="#L-1724"><span class="linenos">1724</span></a>
</span><span id="L-1725"><a href="#L-1725"><span class="linenos">1725</span></a>        <span class="c1"># Function to compute the residual for the exponential curve fit</span>
</span><span id="L-1726"><a href="#L-1726"><span class="linenos">1726</span></a>        <span class="k">def</span> <span class="nf">residual_function</span><span class="p">(</span><span class="n">zeta_w</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
</span><span id="L-1727"><a href="#L-1727"><span class="linenos">1727</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">zeta_w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">s</span>
</span><span id="L-1728"><a href="#L-1728"><span class="linenos">1728</span></a>
</span><span id="L-1729"><a href="#L-1729"><span class="linenos">1729</span></a>        <span class="n">zeta_guess</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">]</span>
</span><span id="L-1730"><a href="#L-1730"><span class="linenos">1730</span></a>
</span><span id="L-1731"><a href="#L-1731"><span class="linenos">1731</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">least_squares</span><span class="p">(</span><span class="n">residual_function</span><span class="p">,</span> <span class="n">zeta_guess</span><span class="p">,</span>
</span><span id="L-1732"><a href="#L-1732"><span class="linenos">1732</span></a>                                              <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">envelope_time</span><span class="p">[</span><span class="n">first_index</span><span class="p">:</span><span class="n">second_index</span><span class="p">],</span>
</span><span id="L-1733"><a href="#L-1733"><span class="linenos">1733</span></a>                                                    <span class="n">envelope</span><span class="p">[</span><span class="n">first_index</span><span class="p">:</span><span class="n">second_index</span><span class="p">]))</span>
</span><span id="L-1734"><a href="#L-1734"><span class="linenos">1734</span></a>        <span class="c1"># Get the zeta*omega constant</span>
</span><span id="L-1735"><a href="#L-1735"><span class="linenos">1735</span></a>        <span class="n">zeta_omega</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1736"><a href="#L-1736"><span class="linenos">1736</span></a>
</span><span id="L-1737"><a href="#L-1737"><span class="linenos">1737</span></a>        <span class="c1"># Compute the fundamental frequency in radians of the signal</span>
</span><span id="L-1738"><a href="#L-1738"><span class="linenos">1738</span></a>        <span class="n">wd</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fundamental</span><span class="p">()</span>
</span><span id="L-1739"><a href="#L-1739"><span class="linenos">1739</span></a>
</span><span id="L-1740"><a href="#L-1740"><span class="linenos">1740</span></a>        <span class="c1"># Plot the two points used for the regression</span>
</span><span id="L-1741"><a href="#L-1741"><span class="linenos">1741</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">envelope_time</span><span class="p">[[</span><span class="n">first_index</span><span class="p">,</span> <span class="n">first_index</span> <span class="o">+</span> <span class="n">second_index</span><span class="p">]],</span> 
</span><span id="L-1742"><a href="#L-1742"><span class="linenos">1742</span></a>                    <span class="n">envelope</span><span class="p">[[</span><span class="n">first_index</span><span class="p">,</span> <span class="n">first_index</span> <span class="o">+</span> <span class="n">second_index</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span><span id="L-1743"><a href="#L-1743"><span class="linenos">1743</span></a>
</span><span id="L-1744"><a href="#L-1744"><span class="linenos">1744</span></a>        <span class="c1"># get the current ax</span>
</span><span id="L-1745"><a href="#L-1745"><span class="linenos">1745</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="L-1746"><a href="#L-1746"><span class="linenos">1746</span></a>
</span><span id="L-1747"><a href="#L-1747"><span class="linenos">1747</span></a>        <span class="c1"># Plot the damping curve</span>
</span><span id="L-1748"><a href="#L-1748"><span class="linenos">1748</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">envelope_time</span><span class="p">[</span><span class="n">first_index</span><span class="p">:</span><span class="n">second_index</span> <span class="o">+</span> <span class="n">first_index</span><span class="p">],</span>
</span><span id="L-1749"><a href="#L-1749"><span class="linenos">1749</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">zeta_omega</span> <span class="o">*</span> <span class="n">envelope_time</span><span class="p">[</span><span class="n">first_index</span><span class="p">:</span><span class="n">second_index</span> <span class="o">+</span> <span class="n">first_index</span><span class="p">]),</span> 
</span><span id="L-1750"><a href="#L-1750"><span class="linenos">1750</span></a>                <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
</span><span id="L-1751"><a href="#L-1751"><span class="linenos">1751</span></a>                <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
</span><span id="L-1752"><a href="#L-1752"><span class="linenos">1752</span></a>
</span><span id="L-1753"><a href="#L-1753"><span class="linenos">1753</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</span><span id="L-1754"><a href="#L-1754"><span class="linenos">1754</span></a>        <span class="k">if</span> <span class="s1">&#39;alpha&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">plot_kwargs</span><span class="p">:</span>
</span><span id="L-1755"><a href="#L-1755"><span class="linenos">1755</span></a>            <span class="n">plot_kwargs</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.6</span>
</span><span id="L-1756"><a href="#L-1756"><span class="linenos">1756</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">envelope</span><span class="p">(</span><span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="L-1757"><a href="#L-1757"><span class="linenos">1757</span></a>
</span><span id="L-1758"><a href="#L-1758"><span class="linenos">1758</span></a>        <span class="k">if</span> <span class="s1">&#39;label&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">plot_kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-1759"><a href="#L-1759"><span class="linenos">1759</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;damping curve&#39;</span><span class="p">,</span> <span class="s1">&#39;signal envelope&#39;</span><span class="p">])</span>
</span><span id="L-1760"><a href="#L-1760"><span class="linenos">1760</span></a>
</span><span id="L-1761"><a href="#L-1761"><span class="linenos">1761</span></a>        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Zeta : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="o">-</span><span class="n">zeta_omega</span> <span class="o">/</span> <span class="n">wd</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; Fundamental &#39;</span> <span class="o">+</span> \
</span><span id="L-1762"><a href="#L-1762"><span class="linenos">1762</span></a>                <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fundamental</span><span class="p">(),</span> <span class="mi">0</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;Hz&#39;</span>
</span><span id="L-1763"><a href="#L-1763"><span class="linenos">1763</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
</span><span id="L-1764"><a href="#L-1764"><span class="linenos">1764</span></a>
</span><span id="L-1765"><a href="#L-1765"><span class="linenos">1765</span></a>    <span class="k">def</span> <span class="nf">integral</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1766"><a href="#L-1766"><span class="linenos">1766</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1767"><a href="#L-1767"><span class="linenos">1767</span></a><span class="sd">        Cumulative integral plot of the normalized signal log envelope</span>
</span><span id="L-1768"><a href="#L-1768"><span class="linenos">1768</span></a>
</span><span id="L-1769"><a href="#L-1769"><span class="linenos">1769</span></a><span class="sd">        Represents the power distribution variation in time for the signal.</span>
</span><span id="L-1770"><a href="#L-1770"><span class="linenos">1770</span></a><span class="sd">        This is a plot of the function $F(x)$ such as :</span>
</span><span id="L-1771"><a href="#L-1771"><span class="linenos">1771</span></a>
</span><span id="L-1772"><a href="#L-1772"><span class="linenos">1772</span></a><span class="sd">        $ F(x) = \int_0^x env(x) dx $</span>
</span><span id="L-1773"><a href="#L-1773"><span class="linenos">1773</span></a>
</span><span id="L-1774"><a href="#L-1774"><span class="linenos">1774</span></a><span class="sd">        Where e(x) is the signal envelope.</span>
</span><span id="L-1775"><a href="#L-1775"><span class="linenos">1775</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1776"><a href="#L-1776"><span class="linenos">1776</span></a>        <span class="c1"># sanitize the kwargs</span>
</span><span id="L-1777"><a href="#L-1777"><span class="linenos">1777</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1778"><a href="#L-1778"><span class="linenos">1778</span></a>
</span><span id="L-1779"><a href="#L-1779"><span class="linenos">1779</span></a>        <span class="c1"># Compute log envelope and log time</span>
</span><span id="L-1780"><a href="#L-1780"><span class="linenos">1780</span></a>        <span class="n">log_envelope</span><span class="p">,</span> <span class="n">log_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="L-1781"><a href="#L-1781"><span class="linenos">1781</span></a>
</span><span id="L-1782"><a href="#L-1782"><span class="linenos">1782</span></a>
</span><span id="L-1783"><a href="#L-1783"><span class="linenos">1783</span></a>        <span class="c1"># compute the cumulative integral</span>
</span><span id="L-1784"><a href="#L-1784"><span class="linenos">1784</span></a>        <span class="n">integral</span> <span class="o">=</span> <span class="p">[</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">log_envelope</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">log_time</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">log_envelope</span><span class="p">),</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="L-1785"><a href="#L-1785"><span class="linenos">1785</span></a>        <span class="n">integral</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span>
</span><span id="L-1786"><a href="#L-1786"><span class="linenos">1786</span></a>
</span><span id="L-1787"><a href="#L-1787"><span class="linenos">1787</span></a>        <span class="c1"># plot the integral</span>
</span><span id="L-1788"><a href="#L-1788"><span class="linenos">1788</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">log_time</span><span class="p">[</span><span class="mi">2</span><span class="p">:],</span> <span class="n">integral</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="L-1789"><a href="#L-1789"><span class="linenos">1789</span></a>
</span><span id="L-1790"><a href="#L-1790"><span class="linenos">1790</span></a>        <span class="c1"># Add labels and scale</span>
</span><span id="L-1791"><a href="#L-1791"><span class="linenos">1791</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
</span><span id="L-1792"><a href="#L-1792"><span class="linenos">1792</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;cumulative power (normalized)&#39;</span><span class="p">)</span>
</span><span id="L-1793"><a href="#L-1793"><span class="linenos">1793</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="L-1794"><a href="#L-1794"><span class="linenos">1794</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span></pre></div>


            </section>
                <section id="SoundPack">
                            <input id="SoundPack-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">SoundPack</span>:

                <label class="view-source-button" for="SoundPack-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SoundPack"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SoundPack-25"><a href="#SoundPack-25"><span class="linenos"> 25</span></a><span class="k">class</span> <span class="nc">SoundPack</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="SoundPack-26"><a href="#SoundPack-26"><span class="linenos"> 26</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack-27"><a href="#SoundPack-27"><span class="linenos"> 27</span></a><span class="sd">    A class to store and analyse multiple sounds</span>
</span><span id="SoundPack-28"><a href="#SoundPack-28"><span class="linenos"> 28</span></a><span class="sd">    Some methods are only available for the case with two sounds</span>
</span><span id="SoundPack-29"><a href="#SoundPack-29"><span class="linenos"> 29</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="SoundPack-30"><a href="#SoundPack-30"><span class="linenos"> 30</span></a>
</span><span id="SoundPack-31"><a href="#SoundPack-31"><span class="linenos"> 31</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">sounds</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fundamentals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">SoundParams</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">equalize_time</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="SoundPack-32"><a href="#SoundPack-32"><span class="linenos"> 32</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack-33"><a href="#SoundPack-33"><span class="linenos"> 33</span></a><span class="sd">        The SoundPack can be instantiated from existing Sound class instances, either in a list or as</span>
</span><span id="SoundPack-34"><a href="#SoundPack-34"><span class="linenos"> 34</span></a><span class="sd">        multiple arguments</span>
</span><span id="SoundPack-35"><a href="#SoundPack-35"><span class="linenos"> 35</span></a>
</span><span id="SoundPack-36"><a href="#SoundPack-36"><span class="linenos"> 36</span></a><span class="sd">        The class can also handle the creation of Sound class instances if the arguments are filenames,</span>
</span><span id="SoundPack-37"><a href="#SoundPack-37"><span class="linenos"> 37</span></a><span class="sd">        either a list or multiple arguments.</span>
</span><span id="SoundPack-38"><a href="#SoundPack-38"><span class="linenos"> 38</span></a>
</span><span id="SoundPack-39"><a href="#SoundPack-39"><span class="linenos"> 39</span></a><span class="sd">        If the number of Sound contained is equal to two, the SoundPack will be &#39;dual&#39; and the associated methods</span>
</span><span id="SoundPack-40"><a href="#SoundPack-40"><span class="linenos"> 40</span></a><span class="sd">        will be available</span>
</span><span id="SoundPack-41"><a href="#SoundPack-41"><span class="linenos"> 41</span></a>
</span><span id="SoundPack-42"><a href="#SoundPack-42"><span class="linenos"> 42</span></a><span class="sd">        If it contains multiple sounds the SoundPack will be multiple and a reduced number of methods will work</span>
</span><span id="SoundPack-43"><a href="#SoundPack-43"><span class="linenos"> 43</span></a>
</span><span id="SoundPack-44"><a href="#SoundPack-44"><span class="linenos"> 44</span></a><span class="sd">        A list of names as strings and fundamental frequencies can be specified when creating the SoundPack</span>
</span><span id="SoundPack-45"><a href="#SoundPack-45"><span class="linenos"> 45</span></a>
</span><span id="SoundPack-46"><a href="#SoundPack-46"><span class="linenos"> 46</span></a><span class="sd">        If equalize_time is set to False, the contained sounds will not be trimmed to the same length.</span>
</span><span id="SoundPack-47"><a href="#SoundPack-47"><span class="linenos"> 47</span></a>
</span><span id="SoundPack-48"><a href="#SoundPack-48"><span class="linenos"> 48</span></a><span class="sd">        Examples :</span>
</span><span id="SoundPack-49"><a href="#SoundPack-49"><span class="linenos"> 49</span></a><span class="sd">        ```</span>
</span><span id="SoundPack-50"><a href="#SoundPack-50"><span class="linenos"> 50</span></a><span class="sd">        Sound_Test = SoundPack(&#39;sounds/test1.wav&#39;, &#39;sounds/test2.wav&#39;, names=[&#39;A&#39;, &#39;B&#39;], fundamentals = [134, 134])</span>
</span><span id="SoundPack-51"><a href="#SoundPack-51"><span class="linenos"> 51</span></a>
</span><span id="SoundPack-52"><a href="#SoundPack-52"><span class="linenos"> 52</span></a><span class="sd">        sounds = [sound1, sound2, sound3, sound4, sound5] # instances of the Sound class</span>
</span><span id="SoundPack-53"><a href="#SoundPack-53"><span class="linenos"> 53</span></a><span class="sd">        large_Test = SoundPack(sounds, names=[&#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;])</span>
</span><span id="SoundPack-54"><a href="#SoundPack-54"><span class="linenos"> 54</span></a><span class="sd">        ```</span>
</span><span id="SoundPack-55"><a href="#SoundPack-55"><span class="linenos"> 55</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack-56"><a href="#SoundPack-56"><span class="linenos"> 56</span></a>        <span class="c1"># create a copy of the sound parameters</span>
</span><span id="SoundPack-57"><a href="#SoundPack-57"><span class="linenos"> 57</span></a>        <span class="k">if</span> <span class="n">SoundParams</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SoundPack-58"><a href="#SoundPack-58"><span class="linenos"> 58</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">SP</span> <span class="o">=</span> <span class="n">sound_parameters</span><span class="p">()</span>
</span><span id="SoundPack-59"><a href="#SoundPack-59"><span class="linenos"> 59</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack-60"><a href="#SoundPack-60"><span class="linenos"> 60</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">SP</span> <span class="o">=</span> <span class="n">SoundParams</span>
</span><span id="SoundPack-61"><a href="#SoundPack-61"><span class="linenos"> 61</span></a>
</span><span id="SoundPack-62"><a href="#SoundPack-62"><span class="linenos"> 62</span></a>        <span class="c1"># Check if the sounds argument is a list</span>
</span><span id="SoundPack-63"><a href="#SoundPack-63"><span class="linenos"> 63</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="SoundPack-64"><a href="#SoundPack-64"><span class="linenos"> 64</span></a>            <span class="n">sounds</span> <span class="o">=</span> <span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># unpack the list</span>
</span><span id="SoundPack-65"><a href="#SoundPack-65"><span class="linenos"> 65</span></a>
</span><span id="SoundPack-66"><a href="#SoundPack-66"><span class="linenos"> 66</span></a>        <span class="c1"># Check for special case</span>
</span><span id="SoundPack-67"><a href="#SoundPack-67"><span class="linenos"> 67</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sounds</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="SoundPack-68"><a href="#SoundPack-68"><span class="linenos"> 68</span></a>            <span class="c1"># special case to compare two sounds</span>
</span><span id="SoundPack-69"><a href="#SoundPack-69"><span class="linenos"> 69</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;dual&#39;</span>
</span><span id="SoundPack-70"><a href="#SoundPack-70"><span class="linenos"> 70</span></a>
</span><span id="SoundPack-71"><a href="#SoundPack-71"><span class="linenos"> 71</span></a>        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sounds</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="SoundPack-72"><a href="#SoundPack-72"><span class="linenos"> 72</span></a>            <span class="c1"># general case for multiple sounds</span>
</span><span id="SoundPack-73"><a href="#SoundPack-73"><span class="linenos"> 73</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;multiple&#39;</span>
</span><span id="SoundPack-74"><a href="#SoundPack-74"><span class="linenos"> 74</span></a>
</span><span id="SoundPack-75"><a href="#SoundPack-75"><span class="linenos"> 75</span></a>        <span class="c1"># If filenames are supplied</span>
</span><span id="SoundPack-76"><a href="#SoundPack-76"><span class="linenos"> 76</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="SoundPack-77"><a href="#SoundPack-77"><span class="linenos"> 77</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sounds_from_files</span><span class="p">(</span><span class="n">sounds</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span> <span class="n">fundamentals</span><span class="o">=</span><span class="n">fundamentals</span><span class="p">)</span>
</span><span id="SoundPack-78"><a href="#SoundPack-78"><span class="linenos"> 78</span></a>
</span><span id="SoundPack-79"><a href="#SoundPack-79"><span class="linenos"> 79</span></a>        <span class="c1"># Else sound instances are supplied</span>
</span><span id="SoundPack-80"><a href="#SoundPack-80"><span class="linenos"> 80</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack-81"><a href="#SoundPack-81"><span class="linenos"> 81</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span> <span class="o">=</span> <span class="n">sounds</span>
</span><span id="SoundPack-82"><a href="#SoundPack-82"><span class="linenos"> 82</span></a>
</span><span id="SoundPack-83"><a href="#SoundPack-83"><span class="linenos"> 83</span></a>            <span class="c1"># sound name defined in constructor</span>
</span><span id="SoundPack-84"><a href="#SoundPack-84"><span class="linenos"> 84</span></a>            <span class="k">if</span> <span class="n">names</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">)):</span>
</span><span id="SoundPack-85"><a href="#SoundPack-85"><span class="linenos"> 85</span></a>                <span class="k">for</span> <span class="n">sound</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">,</span> <span class="n">names</span><span class="p">):</span>
</span><span id="SoundPack-86"><a href="#SoundPack-86"><span class="linenos"> 86</span></a>                    <span class="n">sound</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">n</span>
</span><span id="SoundPack-87"><a href="#SoundPack-87"><span class="linenos"> 87</span></a>
</span><span id="SoundPack-88"><a href="#SoundPack-88"><span class="linenos"> 88</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack-89"><a href="#SoundPack-89"><span class="linenos"> 89</span></a>                <span class="c1"># names obtained from the supplied sounds</span>
</span><span id="SoundPack-90"><a href="#SoundPack-90"><span class="linenos"> 90</span></a>                <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">sound</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span> <span class="k">if</span> <span class="n">sound</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="SoundPack-91"><a href="#SoundPack-91"><span class="linenos"> 91</span></a>
</span><span id="SoundPack-92"><a href="#SoundPack-92"><span class="linenos"> 92</span></a>                <span class="c1"># all sounds have a name</span>
</span><span id="SoundPack-93"><a href="#SoundPack-93"><span class="linenos"> 93</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">sounds</span><span class="p">):</span>
</span><span id="SoundPack-94"><a href="#SoundPack-94"><span class="linenos"> 94</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="n">names</span>
</span><span id="SoundPack-95"><a href="#SoundPack-95"><span class="linenos"> 95</span></a>
</span><span id="SoundPack-96"><a href="#SoundPack-96"><span class="linenos"> 96</span></a>                <span class="c1"># Assign a default value to names</span>
</span><span id="SoundPack-97"><a href="#SoundPack-97"><span class="linenos"> 97</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack-98"><a href="#SoundPack-98"><span class="linenos"> 98</span></a>                    <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sounds</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="SoundPack-99"><a href="#SoundPack-99"><span class="linenos"> 99</span></a>                    <span class="k">for</span> <span class="n">sound</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">,</span> <span class="n">names</span><span class="p">):</span>
</span><span id="SoundPack-100"><a href="#SoundPack-100"><span class="linenos">100</span></a>                        <span class="n">sound</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">n</span>
</span><span id="SoundPack-101"><a href="#SoundPack-101"><span class="linenos">101</span></a>
</span><span id="SoundPack-102"><a href="#SoundPack-102"><span class="linenos">102</span></a>            <span class="c1"># If the sounds are not conditionned condition them</span>
</span><span id="SoundPack-103"><a href="#SoundPack-103"><span class="linenos">103</span></a>            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="SoundPack-104"><a href="#SoundPack-104"><span class="linenos">104</span></a>                <span class="k">if</span> <span class="o">~</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s1">&#39;signal&#39;</span><span class="p">):</span>
</span><span id="SoundPack-105"><a href="#SoundPack-105"><span class="linenos">105</span></a>                    <span class="n">s</span><span class="o">.</span><span class="n">condition</span><span class="p">()</span>
</span><span id="SoundPack-106"><a href="#SoundPack-106"><span class="linenos">106</span></a>
</span><span id="SoundPack-107"><a href="#SoundPack-107"><span class="linenos">107</span></a>        <span class="k">if</span> <span class="n">equalize_time</span><span class="p">:</span>
</span><span id="SoundPack-108"><a href="#SoundPack-108"><span class="linenos">108</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">equalize_time</span><span class="p">()</span>
</span><span id="SoundPack-109"><a href="#SoundPack-109"><span class="linenos">109</span></a>
</span><span id="SoundPack-110"><a href="#SoundPack-110"><span class="linenos">110</span></a>        <span class="c1"># Define bin strings</span>
</span><span id="SoundPack-111"><a href="#SoundPack-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bin_strings</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">1</span><span class="p">:],</span> <span class="s1">&#39;brillance&#39;</span><span class="p">]</span>
</span><span id="SoundPack-112"><a href="#SoundPack-112"><span class="linenos">112</span></a>
</span><span id="SoundPack-113"><a href="#SoundPack-113"><span class="linenos">113</span></a>        <span class="c1"># Sort according to fundamental</span>
</span><span id="SoundPack-114"><a href="#SoundPack-114"><span class="linenos">114</span></a>        <span class="n">key</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">([</span><span class="n">sound</span><span class="o">.</span><span class="n">fundamental</span> <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">])</span>
</span><span id="SoundPack-115"><a href="#SoundPack-115"><span class="linenos">115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">)[</span><span class="n">key</span><span class="p">]</span>
</span><span id="SoundPack-116"><a href="#SoundPack-116"><span class="linenos">116</span></a>
</span><span id="SoundPack-117"><a href="#SoundPack-117"><span class="linenos">117</span></a>    <span class="k">def</span> <span class="nf">sounds_from_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sound_files</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fundamentals</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="SoundPack-118"><a href="#SoundPack-118"><span class="linenos">118</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack-119"><a href="#SoundPack-119"><span class="linenos">119</span></a><span class="sd">        Create Sound class instances and assign them to the SoundPack </span>
</span><span id="SoundPack-120"><a href="#SoundPack-120"><span class="linenos">120</span></a><span class="sd">        from a list of files</span>
</span><span id="SoundPack-121"><a href="#SoundPack-121"><span class="linenos">121</span></a>
</span><span id="SoundPack-122"><a href="#SoundPack-122"><span class="linenos">122</span></a><span class="sd">        :param sound_files: sound filenames</span>
</span><span id="SoundPack-123"><a href="#SoundPack-123"><span class="linenos">123</span></a><span class="sd">        :param names: sound names</span>
</span><span id="SoundPack-124"><a href="#SoundPack-124"><span class="linenos">124</span></a><span class="sd">        :param fundamentals: user specified fundamental frequencies</span>
</span><span id="SoundPack-125"><a href="#SoundPack-125"><span class="linenos">125</span></a><span class="sd">        :return: None</span>
</span><span id="SoundPack-126"><a href="#SoundPack-126"><span class="linenos">126</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack-127"><a href="#SoundPack-127"><span class="linenos">127</span></a>        <span class="c1"># Make the default name list from sound filenames if none is supplied</span>
</span><span id="SoundPack-128"><a href="#SoundPack-128"><span class="linenos">128</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sound_files</span><span class="p">)):</span>
</span><span id="SoundPack-129"><a href="#SoundPack-129"><span class="linenos">129</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">file</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">sound_files</span><span class="p">]</span>  <span class="c1"># remove the .wav</span>
</span><span id="SoundPack-130"><a href="#SoundPack-130"><span class="linenos">130</span></a>
</span><span id="SoundPack-131"><a href="#SoundPack-131"><span class="linenos">131</span></a>        <span class="c1"># If the fundamentals are not supplied or mismatch in number None is used</span>
</span><span id="SoundPack-132"><a href="#SoundPack-132"><span class="linenos">132</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">fundamentals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fundamentals</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sound_files</span><span class="p">)):</span>
</span><span id="SoundPack-133"><a href="#SoundPack-133"><span class="linenos">133</span></a>            <span class="n">fundamentals</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sound_files</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</span><span id="SoundPack-134"><a href="#SoundPack-134"><span class="linenos">134</span></a>
</span><span id="SoundPack-135"><a href="#SoundPack-135"><span class="linenos">135</span></a>        <span class="c1"># Create Sound instances from files</span>
</span><span id="SoundPack-136"><a href="#SoundPack-136"><span class="linenos">136</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SoundPack-137"><a href="#SoundPack-137"><span class="linenos">137</span></a>        <span class="k">for</span> <span class="n">file</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fundamental</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sound_files</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">fundamentals</span><span class="p">):</span>
</span><span id="SoundPack-138"><a href="#SoundPack-138"><span class="linenos">138</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Sound</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">fundamental</span><span class="o">=</span><span class="n">fundamental</span><span class="p">,</span>
</span><span id="SoundPack-139"><a href="#SoundPack-139"><span class="linenos">139</span></a>                                     <span class="n">SoundParams</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">))</span>
</span><span id="SoundPack-140"><a href="#SoundPack-140"><span class="linenos">140</span></a>
</span><span id="SoundPack-141"><a href="#SoundPack-141"><span class="linenos">141</span></a>    <span class="k">def</span> <span class="nf">equalize_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SoundPack-142"><a href="#SoundPack-142"><span class="linenos">142</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack-143"><a href="#SoundPack-143"><span class="linenos">143</span></a><span class="sd">        Trim the sounds so that they all have the length of the shortest sound, </span>
</span><span id="SoundPack-144"><a href="#SoundPack-144"><span class="linenos">144</span></a><span class="sd">        trimming is done at the end of the sounds.</span>
</span><span id="SoundPack-145"><a href="#SoundPack-145"><span class="linenos">145</span></a><span class="sd">        :return: None</span>
</span><span id="SoundPack-146"><a href="#SoundPack-146"><span class="linenos">146</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack-147"><a href="#SoundPack-147"><span class="linenos">147</span></a>        <span class="n">trim_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">sound</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">signal</span><span class="p">)</span> <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">])</span>
</span><span id="SoundPack-148"><a href="#SoundPack-148"><span class="linenos">148</span></a>        <span class="n">trimmed_sounds</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SoundPack-149"><a href="#SoundPack-149"><span class="linenos">149</span></a>        <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="SoundPack-150"><a href="#SoundPack-150"><span class="linenos">150</span></a>            <span class="n">new_sound</span> <span class="o">=</span> <span class="n">sound</span>
</span><span id="SoundPack-151"><a href="#SoundPack-151"><span class="linenos">151</span></a>            <span class="n">new_sound</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="n">new_sound</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">trim_time</span><span class="p">(</span><span class="n">trim_index</span> <span class="o">/</span> <span class="n">sound</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">sr</span><span class="p">)</span>
</span><span id="SoundPack-152"><a href="#SoundPack-152"><span class="linenos">152</span></a>            <span class="n">new_sound</span><span class="o">.</span><span class="n">bin_divide</span><span class="p">()</span>
</span><span id="SoundPack-153"><a href="#SoundPack-153"><span class="linenos">153</span></a>            <span class="n">trimmed_sounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_sound</span><span class="p">)</span>
</span><span id="SoundPack-154"><a href="#SoundPack-154"><span class="linenos">154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span> <span class="o">=</span> <span class="n">trimmed_sounds</span>
</span><span id="SoundPack-155"><a href="#SoundPack-155"><span class="linenos">155</span></a>
</span><span id="SoundPack-156"><a href="#SoundPack-156"><span class="linenos">156</span></a>    <span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SoundPack-157"><a href="#SoundPack-157"><span class="linenos">157</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack-158"><a href="#SoundPack-158"><span class="linenos">158</span></a><span class="sd">        Normalize all the signals in the SoundPack and returns a normalized</span>
</span><span id="SoundPack-159"><a href="#SoundPack-159"><span class="linenos">159</span></a><span class="sd">        instance of itself. See `Signal.normalize` for more information.</span>
</span><span id="SoundPack-160"><a href="#SoundPack-160"><span class="linenos">160</span></a><span class="sd">        :return: SoundPack with normalized signals</span>
</span><span id="SoundPack-161"><a href="#SoundPack-161"><span class="linenos">161</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack-162"><a href="#SoundPack-162"><span class="linenos">162</span></a>        <span class="n">new_sounds</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SoundPack-163"><a href="#SoundPack-163"><span class="linenos">163</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">sound</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">]</span>
</span><span id="SoundPack-164"><a href="#SoundPack-164"><span class="linenos">164</span></a>        <span class="n">fundamentals</span> <span class="o">=</span> <span class="p">[</span><span class="n">sound</span><span class="o">.</span><span class="n">fundamental</span> <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">]</span>
</span><span id="SoundPack-165"><a href="#SoundPack-165"><span class="linenos">165</span></a>        <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="SoundPack-166"><a href="#SoundPack-166"><span class="linenos">166</span></a>            <span class="n">sound</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
</span><span id="SoundPack-167"><a href="#SoundPack-167"><span class="linenos">167</span></a>            <span class="n">new_sounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sound</span><span class="p">)</span>
</span><span id="SoundPack-168"><a href="#SoundPack-168"><span class="linenos">168</span></a>
</span><span id="SoundPack-169"><a href="#SoundPack-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span> <span class="o">=</span> <span class="n">new_sounds</span>
</span><span id="SoundPack-170"><a href="#SoundPack-170"><span class="linenos">170</span></a>
</span><span id="SoundPack-171"><a href="#SoundPack-171"><span class="linenos">171</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="SoundPack-172"><a href="#SoundPack-172"><span class="linenos">172</span></a>
</span><span id="SoundPack-173"><a href="#SoundPack-173"><span class="linenos">173</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack-174"><a href="#SoundPack-174"><span class="linenos">174</span></a><span class="sd">    Methods for all SoundPacks</span>
</span><span id="SoundPack-175"><a href="#SoundPack-175"><span class="linenos">175</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="SoundPack-176"><a href="#SoundPack-176"><span class="linenos">176</span></a>
</span><span id="SoundPack-177"><a href="#SoundPack-177"><span class="linenos">177</span></a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="SoundPack-178"><a href="#SoundPack-178"><span class="linenos">178</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack-179"><a href="#SoundPack-179"><span class="linenos">179</span></a><span class="sd">        Superimposed plot of all the sounds on one figure for a specific kind</span>
</span><span id="SoundPack-180"><a href="#SoundPack-180"><span class="linenos">180</span></a>
</span><span id="SoundPack-181"><a href="#SoundPack-181"><span class="linenos">181</span></a><span class="sd">        __ Multiple SoundPack Method __</span>
</span><span id="SoundPack-182"><a href="#SoundPack-182"><span class="linenos">182</span></a><span class="sd">        Plots a specific signal.plot for all sounds on the same figure</span>
</span><span id="SoundPack-183"><a href="#SoundPack-183"><span class="linenos">183</span></a>
</span><span id="SoundPack-184"><a href="#SoundPack-184"><span class="linenos">184</span></a><span class="sd">        Ex : SoundPack.plot(&#39;fft&#39;) plots the fft of all sounds on a single figure</span>
</span><span id="SoundPack-185"><a href="#SoundPack-185"><span class="linenos">185</span></a><span class="sd">        The color argument is set to none so that the plots have different colors</span>
</span><span id="SoundPack-186"><a href="#SoundPack-186"><span class="linenos">186</span></a><span class="sd">        :param kind: feature name passed to the `signal.plot()` method</span>
</span><span id="SoundPack-187"><a href="#SoundPack-187"><span class="linenos">187</span></a><span class="sd">        :param kwargs: keywords arguments to pass to the `matplotlib.plot()` </span>
</span><span id="SoundPack-188"><a href="#SoundPack-188"><span class="linenos">188</span></a><span class="sd">        method</span>
</span><span id="SoundPack-189"><a href="#SoundPack-189"><span class="linenos">189</span></a>
</span><span id="SoundPack-190"><a href="#SoundPack-190"><span class="linenos">190</span></a><span class="sd">        :return: None</span>
</span><span id="SoundPack-191"><a href="#SoundPack-191"><span class="linenos">191</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack-192"><a href="#SoundPack-192"><span class="linenos">192</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="SoundPack-193"><a href="#SoundPack-193"><span class="linenos">193</span></a>        <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="SoundPack-194"><a href="#SoundPack-194"><span class="linenos">194</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">name</span>
</span><span id="SoundPack-195"><a href="#SoundPack-195"><span class="linenos">195</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SoundPack-196"><a href="#SoundPack-196"><span class="linenos">196</span></a>            <span class="n">sound</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">method_dict</span><span class="p">[</span><span class="n">kind</span><span class="p">](</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="SoundPack-197"><a href="#SoundPack-197"><span class="linenos">197</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="SoundPack-198"><a href="#SoundPack-198"><span class="linenos">198</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">kind</span> <span class="o">+</span> <span class="s1">&#39; plot&#39;</span><span class="p">)</span>
</span><span id="SoundPack-199"><a href="#SoundPack-199"><span class="linenos">199</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="SoundPack-200"><a href="#SoundPack-200"><span class="linenos">200</span></a>        <span class="k">return</span> <span class="n">ax</span>
</span><span id="SoundPack-201"><a href="#SoundPack-201"><span class="linenos">201</span></a>
</span><span id="SoundPack-202"><a href="#SoundPack-202"><span class="linenos">202</span></a>    <span class="k">def</span> <span class="nf">compare_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="SoundPack-203"><a href="#SoundPack-203"><span class="linenos">203</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack-204"><a href="#SoundPack-204"><span class="linenos">204</span></a><span class="sd">        Plots all the sounds on different figures to compare them for a specific kind</span>
</span><span id="SoundPack-205"><a href="#SoundPack-205"><span class="linenos">205</span></a>
</span><span id="SoundPack-206"><a href="#SoundPack-206"><span class="linenos">206</span></a><span class="sd">        __ Multiple SoundPack Method __</span>
</span><span id="SoundPack-207"><a href="#SoundPack-207"><span class="linenos">207</span></a><span class="sd">        Draws the same kind of plot on a different axis for each sound</span>
</span><span id="SoundPack-208"><a href="#SoundPack-208"><span class="linenos">208</span></a><span class="sd">        Example : `SoundPack.compare_plot(&#39;peaks&#39;)` with 4 Sounds will plot a </span>
</span><span id="SoundPack-209"><a href="#SoundPack-209"><span class="linenos">209</span></a><span class="sd">        figure with 4 axes, with each a different &#39;peak&#39; plot.</span>
</span><span id="SoundPack-210"><a href="#SoundPack-210"><span class="linenos">210</span></a>
</span><span id="SoundPack-211"><a href="#SoundPack-211"><span class="linenos">211</span></a><span class="sd">        :param kind: kind argument passed to `Signal.plot()`</span>
</span><span id="SoundPack-212"><a href="#SoundPack-212"><span class="linenos">212</span></a><span class="sd">        :param kwargs: key word arguments passed to `matplotlib.plot()`</span>
</span><span id="SoundPack-213"><a href="#SoundPack-213"><span class="linenos">213</span></a>
</span><span id="SoundPack-214"><a href="#SoundPack-214"><span class="linenos">214</span></a><span class="sd">        :return: None</span>
</span><span id="SoundPack-215"><a href="#SoundPack-215"><span class="linenos">215</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack-216"><a href="#SoundPack-216"><span class="linenos">216</span></a>        <span class="c1"># if a dual SoundPack : only plot two big plots</span>
</span><span id="SoundPack-217"><a href="#SoundPack-217"><span class="linenos">217</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;dual&#39;</span><span class="p">:</span>
</span><span id="SoundPack-218"><a href="#SoundPack-218"><span class="linenos">218</span></a>            <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="SoundPack-219"><a href="#SoundPack-219"><span class="linenos">219</span></a>            <span class="k">for</span> <span class="n">sound</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">,</span> <span class="n">axs</span><span class="p">):</span>
</span><span id="SoundPack-220"><a href="#SoundPack-220"><span class="linenos">220</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</span><span id="SoundPack-221"><a href="#SoundPack-221"><span class="linenos">221</span></a>                <span class="n">sound</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">method_dict</span><span class="p">[</span><span class="n">kind</span><span class="p">](</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="SoundPack-222"><a href="#SoundPack-222"><span class="linenos">222</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">kind</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">sound</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack-223"><a href="#SoundPack-223"><span class="linenos">223</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="SoundPack-224"><a href="#SoundPack-224"><span class="linenos">224</span></a>
</span><span id="SoundPack-225"><a href="#SoundPack-225"><span class="linenos">225</span></a>        <span class="c1"># If a multiple SoundPack : plot on a grid of axes</span>
</span><span id="SoundPack-226"><a href="#SoundPack-226"><span class="linenos">226</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;multiple&#39;</span><span class="p">:</span>
</span><span id="SoundPack-227"><a href="#SoundPack-227"><span class="linenos">227</span></a>            <span class="c1"># find the n, m values for the subplots line and columns</span>
</span><span id="SoundPack-228"><a href="#SoundPack-228"><span class="linenos">228</span></a>            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">)</span>
</span><span id="SoundPack-229"><a href="#SoundPack-229"><span class="linenos">229</span></a>            <span class="n">cols</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="SoundPack-230"><a href="#SoundPack-230"><span class="linenos">230</span></a>            <span class="k">if</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">4</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
</span><span id="SoundPack-231"><a href="#SoundPack-231"><span class="linenos">231</span></a>                <span class="c1"># a lot of sounds</span>
</span><span id="SoundPack-232"><a href="#SoundPack-232"><span class="linenos">232</span></a>                <span class="n">cols</span> <span class="o">=</span> <span class="mi">4</span>
</span><span id="SoundPack-233"><a href="#SoundPack-233"><span class="linenos">233</span></a>            <span class="k">elif</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">3</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
</span><span id="SoundPack-234"><a href="#SoundPack-234"><span class="linenos">234</span></a>                <span class="c1"># many sounds</span>
</span><span id="SoundPack-235"><a href="#SoundPack-235"><span class="linenos">235</span></a>                <span class="n">cols</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="SoundPack-236"><a href="#SoundPack-236"><span class="linenos">236</span></a>            <span class="k">elif</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="SoundPack-237"><a href="#SoundPack-237"><span class="linenos">237</span></a>                <span class="c1"># a few sounds</span>
</span><span id="SoundPack-238"><a href="#SoundPack-238"><span class="linenos">238</span></a>                <span class="n">cols</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="SoundPack-239"><a href="#SoundPack-239"><span class="linenos">239</span></a>
</span><span id="SoundPack-240"><a href="#SoundPack-240"><span class="linenos">240</span></a>            <span class="n">remainder</span> <span class="o">=</span> <span class="n">n</span> <span class="o">%</span> <span class="n">cols</span>
</span><span id="SoundPack-241"><a href="#SoundPack-241"><span class="linenos">241</span></a>            <span class="k">if</span> <span class="n">remainder</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="SoundPack-242"><a href="#SoundPack-242"><span class="linenos">242</span></a>                <span class="n">rows</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="n">cols</span>
</span><span id="SoundPack-243"><a href="#SoundPack-243"><span class="linenos">243</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack-244"><a href="#SoundPack-244"><span class="linenos">244</span></a>                <span class="n">rows</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="n">cols</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="SoundPack-245"><a href="#SoundPack-245"><span class="linenos">245</span></a>
</span><span id="SoundPack-246"><a href="#SoundPack-246"><span class="linenos">246</span></a>            <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">rows</span><span class="p">))</span>
</span><span id="SoundPack-247"><a href="#SoundPack-247"><span class="linenos">247</span></a>            <span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="SoundPack-248"><a href="#SoundPack-248"><span class="linenos">248</span></a>            <span class="k">for</span> <span class="n">sound</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">,</span> <span class="n">axs</span><span class="p">):</span>
</span><span id="SoundPack-249"><a href="#SoundPack-249"><span class="linenos">249</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</span><span id="SoundPack-250"><a href="#SoundPack-250"><span class="linenos">250</span></a>                <span class="n">sound</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">method_dict</span><span class="p">[</span><span class="n">kind</span><span class="p">](</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="SoundPack-251"><a href="#SoundPack-251"><span class="linenos">251</span></a>                <span class="n">title</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_title</span><span class="p">()</span>
</span><span id="SoundPack-252"><a href="#SoundPack-252"><span class="linenos">252</span></a>                <span class="n">title</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">title</span>
</span><span id="SoundPack-253"><a href="#SoundPack-253"><span class="linenos">253</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
</span><span id="SoundPack-254"><a href="#SoundPack-254"><span class="linenos">254</span></a>
</span><span id="SoundPack-255"><a href="#SoundPack-255"><span class="linenos">255</span></a>            <span class="k">if</span> <span class="n">remainder</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="SoundPack-256"><a href="#SoundPack-256"><span class="linenos">256</span></a>                <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">cols</span> <span class="o">-</span> <span class="n">remainder</span><span class="p">):]:</span>
</span><span id="SoundPack-257"><a href="#SoundPack-257"><span class="linenos">257</span></a>                    <span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
</span><span id="SoundPack-258"><a href="#SoundPack-258"><span class="linenos">258</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="SoundPack-259"><a href="#SoundPack-259"><span class="linenos">259</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack-260"><a href="#SoundPack-260"><span class="linenos">260</span></a>            <span class="k">raise</span> <span class="ne">Exception</span>
</span><span id="SoundPack-261"><a href="#SoundPack-261"><span class="linenos">261</span></a>        <span class="k">return</span> <span class="n">axs</span>
</span><span id="SoundPack-262"><a href="#SoundPack-262"><span class="linenos">262</span></a>
</span><span id="SoundPack-263"><a href="#SoundPack-263"><span class="linenos">263</span></a>    <span class="k">def</span> <span class="nf">freq_bin_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f_bin</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">):</span>
</span><span id="SoundPack-264"><a href="#SoundPack-264"><span class="linenos">264</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack-265"><a href="#SoundPack-265"><span class="linenos">265</span></a><span class="sd">        Plots the log envelope of specified frequency bins</span>
</span><span id="SoundPack-266"><a href="#SoundPack-266"><span class="linenos">266</span></a>
</span><span id="SoundPack-267"><a href="#SoundPack-267"><span class="linenos">267</span></a><span class="sd">        __ Multiple SoundPack Method __</span>
</span><span id="SoundPack-268"><a href="#SoundPack-268"><span class="linenos">268</span></a><span class="sd">        A function to compare signals decomposed frequency wise in the time </span>
</span><span id="SoundPack-269"><a href="#SoundPack-269"><span class="linenos">269</span></a><span class="sd">        domain on a logarithm scale. The methods plot all the sounds and plots </span>
</span><span id="SoundPack-270"><a href="#SoundPack-270"><span class="linenos">270</span></a><span class="sd">        their frequency bins according to the frequency bin argument f_bin.</span>
</span><span id="SoundPack-271"><a href="#SoundPack-271"><span class="linenos">271</span></a>
</span><span id="SoundPack-272"><a href="#SoundPack-272"><span class="linenos">272</span></a><span class="sd">        Example : SoundPack.freq_bin_plot(f_bin=&#39;mid&#39;) will plot the log-scale </span>
</span><span id="SoundPack-273"><a href="#SoundPack-273"><span class="linenos">273</span></a><span class="sd">        envelope of the &#39;mid&#39; signal of every sound in the SoundPack.</span>
</span><span id="SoundPack-274"><a href="#SoundPack-274"><span class="linenos">274</span></a>
</span><span id="SoundPack-275"><a href="#SoundPack-275"><span class="linenos">275</span></a><span class="sd">        f_bin: frequency bins to compare, Supported arguments are :</span>
</span><span id="SoundPack-276"><a href="#SoundPack-276"><span class="linenos">276</span></a><span class="sd">        &#39;all&#39;, &#39;bass&#39;, &#39;mid&#39;, &#39;highmid&#39;, &#39;uppermid&#39;, &#39;presence&#39;, &#39;brillance&#39;</span>
</span><span id="SoundPack-277"><a href="#SoundPack-277"><span class="linenos">277</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack-278"><a href="#SoundPack-278"><span class="linenos">278</span></a>
</span><span id="SoundPack-279"><a href="#SoundPack-279"><span class="linenos">279</span></a>        <span class="k">if</span> <span class="n">f_bin</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
</span><span id="SoundPack-280"><a href="#SoundPack-280"><span class="linenos">280</span></a>            <span class="c1"># Create one plot per bin</span>
</span><span id="SoundPack-281"><a href="#SoundPack-281"><span class="linenos">281</span></a>            <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
</span><span id="SoundPack-282"><a href="#SoundPack-282"><span class="linenos">282</span></a>            <span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="SoundPack-283"><a href="#SoundPack-283"><span class="linenos">283</span></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">1</span><span class="p">:],</span> <span class="s1">&#39;brillance&#39;</span><span class="p">],</span> <span class="n">axs</span><span class="p">):</span>
</span><span id="SoundPack-284"><a href="#SoundPack-284"><span class="linenos">284</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</span><span id="SoundPack-285"><a href="#SoundPack-285"><span class="linenos">285</span></a>                <span class="c1"># plot every sound for a frequency bin</span>
</span><span id="SoundPack-286"><a href="#SoundPack-286"><span class="linenos">286</span></a>                <span class="n">norm_factors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">norm_factor</span> <span class="k">for</span> <span class="n">son</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">])</span>
</span><span id="SoundPack-287"><a href="#SoundPack-287"><span class="linenos">287</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">son</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">):</span>
</span><span id="SoundPack-288"><a href="#SoundPack-288"><span class="linenos">288</span></a>                    <span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">old_plot</span><span class="p">(</span><span class="s1">&#39;log envelope&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">son</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack-289"><a href="#SoundPack-289"><span class="linenos">289</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="SoundPack-290"><a href="#SoundPack-290"><span class="linenos">290</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="SoundPack-291"><a href="#SoundPack-291"><span class="linenos">291</span></a>                <span class="n">son</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SoundPack-292"><a href="#SoundPack-292"><span class="linenos">292</span></a>                <span class="n">title0</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s1">&#39; : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
</span><span id="SoundPack-293"><a href="#SoundPack-293"><span class="linenos">293</span></a>                         <span class="nb">int</span><span class="p">(</span><span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; Hz, &#39;</span>
</span><span id="SoundPack-294"><a href="#SoundPack-294"><span class="linenos">294</span></a>                <span class="n">title1</span> <span class="o">=</span> <span class="s1">&#39;Norm. Factors : &#39;</span>
</span><span id="SoundPack-295"><a href="#SoundPack-295"><span class="linenos">295</span></a>                <span class="n">title2</span> <span class="o">=</span> <span class="s1">&#39;x, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">norm_factor</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="k">for</span> <span class="n">norm_factor</span> <span class="ow">in</span> <span class="n">norm_factors</span><span class="p">)</span>
</span><span id="SoundPack-296"><a href="#SoundPack-296"><span class="linenos">296</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title0</span> <span class="o">+</span> <span class="n">title1</span> <span class="o">+</span> <span class="n">title2</span><span class="p">)</span>
</span><span id="SoundPack-297"><a href="#SoundPack-297"><span class="linenos">297</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="SoundPack-298"><a href="#SoundPack-298"><span class="linenos">298</span></a>
</span><span id="SoundPack-299"><a href="#SoundPack-299"><span class="linenos">299</span></a>        <span class="k">elif</span> <span class="n">f_bin</span> <span class="ow">in</span> <span class="p">[</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="n">sound_parameters</span><span class="p">()</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">1</span><span class="p">:],</span> <span class="s1">&#39;brillance&#39;</span><span class="p">]:</span>
</span><span id="SoundPack-300"><a href="#SoundPack-300"><span class="linenos">300</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="SoundPack-301"><a href="#SoundPack-301"><span class="linenos">301</span></a>            <span class="c1"># Plot every envelope for a single frequency bin</span>
</span><span id="SoundPack-302"><a href="#SoundPack-302"><span class="linenos">302</span></a>            <span class="n">norm_factors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">norm_factor</span> <span class="k">for</span> <span class="n">son</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">])</span>
</span><span id="SoundPack-303"><a href="#SoundPack-303"><span class="linenos">303</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">son</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">):</span>
</span><span id="SoundPack-304"><a href="#SoundPack-304"><span class="linenos">304</span></a>                <span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">old_plot</span><span class="p">(</span><span class="s1">&#39;log envelope&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;. &#39;</span> <span class="o">+</span> <span class="n">son</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
</span><span id="SoundPack-305"><a href="#SoundPack-305"><span class="linenos">305</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="SoundPack-306"><a href="#SoundPack-306"><span class="linenos">306</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="SoundPack-307"><a href="#SoundPack-307"><span class="linenos">307</span></a>            <span class="n">son</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SoundPack-308"><a href="#SoundPack-308"><span class="linenos">308</span></a>            <span class="n">title0</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">f_bin</span> <span class="o">+</span> <span class="s1">&#39; : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
</span><span id="SoundPack-309"><a href="#SoundPack-309"><span class="linenos">309</span></a>                <span class="nb">int</span><span class="p">(</span><span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; Hz, &#39;</span>
</span><span id="SoundPack-310"><a href="#SoundPack-310"><span class="linenos">310</span></a>            <span class="n">title1</span> <span class="o">=</span> <span class="s1">&#39;Norm. Factors : &#39;</span>
</span><span id="SoundPack-311"><a href="#SoundPack-311"><span class="linenos">311</span></a>            <span class="n">title2</span> <span class="o">=</span> <span class="s1">&#39;x, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">norm_factor</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="k">for</span> <span class="n">norm_factor</span> <span class="ow">in</span> <span class="n">norm_factors</span><span class="p">)</span>
</span><span id="SoundPack-312"><a href="#SoundPack-312"><span class="linenos">312</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title0</span> <span class="o">+</span> <span class="n">title1</span> <span class="o">+</span> <span class="n">title2</span><span class="p">)</span>
</span><span id="SoundPack-313"><a href="#SoundPack-313"><span class="linenos">313</span></a>
</span><span id="SoundPack-314"><a href="#SoundPack-314"><span class="linenos">314</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack-315"><a href="#SoundPack-315"><span class="linenos">315</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;invalid frequency bin&#39;</span><span class="p">)</span>
</span><span id="SoundPack-316"><a href="#SoundPack-316"><span class="linenos">316</span></a>
</span><span id="SoundPack-317"><a href="#SoundPack-317"><span class="linenos">317</span></a>    <span class="k">def</span> <span class="nf">fundamentals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SoundPack-318"><a href="#SoundPack-318"><span class="linenos">318</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack-319"><a href="#SoundPack-319"><span class="linenos">319</span></a><span class="sd">        __ Multiple Soundpack Method __</span>
</span><span id="SoundPack-320"><a href="#SoundPack-320"><span class="linenos">320</span></a><span class="sd">        Displays the fundamentals of every sound in the SoundPack</span>
</span><span id="SoundPack-321"><a href="#SoundPack-321"><span class="linenos">321</span></a>
</span><span id="SoundPack-322"><a href="#SoundPack-322"><span class="linenos">322</span></a><span class="sd">        :return: None</span>
</span><span id="SoundPack-323"><a href="#SoundPack-323"><span class="linenos">323</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack-324"><a href="#SoundPack-324"><span class="linenos">324</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">sound</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">])</span>
</span><span id="SoundPack-325"><a href="#SoundPack-325"><span class="linenos">325</span></a>        <span class="n">fundamentals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">sound</span><span class="o">.</span><span class="n">fundamental</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">])</span>
</span><span id="SoundPack-326"><a href="#SoundPack-326"><span class="linenos">326</span></a>        <span class="n">key</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">fundamentals</span><span class="p">)</span>
</span><span id="SoundPack-327"><a href="#SoundPack-327"><span class="linenos">327</span></a>        <span class="n">table_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">names</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">fundamentals</span><span class="p">[</span><span class="n">key</span><span class="p">]]</span>
</span><span id="SoundPack-328"><a href="#SoundPack-328"><span class="linenos">328</span></a>
</span><span id="SoundPack-329"><a href="#SoundPack-329"><span class="linenos">329</span></a>        <span class="n">table_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">table_data</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</span><span id="SoundPack-330"><a href="#SoundPack-330"><span class="linenos">330</span></a>
</span><span id="SoundPack-331"><a href="#SoundPack-331"><span class="linenos">331</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table_data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Fundamental (Hz)&#39;</span><span class="p">]))</span>
</span><span id="SoundPack-332"><a href="#SoundPack-332"><span class="linenos">332</span></a>
</span><span id="SoundPack-333"><a href="#SoundPack-333"><span class="linenos">333</span></a>    <span class="k">def</span> <span class="nf">integral_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f_bin</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">):</span>
</span><span id="SoundPack-334"><a href="#SoundPack-334"><span class="linenos">334</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack-335"><a href="#SoundPack-335"><span class="linenos">335</span></a><span class="sd">        Normalized cumulative bin power plot for the frequency bins.</span>
</span><span id="SoundPack-336"><a href="#SoundPack-336"><span class="linenos">336</span></a><span class="sd">        See `Plot.integral` for more information.</span>
</span><span id="SoundPack-337"><a href="#SoundPack-337"><span class="linenos">337</span></a>
</span><span id="SoundPack-338"><a href="#SoundPack-338"><span class="linenos">338</span></a><span class="sd">        __ Multiple SoundPack Method __</span>
</span><span id="SoundPack-339"><a href="#SoundPack-339"><span class="linenos">339</span></a><span class="sd">        Plots the cumulative integral plot of specified frequency bins</span>
</span><span id="SoundPack-340"><a href="#SoundPack-340"><span class="linenos">340</span></a><span class="sd">        see help(Plot.integral)</span>
</span><span id="SoundPack-341"><a href="#SoundPack-341"><span class="linenos">341</span></a>
</span><span id="SoundPack-342"><a href="#SoundPack-342"><span class="linenos">342</span></a><span class="sd">        :param f_bin: frequency bins to compare, Supported arguments are </span>
</span><span id="SoundPack-343"><a href="#SoundPack-343"><span class="linenos">343</span></a><span class="sd">        &#39;all&#39;, &#39;bass&#39;, &#39;mid&#39;, &#39;highmid&#39;, &#39;uppermid&#39;, &#39;presence&#39;, &#39;brillance&#39;</span>
</span><span id="SoundPack-344"><a href="#SoundPack-344"><span class="linenos">344</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack-345"><a href="#SoundPack-345"><span class="linenos">345</span></a>
</span><span id="SoundPack-346"><a href="#SoundPack-346"><span class="linenos">346</span></a>        <span class="k">if</span> <span class="n">f_bin</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
</span><span id="SoundPack-347"><a href="#SoundPack-347"><span class="linenos">347</span></a>            <span class="c1"># create a figure with 6 axes</span>
</span><span id="SoundPack-348"><a href="#SoundPack-348"><span class="linenos">348</span></a>            <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
</span><span id="SoundPack-349"><a href="#SoundPack-349"><span class="linenos">349</span></a>            <span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="SoundPack-350"><a href="#SoundPack-350"><span class="linenos">350</span></a>
</span><span id="SoundPack-351"><a href="#SoundPack-351"><span class="linenos">351</span></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bin_strings</span><span class="p">,</span> <span class="n">axs</span><span class="p">):</span>
</span><span id="SoundPack-352"><a href="#SoundPack-352"><span class="linenos">352</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</span><span id="SoundPack-353"><a href="#SoundPack-353"><span class="linenos">353</span></a>                <span class="n">norm_factors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">norm_factor</span> <span class="k">for</span> <span class="n">son</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">])</span>
</span><span id="SoundPack-354"><a href="#SoundPack-354"><span class="linenos">354</span></a>                <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="SoundPack-355"><a href="#SoundPack-355"><span class="linenos">355</span></a>                    <span class="n">sound</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">sound</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack-356"><a href="#SoundPack-356"><span class="linenos">356</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="SoundPack-357"><a href="#SoundPack-357"><span class="linenos">357</span></a>                <span class="n">sound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SoundPack-358"><a href="#SoundPack-358"><span class="linenos">358</span></a>                <span class="n">title0</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s1">&#39; : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sound</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
</span><span id="SoundPack-359"><a href="#SoundPack-359"><span class="linenos">359</span></a>                    <span class="nb">int</span><span class="p">(</span><span class="n">sound</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; Hz, &#39;</span>
</span><span id="SoundPack-360"><a href="#SoundPack-360"><span class="linenos">360</span></a>                <span class="n">title1</span> <span class="o">=</span> <span class="s1">&#39;Norm. Factors : &#39;</span>
</span><span id="SoundPack-361"><a href="#SoundPack-361"><span class="linenos">361</span></a>                <span class="n">title2</span> <span class="o">=</span> <span class="s1">&#39;x, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">norm_factor</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="k">for</span> <span class="n">norm_factor</span> <span class="ow">in</span> <span class="n">norm_factors</span><span class="p">)</span>
</span><span id="SoundPack-362"><a href="#SoundPack-362"><span class="linenos">362</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title0</span> <span class="o">+</span> <span class="n">title1</span> <span class="o">+</span> <span class="n">title2</span><span class="p">)</span>
</span><span id="SoundPack-363"><a href="#SoundPack-363"><span class="linenos">363</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title0</span> <span class="o">+</span> <span class="n">title1</span> <span class="o">+</span> <span class="n">title2</span><span class="p">)</span>
</span><span id="SoundPack-364"><a href="#SoundPack-364"><span class="linenos">364</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="SoundPack-365"><a href="#SoundPack-365"><span class="linenos">365</span></a>
</span><span id="SoundPack-366"><a href="#SoundPack-366"><span class="linenos">366</span></a>        <span class="k">elif</span> <span class="n">f_bin</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_strings</span><span class="p">:</span>
</span><span id="SoundPack-367"><a href="#SoundPack-367"><span class="linenos">367</span></a>            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="SoundPack-368"><a href="#SoundPack-368"><span class="linenos">368</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</span><span id="SoundPack-369"><a href="#SoundPack-369"><span class="linenos">369</span></a>            <span class="n">norm_factors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">norm_factor</span> <span class="k">for</span> <span class="n">son</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">])</span>
</span><span id="SoundPack-370"><a href="#SoundPack-370"><span class="linenos">370</span></a>            <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="SoundPack-371"><a href="#SoundPack-371"><span class="linenos">371</span></a>                <span class="n">sound</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">sound</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack-372"><a href="#SoundPack-372"><span class="linenos">372</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="SoundPack-373"><a href="#SoundPack-373"><span class="linenos">373</span></a>            <span class="n">sound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SoundPack-374"><a href="#SoundPack-374"><span class="linenos">374</span></a>            <span class="n">title0</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">f_bin</span> <span class="o">+</span> <span class="s1">&#39; : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sound</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
</span><span id="SoundPack-375"><a href="#SoundPack-375"><span class="linenos">375</span></a>                <span class="nb">int</span><span class="p">(</span><span class="n">sound</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; Hz, &#39;</span>
</span><span id="SoundPack-376"><a href="#SoundPack-376"><span class="linenos">376</span></a>            <span class="n">title1</span> <span class="o">=</span> <span class="s1">&#39;Norm. Factors : &#39;</span>
</span><span id="SoundPack-377"><a href="#SoundPack-377"><span class="linenos">377</span></a>            <span class="n">title2</span> <span class="o">=</span> <span class="s1">&#39;x, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">norm_factor</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="k">for</span> <span class="n">norm_factor</span> <span class="ow">in</span> <span class="n">norm_factors</span><span class="p">)</span>
</span><span id="SoundPack-378"><a href="#SoundPack-378"><span class="linenos">378</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title0</span> <span class="o">+</span> <span class="n">title1</span> <span class="o">+</span> <span class="n">title2</span><span class="p">)</span>
</span><span id="SoundPack-379"><a href="#SoundPack-379"><span class="linenos">379</span></a>
</span><span id="SoundPack-380"><a href="#SoundPack-380"><span class="linenos">380</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack-381"><a href="#SoundPack-381"><span class="linenos">381</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;invalid frequency bin&#39;</span><span class="p">)</span>
</span><span id="SoundPack-382"><a href="#SoundPack-382"><span class="linenos">382</span></a>            
</span><span id="SoundPack-383"><a href="#SoundPack-383"><span class="linenos">383</span></a>    <span class="k">def</span> <span class="nf">bin_power_table</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SoundPack-384"><a href="#SoundPack-384"><span class="linenos">384</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack-385"><a href="#SoundPack-385"><span class="linenos">385</span></a><span class="sd">        Displays a table with the signal power contained in every frequency bin</span>
</span><span id="SoundPack-386"><a href="#SoundPack-386"><span class="linenos">386</span></a><span class="sd">        </span>
</span><span id="SoundPack-387"><a href="#SoundPack-387"><span class="linenos">387</span></a><span class="sd">        The power is computed as the time integral of the signal, such as :</span>
</span><span id="SoundPack-388"><a href="#SoundPack-388"><span class="linenos">388</span></a>
</span><span id="SoundPack-389"><a href="#SoundPack-389"><span class="linenos">389</span></a><span class="sd">            $ P = \int_0^{t_{max}} sig(t) dt $</span>
</span><span id="SoundPack-390"><a href="#SoundPack-390"><span class="linenos">390</span></a>
</span><span id="SoundPack-391"><a href="#SoundPack-391"><span class="linenos">391</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack-392"><a href="#SoundPack-392"><span class="linenos">392</span></a>        <span class="c1"># Bin power distribution table</span>
</span><span id="SoundPack-393"><a href="#SoundPack-393"><span class="linenos">393</span></a>        <span class="n">bin_strings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_strings</span>
</span><span id="SoundPack-394"><a href="#SoundPack-394"><span class="linenos">394</span></a>        <span class="n">integrals</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SoundPack-395"><a href="#SoundPack-395"><span class="linenos">395</span></a>
</span><span id="SoundPack-396"><a href="#SoundPack-396"><span class="linenos">396</span></a>        <span class="c1"># for every sound in the SoundPack</span>
</span><span id="SoundPack-397"><a href="#SoundPack-397"><span class="linenos">397</span></a>        <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="SoundPack-398"><a href="#SoundPack-398"><span class="linenos">398</span></a>
</span><span id="SoundPack-399"><a href="#SoundPack-399"><span class="linenos">399</span></a>            <span class="n">integral</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SoundPack-400"><a href="#SoundPack-400"><span class="linenos">400</span></a>            <span class="c1"># for every frequency bin in the sound</span>
</span><span id="SoundPack-401"><a href="#SoundPack-401"><span class="linenos">401</span></a>            <span class="k">for</span> <span class="n">f_bin</span> <span class="ow">in</span> <span class="n">bin_strings</span><span class="p">:</span>
</span><span id="SoundPack-402"><a href="#SoundPack-402"><span class="linenos">402</span></a>                <span class="n">log_envelope</span><span class="p">,</span> <span class="n">log_time</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="SoundPack-403"><a href="#SoundPack-403"><span class="linenos">403</span></a>                <span class="n">integral</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">log_envelope</span><span class="p">,</span> <span class="n">log_time</span><span class="p">))</span>
</span><span id="SoundPack-404"><a href="#SoundPack-404"><span class="linenos">404</span></a>
</span><span id="SoundPack-405"><a href="#SoundPack-405"><span class="linenos">405</span></a>            <span class="c1"># a list of dict for every sound</span>
</span><span id="SoundPack-406"><a href="#SoundPack-406"><span class="linenos">406</span></a>            <span class="n">integrals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span>
</span><span id="SoundPack-407"><a href="#SoundPack-407"><span class="linenos">407</span></a>
</span><span id="SoundPack-408"><a href="#SoundPack-408"><span class="linenos">408</span></a>        <span class="c1"># make the table</span>
</span><span id="SoundPack-409"><a href="#SoundPack-409"><span class="linenos">409</span></a>        <span class="n">table_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="n">bin_strings</span><span class="p">),</span> <span class="o">*</span><span class="n">integrals</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</span><span id="SoundPack-410"><a href="#SoundPack-410"><span class="linenos">410</span></a>        <span class="n">sound_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">sound</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">]</span>
</span><span id="SoundPack-411"><a href="#SoundPack-411"><span class="linenos">411</span></a>
</span><span id="SoundPack-412"><a href="#SoundPack-412"><span class="linenos">412</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;___ Signal Power Frequency Bin Distribution ___ </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="SoundPack-413"><a href="#SoundPack-413"><span class="linenos">413</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table_data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bin&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">sound_names</span><span class="p">]))</span>
</span><span id="SoundPack-414"><a href="#SoundPack-414"><span class="linenos">414</span></a>
</span><span id="SoundPack-415"><a href="#SoundPack-415"><span class="linenos">415</span></a>    <span class="k">def</span> <span class="nf">bin_power_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SoundPack-416"><a href="#SoundPack-416"><span class="linenos">416</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack-417"><a href="#SoundPack-417"><span class="linenos">417</span></a><span class="sd">        Histogram of the frequency bin power for multiple sounds</span>
</span><span id="SoundPack-418"><a href="#SoundPack-418"><span class="linenos">418</span></a>
</span><span id="SoundPack-419"><a href="#SoundPack-419"><span class="linenos">419</span></a><span class="sd">        frequency bin power is computed as the integral of the bin envelope, </span>
</span><span id="SoundPack-420"><a href="#SoundPack-420"><span class="linenos">420</span></a><span class="sd">        such as </span>
</span><span id="SoundPack-421"><a href="#SoundPack-421"><span class="linenos">421</span></a>
</span><span id="SoundPack-422"><a href="#SoundPack-422"><span class="linenos">422</span></a><span class="sd">            $ P = \int_0^{t_{max}} env(t) dt $</span>
</span><span id="SoundPack-423"><a href="#SoundPack-423"><span class="linenos">423</span></a>
</span><span id="SoundPack-424"><a href="#SoundPack-424"><span class="linenos">424</span></a>
</span><span id="SoundPack-425"><a href="#SoundPack-425"><span class="linenos">425</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack-426"><a href="#SoundPack-426"><span class="linenos">426</span></a>        <span class="c1"># Compute the bin powers</span>
</span><span id="SoundPack-427"><a href="#SoundPack-427"><span class="linenos">427</span></a>        <span class="n">bin_strings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_strings</span>
</span><span id="SoundPack-428"><a href="#SoundPack-428"><span class="linenos">428</span></a>        <span class="n">integrals</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SoundPack-429"><a href="#SoundPack-429"><span class="linenos">429</span></a>
</span><span id="SoundPack-430"><a href="#SoundPack-430"><span class="linenos">430</span></a>        <span class="c1"># for every sound in the SoundPack</span>
</span><span id="SoundPack-431"><a href="#SoundPack-431"><span class="linenos">431</span></a>        <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="SoundPack-432"><a href="#SoundPack-432"><span class="linenos">432</span></a>
</span><span id="SoundPack-433"><a href="#SoundPack-433"><span class="linenos">433</span></a>            <span class="n">integral</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SoundPack-434"><a href="#SoundPack-434"><span class="linenos">434</span></a>            <span class="c1"># for every frequency bin in the sound</span>
</span><span id="SoundPack-435"><a href="#SoundPack-435"><span class="linenos">435</span></a>            <span class="k">for</span> <span class="n">f_bin</span> <span class="ow">in</span> <span class="n">bin_strings</span><span class="p">:</span>
</span><span id="SoundPack-436"><a href="#SoundPack-436"><span class="linenos">436</span></a>                <span class="n">log_envelope</span><span class="p">,</span> <span class="n">log_time</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="SoundPack-437"><a href="#SoundPack-437"><span class="linenos">437</span></a>                <span class="n">integral</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">log_envelope</span><span class="p">,</span> <span class="n">log_time</span><span class="p">))</span>
</span><span id="SoundPack-438"><a href="#SoundPack-438"><span class="linenos">438</span></a>
</span><span id="SoundPack-439"><a href="#SoundPack-439"><span class="linenos">439</span></a>            <span class="c1"># a list of dict for every sound</span>
</span><span id="SoundPack-440"><a href="#SoundPack-440"><span class="linenos">440</span></a>            <span class="n">integral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span>
</span><span id="SoundPack-441"><a href="#SoundPack-441"><span class="linenos">441</span></a>            <span class="n">integral</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span>
</span><span id="SoundPack-442"><a href="#SoundPack-442"><span class="linenos">442</span></a>            <span class="n">integrals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span>
</span><span id="SoundPack-443"><a href="#SoundPack-443"><span class="linenos">443</span></a>
</span><span id="SoundPack-444"><a href="#SoundPack-444"><span class="linenos">444</span></a>        <span class="c1"># create the bar plotting vectors</span>
</span><span id="SoundPack-445"><a href="#SoundPack-445"><span class="linenos">445</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="SoundPack-446"><a href="#SoundPack-446"><span class="linenos">446</span></a>
</span><span id="SoundPack-447"><a href="#SoundPack-447"><span class="linenos">447</span></a>        <span class="c1"># make the bar plot</span>
</span><span id="SoundPack-448"><a href="#SoundPack-448"><span class="linenos">448</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">)</span>
</span><span id="SoundPack-449"><a href="#SoundPack-449"><span class="linenos">449</span></a>        <span class="n">width</span> <span class="o">=</span> <span class="mf">0.8</span> <span class="o">/</span> <span class="n">n</span>
</span><span id="SoundPack-450"><a href="#SoundPack-450"><span class="linenos">450</span></a>        <span class="c1"># get nice colors</span>
</span><span id="SoundPack-451"><a href="#SoundPack-451"><span class="linenos">451</span></a>        <span class="n">cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;Set2&#39;</span><span class="p">)</span>
</span><span id="SoundPack-452"><a href="#SoundPack-452"><span class="linenos">452</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sound</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">):</span>
</span><span id="SoundPack-453"><a href="#SoundPack-453"><span class="linenos">453</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">width</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">bin_strings</span><span class="p">)</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">width</span><span class="p">)</span>
</span><span id="SoundPack-454"><a href="#SoundPack-454"><span class="linenos">454</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">integrals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="SoundPack-455"><a href="#SoundPack-455"><span class="linenos">455</span></a>            <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="SoundPack-456"><a href="#SoundPack-456"><span class="linenos">456</span></a>                <span class="n">color</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="SoundPack-457"><a href="#SoundPack-457"><span class="linenos">457</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack-458"><a href="#SoundPack-458"><span class="linenos">458</span></a>                <span class="n">color</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SoundPack-459"><a href="#SoundPack-459"><span class="linenos">459</span></a>
</span><span id="SoundPack-460"><a href="#SoundPack-460"><span class="linenos">460</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="SoundPack-461"><a href="#SoundPack-461"><span class="linenos">461</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">tick_label</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">bin_strings</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">sound</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="SoundPack-462"><a href="#SoundPack-462"><span class="linenos">462</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack-463"><a href="#SoundPack-463"><span class="linenos">463</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">sound</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="SoundPack-464"><a href="#SoundPack-464"><span class="linenos">464</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;frequency bin name&#39;</span><span class="p">)</span>
</span><span id="SoundPack-465"><a href="#SoundPack-465"><span class="linenos">465</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;normalized power&#39;</span><span class="p">)</span>
</span><span id="SoundPack-466"><a href="#SoundPack-466"><span class="linenos">466</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="SoundPack-467"><a href="#SoundPack-467"><span class="linenos">467</span></a>    
</span><span id="SoundPack-468"><a href="#SoundPack-468"><span class="linenos">468</span></a>    <span class="k">def</span> <span class="nf">listen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SoundPack-469"><a href="#SoundPack-469"><span class="linenos">469</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack-470"><a href="#SoundPack-470"><span class="linenos">470</span></a><span class="sd">        Listen to all the sounds in the SoundPack inside the Jupyter Notebook </span>
</span><span id="SoundPack-471"><a href="#SoundPack-471"><span class="linenos">471</span></a><span class="sd">        environment</span>
</span><span id="SoundPack-472"><a href="#SoundPack-472"><span class="linenos">472</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack-473"><a href="#SoundPack-473"><span class="linenos">473</span></a>        <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="SoundPack-474"><a href="#SoundPack-474"><span class="linenos">474</span></a>            <span class="n">sound</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">listen</span><span class="p">()</span>
</span><span id="SoundPack-475"><a href="#SoundPack-475"><span class="linenos">475</span></a><span class="w">        </span>
</span><span id="SoundPack-476"><a href="#SoundPack-476"><span class="linenos">476</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack-477"><a href="#SoundPack-477"><span class="linenos">477</span></a><span class="sd">    Methods for dual SoundPacks</span>
</span><span id="SoundPack-478"><a href="#SoundPack-478"><span class="linenos">478</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="SoundPack-479"><a href="#SoundPack-479"><span class="linenos">479</span></a>
</span><span id="SoundPack-480"><a href="#SoundPack-480"><span class="linenos">480</span></a>    <span class="k">def</span> <span class="nf">compare_peaks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SoundPack-481"><a href="#SoundPack-481"><span class="linenos">481</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack-482"><a href="#SoundPack-482"><span class="linenos">482</span></a><span class="sd">        Plot to compare the FFT peaks values of two sounds</span>
</span><span id="SoundPack-483"><a href="#SoundPack-483"><span class="linenos">483</span></a>
</span><span id="SoundPack-484"><a href="#SoundPack-484"><span class="linenos">484</span></a><span class="sd">        __ Dual SoundPack Method __</span>
</span><span id="SoundPack-485"><a href="#SoundPack-485"><span class="linenos">485</span></a><span class="sd">        Compares the peaks in the Fourier Transform of two Sounds,</span>
</span><span id="SoundPack-486"><a href="#SoundPack-486"><span class="linenos">486</span></a><span class="sd">        the peaks having the highest difference are highlighted. If no peaks</span>
</span><span id="SoundPack-487"><a href="#SoundPack-487"><span class="linenos">487</span></a><span class="sd">        are found to have a significant difference, only the two normalized </span>
</span><span id="SoundPack-488"><a href="#SoundPack-488"><span class="linenos">488</span></a><span class="sd">        Fourier transform are plotted in a mirror configuration to visualize</span>
</span><span id="SoundPack-489"><a href="#SoundPack-489"><span class="linenos">489</span></a><span class="sd">        them.</span>
</span><span id="SoundPack-490"><a href="#SoundPack-490"><span class="linenos">490</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack-491"><a href="#SoundPack-491"><span class="linenos">491</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;dual&#39;</span><span class="p">:</span>
</span><span id="SoundPack-492"><a href="#SoundPack-492"><span class="linenos">492</span></a>            <span class="n">son1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SoundPack-493"><a href="#SoundPack-493"><span class="linenos">493</span></a>            <span class="n">son2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SoundPack-494"><a href="#SoundPack-494"><span class="linenos">494</span></a>            <span class="n">index1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">son1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">fft_range</span><span class="o">.</span><span class="n">value</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SoundPack-495"><a href="#SoundPack-495"><span class="linenos">495</span></a>            <span class="n">index2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">son2</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">fft_range</span><span class="o">.</span><span class="n">value</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SoundPack-496"><a href="#SoundPack-496"><span class="linenos">496</span></a>
</span><span id="SoundPack-497"><a href="#SoundPack-497"><span class="linenos">497</span></a>            <span class="c1"># Get the peak data from the sounds</span>
</span><span id="SoundPack-498"><a href="#SoundPack-498"><span class="linenos">498</span></a>            <span class="n">peaks1</span> <span class="o">=</span> <span class="n">son1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">peaks</span><span class="p">()</span>
</span><span id="SoundPack-499"><a href="#SoundPack-499"><span class="linenos">499</span></a>            <span class="n">peaks2</span> <span class="o">=</span> <span class="n">son2</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">peaks</span><span class="p">()</span>
</span><span id="SoundPack-500"><a href="#SoundPack-500"><span class="linenos">500</span></a>            <span class="n">freq1</span> <span class="o">=</span> <span class="n">son1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[:</span><span class="n">index1</span><span class="p">]</span>
</span><span id="SoundPack-501"><a href="#SoundPack-501"><span class="linenos">501</span></a>            <span class="n">freq2</span> <span class="o">=</span> <span class="n">son2</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[:</span><span class="n">index2</span><span class="p">]</span>
</span><span id="SoundPack-502"><a href="#SoundPack-502"><span class="linenos">502</span></a>            <span class="n">fft1</span> <span class="o">=</span> <span class="n">son1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft</span><span class="p">()[:</span><span class="n">index1</span><span class="p">]</span>
</span><span id="SoundPack-503"><a href="#SoundPack-503"><span class="linenos">503</span></a>            <span class="n">fft2</span> <span class="o">=</span> <span class="n">son2</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft</span><span class="p">()[:</span><span class="n">index2</span><span class="p">]</span>
</span><span id="SoundPack-504"><a href="#SoundPack-504"><span class="linenos">504</span></a>
</span><span id="SoundPack-505"><a href="#SoundPack-505"><span class="linenos">505</span></a>            <span class="n">short_peaks_1</span> <span class="o">=</span> <span class="p">[</span><span class="n">peak</span> <span class="k">for</span> <span class="n">peak</span> <span class="ow">in</span> <span class="n">peaks1</span> <span class="k">if</span> <span class="n">peak</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">freq1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="SoundPack-506"><a href="#SoundPack-506"><span class="linenos">506</span></a>            <span class="n">short_peaks_2</span> <span class="o">=</span> <span class="p">[</span><span class="n">peak</span> <span class="k">for</span> <span class="n">peak</span> <span class="ow">in</span> <span class="n">peaks2</span> <span class="k">if</span> <span class="n">peak</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">freq1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="SoundPack-507"><a href="#SoundPack-507"><span class="linenos">507</span></a>            <span class="n">peak_distance1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">freq1</span><span class="p">[</span><span class="n">peaks1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">-</span> <span class="n">freq1</span><span class="p">[</span><span class="n">peaks1</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">short_peaks_1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)])</span> <span class="o">/</span> <span class="mi">4</span>
</span><span id="SoundPack-508"><a href="#SoundPack-508"><span class="linenos">508</span></a>            <span class="n">peak_distance2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">freq2</span><span class="p">[</span><span class="n">peaks2</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">-</span> <span class="n">freq2</span><span class="p">[</span><span class="n">peaks2</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">short_peaks_2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)])</span> <span class="o">/</span> <span class="mi">4</span>
</span><span id="SoundPack-509"><a href="#SoundPack-509"><span class="linenos">509</span></a>            <span class="n">peak_distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">peak_distance1</span><span class="p">,</span> <span class="n">peak_distance2</span><span class="p">]))</span>
</span><span id="SoundPack-510"><a href="#SoundPack-510"><span class="linenos">510</span></a>
</span><span id="SoundPack-511"><a href="#SoundPack-511"><span class="linenos">511</span></a>            <span class="c1"># Align  the two peak vectors</span>
</span><span id="SoundPack-512"><a href="#SoundPack-512"><span class="linenos">512</span></a>            <span class="n">new_peaks1</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SoundPack-513"><a href="#SoundPack-513"><span class="linenos">513</span></a>            <span class="n">new_peaks2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SoundPack-514"><a href="#SoundPack-514"><span class="linenos">514</span></a>            <span class="k">for</span> <span class="n">peak1</span> <span class="ow">in</span> <span class="n">short_peaks_1</span><span class="p">:</span>
</span><span id="SoundPack-515"><a href="#SoundPack-515"><span class="linenos">515</span></a>                <span class="k">for</span> <span class="n">peak2</span> <span class="ow">in</span> <span class="n">short_peaks_2</span><span class="p">:</span>
</span><span id="SoundPack-516"><a href="#SoundPack-516"><span class="linenos">516</span></a>                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">freq1</span><span class="p">[</span><span class="n">peak1</span><span class="p">]</span> <span class="o">-</span> <span class="n">freq2</span><span class="p">[</span><span class="n">peak2</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">peak_distance</span><span class="p">:</span>
</span><span id="SoundPack-517"><a href="#SoundPack-517"><span class="linenos">517</span></a>                        <span class="n">new_peaks1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">peak1</span><span class="p">)</span>
</span><span id="SoundPack-518"><a href="#SoundPack-518"><span class="linenos">518</span></a>                        <span class="n">new_peaks2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">peak2</span><span class="p">)</span>
</span><span id="SoundPack-519"><a href="#SoundPack-519"><span class="linenos">519</span></a>            <span class="n">new_peaks1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">new_peaks1</span><span class="p">))</span>
</span><span id="SoundPack-520"><a href="#SoundPack-520"><span class="linenos">520</span></a>            <span class="n">new_peaks2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">new_peaks2</span><span class="p">))</span>
</span><span id="SoundPack-521"><a href="#SoundPack-521"><span class="linenos">521</span></a>
</span><span id="SoundPack-522"><a href="#SoundPack-522"><span class="linenos">522</span></a>            <span class="n">different_peaks1</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SoundPack-523"><a href="#SoundPack-523"><span class="linenos">523</span></a>            <span class="n">different_peaks2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SoundPack-524"><a href="#SoundPack-524"><span class="linenos">524</span></a>            <span class="n">difference_threshold</span> <span class="o">=</span> <span class="mf">0.5</span>
</span><span id="SoundPack-525"><a href="#SoundPack-525"><span class="linenos">525</span></a>            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">different_peaks1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="SoundPack-526"><a href="#SoundPack-526"><span class="linenos">526</span></a>                <span class="k">for</span> <span class="n">peak1</span><span class="p">,</span> <span class="n">peak2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">new_peaks1</span><span class="p">,</span> <span class="n">new_peaks2</span><span class="p">):</span>
</span><span id="SoundPack-527"><a href="#SoundPack-527"><span class="linenos">527</span></a>                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fft1</span><span class="p">[</span><span class="n">peak1</span><span class="p">]</span> <span class="o">-</span> <span class="n">fft2</span><span class="p">[</span><span class="n">peak2</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">difference_threshold</span><span class="p">:</span>
</span><span id="SoundPack-528"><a href="#SoundPack-528"><span class="linenos">528</span></a>                        <span class="n">different_peaks1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">peak1</span><span class="p">)</span>
</span><span id="SoundPack-529"><a href="#SoundPack-529"><span class="linenos">529</span></a>                        <span class="n">different_peaks2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">peak2</span><span class="p">)</span>
</span><span id="SoundPack-530"><a href="#SoundPack-530"><span class="linenos">530</span></a>                <span class="n">difference_threshold</span> <span class="o">-=</span> <span class="mf">0.01</span>
</span><span id="SoundPack-531"><a href="#SoundPack-531"><span class="linenos">531</span></a>                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">difference_threshold</span><span class="p">,</span> <span class="mf">0.</span><span class="p">):</span>
</span><span id="SoundPack-532"><a href="#SoundPack-532"><span class="linenos">532</span></a>                    <span class="k">break</span>
</span><span id="SoundPack-533"><a href="#SoundPack-533"><span class="linenos">533</span></a>
</span><span id="SoundPack-534"><a href="#SoundPack-534"><span class="linenos">534</span></a>            <span class="c1"># Plot the output</span>
</span><span id="SoundPack-535"><a href="#SoundPack-535"><span class="linenos">535</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="SoundPack-536"><a href="#SoundPack-536"><span class="linenos">536</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;symlog&#39;</span><span class="p">,</span> <span class="n">linthresh</span><span class="o">=</span><span class="mf">10e-1</span><span class="p">)</span>
</span><span id="SoundPack-537"><a href="#SoundPack-537"><span class="linenos">537</span></a>
</span><span id="SoundPack-538"><a href="#SoundPack-538"><span class="linenos">538</span></a>            <span class="c1"># Sound 1</span>
</span><span id="SoundPack-539"><a href="#SoundPack-539"><span class="linenos">539</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq1</span><span class="p">,</span> <span class="n">fft1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#919191&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">son1</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack-540"><a href="#SoundPack-540"><span class="linenos">540</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">freq1</span><span class="p">[</span><span class="n">new_peaks1</span><span class="p">],</span> <span class="n">fft1</span><span class="p">[</span><span class="n">new_peaks1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;peaks&#39;</span><span class="p">)</span>
</span><span id="SoundPack-541"><a href="#SoundPack-541"><span class="linenos">541</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">different_peaks1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="SoundPack-542"><a href="#SoundPack-542"><span class="linenos">542</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">freq1</span><span class="p">[</span><span class="n">different_peaks1</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">fft1</span><span class="p">[</span><span class="n">different_peaks1</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;diff peaks&#39;</span><span class="p">)</span>
</span><span id="SoundPack-543"><a href="#SoundPack-543"><span class="linenos">543</span></a>                <span class="n">annotation_string</span> <span class="o">=</span> <span class="s1">&#39;Peaks with &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">difference_threshold</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; difference&#39;</span>
</span><span id="SoundPack-544"><a href="#SoundPack-544"><span class="linenos">544</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">annotation_string</span><span class="p">,</span> <span class="p">(</span><span class="n">freq1</span><span class="p">[</span><span class="n">different_peaks1</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">peak_distance</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">fft1</span><span class="p">[</span><span class="n">different_peaks1</span><span class="p">[</span><span class="mi">0</span><span class="p">]]))</span>
</span><span id="SoundPack-545"><a href="#SoundPack-545"><span class="linenos">545</span></a>
</span><span id="SoundPack-546"><a href="#SoundPack-546"><span class="linenos">546</span></a>            <span class="c1"># Sound2</span>
</span><span id="SoundPack-547"><a href="#SoundPack-547"><span class="linenos">547</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq2</span><span class="p">,</span> <span class="o">-</span><span class="n">fft2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#3d3d3d&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">son2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack-548"><a href="#SoundPack-548"><span class="linenos">548</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">freq2</span><span class="p">[</span><span class="n">new_peaks2</span><span class="p">],</span> <span class="o">-</span><span class="n">fft2</span><span class="p">[</span><span class="n">new_peaks2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
</span><span id="SoundPack-549"><a href="#SoundPack-549"><span class="linenos">549</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">different_peaks2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="SoundPack-550"><a href="#SoundPack-550"><span class="linenos">550</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">freq2</span><span class="p">[</span><span class="n">different_peaks2</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="o">-</span><span class="n">fft2</span><span class="p">[</span><span class="n">different_peaks2</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
</span><span id="SoundPack-551"><a href="#SoundPack-551"><span class="linenos">551</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Fourier Transform Peak Analysis for &#39;</span> <span class="o">+</span> <span class="n">son1</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; and &#39;</span> <span class="o">+</span> <span class="n">son2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack-552"><a href="#SoundPack-552"><span class="linenos">552</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="SoundPack-553"><a href="#SoundPack-553"><span class="linenos">553</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="SoundPack-554"><a href="#SoundPack-554"><span class="linenos">554</span></a>            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="SoundPack-555"><a href="#SoundPack-555"><span class="linenos">555</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
</span><span id="SoundPack-556"><a href="#SoundPack-556"><span class="linenos">556</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;mirror amplitude (0-1)&#39;</span><span class="p">)</span>
</span><span id="SoundPack-557"><a href="#SoundPack-557"><span class="linenos">557</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack-558"><a href="#SoundPack-558"><span class="linenos">558</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Unsupported for multiple sounds SoundPacks&#39;</span><span class="p">)</span>
</span><span id="SoundPack-559"><a href="#SoundPack-559"><span class="linenos">559</span></a>
</span><span id="SoundPack-560"><a href="#SoundPack-560"><span class="linenos">560</span></a>    <span class="k">def</span> <span class="nf">fft_mirror</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SoundPack-561"><a href="#SoundPack-561"><span class="linenos">561</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack-562"><a href="#SoundPack-562"><span class="linenos">562</span></a><span class="sd">        Plot the Fourier Transforms of two sounds on opposed axis to compare the spectral content</span>
</span><span id="SoundPack-563"><a href="#SoundPack-563"><span class="linenos">563</span></a>
</span><span id="SoundPack-564"><a href="#SoundPack-564"><span class="linenos">564</span></a><span class="sd">        __ Dual SoundPack Method __</span>
</span><span id="SoundPack-565"><a href="#SoundPack-565"><span class="linenos">565</span></a><span class="sd">        The fourier transforms are plotted normalized between 0 and 1. </span>
</span><span id="SoundPack-566"><a href="#SoundPack-566"><span class="linenos">566</span></a><span class="sd">        The y scale is symmetric logarithmic, so that a signal is plotted </span>
</span><span id="SoundPack-567"><a href="#SoundPack-567"><span class="linenos">567</span></a><span class="sd">        between 0 and -1, and the other is plotted between 0 and 1. </span>
</span><span id="SoundPack-568"><a href="#SoundPack-568"><span class="linenos">568</span></a><span class="sd">        :return: None</span>
</span><span id="SoundPack-569"><a href="#SoundPack-569"><span class="linenos">569</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack-570"><a href="#SoundPack-570"><span class="linenos">570</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;dual&#39;</span><span class="p">:</span>
</span><span id="SoundPack-571"><a href="#SoundPack-571"><span class="linenos">571</span></a>            <span class="n">son1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SoundPack-572"><a href="#SoundPack-572"><span class="linenos">572</span></a>            <span class="n">son2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SoundPack-573"><a href="#SoundPack-573"><span class="linenos">573</span></a>            <span class="n">fft_range_value</span> <span class="o">=</span> <span class="n">sound_parameters</span><span class="p">()</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">fft_range</span><span class="o">.</span><span class="n">value</span>
</span><span id="SoundPack-574"><a href="#SoundPack-574"><span class="linenos">574</span></a>            <span class="n">fft_freq_value</span> <span class="o">=</span> <span class="n">son1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span>
</span><span id="SoundPack-575"><a href="#SoundPack-575"><span class="linenos">575</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fft_freq_value</span> <span class="o">&gt;</span> <span class="n">fft_range_value</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SoundPack-576"><a href="#SoundPack-576"><span class="linenos">576</span></a>
</span><span id="SoundPack-577"><a href="#SoundPack-577"><span class="linenos">577</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="SoundPack-578"><a href="#SoundPack-578"><span class="linenos">578</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;symlog&#39;</span><span class="p">)</span>
</span><span id="SoundPack-579"><a href="#SoundPack-579"><span class="linenos">579</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="SoundPack-580"><a href="#SoundPack-580"><span class="linenos">580</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">son1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[:</span><span class="n">index</span><span class="p">],</span> <span class="n">son1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft</span><span class="p">()[:</span><span class="n">index</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">son1</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack-581"><a href="#SoundPack-581"><span class="linenos">581</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">son2</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[:</span><span class="n">index</span><span class="p">],</span> <span class="o">-</span><span class="n">son2</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft</span><span class="p">()[:</span><span class="n">index</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">son2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack-582"><a href="#SoundPack-582"><span class="linenos">582</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
</span><span id="SoundPack-583"><a href="#SoundPack-583"><span class="linenos">583</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;mirror amplitude (normalized)&#39;</span><span class="p">)</span>
</span><span id="SoundPack-584"><a href="#SoundPack-584"><span class="linenos">584</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Mirror Fourier Transform for &#39;</span> <span class="o">+</span> <span class="n">son1</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; and &#39;</span> <span class="o">+</span> <span class="n">son2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack-585"><a href="#SoundPack-585"><span class="linenos">585</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="SoundPack-586"><a href="#SoundPack-586"><span class="linenos">586</span></a>
</span><span id="SoundPack-587"><a href="#SoundPack-587"><span class="linenos">587</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack-588"><a href="#SoundPack-588"><span class="linenos">588</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Unsupported for multiple sounds SoundPacks&#39;</span><span class="p">)</span>
</span><span id="SoundPack-589"><a href="#SoundPack-589"><span class="linenos">589</span></a>
</span><span id="SoundPack-590"><a href="#SoundPack-590"><span class="linenos">590</span></a>    <span class="k">def</span> <span class="nf">fft_diff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="SoundPack-591"><a href="#SoundPack-591"><span class="linenos">591</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack-592"><a href="#SoundPack-592"><span class="linenos">592</span></a><span class="sd">        Plot the difference between the spectral distribution in the two sounds</span>
</span><span id="SoundPack-593"><a href="#SoundPack-593"><span class="linenos">593</span></a>
</span><span id="SoundPack-594"><a href="#SoundPack-594"><span class="linenos">594</span></a><span class="sd">        __ Dual SoundPack Method __</span>
</span><span id="SoundPack-595"><a href="#SoundPack-595"><span class="linenos">595</span></a><span class="sd">        Compare the Fourier Transform of two sounds by computing the differences of the octave bins heights.</span>
</span><span id="SoundPack-596"><a href="#SoundPack-596"><span class="linenos">596</span></a><span class="sd">        The two FTs are superimposed on the first plot to show differences</span>
</span><span id="SoundPack-597"><a href="#SoundPack-597"><span class="linenos">597</span></a><span class="sd">        The difference between the two FTs is plotted on the second plot</span>
</span><span id="SoundPack-598"><a href="#SoundPack-598"><span class="linenos">598</span></a>
</span><span id="SoundPack-599"><a href="#SoundPack-599"><span class="linenos">599</span></a><span class="sd">        :param fraction: octave fraction value used to compute the frequency bins A higher number will show</span>
</span><span id="SoundPack-600"><a href="#SoundPack-600"><span class="linenos">600</span></a><span class="sd">        a more precise comparison, but conclusions may be harder to draw.</span>
</span><span id="SoundPack-601"><a href="#SoundPack-601"><span class="linenos">601</span></a><span class="sd">        :param ticks:  If equal to &#39;bins&#39; the frequency bins intervals are used as X axis ticks</span>
</span><span id="SoundPack-602"><a href="#SoundPack-602"><span class="linenos">602</span></a><span class="sd">        :return: None</span>
</span><span id="SoundPack-603"><a href="#SoundPack-603"><span class="linenos">603</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack-604"><a href="#SoundPack-604"><span class="linenos">604</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;dual&#39;</span><span class="p">:</span>
</span><span id="SoundPack-605"><a href="#SoundPack-605"><span class="linenos">605</span></a>            <span class="c1"># Separate the sounds</span>
</span><span id="SoundPack-606"><a href="#SoundPack-606"><span class="linenos">606</span></a>            <span class="n">son1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SoundPack-607"><a href="#SoundPack-607"><span class="linenos">607</span></a>            <span class="n">son2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SoundPack-608"><a href="#SoundPack-608"><span class="linenos">608</span></a>
</span><span id="SoundPack-609"><a href="#SoundPack-609"><span class="linenos">609</span></a>            <span class="c1"># Compute plotting bins</span>
</span><span id="SoundPack-610"><a href="#SoundPack-610"><span class="linenos">610</span></a>            <span class="n">x_values</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">octave_values</span><span class="p">(</span><span class="n">fraction</span><span class="p">)</span>
</span><span id="SoundPack-611"><a href="#SoundPack-611"><span class="linenos">611</span></a>            <span class="n">hist_bins</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">octave_histogram</span><span class="p">(</span><span class="n">fraction</span><span class="p">)</span>
</span><span id="SoundPack-612"><a href="#SoundPack-612"><span class="linenos">612</span></a>            <span class="n">bar_widths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">hist_bins</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">hist_bins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">hist_bins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)])</span>
</span><span id="SoundPack-613"><a href="#SoundPack-613"><span class="linenos">613</span></a>
</span><span id="SoundPack-614"><a href="#SoundPack-614"><span class="linenos">614</span></a>            <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="SoundPack-615"><a href="#SoundPack-615"><span class="linenos">615</span></a>            <span class="n">plot1</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">son1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_bins</span><span class="p">(),</span> <span class="n">utils</span><span class="o">.</span><span class="n">octave_histogram</span><span class="p">(</span><span class="n">fraction</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
</span><span id="SoundPack-616"><a href="#SoundPack-616"><span class="linenos">616</span></a>                             <span class="n">label</span><span class="o">=</span><span class="n">son1</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack-617"><a href="#SoundPack-617"><span class="linenos">617</span></a>            <span class="n">plot2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">son2</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_bins</span><span class="p">(),</span> <span class="n">utils</span><span class="o">.</span><span class="n">octave_histogram</span><span class="p">(</span><span class="n">fraction</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
</span><span id="SoundPack-618"><a href="#SoundPack-618"><span class="linenos">618</span></a>                             <span class="n">label</span><span class="o">=</span><span class="n">son2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack-619"><a href="#SoundPack-619"><span class="linenos">619</span></a>            <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;FT Histogram for &#39;</span> <span class="o">+</span> <span class="n">son1</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; and &#39;</span> <span class="o">+</span> <span class="n">son2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack-620"><a href="#SoundPack-620"><span class="linenos">620</span></a>            <span class="n">ax1</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="SoundPack-621"><a href="#SoundPack-621"><span class="linenos">621</span></a>            <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
</span><span id="SoundPack-622"><a href="#SoundPack-622"><span class="linenos">622</span></a>            <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;amplitude&#39;</span><span class="p">)</span>
</span><span id="SoundPack-623"><a href="#SoundPack-623"><span class="linenos">623</span></a>            <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="SoundPack-624"><a href="#SoundPack-624"><span class="linenos">624</span></a>            <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="SoundPack-625"><a href="#SoundPack-625"><span class="linenos">625</span></a>
</span><span id="SoundPack-626"><a href="#SoundPack-626"><span class="linenos">626</span></a>            <span class="n">diff</span> <span class="o">=</span> <span class="n">plot1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">plot2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SoundPack-627"><a href="#SoundPack-627"><span class="linenos">627</span></a>            <span class="n">n_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">diff</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SoundPack-628"><a href="#SoundPack-628"><span class="linenos">628</span></a>            <span class="n">p_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">diff</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SoundPack-629"><a href="#SoundPack-629"><span class="linenos">629</span></a>
</span><span id="SoundPack-630"><a href="#SoundPack-630"><span class="linenos">630</span></a>            <span class="c1"># Negative difference corresponding to sound 2</span>
</span><span id="SoundPack-631"><a href="#SoundPack-631"><span class="linenos">631</span></a>            <span class="n">ax2</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x_values</span><span class="p">[</span><span class="n">n_index</span><span class="p">],</span> <span class="n">diff</span><span class="p">[</span><span class="n">n_index</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="n">bar_widths</span><span class="p">[</span><span class="n">n_index</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</span><span id="SoundPack-632"><a href="#SoundPack-632"><span class="linenos">632</span></a>            <span class="c1"># Positive difference corresponding to sound1</span>
</span><span id="SoundPack-633"><a href="#SoundPack-633"><span class="linenos">633</span></a>            <span class="n">ax2</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x_values</span><span class="p">[</span><span class="n">p_index</span><span class="p">],</span> <span class="n">diff</span><span class="p">[</span><span class="n">p_index</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="n">bar_widths</span><span class="p">[</span><span class="n">p_index</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</span><span id="SoundPack-634"><a href="#SoundPack-634"><span class="linenos">634</span></a>            <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Difference &#39;</span> <span class="o">+</span> <span class="n">son1</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="n">son2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack-635"><a href="#SoundPack-635"><span class="linenos">635</span></a>            <span class="n">ax2</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="SoundPack-636"><a href="#SoundPack-636"><span class="linenos">636</span></a>            <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
</span><span id="SoundPack-637"><a href="#SoundPack-637"><span class="linenos">637</span></a>            <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&lt;- sound 2 : sound 1 -&gt;&#39;</span><span class="p">)</span>
</span><span id="SoundPack-638"><a href="#SoundPack-638"><span class="linenos">638</span></a>            <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="SoundPack-639"><a href="#SoundPack-639"><span class="linenos">639</span></a>
</span><span id="SoundPack-640"><a href="#SoundPack-640"><span class="linenos">640</span></a>            <span class="k">if</span> <span class="n">ticks</span> <span class="o">==</span> <span class="s1">&#39;bins&#39;</span><span class="p">:</span>
</span><span id="SoundPack-641"><a href="#SoundPack-641"><span class="linenos">641</span></a>                <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">label</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="vm">__dict__</span> <span class="k">if</span> <span class="n">label</span> <span class="o">!=</span> <span class="s1">&#39;name&#39;</span><span class="p">]</span>
</span><span id="SoundPack-642"><a href="#SoundPack-642"><span class="linenos">642</span></a>                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;brillance&#39;</span><span class="p">)</span>
</span><span id="SoundPack-643"><a href="#SoundPack-643"><span class="linenos">643</span></a>                <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">param</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">param</span> <span class="o">!=</span> <span class="s1">&#39;bins&#39;</span><span class="p">]</span>
</span><span id="SoundPack-644"><a href="#SoundPack-644"><span class="linenos">644</span></a>                <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">11250</span><span class="p">)</span>
</span><span id="SoundPack-645"><a href="#SoundPack-645"><span class="linenos">645</span></a>                <span class="n">x_formatter</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FixedFormatter</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</span><span id="SoundPack-646"><a href="#SoundPack-646"><span class="linenos">646</span></a>                <span class="n">x_locator</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="SoundPack-647"><a href="#SoundPack-647"><span class="linenos">647</span></a>                <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">x_locator</span><span class="p">)</span>
</span><span id="SoundPack-648"><a href="#SoundPack-648"><span class="linenos">648</span></a>                <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">x_formatter</span><span class="p">)</span>
</span><span id="SoundPack-649"><a href="#SoundPack-649"><span class="linenos">649</span></a>                <span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelrotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
</span><span id="SoundPack-650"><a href="#SoundPack-650"><span class="linenos">650</span></a>                <span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">x_locator</span><span class="p">)</span>
</span><span id="SoundPack-651"><a href="#SoundPack-651"><span class="linenos">651</span></a>                <span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">x_formatter</span><span class="p">)</span>
</span><span id="SoundPack-652"><a href="#SoundPack-652"><span class="linenos">652</span></a>                <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelrotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
</span><span id="SoundPack-653"><a href="#SoundPack-653"><span class="linenos">653</span></a>
</span><span id="SoundPack-654"><a href="#SoundPack-654"><span class="linenos">654</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack-655"><a href="#SoundPack-655"><span class="linenos">655</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Unsupported for multiple sounds SoundPacks&#39;</span><span class="p">)</span>
</span><span id="SoundPack-656"><a href="#SoundPack-656"><span class="linenos">656</span></a>
</span><span id="SoundPack-657"><a href="#SoundPack-657"><span class="linenos">657</span></a>    <span class="k">def</span> <span class="nf">integral_compare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f_bin</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">):</span>
</span><span id="SoundPack-658"><a href="#SoundPack-658"><span class="linenos">658</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack-659"><a href="#SoundPack-659"><span class="linenos">659</span></a><span class="sd">          Cumulative bin envelope integral comparison for two signals</span>
</span><span id="SoundPack-660"><a href="#SoundPack-660"><span class="linenos">660</span></a>
</span><span id="SoundPack-661"><a href="#SoundPack-661"><span class="linenos">661</span></a><span class="sd">          __ Dual SoundPack Method __</span>
</span><span id="SoundPack-662"><a href="#SoundPack-662"><span class="linenos">662</span></a><span class="sd">          Plots the cumulative integral plot of specified frequency bins</span>
</span><span id="SoundPack-663"><a href="#SoundPack-663"><span class="linenos">663</span></a><span class="sd">          and their difference as surfaces</span>
</span><span id="SoundPack-664"><a href="#SoundPack-664"><span class="linenos">664</span></a>
</span><span id="SoundPack-665"><a href="#SoundPack-665"><span class="linenos">665</span></a><span class="sd">          f_bin: frequency bins to compare, Supported arguments are :</span>
</span><span id="SoundPack-666"><a href="#SoundPack-666"><span class="linenos">666</span></a><span class="sd">          &#39;all&#39;, &#39;bass&#39;, &#39;mid&#39;, &#39;highmid&#39;, &#39;uppermid&#39;, &#39;presence&#39;, &#39;brillance&#39;</span>
</span><span id="SoundPack-667"><a href="#SoundPack-667"><span class="linenos">667</span></a><span class="sd">          &quot;&quot;&quot;</span>
</span><span id="SoundPack-668"><a href="#SoundPack-668"><span class="linenos">668</span></a>
</span><span id="SoundPack-669"><a href="#SoundPack-669"><span class="linenos">669</span></a>        <span class="c1"># Case when plotting all the frequency bins</span>
</span><span id="SoundPack-670"><a href="#SoundPack-670"><span class="linenos">670</span></a>        <span class="k">if</span> <span class="n">f_bin</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
</span><span id="SoundPack-671"><a href="#SoundPack-671"><span class="linenos">671</span></a>            <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
</span><span id="SoundPack-672"><a href="#SoundPack-672"><span class="linenos">672</span></a>            <span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="SoundPack-673"><a href="#SoundPack-673"><span class="linenos">673</span></a>
</span><span id="SoundPack-674"><a href="#SoundPack-674"><span class="linenos">674</span></a>            <span class="c1"># get the bins frequency values</span>
</span><span id="SoundPack-675"><a href="#SoundPack-675"><span class="linenos">675</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">bin_strings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="SoundPack-676"><a href="#SoundPack-676"><span class="linenos">676</span></a>            <span class="n">bins1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="SoundPack-677"><a href="#SoundPack-677"><span class="linenos">677</span></a>            <span class="n">bins2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="SoundPack-678"><a href="#SoundPack-678"><span class="linenos">678</span></a>
</span><span id="SoundPack-679"><a href="#SoundPack-679"><span class="linenos">679</span></a>            <span class="k">for</span> <span class="n">signal1</span><span class="p">,</span> <span class="n">signal2</span><span class="p">,</span> <span class="n">bin_string</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bins1</span><span class="p">,</span> <span class="n">bins2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_strings</span><span class="p">,</span> <span class="n">axs</span><span class="p">):</span>
</span><span id="SoundPack-680"><a href="#SoundPack-680"><span class="linenos">680</span></a>                <span class="c1"># Compute the log time and envelopes integrals</span>
</span><span id="SoundPack-681"><a href="#SoundPack-681"><span class="linenos">681</span></a>                <span class="n">log_envelope1</span><span class="p">,</span> <span class="n">log_time1</span> <span class="o">=</span> <span class="n">signal1</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="SoundPack-682"><a href="#SoundPack-682"><span class="linenos">682</span></a>                <span class="n">log_envelope2</span><span class="p">,</span> <span class="n">log_time2</span> <span class="o">=</span> <span class="n">signal2</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="SoundPack-683"><a href="#SoundPack-683"><span class="linenos">683</span></a>                <span class="n">env_range1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">log_envelope1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="SoundPack-684"><a href="#SoundPack-684"><span class="linenos">684</span></a>                <span class="n">env_range2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">log_envelope2</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="SoundPack-685"><a href="#SoundPack-685"><span class="linenos">685</span></a>                <span class="n">integral1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">log_envelope1</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">log_time1</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">env_range1</span><span class="p">])</span>
</span><span id="SoundPack-686"><a href="#SoundPack-686"><span class="linenos">686</span></a>                <span class="n">integral2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">log_envelope2</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">log_time2</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">env_range2</span><span class="p">])</span>
</span><span id="SoundPack-687"><a href="#SoundPack-687"><span class="linenos">687</span></a>                <span class="n">time1</span> <span class="o">=</span> <span class="n">log_time1</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">log_time1</span><span class="p">):</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SoundPack-688"><a href="#SoundPack-688"><span class="linenos">688</span></a>                <span class="n">time2</span> <span class="o">=</span> <span class="n">log_time2</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">log_time2</span><span class="p">):</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SoundPack-689"><a href="#SoundPack-689"><span class="linenos">689</span></a>
</span><span id="SoundPack-690"><a href="#SoundPack-690"><span class="linenos">690</span></a>                <span class="c1"># resize arrays to match shape</span>
</span><span id="SoundPack-691"><a href="#SoundPack-691"><span class="linenos">691</span></a>                <span class="n">common_len</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">time2</span><span class="p">))</span>
</span><span id="SoundPack-692"><a href="#SoundPack-692"><span class="linenos">692</span></a>                <span class="n">time1</span> <span class="o">=</span> <span class="n">time1</span><span class="p">[:</span><span class="n">common_len</span><span class="p">]</span>
</span><span id="SoundPack-693"><a href="#SoundPack-693"><span class="linenos">693</span></a>                <span class="n">time2</span> <span class="o">=</span> <span class="n">time2</span><span class="p">[:</span><span class="n">common_len</span><span class="p">]</span>
</span><span id="SoundPack-694"><a href="#SoundPack-694"><span class="linenos">694</span></a>                <span class="n">integral1</span> <span class="o">=</span> <span class="n">integral1</span><span class="p">[:</span><span class="n">common_len</span><span class="p">]</span>
</span><span id="SoundPack-695"><a href="#SoundPack-695"><span class="linenos">695</span></a>                <span class="n">integral2</span> <span class="o">=</span> <span class="n">integral2</span><span class="p">[:</span><span class="n">common_len</span><span class="p">]</span>
</span><span id="SoundPack-696"><a href="#SoundPack-696"><span class="linenos">696</span></a>                <span class="c1"># Normalize</span>
</span><span id="SoundPack-697"><a href="#SoundPack-697"><span class="linenos">697</span></a>                <span class="n">max_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">integral1</span><span class="p">,</span> <span class="n">integral2</span><span class="p">]))</span>
</span><span id="SoundPack-698"><a href="#SoundPack-698"><span class="linenos">698</span></a>                <span class="n">integral1</span> <span class="o">/=</span> <span class="n">max_value</span>
</span><span id="SoundPack-699"><a href="#SoundPack-699"><span class="linenos">699</span></a>                <span class="n">integral2</span> <span class="o">/=</span> <span class="n">max_value</span>
</span><span id="SoundPack-700"><a href="#SoundPack-700"><span class="linenos">700</span></a>
</span><span id="SoundPack-701"><a href="#SoundPack-701"><span class="linenos">701</span></a>                <span class="c1"># plot the integral area curves</span>
</span><span id="SoundPack-702"><a href="#SoundPack-702"><span class="linenos">702</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">time1</span><span class="p">,</span> <span class="n">integral1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</span><span id="SoundPack-703"><a href="#SoundPack-703"><span class="linenos">703</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">time2</span><span class="p">,</span> <span class="o">-</span><span class="n">integral2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</span><span id="SoundPack-704"><a href="#SoundPack-704"><span class="linenos">704</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">time2</span><span class="p">,</span> <span class="n">integral1</span> <span class="o">-</span> <span class="n">integral2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;int diff&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</span><span id="SoundPack-705"><a href="#SoundPack-705"><span class="linenos">705</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
</span><span id="SoundPack-706"><a href="#SoundPack-706"><span class="linenos">706</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;mirror cumulative power (normalized)&#39;</span><span class="p">)</span>
</span><span id="SoundPack-707"><a href="#SoundPack-707"><span class="linenos">707</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="SoundPack-708"><a href="#SoundPack-708"><span class="linenos">708</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">bin_string</span><span class="p">)</span>
</span><span id="SoundPack-709"><a href="#SoundPack-709"><span class="linenos">709</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="SoundPack-710"><a href="#SoundPack-710"><span class="linenos">710</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="SoundPack-711"><a href="#SoundPack-711"><span class="linenos">711</span></a>
</span><span id="SoundPack-712"><a href="#SoundPack-712"><span class="linenos">712</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="SoundPack-713"><a href="#SoundPack-713"><span class="linenos">713</span></a>
</span><span id="SoundPack-714"><a href="#SoundPack-714"><span class="linenos">714</span></a>        <span class="k">elif</span> <span class="n">f_bin</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_strings</span><span class="p">:</span>
</span><span id="SoundPack-715"><a href="#SoundPack-715"><span class="linenos">715</span></a>
</span><span id="SoundPack-716"><a href="#SoundPack-716"><span class="linenos">716</span></a>            <span class="c1"># Compute the log envelopes and areau curves</span>
</span><span id="SoundPack-717"><a href="#SoundPack-717"><span class="linenos">717</span></a>            <span class="n">signal1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span>
</span><span id="SoundPack-718"><a href="#SoundPack-718"><span class="linenos">718</span></a>            <span class="n">signal2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span>
</span><span id="SoundPack-719"><a href="#SoundPack-719"><span class="linenos">719</span></a>            <span class="n">log_envelope1</span><span class="p">,</span> <span class="n">log_time1</span> <span class="o">=</span> <span class="n">signal1</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="SoundPack-720"><a href="#SoundPack-720"><span class="linenos">720</span></a>            <span class="n">log_envelope2</span><span class="p">,</span> <span class="n">log_time2</span> <span class="o">=</span> <span class="n">signal2</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="SoundPack-721"><a href="#SoundPack-721"><span class="linenos">721</span></a>            <span class="n">integral1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">log_envelope1</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">log_time1</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">log_envelope1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)])</span>
</span><span id="SoundPack-722"><a href="#SoundPack-722"><span class="linenos">722</span></a>            <span class="n">integral2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">log_envelope2</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">log_time2</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">log_envelope2</span><span class="p">),</span> <span class="mi">1</span><span class="p">)])</span>
</span><span id="SoundPack-723"><a href="#SoundPack-723"><span class="linenos">723</span></a>            <span class="n">time1</span> <span class="o">=</span> <span class="n">log_time1</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">log_time1</span><span class="p">):</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SoundPack-724"><a href="#SoundPack-724"><span class="linenos">724</span></a>            <span class="n">time2</span> <span class="o">=</span> <span class="n">log_time2</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">log_time2</span><span class="p">):</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SoundPack-725"><a href="#SoundPack-725"><span class="linenos">725</span></a>
</span><span id="SoundPack-726"><a href="#SoundPack-726"><span class="linenos">726</span></a>            <span class="c1"># resize arrays to match shape</span>
</span><span id="SoundPack-727"><a href="#SoundPack-727"><span class="linenos">727</span></a>            <span class="n">common_len</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">time2</span><span class="p">))</span>
</span><span id="SoundPack-728"><a href="#SoundPack-728"><span class="linenos">728</span></a>            <span class="n">time1</span> <span class="o">=</span> <span class="n">time1</span><span class="p">[:</span><span class="n">common_len</span><span class="p">]</span>
</span><span id="SoundPack-729"><a href="#SoundPack-729"><span class="linenos">729</span></a>            <span class="n">time2</span> <span class="o">=</span> <span class="n">time2</span><span class="p">[:</span><span class="n">common_len</span><span class="p">]</span>
</span><span id="SoundPack-730"><a href="#SoundPack-730"><span class="linenos">730</span></a>            <span class="n">integral1</span> <span class="o">=</span> <span class="n">integral1</span><span class="p">[:</span><span class="n">common_len</span><span class="p">]</span>
</span><span id="SoundPack-731"><a href="#SoundPack-731"><span class="linenos">731</span></a>            <span class="n">integral2</span> <span class="o">=</span> <span class="n">integral2</span><span class="p">[:</span><span class="n">common_len</span><span class="p">]</span>
</span><span id="SoundPack-732"><a href="#SoundPack-732"><span class="linenos">732</span></a>            <span class="c1"># Normalize</span>
</span><span id="SoundPack-733"><a href="#SoundPack-733"><span class="linenos">733</span></a>            <span class="n">max_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">integral1</span><span class="p">,</span> <span class="n">integral2</span><span class="p">]))</span>
</span><span id="SoundPack-734"><a href="#SoundPack-734"><span class="linenos">734</span></a>            <span class="n">integral1</span> <span class="o">/=</span> <span class="n">max_value</span>
</span><span id="SoundPack-735"><a href="#SoundPack-735"><span class="linenos">735</span></a>            <span class="n">integral2</span> <span class="o">/=</span> <span class="n">max_value</span>
</span><span id="SoundPack-736"><a href="#SoundPack-736"><span class="linenos">736</span></a>
</span><span id="SoundPack-737"><a href="#SoundPack-737"><span class="linenos">737</span></a>            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="SoundPack-738"><a href="#SoundPack-738"><span class="linenos">738</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">time1</span><span class="p">,</span> <span class="n">integral1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</span><span id="SoundPack-739"><a href="#SoundPack-739"><span class="linenos">739</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">time2</span><span class="p">,</span> <span class="o">-</span><span class="n">integral2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</span><span id="SoundPack-740"><a href="#SoundPack-740"><span class="linenos">740</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">time2</span><span class="p">,</span> <span class="n">integral1</span> <span class="o">-</span> <span class="n">integral2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;int diff&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</span><span id="SoundPack-741"><a href="#SoundPack-741"><span class="linenos">741</span></a>
</span><span id="SoundPack-742"><a href="#SoundPack-742"><span class="linenos">742</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
</span><span id="SoundPack-743"><a href="#SoundPack-743"><span class="linenos">743</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;mirror cumulative power (normalized)&#39;</span><span class="p">)</span>
</span><span id="SoundPack-744"><a href="#SoundPack-744"><span class="linenos">744</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="SoundPack-745"><a href="#SoundPack-745"><span class="linenos">745</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">f_bin</span><span class="p">)</span>
</span><span id="SoundPack-746"><a href="#SoundPack-746"><span class="linenos">746</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
</span><span id="SoundPack-747"><a href="#SoundPack-747"><span class="linenos">747</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="SoundPack-748"><a href="#SoundPack-748"><span class="linenos">748</span></a>
</span><span id="SoundPack-749"><a href="#SoundPack-749"><span class="linenos">749</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack-750"><a href="#SoundPack-750"><span class="linenos">750</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;invalid frequency bin&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>A class to store and analyse multiple sounds
Some methods are only available for the case with two sounds</p>
</div>


                            <div id="SoundPack.__init__" class="classattr">
                                        <input id="SoundPack.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">SoundPack</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span><span class="n">sounds</span>,</span><span class="param">	<span class="n">names</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">fundamentals</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">SoundParams</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">equalize_time</span><span class="o">=</span><span class="kc">True</span></span>)</span>

                <label class="view-source-button" for="SoundPack.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SoundPack.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SoundPack.__init__-31"><a href="#SoundPack.__init__-31"><span class="linenos"> 31</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">sounds</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fundamentals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">SoundParams</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">equalize_time</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="SoundPack.__init__-32"><a href="#SoundPack.__init__-32"><span class="linenos"> 32</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack.__init__-33"><a href="#SoundPack.__init__-33"><span class="linenos"> 33</span></a><span class="sd">        The SoundPack can be instantiated from existing Sound class instances, either in a list or as</span>
</span><span id="SoundPack.__init__-34"><a href="#SoundPack.__init__-34"><span class="linenos"> 34</span></a><span class="sd">        multiple arguments</span>
</span><span id="SoundPack.__init__-35"><a href="#SoundPack.__init__-35"><span class="linenos"> 35</span></a>
</span><span id="SoundPack.__init__-36"><a href="#SoundPack.__init__-36"><span class="linenos"> 36</span></a><span class="sd">        The class can also handle the creation of Sound class instances if the arguments are filenames,</span>
</span><span id="SoundPack.__init__-37"><a href="#SoundPack.__init__-37"><span class="linenos"> 37</span></a><span class="sd">        either a list or multiple arguments.</span>
</span><span id="SoundPack.__init__-38"><a href="#SoundPack.__init__-38"><span class="linenos"> 38</span></a>
</span><span id="SoundPack.__init__-39"><a href="#SoundPack.__init__-39"><span class="linenos"> 39</span></a><span class="sd">        If the number of Sound contained is equal to two, the SoundPack will be &#39;dual&#39; and the associated methods</span>
</span><span id="SoundPack.__init__-40"><a href="#SoundPack.__init__-40"><span class="linenos"> 40</span></a><span class="sd">        will be available</span>
</span><span id="SoundPack.__init__-41"><a href="#SoundPack.__init__-41"><span class="linenos"> 41</span></a>
</span><span id="SoundPack.__init__-42"><a href="#SoundPack.__init__-42"><span class="linenos"> 42</span></a><span class="sd">        If it contains multiple sounds the SoundPack will be multiple and a reduced number of methods will work</span>
</span><span id="SoundPack.__init__-43"><a href="#SoundPack.__init__-43"><span class="linenos"> 43</span></a>
</span><span id="SoundPack.__init__-44"><a href="#SoundPack.__init__-44"><span class="linenos"> 44</span></a><span class="sd">        A list of names as strings and fundamental frequencies can be specified when creating the SoundPack</span>
</span><span id="SoundPack.__init__-45"><a href="#SoundPack.__init__-45"><span class="linenos"> 45</span></a>
</span><span id="SoundPack.__init__-46"><a href="#SoundPack.__init__-46"><span class="linenos"> 46</span></a><span class="sd">        If equalize_time is set to False, the contained sounds will not be trimmed to the same length.</span>
</span><span id="SoundPack.__init__-47"><a href="#SoundPack.__init__-47"><span class="linenos"> 47</span></a>
</span><span id="SoundPack.__init__-48"><a href="#SoundPack.__init__-48"><span class="linenos"> 48</span></a><span class="sd">        Examples :</span>
</span><span id="SoundPack.__init__-49"><a href="#SoundPack.__init__-49"><span class="linenos"> 49</span></a><span class="sd">        ```</span>
</span><span id="SoundPack.__init__-50"><a href="#SoundPack.__init__-50"><span class="linenos"> 50</span></a><span class="sd">        Sound_Test = SoundPack(&#39;sounds/test1.wav&#39;, &#39;sounds/test2.wav&#39;, names=[&#39;A&#39;, &#39;B&#39;], fundamentals = [134, 134])</span>
</span><span id="SoundPack.__init__-51"><a href="#SoundPack.__init__-51"><span class="linenos"> 51</span></a>
</span><span id="SoundPack.__init__-52"><a href="#SoundPack.__init__-52"><span class="linenos"> 52</span></a><span class="sd">        sounds = [sound1, sound2, sound3, sound4, sound5] # instances of the Sound class</span>
</span><span id="SoundPack.__init__-53"><a href="#SoundPack.__init__-53"><span class="linenos"> 53</span></a><span class="sd">        large_Test = SoundPack(sounds, names=[&#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;])</span>
</span><span id="SoundPack.__init__-54"><a href="#SoundPack.__init__-54"><span class="linenos"> 54</span></a><span class="sd">        ```</span>
</span><span id="SoundPack.__init__-55"><a href="#SoundPack.__init__-55"><span class="linenos"> 55</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack.__init__-56"><a href="#SoundPack.__init__-56"><span class="linenos"> 56</span></a>        <span class="c1"># create a copy of the sound parameters</span>
</span><span id="SoundPack.__init__-57"><a href="#SoundPack.__init__-57"><span class="linenos"> 57</span></a>        <span class="k">if</span> <span class="n">SoundParams</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SoundPack.__init__-58"><a href="#SoundPack.__init__-58"><span class="linenos"> 58</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">SP</span> <span class="o">=</span> <span class="n">sound_parameters</span><span class="p">()</span>
</span><span id="SoundPack.__init__-59"><a href="#SoundPack.__init__-59"><span class="linenos"> 59</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack.__init__-60"><a href="#SoundPack.__init__-60"><span class="linenos"> 60</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">SP</span> <span class="o">=</span> <span class="n">SoundParams</span>
</span><span id="SoundPack.__init__-61"><a href="#SoundPack.__init__-61"><span class="linenos"> 61</span></a>
</span><span id="SoundPack.__init__-62"><a href="#SoundPack.__init__-62"><span class="linenos"> 62</span></a>        <span class="c1"># Check if the sounds argument is a list</span>
</span><span id="SoundPack.__init__-63"><a href="#SoundPack.__init__-63"><span class="linenos"> 63</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="SoundPack.__init__-64"><a href="#SoundPack.__init__-64"><span class="linenos"> 64</span></a>            <span class="n">sounds</span> <span class="o">=</span> <span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># unpack the list</span>
</span><span id="SoundPack.__init__-65"><a href="#SoundPack.__init__-65"><span class="linenos"> 65</span></a>
</span><span id="SoundPack.__init__-66"><a href="#SoundPack.__init__-66"><span class="linenos"> 66</span></a>        <span class="c1"># Check for special case</span>
</span><span id="SoundPack.__init__-67"><a href="#SoundPack.__init__-67"><span class="linenos"> 67</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sounds</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="SoundPack.__init__-68"><a href="#SoundPack.__init__-68"><span class="linenos"> 68</span></a>            <span class="c1"># special case to compare two sounds</span>
</span><span id="SoundPack.__init__-69"><a href="#SoundPack.__init__-69"><span class="linenos"> 69</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;dual&#39;</span>
</span><span id="SoundPack.__init__-70"><a href="#SoundPack.__init__-70"><span class="linenos"> 70</span></a>
</span><span id="SoundPack.__init__-71"><a href="#SoundPack.__init__-71"><span class="linenos"> 71</span></a>        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sounds</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="SoundPack.__init__-72"><a href="#SoundPack.__init__-72"><span class="linenos"> 72</span></a>            <span class="c1"># general case for multiple sounds</span>
</span><span id="SoundPack.__init__-73"><a href="#SoundPack.__init__-73"><span class="linenos"> 73</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;multiple&#39;</span>
</span><span id="SoundPack.__init__-74"><a href="#SoundPack.__init__-74"><span class="linenos"> 74</span></a>
</span><span id="SoundPack.__init__-75"><a href="#SoundPack.__init__-75"><span class="linenos"> 75</span></a>        <span class="c1"># If filenames are supplied</span>
</span><span id="SoundPack.__init__-76"><a href="#SoundPack.__init__-76"><span class="linenos"> 76</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="SoundPack.__init__-77"><a href="#SoundPack.__init__-77"><span class="linenos"> 77</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sounds_from_files</span><span class="p">(</span><span class="n">sounds</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span> <span class="n">fundamentals</span><span class="o">=</span><span class="n">fundamentals</span><span class="p">)</span>
</span><span id="SoundPack.__init__-78"><a href="#SoundPack.__init__-78"><span class="linenos"> 78</span></a>
</span><span id="SoundPack.__init__-79"><a href="#SoundPack.__init__-79"><span class="linenos"> 79</span></a>        <span class="c1"># Else sound instances are supplied</span>
</span><span id="SoundPack.__init__-80"><a href="#SoundPack.__init__-80"><span class="linenos"> 80</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack.__init__-81"><a href="#SoundPack.__init__-81"><span class="linenos"> 81</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span> <span class="o">=</span> <span class="n">sounds</span>
</span><span id="SoundPack.__init__-82"><a href="#SoundPack.__init__-82"><span class="linenos"> 82</span></a>
</span><span id="SoundPack.__init__-83"><a href="#SoundPack.__init__-83"><span class="linenos"> 83</span></a>            <span class="c1"># sound name defined in constructor</span>
</span><span id="SoundPack.__init__-84"><a href="#SoundPack.__init__-84"><span class="linenos"> 84</span></a>            <span class="k">if</span> <span class="n">names</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">)):</span>
</span><span id="SoundPack.__init__-85"><a href="#SoundPack.__init__-85"><span class="linenos"> 85</span></a>                <span class="k">for</span> <span class="n">sound</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">,</span> <span class="n">names</span><span class="p">):</span>
</span><span id="SoundPack.__init__-86"><a href="#SoundPack.__init__-86"><span class="linenos"> 86</span></a>                    <span class="n">sound</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">n</span>
</span><span id="SoundPack.__init__-87"><a href="#SoundPack.__init__-87"><span class="linenos"> 87</span></a>
</span><span id="SoundPack.__init__-88"><a href="#SoundPack.__init__-88"><span class="linenos"> 88</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack.__init__-89"><a href="#SoundPack.__init__-89"><span class="linenos"> 89</span></a>                <span class="c1"># names obtained from the supplied sounds</span>
</span><span id="SoundPack.__init__-90"><a href="#SoundPack.__init__-90"><span class="linenos"> 90</span></a>                <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">sound</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span> <span class="k">if</span> <span class="n">sound</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span><span id="SoundPack.__init__-91"><a href="#SoundPack.__init__-91"><span class="linenos"> 91</span></a>
</span><span id="SoundPack.__init__-92"><a href="#SoundPack.__init__-92"><span class="linenos"> 92</span></a>                <span class="c1"># all sounds have a name</span>
</span><span id="SoundPack.__init__-93"><a href="#SoundPack.__init__-93"><span class="linenos"> 93</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">sounds</span><span class="p">):</span>
</span><span id="SoundPack.__init__-94"><a href="#SoundPack.__init__-94"><span class="linenos"> 94</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="n">names</span>
</span><span id="SoundPack.__init__-95"><a href="#SoundPack.__init__-95"><span class="linenos"> 95</span></a>
</span><span id="SoundPack.__init__-96"><a href="#SoundPack.__init__-96"><span class="linenos"> 96</span></a>                <span class="c1"># Assign a default value to names</span>
</span><span id="SoundPack.__init__-97"><a href="#SoundPack.__init__-97"><span class="linenos"> 97</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack.__init__-98"><a href="#SoundPack.__init__-98"><span class="linenos"> 98</span></a>                    <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sounds</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="SoundPack.__init__-99"><a href="#SoundPack.__init__-99"><span class="linenos"> 99</span></a>                    <span class="k">for</span> <span class="n">sound</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">,</span> <span class="n">names</span><span class="p">):</span>
</span><span id="SoundPack.__init__-100"><a href="#SoundPack.__init__-100"><span class="linenos">100</span></a>                        <span class="n">sound</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">n</span>
</span><span id="SoundPack.__init__-101"><a href="#SoundPack.__init__-101"><span class="linenos">101</span></a>
</span><span id="SoundPack.__init__-102"><a href="#SoundPack.__init__-102"><span class="linenos">102</span></a>            <span class="c1"># If the sounds are not conditionned condition them</span>
</span><span id="SoundPack.__init__-103"><a href="#SoundPack.__init__-103"><span class="linenos">103</span></a>            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="SoundPack.__init__-104"><a href="#SoundPack.__init__-104"><span class="linenos">104</span></a>                <span class="k">if</span> <span class="o">~</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s1">&#39;signal&#39;</span><span class="p">):</span>
</span><span id="SoundPack.__init__-105"><a href="#SoundPack.__init__-105"><span class="linenos">105</span></a>                    <span class="n">s</span><span class="o">.</span><span class="n">condition</span><span class="p">()</span>
</span><span id="SoundPack.__init__-106"><a href="#SoundPack.__init__-106"><span class="linenos">106</span></a>
</span><span id="SoundPack.__init__-107"><a href="#SoundPack.__init__-107"><span class="linenos">107</span></a>        <span class="k">if</span> <span class="n">equalize_time</span><span class="p">:</span>
</span><span id="SoundPack.__init__-108"><a href="#SoundPack.__init__-108"><span class="linenos">108</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">equalize_time</span><span class="p">()</span>
</span><span id="SoundPack.__init__-109"><a href="#SoundPack.__init__-109"><span class="linenos">109</span></a>
</span><span id="SoundPack.__init__-110"><a href="#SoundPack.__init__-110"><span class="linenos">110</span></a>        <span class="c1"># Define bin strings</span>
</span><span id="SoundPack.__init__-111"><a href="#SoundPack.__init__-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bin_strings</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">1</span><span class="p">:],</span> <span class="s1">&#39;brillance&#39;</span><span class="p">]</span>
</span><span id="SoundPack.__init__-112"><a href="#SoundPack.__init__-112"><span class="linenos">112</span></a>
</span><span id="SoundPack.__init__-113"><a href="#SoundPack.__init__-113"><span class="linenos">113</span></a>        <span class="c1"># Sort according to fundamental</span>
</span><span id="SoundPack.__init__-114"><a href="#SoundPack.__init__-114"><span class="linenos">114</span></a>        <span class="n">key</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">([</span><span class="n">sound</span><span class="o">.</span><span class="n">fundamental</span> <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">])</span>
</span><span id="SoundPack.__init__-115"><a href="#SoundPack.__init__-115"><span class="linenos">115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">)[</span><span class="n">key</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>The SoundPack can be instantiated from existing Sound class instances, either in a list or as
multiple arguments</p>

<p>The class can also handle the creation of Sound class instances if the arguments are filenames,
either a list or multiple arguments.</p>

<p>If the number of Sound contained is equal to two, the SoundPack will be 'dual' and the associated methods
will be available</p>

<p>If it contains multiple sounds the SoundPack will be multiple and a reduced number of methods will work</p>

<p>A list of names as strings and fundamental frequencies can be specified when creating the SoundPack</p>

<p>If equalize_time is set to False, the contained sounds will not be trimmed to the same length.</p>

<p>Examples :</p>

<pre><code>Sound_Test = SoundPack('sounds/test1.wav', 'sounds/test2.wav', names=['A', 'B'], fundamentals = [134, 134])

sounds = [sound1, sound2, sound3, sound4, sound5] # instances of the Sound class
large_Test = SoundPack(sounds, names=['1', '2', '3', '4', '5'])
</code></pre>
</div>


                            </div>
                            <div id="SoundPack.sounds_from_files" class="classattr">
                                        <input id="SoundPack.sounds_from_files-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sounds_from_files</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">sound_files</span>, </span><span class="param"><span class="n">names</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">fundamentals</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SoundPack.sounds_from_files-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SoundPack.sounds_from_files"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SoundPack.sounds_from_files-117"><a href="#SoundPack.sounds_from_files-117"><span class="linenos">117</span></a>    <span class="k">def</span> <span class="nf">sounds_from_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sound_files</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fundamentals</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="SoundPack.sounds_from_files-118"><a href="#SoundPack.sounds_from_files-118"><span class="linenos">118</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack.sounds_from_files-119"><a href="#SoundPack.sounds_from_files-119"><span class="linenos">119</span></a><span class="sd">        Create Sound class instances and assign them to the SoundPack </span>
</span><span id="SoundPack.sounds_from_files-120"><a href="#SoundPack.sounds_from_files-120"><span class="linenos">120</span></a><span class="sd">        from a list of files</span>
</span><span id="SoundPack.sounds_from_files-121"><a href="#SoundPack.sounds_from_files-121"><span class="linenos">121</span></a>
</span><span id="SoundPack.sounds_from_files-122"><a href="#SoundPack.sounds_from_files-122"><span class="linenos">122</span></a><span class="sd">        :param sound_files: sound filenames</span>
</span><span id="SoundPack.sounds_from_files-123"><a href="#SoundPack.sounds_from_files-123"><span class="linenos">123</span></a><span class="sd">        :param names: sound names</span>
</span><span id="SoundPack.sounds_from_files-124"><a href="#SoundPack.sounds_from_files-124"><span class="linenos">124</span></a><span class="sd">        :param fundamentals: user specified fundamental frequencies</span>
</span><span id="SoundPack.sounds_from_files-125"><a href="#SoundPack.sounds_from_files-125"><span class="linenos">125</span></a><span class="sd">        :return: None</span>
</span><span id="SoundPack.sounds_from_files-126"><a href="#SoundPack.sounds_from_files-126"><span class="linenos">126</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack.sounds_from_files-127"><a href="#SoundPack.sounds_from_files-127"><span class="linenos">127</span></a>        <span class="c1"># Make the default name list from sound filenames if none is supplied</span>
</span><span id="SoundPack.sounds_from_files-128"><a href="#SoundPack.sounds_from_files-128"><span class="linenos">128</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sound_files</span><span class="p">)):</span>
</span><span id="SoundPack.sounds_from_files-129"><a href="#SoundPack.sounds_from_files-129"><span class="linenos">129</span></a>            <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">file</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">sound_files</span><span class="p">]</span>  <span class="c1"># remove the .wav</span>
</span><span id="SoundPack.sounds_from_files-130"><a href="#SoundPack.sounds_from_files-130"><span class="linenos">130</span></a>
</span><span id="SoundPack.sounds_from_files-131"><a href="#SoundPack.sounds_from_files-131"><span class="linenos">131</span></a>        <span class="c1"># If the fundamentals are not supplied or mismatch in number None is used</span>
</span><span id="SoundPack.sounds_from_files-132"><a href="#SoundPack.sounds_from_files-132"><span class="linenos">132</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">fundamentals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fundamentals</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sound_files</span><span class="p">)):</span>
</span><span id="SoundPack.sounds_from_files-133"><a href="#SoundPack.sounds_from_files-133"><span class="linenos">133</span></a>            <span class="n">fundamentals</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sound_files</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</span><span id="SoundPack.sounds_from_files-134"><a href="#SoundPack.sounds_from_files-134"><span class="linenos">134</span></a>
</span><span id="SoundPack.sounds_from_files-135"><a href="#SoundPack.sounds_from_files-135"><span class="linenos">135</span></a>        <span class="c1"># Create Sound instances from files</span>
</span><span id="SoundPack.sounds_from_files-136"><a href="#SoundPack.sounds_from_files-136"><span class="linenos">136</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SoundPack.sounds_from_files-137"><a href="#SoundPack.sounds_from_files-137"><span class="linenos">137</span></a>        <span class="k">for</span> <span class="n">file</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fundamental</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sound_files</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">fundamentals</span><span class="p">):</span>
</span><span id="SoundPack.sounds_from_files-138"><a href="#SoundPack.sounds_from_files-138"><span class="linenos">138</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Sound</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">fundamental</span><span class="o">=</span><span class="n">fundamental</span><span class="p">,</span>
</span><span id="SoundPack.sounds_from_files-139"><a href="#SoundPack.sounds_from_files-139"><span class="linenos">139</span></a>                                     <span class="n">SoundParams</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Create Sound class instances and assign them to the SoundPack 
from a list of files</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>sound_files</strong>:  sound filenames</li>
<li><strong>names</strong>:  sound names</li>
<li><strong>fundamentals</strong>:  user specified fundamental frequencies</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="SoundPack.equalize_time" class="classattr">
                                        <input id="SoundPack.equalize_time-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">equalize_time</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SoundPack.equalize_time-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SoundPack.equalize_time"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SoundPack.equalize_time-141"><a href="#SoundPack.equalize_time-141"><span class="linenos">141</span></a>    <span class="k">def</span> <span class="nf">equalize_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SoundPack.equalize_time-142"><a href="#SoundPack.equalize_time-142"><span class="linenos">142</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack.equalize_time-143"><a href="#SoundPack.equalize_time-143"><span class="linenos">143</span></a><span class="sd">        Trim the sounds so that they all have the length of the shortest sound, </span>
</span><span id="SoundPack.equalize_time-144"><a href="#SoundPack.equalize_time-144"><span class="linenos">144</span></a><span class="sd">        trimming is done at the end of the sounds.</span>
</span><span id="SoundPack.equalize_time-145"><a href="#SoundPack.equalize_time-145"><span class="linenos">145</span></a><span class="sd">        :return: None</span>
</span><span id="SoundPack.equalize_time-146"><a href="#SoundPack.equalize_time-146"><span class="linenos">146</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack.equalize_time-147"><a href="#SoundPack.equalize_time-147"><span class="linenos">147</span></a>        <span class="n">trim_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">sound</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">signal</span><span class="p">)</span> <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">])</span>
</span><span id="SoundPack.equalize_time-148"><a href="#SoundPack.equalize_time-148"><span class="linenos">148</span></a>        <span class="n">trimmed_sounds</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SoundPack.equalize_time-149"><a href="#SoundPack.equalize_time-149"><span class="linenos">149</span></a>        <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="SoundPack.equalize_time-150"><a href="#SoundPack.equalize_time-150"><span class="linenos">150</span></a>            <span class="n">new_sound</span> <span class="o">=</span> <span class="n">sound</span>
</span><span id="SoundPack.equalize_time-151"><a href="#SoundPack.equalize_time-151"><span class="linenos">151</span></a>            <span class="n">new_sound</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="n">new_sound</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">trim_time</span><span class="p">(</span><span class="n">trim_index</span> <span class="o">/</span> <span class="n">sound</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">sr</span><span class="p">)</span>
</span><span id="SoundPack.equalize_time-152"><a href="#SoundPack.equalize_time-152"><span class="linenos">152</span></a>            <span class="n">new_sound</span><span class="o">.</span><span class="n">bin_divide</span><span class="p">()</span>
</span><span id="SoundPack.equalize_time-153"><a href="#SoundPack.equalize_time-153"><span class="linenos">153</span></a>            <span class="n">trimmed_sounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_sound</span><span class="p">)</span>
</span><span id="SoundPack.equalize_time-154"><a href="#SoundPack.equalize_time-154"><span class="linenos">154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span> <span class="o">=</span> <span class="n">trimmed_sounds</span>
</span></pre></div>


            <div class="docstring"><p>Trim the sounds so that they all have the length of the shortest sound, 
trimming is done at the end of the sounds.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="SoundPack.normalize" class="classattr">
                                        <input id="SoundPack.normalize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">normalize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SoundPack.normalize-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SoundPack.normalize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SoundPack.normalize-156"><a href="#SoundPack.normalize-156"><span class="linenos">156</span></a>    <span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SoundPack.normalize-157"><a href="#SoundPack.normalize-157"><span class="linenos">157</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack.normalize-158"><a href="#SoundPack.normalize-158"><span class="linenos">158</span></a><span class="sd">        Normalize all the signals in the SoundPack and returns a normalized</span>
</span><span id="SoundPack.normalize-159"><a href="#SoundPack.normalize-159"><span class="linenos">159</span></a><span class="sd">        instance of itself. See `Signal.normalize` for more information.</span>
</span><span id="SoundPack.normalize-160"><a href="#SoundPack.normalize-160"><span class="linenos">160</span></a><span class="sd">        :return: SoundPack with normalized signals</span>
</span><span id="SoundPack.normalize-161"><a href="#SoundPack.normalize-161"><span class="linenos">161</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack.normalize-162"><a href="#SoundPack.normalize-162"><span class="linenos">162</span></a>        <span class="n">new_sounds</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SoundPack.normalize-163"><a href="#SoundPack.normalize-163"><span class="linenos">163</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">sound</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">]</span>
</span><span id="SoundPack.normalize-164"><a href="#SoundPack.normalize-164"><span class="linenos">164</span></a>        <span class="n">fundamentals</span> <span class="o">=</span> <span class="p">[</span><span class="n">sound</span><span class="o">.</span><span class="n">fundamental</span> <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">]</span>
</span><span id="SoundPack.normalize-165"><a href="#SoundPack.normalize-165"><span class="linenos">165</span></a>        <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="SoundPack.normalize-166"><a href="#SoundPack.normalize-166"><span class="linenos">166</span></a>            <span class="n">sound</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
</span><span id="SoundPack.normalize-167"><a href="#SoundPack.normalize-167"><span class="linenos">167</span></a>            <span class="n">new_sounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sound</span><span class="p">)</span>
</span><span id="SoundPack.normalize-168"><a href="#SoundPack.normalize-168"><span class="linenos">168</span></a>
</span><span id="SoundPack.normalize-169"><a href="#SoundPack.normalize-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span> <span class="o">=</span> <span class="n">new_sounds</span>
</span><span id="SoundPack.normalize-170"><a href="#SoundPack.normalize-170"><span class="linenos">170</span></a>
</span><span id="SoundPack.normalize-171"><a href="#SoundPack.normalize-171"><span class="linenos">171</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Normalize all the signals in the SoundPack and returns a normalized
instance of itself. See <code><a href="#Signal.normalize">Signal.normalize</a></code> for more information.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>SoundPack with normalized signals</p>
</blockquote>
</div>


                            </div>
                            <div id="SoundPack.plot" class="classattr">
                                        <input id="SoundPack.plot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">kind</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SoundPack.plot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SoundPack.plot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SoundPack.plot-177"><a href="#SoundPack.plot-177"><span class="linenos">177</span></a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="SoundPack.plot-178"><a href="#SoundPack.plot-178"><span class="linenos">178</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack.plot-179"><a href="#SoundPack.plot-179"><span class="linenos">179</span></a><span class="sd">        Superimposed plot of all the sounds on one figure for a specific kind</span>
</span><span id="SoundPack.plot-180"><a href="#SoundPack.plot-180"><span class="linenos">180</span></a>
</span><span id="SoundPack.plot-181"><a href="#SoundPack.plot-181"><span class="linenos">181</span></a><span class="sd">        __ Multiple SoundPack Method __</span>
</span><span id="SoundPack.plot-182"><a href="#SoundPack.plot-182"><span class="linenos">182</span></a><span class="sd">        Plots a specific signal.plot for all sounds on the same figure</span>
</span><span id="SoundPack.plot-183"><a href="#SoundPack.plot-183"><span class="linenos">183</span></a>
</span><span id="SoundPack.plot-184"><a href="#SoundPack.plot-184"><span class="linenos">184</span></a><span class="sd">        Ex : SoundPack.plot(&#39;fft&#39;) plots the fft of all sounds on a single figure</span>
</span><span id="SoundPack.plot-185"><a href="#SoundPack.plot-185"><span class="linenos">185</span></a><span class="sd">        The color argument is set to none so that the plots have different colors</span>
</span><span id="SoundPack.plot-186"><a href="#SoundPack.plot-186"><span class="linenos">186</span></a><span class="sd">        :param kind: feature name passed to the `signal.plot()` method</span>
</span><span id="SoundPack.plot-187"><a href="#SoundPack.plot-187"><span class="linenos">187</span></a><span class="sd">        :param kwargs: keywords arguments to pass to the `matplotlib.plot()` </span>
</span><span id="SoundPack.plot-188"><a href="#SoundPack.plot-188"><span class="linenos">188</span></a><span class="sd">        method</span>
</span><span id="SoundPack.plot-189"><a href="#SoundPack.plot-189"><span class="linenos">189</span></a>
</span><span id="SoundPack.plot-190"><a href="#SoundPack.plot-190"><span class="linenos">190</span></a><span class="sd">        :return: None</span>
</span><span id="SoundPack.plot-191"><a href="#SoundPack.plot-191"><span class="linenos">191</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack.plot-192"><a href="#SoundPack.plot-192"><span class="linenos">192</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="SoundPack.plot-193"><a href="#SoundPack.plot-193"><span class="linenos">193</span></a>        <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="SoundPack.plot-194"><a href="#SoundPack.plot-194"><span class="linenos">194</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">name</span>
</span><span id="SoundPack.plot-195"><a href="#SoundPack.plot-195"><span class="linenos">195</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SoundPack.plot-196"><a href="#SoundPack.plot-196"><span class="linenos">196</span></a>            <span class="n">sound</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">method_dict</span><span class="p">[</span><span class="n">kind</span><span class="p">](</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="SoundPack.plot-197"><a href="#SoundPack.plot-197"><span class="linenos">197</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="SoundPack.plot-198"><a href="#SoundPack.plot-198"><span class="linenos">198</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">kind</span> <span class="o">+</span> <span class="s1">&#39; plot&#39;</span><span class="p">)</span>
</span><span id="SoundPack.plot-199"><a href="#SoundPack.plot-199"><span class="linenos">199</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="SoundPack.plot-200"><a href="#SoundPack.plot-200"><span class="linenos">200</span></a>        <span class="k">return</span> <span class="n">ax</span>
</span></pre></div>


            <div class="docstring"><p>Superimposed plot of all the sounds on one figure for a specific kind</p>

<p>__ Multiple SoundPack Method __
Plots a specific signal.plot for all sounds on the same figure</p>

<p>Ex : <a href="#SoundPack.plot">SoundPack.plot</a>('fft') plots the fft of all sounds on a single figure
The color argument is set to none so that the plots have different colors</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>kind</strong>:  feature name passed to the <code>signal.plot()</code> method</li>
<li><strong>kwargs</strong>:  keywords arguments to pass to the <code>matplotlib.plot()</code> 
method</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="SoundPack.compare_plot" class="classattr">
                                        <input id="SoundPack.compare_plot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">compare_plot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">kind</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SoundPack.compare_plot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SoundPack.compare_plot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SoundPack.compare_plot-202"><a href="#SoundPack.compare_plot-202"><span class="linenos">202</span></a>    <span class="k">def</span> <span class="nf">compare_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="SoundPack.compare_plot-203"><a href="#SoundPack.compare_plot-203"><span class="linenos">203</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack.compare_plot-204"><a href="#SoundPack.compare_plot-204"><span class="linenos">204</span></a><span class="sd">        Plots all the sounds on different figures to compare them for a specific kind</span>
</span><span id="SoundPack.compare_plot-205"><a href="#SoundPack.compare_plot-205"><span class="linenos">205</span></a>
</span><span id="SoundPack.compare_plot-206"><a href="#SoundPack.compare_plot-206"><span class="linenos">206</span></a><span class="sd">        __ Multiple SoundPack Method __</span>
</span><span id="SoundPack.compare_plot-207"><a href="#SoundPack.compare_plot-207"><span class="linenos">207</span></a><span class="sd">        Draws the same kind of plot on a different axis for each sound</span>
</span><span id="SoundPack.compare_plot-208"><a href="#SoundPack.compare_plot-208"><span class="linenos">208</span></a><span class="sd">        Example : `SoundPack.compare_plot(&#39;peaks&#39;)` with 4 Sounds will plot a </span>
</span><span id="SoundPack.compare_plot-209"><a href="#SoundPack.compare_plot-209"><span class="linenos">209</span></a><span class="sd">        figure with 4 axes, with each a different &#39;peak&#39; plot.</span>
</span><span id="SoundPack.compare_plot-210"><a href="#SoundPack.compare_plot-210"><span class="linenos">210</span></a>
</span><span id="SoundPack.compare_plot-211"><a href="#SoundPack.compare_plot-211"><span class="linenos">211</span></a><span class="sd">        :param kind: kind argument passed to `Signal.plot()`</span>
</span><span id="SoundPack.compare_plot-212"><a href="#SoundPack.compare_plot-212"><span class="linenos">212</span></a><span class="sd">        :param kwargs: key word arguments passed to `matplotlib.plot()`</span>
</span><span id="SoundPack.compare_plot-213"><a href="#SoundPack.compare_plot-213"><span class="linenos">213</span></a>
</span><span id="SoundPack.compare_plot-214"><a href="#SoundPack.compare_plot-214"><span class="linenos">214</span></a><span class="sd">        :return: None</span>
</span><span id="SoundPack.compare_plot-215"><a href="#SoundPack.compare_plot-215"><span class="linenos">215</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack.compare_plot-216"><a href="#SoundPack.compare_plot-216"><span class="linenos">216</span></a>        <span class="c1"># if a dual SoundPack : only plot two big plots</span>
</span><span id="SoundPack.compare_plot-217"><a href="#SoundPack.compare_plot-217"><span class="linenos">217</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;dual&#39;</span><span class="p">:</span>
</span><span id="SoundPack.compare_plot-218"><a href="#SoundPack.compare_plot-218"><span class="linenos">218</span></a>            <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="SoundPack.compare_plot-219"><a href="#SoundPack.compare_plot-219"><span class="linenos">219</span></a>            <span class="k">for</span> <span class="n">sound</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">,</span> <span class="n">axs</span><span class="p">):</span>
</span><span id="SoundPack.compare_plot-220"><a href="#SoundPack.compare_plot-220"><span class="linenos">220</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</span><span id="SoundPack.compare_plot-221"><a href="#SoundPack.compare_plot-221"><span class="linenos">221</span></a>                <span class="n">sound</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">method_dict</span><span class="p">[</span><span class="n">kind</span><span class="p">](</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="SoundPack.compare_plot-222"><a href="#SoundPack.compare_plot-222"><span class="linenos">222</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">kind</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">sound</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack.compare_plot-223"><a href="#SoundPack.compare_plot-223"><span class="linenos">223</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="SoundPack.compare_plot-224"><a href="#SoundPack.compare_plot-224"><span class="linenos">224</span></a>
</span><span id="SoundPack.compare_plot-225"><a href="#SoundPack.compare_plot-225"><span class="linenos">225</span></a>        <span class="c1"># If a multiple SoundPack : plot on a grid of axes</span>
</span><span id="SoundPack.compare_plot-226"><a href="#SoundPack.compare_plot-226"><span class="linenos">226</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;multiple&#39;</span><span class="p">:</span>
</span><span id="SoundPack.compare_plot-227"><a href="#SoundPack.compare_plot-227"><span class="linenos">227</span></a>            <span class="c1"># find the n, m values for the subplots line and columns</span>
</span><span id="SoundPack.compare_plot-228"><a href="#SoundPack.compare_plot-228"><span class="linenos">228</span></a>            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">)</span>
</span><span id="SoundPack.compare_plot-229"><a href="#SoundPack.compare_plot-229"><span class="linenos">229</span></a>            <span class="n">cols</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="SoundPack.compare_plot-230"><a href="#SoundPack.compare_plot-230"><span class="linenos">230</span></a>            <span class="k">if</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">4</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
</span><span id="SoundPack.compare_plot-231"><a href="#SoundPack.compare_plot-231"><span class="linenos">231</span></a>                <span class="c1"># a lot of sounds</span>
</span><span id="SoundPack.compare_plot-232"><a href="#SoundPack.compare_plot-232"><span class="linenos">232</span></a>                <span class="n">cols</span> <span class="o">=</span> <span class="mi">4</span>
</span><span id="SoundPack.compare_plot-233"><a href="#SoundPack.compare_plot-233"><span class="linenos">233</span></a>            <span class="k">elif</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">3</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
</span><span id="SoundPack.compare_plot-234"><a href="#SoundPack.compare_plot-234"><span class="linenos">234</span></a>                <span class="c1"># many sounds</span>
</span><span id="SoundPack.compare_plot-235"><a href="#SoundPack.compare_plot-235"><span class="linenos">235</span></a>                <span class="n">cols</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="SoundPack.compare_plot-236"><a href="#SoundPack.compare_plot-236"><span class="linenos">236</span></a>            <span class="k">elif</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="SoundPack.compare_plot-237"><a href="#SoundPack.compare_plot-237"><span class="linenos">237</span></a>                <span class="c1"># a few sounds</span>
</span><span id="SoundPack.compare_plot-238"><a href="#SoundPack.compare_plot-238"><span class="linenos">238</span></a>                <span class="n">cols</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="SoundPack.compare_plot-239"><a href="#SoundPack.compare_plot-239"><span class="linenos">239</span></a>
</span><span id="SoundPack.compare_plot-240"><a href="#SoundPack.compare_plot-240"><span class="linenos">240</span></a>            <span class="n">remainder</span> <span class="o">=</span> <span class="n">n</span> <span class="o">%</span> <span class="n">cols</span>
</span><span id="SoundPack.compare_plot-241"><a href="#SoundPack.compare_plot-241"><span class="linenos">241</span></a>            <span class="k">if</span> <span class="n">remainder</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="SoundPack.compare_plot-242"><a href="#SoundPack.compare_plot-242"><span class="linenos">242</span></a>                <span class="n">rows</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="n">cols</span>
</span><span id="SoundPack.compare_plot-243"><a href="#SoundPack.compare_plot-243"><span class="linenos">243</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack.compare_plot-244"><a href="#SoundPack.compare_plot-244"><span class="linenos">244</span></a>                <span class="n">rows</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="n">cols</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="SoundPack.compare_plot-245"><a href="#SoundPack.compare_plot-245"><span class="linenos">245</span></a>
</span><span id="SoundPack.compare_plot-246"><a href="#SoundPack.compare_plot-246"><span class="linenos">246</span></a>            <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">rows</span><span class="p">))</span>
</span><span id="SoundPack.compare_plot-247"><a href="#SoundPack.compare_plot-247"><span class="linenos">247</span></a>            <span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="SoundPack.compare_plot-248"><a href="#SoundPack.compare_plot-248"><span class="linenos">248</span></a>            <span class="k">for</span> <span class="n">sound</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">,</span> <span class="n">axs</span><span class="p">):</span>
</span><span id="SoundPack.compare_plot-249"><a href="#SoundPack.compare_plot-249"><span class="linenos">249</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</span><span id="SoundPack.compare_plot-250"><a href="#SoundPack.compare_plot-250"><span class="linenos">250</span></a>                <span class="n">sound</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">method_dict</span><span class="p">[</span><span class="n">kind</span><span class="p">](</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="SoundPack.compare_plot-251"><a href="#SoundPack.compare_plot-251"><span class="linenos">251</span></a>                <span class="n">title</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_title</span><span class="p">()</span>
</span><span id="SoundPack.compare_plot-252"><a href="#SoundPack.compare_plot-252"><span class="linenos">252</span></a>                <span class="n">title</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">title</span>
</span><span id="SoundPack.compare_plot-253"><a href="#SoundPack.compare_plot-253"><span class="linenos">253</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
</span><span id="SoundPack.compare_plot-254"><a href="#SoundPack.compare_plot-254"><span class="linenos">254</span></a>
</span><span id="SoundPack.compare_plot-255"><a href="#SoundPack.compare_plot-255"><span class="linenos">255</span></a>            <span class="k">if</span> <span class="n">remainder</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="SoundPack.compare_plot-256"><a href="#SoundPack.compare_plot-256"><span class="linenos">256</span></a>                <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">cols</span> <span class="o">-</span> <span class="n">remainder</span><span class="p">):]:</span>
</span><span id="SoundPack.compare_plot-257"><a href="#SoundPack.compare_plot-257"><span class="linenos">257</span></a>                    <span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
</span><span id="SoundPack.compare_plot-258"><a href="#SoundPack.compare_plot-258"><span class="linenos">258</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="SoundPack.compare_plot-259"><a href="#SoundPack.compare_plot-259"><span class="linenos">259</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack.compare_plot-260"><a href="#SoundPack.compare_plot-260"><span class="linenos">260</span></a>            <span class="k">raise</span> <span class="ne">Exception</span>
</span><span id="SoundPack.compare_plot-261"><a href="#SoundPack.compare_plot-261"><span class="linenos">261</span></a>        <span class="k">return</span> <span class="n">axs</span>
</span></pre></div>


            <div class="docstring"><p>Plots all the sounds on different figures to compare them for a specific kind</p>

<p>__ Multiple SoundPack Method __
Draws the same kind of plot on a different axis for each sound
Example : <code><a href="#SoundPack.compare_plot">SoundPack.compare_plot</a>('peaks')</code> with 4 Sounds will plot a 
figure with 4 axes, with each a different 'peak' plot.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>kind</strong>:  kind argument passed to <code>Signal.plot()</code></li>
<li><strong>kwargs</strong>:  key word arguments passed to <code>matplotlib.plot()</code></li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="SoundPack.freq_bin_plot" class="classattr">
                                        <input id="SoundPack.freq_bin_plot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">freq_bin_plot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">f_bin</span><span class="o">=</span><span class="s1">&#39;all&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SoundPack.freq_bin_plot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SoundPack.freq_bin_plot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SoundPack.freq_bin_plot-263"><a href="#SoundPack.freq_bin_plot-263"><span class="linenos">263</span></a>    <span class="k">def</span> <span class="nf">freq_bin_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f_bin</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">):</span>
</span><span id="SoundPack.freq_bin_plot-264"><a href="#SoundPack.freq_bin_plot-264"><span class="linenos">264</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack.freq_bin_plot-265"><a href="#SoundPack.freq_bin_plot-265"><span class="linenos">265</span></a><span class="sd">        Plots the log envelope of specified frequency bins</span>
</span><span id="SoundPack.freq_bin_plot-266"><a href="#SoundPack.freq_bin_plot-266"><span class="linenos">266</span></a>
</span><span id="SoundPack.freq_bin_plot-267"><a href="#SoundPack.freq_bin_plot-267"><span class="linenos">267</span></a><span class="sd">        __ Multiple SoundPack Method __</span>
</span><span id="SoundPack.freq_bin_plot-268"><a href="#SoundPack.freq_bin_plot-268"><span class="linenos">268</span></a><span class="sd">        A function to compare signals decomposed frequency wise in the time </span>
</span><span id="SoundPack.freq_bin_plot-269"><a href="#SoundPack.freq_bin_plot-269"><span class="linenos">269</span></a><span class="sd">        domain on a logarithm scale. The methods plot all the sounds and plots </span>
</span><span id="SoundPack.freq_bin_plot-270"><a href="#SoundPack.freq_bin_plot-270"><span class="linenos">270</span></a><span class="sd">        their frequency bins according to the frequency bin argument f_bin.</span>
</span><span id="SoundPack.freq_bin_plot-271"><a href="#SoundPack.freq_bin_plot-271"><span class="linenos">271</span></a>
</span><span id="SoundPack.freq_bin_plot-272"><a href="#SoundPack.freq_bin_plot-272"><span class="linenos">272</span></a><span class="sd">        Example : SoundPack.freq_bin_plot(f_bin=&#39;mid&#39;) will plot the log-scale </span>
</span><span id="SoundPack.freq_bin_plot-273"><a href="#SoundPack.freq_bin_plot-273"><span class="linenos">273</span></a><span class="sd">        envelope of the &#39;mid&#39; signal of every sound in the SoundPack.</span>
</span><span id="SoundPack.freq_bin_plot-274"><a href="#SoundPack.freq_bin_plot-274"><span class="linenos">274</span></a>
</span><span id="SoundPack.freq_bin_plot-275"><a href="#SoundPack.freq_bin_plot-275"><span class="linenos">275</span></a><span class="sd">        f_bin: frequency bins to compare, Supported arguments are :</span>
</span><span id="SoundPack.freq_bin_plot-276"><a href="#SoundPack.freq_bin_plot-276"><span class="linenos">276</span></a><span class="sd">        &#39;all&#39;, &#39;bass&#39;, &#39;mid&#39;, &#39;highmid&#39;, &#39;uppermid&#39;, &#39;presence&#39;, &#39;brillance&#39;</span>
</span><span id="SoundPack.freq_bin_plot-277"><a href="#SoundPack.freq_bin_plot-277"><span class="linenos">277</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack.freq_bin_plot-278"><a href="#SoundPack.freq_bin_plot-278"><span class="linenos">278</span></a>
</span><span id="SoundPack.freq_bin_plot-279"><a href="#SoundPack.freq_bin_plot-279"><span class="linenos">279</span></a>        <span class="k">if</span> <span class="n">f_bin</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
</span><span id="SoundPack.freq_bin_plot-280"><a href="#SoundPack.freq_bin_plot-280"><span class="linenos">280</span></a>            <span class="c1"># Create one plot per bin</span>
</span><span id="SoundPack.freq_bin_plot-281"><a href="#SoundPack.freq_bin_plot-281"><span class="linenos">281</span></a>            <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
</span><span id="SoundPack.freq_bin_plot-282"><a href="#SoundPack.freq_bin_plot-282"><span class="linenos">282</span></a>            <span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="SoundPack.freq_bin_plot-283"><a href="#SoundPack.freq_bin_plot-283"><span class="linenos">283</span></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">1</span><span class="p">:],</span> <span class="s1">&#39;brillance&#39;</span><span class="p">],</span> <span class="n">axs</span><span class="p">):</span>
</span><span id="SoundPack.freq_bin_plot-284"><a href="#SoundPack.freq_bin_plot-284"><span class="linenos">284</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</span><span id="SoundPack.freq_bin_plot-285"><a href="#SoundPack.freq_bin_plot-285"><span class="linenos">285</span></a>                <span class="c1"># plot every sound for a frequency bin</span>
</span><span id="SoundPack.freq_bin_plot-286"><a href="#SoundPack.freq_bin_plot-286"><span class="linenos">286</span></a>                <span class="n">norm_factors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">norm_factor</span> <span class="k">for</span> <span class="n">son</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">])</span>
</span><span id="SoundPack.freq_bin_plot-287"><a href="#SoundPack.freq_bin_plot-287"><span class="linenos">287</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">son</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">):</span>
</span><span id="SoundPack.freq_bin_plot-288"><a href="#SoundPack.freq_bin_plot-288"><span class="linenos">288</span></a>                    <span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">old_plot</span><span class="p">(</span><span class="s1">&#39;log envelope&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">son</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack.freq_bin_plot-289"><a href="#SoundPack.freq_bin_plot-289"><span class="linenos">289</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="SoundPack.freq_bin_plot-290"><a href="#SoundPack.freq_bin_plot-290"><span class="linenos">290</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="SoundPack.freq_bin_plot-291"><a href="#SoundPack.freq_bin_plot-291"><span class="linenos">291</span></a>                <span class="n">son</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SoundPack.freq_bin_plot-292"><a href="#SoundPack.freq_bin_plot-292"><span class="linenos">292</span></a>                <span class="n">title0</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s1">&#39; : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
</span><span id="SoundPack.freq_bin_plot-293"><a href="#SoundPack.freq_bin_plot-293"><span class="linenos">293</span></a>                         <span class="nb">int</span><span class="p">(</span><span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; Hz, &#39;</span>
</span><span id="SoundPack.freq_bin_plot-294"><a href="#SoundPack.freq_bin_plot-294"><span class="linenos">294</span></a>                <span class="n">title1</span> <span class="o">=</span> <span class="s1">&#39;Norm. Factors : &#39;</span>
</span><span id="SoundPack.freq_bin_plot-295"><a href="#SoundPack.freq_bin_plot-295"><span class="linenos">295</span></a>                <span class="n">title2</span> <span class="o">=</span> <span class="s1">&#39;x, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">norm_factor</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="k">for</span> <span class="n">norm_factor</span> <span class="ow">in</span> <span class="n">norm_factors</span><span class="p">)</span>
</span><span id="SoundPack.freq_bin_plot-296"><a href="#SoundPack.freq_bin_plot-296"><span class="linenos">296</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title0</span> <span class="o">+</span> <span class="n">title1</span> <span class="o">+</span> <span class="n">title2</span><span class="p">)</span>
</span><span id="SoundPack.freq_bin_plot-297"><a href="#SoundPack.freq_bin_plot-297"><span class="linenos">297</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="SoundPack.freq_bin_plot-298"><a href="#SoundPack.freq_bin_plot-298"><span class="linenos">298</span></a>
</span><span id="SoundPack.freq_bin_plot-299"><a href="#SoundPack.freq_bin_plot-299"><span class="linenos">299</span></a>        <span class="k">elif</span> <span class="n">f_bin</span> <span class="ow">in</span> <span class="p">[</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="n">sound_parameters</span><span class="p">()</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">1</span><span class="p">:],</span> <span class="s1">&#39;brillance&#39;</span><span class="p">]:</span>
</span><span id="SoundPack.freq_bin_plot-300"><a href="#SoundPack.freq_bin_plot-300"><span class="linenos">300</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="SoundPack.freq_bin_plot-301"><a href="#SoundPack.freq_bin_plot-301"><span class="linenos">301</span></a>            <span class="c1"># Plot every envelope for a single frequency bin</span>
</span><span id="SoundPack.freq_bin_plot-302"><a href="#SoundPack.freq_bin_plot-302"><span class="linenos">302</span></a>            <span class="n">norm_factors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">norm_factor</span> <span class="k">for</span> <span class="n">son</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">])</span>
</span><span id="SoundPack.freq_bin_plot-303"><a href="#SoundPack.freq_bin_plot-303"><span class="linenos">303</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">son</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">):</span>
</span><span id="SoundPack.freq_bin_plot-304"><a href="#SoundPack.freq_bin_plot-304"><span class="linenos">304</span></a>                <span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">old_plot</span><span class="p">(</span><span class="s1">&#39;log envelope&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;. &#39;</span> <span class="o">+</span> <span class="n">son</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
</span><span id="SoundPack.freq_bin_plot-305"><a href="#SoundPack.freq_bin_plot-305"><span class="linenos">305</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="SoundPack.freq_bin_plot-306"><a href="#SoundPack.freq_bin_plot-306"><span class="linenos">306</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="SoundPack.freq_bin_plot-307"><a href="#SoundPack.freq_bin_plot-307"><span class="linenos">307</span></a>            <span class="n">son</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SoundPack.freq_bin_plot-308"><a href="#SoundPack.freq_bin_plot-308"><span class="linenos">308</span></a>            <span class="n">title0</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">f_bin</span> <span class="o">+</span> <span class="s1">&#39; : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
</span><span id="SoundPack.freq_bin_plot-309"><a href="#SoundPack.freq_bin_plot-309"><span class="linenos">309</span></a>                <span class="nb">int</span><span class="p">(</span><span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; Hz, &#39;</span>
</span><span id="SoundPack.freq_bin_plot-310"><a href="#SoundPack.freq_bin_plot-310"><span class="linenos">310</span></a>            <span class="n">title1</span> <span class="o">=</span> <span class="s1">&#39;Norm. Factors : &#39;</span>
</span><span id="SoundPack.freq_bin_plot-311"><a href="#SoundPack.freq_bin_plot-311"><span class="linenos">311</span></a>            <span class="n">title2</span> <span class="o">=</span> <span class="s1">&#39;x, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">norm_factor</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="k">for</span> <span class="n">norm_factor</span> <span class="ow">in</span> <span class="n">norm_factors</span><span class="p">)</span>
</span><span id="SoundPack.freq_bin_plot-312"><a href="#SoundPack.freq_bin_plot-312"><span class="linenos">312</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title0</span> <span class="o">+</span> <span class="n">title1</span> <span class="o">+</span> <span class="n">title2</span><span class="p">)</span>
</span><span id="SoundPack.freq_bin_plot-313"><a href="#SoundPack.freq_bin_plot-313"><span class="linenos">313</span></a>
</span><span id="SoundPack.freq_bin_plot-314"><a href="#SoundPack.freq_bin_plot-314"><span class="linenos">314</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack.freq_bin_plot-315"><a href="#SoundPack.freq_bin_plot-315"><span class="linenos">315</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;invalid frequency bin&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plots the log envelope of specified frequency bins</p>

<p>__ Multiple SoundPack Method __
A function to compare signals decomposed frequency wise in the time 
domain on a logarithm scale. The methods plot all the sounds and plots 
their frequency bins according to the frequency bin argument f_bin.</p>

<p>Example : <a href="#SoundPack.freq_bin_plot">SoundPack.freq_bin_plot</a>(f_bin='mid') will plot the log-scale 
envelope of the 'mid' signal of every sound in the SoundPack.</p>

<p>f_bin: frequency bins to compare, Supported arguments are :
'all', 'bass', 'mid', 'highmid', 'uppermid', 'presence', 'brillance'</p>
</div>


                            </div>
                            <div id="SoundPack.fundamentals" class="classattr">
                                        <input id="SoundPack.fundamentals-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fundamentals</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SoundPack.fundamentals-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SoundPack.fundamentals"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SoundPack.fundamentals-317"><a href="#SoundPack.fundamentals-317"><span class="linenos">317</span></a>    <span class="k">def</span> <span class="nf">fundamentals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SoundPack.fundamentals-318"><a href="#SoundPack.fundamentals-318"><span class="linenos">318</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack.fundamentals-319"><a href="#SoundPack.fundamentals-319"><span class="linenos">319</span></a><span class="sd">        __ Multiple Soundpack Method __</span>
</span><span id="SoundPack.fundamentals-320"><a href="#SoundPack.fundamentals-320"><span class="linenos">320</span></a><span class="sd">        Displays the fundamentals of every sound in the SoundPack</span>
</span><span id="SoundPack.fundamentals-321"><a href="#SoundPack.fundamentals-321"><span class="linenos">321</span></a>
</span><span id="SoundPack.fundamentals-322"><a href="#SoundPack.fundamentals-322"><span class="linenos">322</span></a><span class="sd">        :return: None</span>
</span><span id="SoundPack.fundamentals-323"><a href="#SoundPack.fundamentals-323"><span class="linenos">323</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack.fundamentals-324"><a href="#SoundPack.fundamentals-324"><span class="linenos">324</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">sound</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">])</span>
</span><span id="SoundPack.fundamentals-325"><a href="#SoundPack.fundamentals-325"><span class="linenos">325</span></a>        <span class="n">fundamentals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">sound</span><span class="o">.</span><span class="n">fundamental</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">])</span>
</span><span id="SoundPack.fundamentals-326"><a href="#SoundPack.fundamentals-326"><span class="linenos">326</span></a>        <span class="n">key</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">fundamentals</span><span class="p">)</span>
</span><span id="SoundPack.fundamentals-327"><a href="#SoundPack.fundamentals-327"><span class="linenos">327</span></a>        <span class="n">table_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">names</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">fundamentals</span><span class="p">[</span><span class="n">key</span><span class="p">]]</span>
</span><span id="SoundPack.fundamentals-328"><a href="#SoundPack.fundamentals-328"><span class="linenos">328</span></a>
</span><span id="SoundPack.fundamentals-329"><a href="#SoundPack.fundamentals-329"><span class="linenos">329</span></a>        <span class="n">table_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">table_data</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</span><span id="SoundPack.fundamentals-330"><a href="#SoundPack.fundamentals-330"><span class="linenos">330</span></a>
</span><span id="SoundPack.fundamentals-331"><a href="#SoundPack.fundamentals-331"><span class="linenos">331</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table_data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Fundamental (Hz)&#39;</span><span class="p">]))</span>
</span></pre></div>


            <div class="docstring"><p>__ Multiple Soundpack Method __
Displays the fundamentals of every sound in the SoundPack</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="SoundPack.integral_plot" class="classattr">
                                        <input id="SoundPack.integral_plot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">integral_plot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">f_bin</span><span class="o">=</span><span class="s1">&#39;all&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SoundPack.integral_plot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SoundPack.integral_plot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SoundPack.integral_plot-333"><a href="#SoundPack.integral_plot-333"><span class="linenos">333</span></a>    <span class="k">def</span> <span class="nf">integral_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f_bin</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">):</span>
</span><span id="SoundPack.integral_plot-334"><a href="#SoundPack.integral_plot-334"><span class="linenos">334</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack.integral_plot-335"><a href="#SoundPack.integral_plot-335"><span class="linenos">335</span></a><span class="sd">        Normalized cumulative bin power plot for the frequency bins.</span>
</span><span id="SoundPack.integral_plot-336"><a href="#SoundPack.integral_plot-336"><span class="linenos">336</span></a><span class="sd">        See `Plot.integral` for more information.</span>
</span><span id="SoundPack.integral_plot-337"><a href="#SoundPack.integral_plot-337"><span class="linenos">337</span></a>
</span><span id="SoundPack.integral_plot-338"><a href="#SoundPack.integral_plot-338"><span class="linenos">338</span></a><span class="sd">        __ Multiple SoundPack Method __</span>
</span><span id="SoundPack.integral_plot-339"><a href="#SoundPack.integral_plot-339"><span class="linenos">339</span></a><span class="sd">        Plots the cumulative integral plot of specified frequency bins</span>
</span><span id="SoundPack.integral_plot-340"><a href="#SoundPack.integral_plot-340"><span class="linenos">340</span></a><span class="sd">        see help(Plot.integral)</span>
</span><span id="SoundPack.integral_plot-341"><a href="#SoundPack.integral_plot-341"><span class="linenos">341</span></a>
</span><span id="SoundPack.integral_plot-342"><a href="#SoundPack.integral_plot-342"><span class="linenos">342</span></a><span class="sd">        :param f_bin: frequency bins to compare, Supported arguments are </span>
</span><span id="SoundPack.integral_plot-343"><a href="#SoundPack.integral_plot-343"><span class="linenos">343</span></a><span class="sd">        &#39;all&#39;, &#39;bass&#39;, &#39;mid&#39;, &#39;highmid&#39;, &#39;uppermid&#39;, &#39;presence&#39;, &#39;brillance&#39;</span>
</span><span id="SoundPack.integral_plot-344"><a href="#SoundPack.integral_plot-344"><span class="linenos">344</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack.integral_plot-345"><a href="#SoundPack.integral_plot-345"><span class="linenos">345</span></a>
</span><span id="SoundPack.integral_plot-346"><a href="#SoundPack.integral_plot-346"><span class="linenos">346</span></a>        <span class="k">if</span> <span class="n">f_bin</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
</span><span id="SoundPack.integral_plot-347"><a href="#SoundPack.integral_plot-347"><span class="linenos">347</span></a>            <span class="c1"># create a figure with 6 axes</span>
</span><span id="SoundPack.integral_plot-348"><a href="#SoundPack.integral_plot-348"><span class="linenos">348</span></a>            <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
</span><span id="SoundPack.integral_plot-349"><a href="#SoundPack.integral_plot-349"><span class="linenos">349</span></a>            <span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="SoundPack.integral_plot-350"><a href="#SoundPack.integral_plot-350"><span class="linenos">350</span></a>
</span><span id="SoundPack.integral_plot-351"><a href="#SoundPack.integral_plot-351"><span class="linenos">351</span></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bin_strings</span><span class="p">,</span> <span class="n">axs</span><span class="p">):</span>
</span><span id="SoundPack.integral_plot-352"><a href="#SoundPack.integral_plot-352"><span class="linenos">352</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</span><span id="SoundPack.integral_plot-353"><a href="#SoundPack.integral_plot-353"><span class="linenos">353</span></a>                <span class="n">norm_factors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">norm_factor</span> <span class="k">for</span> <span class="n">son</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">])</span>
</span><span id="SoundPack.integral_plot-354"><a href="#SoundPack.integral_plot-354"><span class="linenos">354</span></a>                <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="SoundPack.integral_plot-355"><a href="#SoundPack.integral_plot-355"><span class="linenos">355</span></a>                    <span class="n">sound</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">sound</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack.integral_plot-356"><a href="#SoundPack.integral_plot-356"><span class="linenos">356</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="SoundPack.integral_plot-357"><a href="#SoundPack.integral_plot-357"><span class="linenos">357</span></a>                <span class="n">sound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SoundPack.integral_plot-358"><a href="#SoundPack.integral_plot-358"><span class="linenos">358</span></a>                <span class="n">title0</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s1">&#39; : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sound</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
</span><span id="SoundPack.integral_plot-359"><a href="#SoundPack.integral_plot-359"><span class="linenos">359</span></a>                    <span class="nb">int</span><span class="p">(</span><span class="n">sound</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; Hz, &#39;</span>
</span><span id="SoundPack.integral_plot-360"><a href="#SoundPack.integral_plot-360"><span class="linenos">360</span></a>                <span class="n">title1</span> <span class="o">=</span> <span class="s1">&#39;Norm. Factors : &#39;</span>
</span><span id="SoundPack.integral_plot-361"><a href="#SoundPack.integral_plot-361"><span class="linenos">361</span></a>                <span class="n">title2</span> <span class="o">=</span> <span class="s1">&#39;x, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">norm_factor</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="k">for</span> <span class="n">norm_factor</span> <span class="ow">in</span> <span class="n">norm_factors</span><span class="p">)</span>
</span><span id="SoundPack.integral_plot-362"><a href="#SoundPack.integral_plot-362"><span class="linenos">362</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title0</span> <span class="o">+</span> <span class="n">title1</span> <span class="o">+</span> <span class="n">title2</span><span class="p">)</span>
</span><span id="SoundPack.integral_plot-363"><a href="#SoundPack.integral_plot-363"><span class="linenos">363</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title0</span> <span class="o">+</span> <span class="n">title1</span> <span class="o">+</span> <span class="n">title2</span><span class="p">)</span>
</span><span id="SoundPack.integral_plot-364"><a href="#SoundPack.integral_plot-364"><span class="linenos">364</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="SoundPack.integral_plot-365"><a href="#SoundPack.integral_plot-365"><span class="linenos">365</span></a>
</span><span id="SoundPack.integral_plot-366"><a href="#SoundPack.integral_plot-366"><span class="linenos">366</span></a>        <span class="k">elif</span> <span class="n">f_bin</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_strings</span><span class="p">:</span>
</span><span id="SoundPack.integral_plot-367"><a href="#SoundPack.integral_plot-367"><span class="linenos">367</span></a>            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="SoundPack.integral_plot-368"><a href="#SoundPack.integral_plot-368"><span class="linenos">368</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</span><span id="SoundPack.integral_plot-369"><a href="#SoundPack.integral_plot-369"><span class="linenos">369</span></a>            <span class="n">norm_factors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">son</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">norm_factor</span> <span class="k">for</span> <span class="n">son</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">])</span>
</span><span id="SoundPack.integral_plot-370"><a href="#SoundPack.integral_plot-370"><span class="linenos">370</span></a>            <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="SoundPack.integral_plot-371"><a href="#SoundPack.integral_plot-371"><span class="linenos">371</span></a>                <span class="n">sound</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">sound</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack.integral_plot-372"><a href="#SoundPack.integral_plot-372"><span class="linenos">372</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="SoundPack.integral_plot-373"><a href="#SoundPack.integral_plot-373"><span class="linenos">373</span></a>            <span class="n">sound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SoundPack.integral_plot-374"><a href="#SoundPack.integral_plot-374"><span class="linenos">374</span></a>            <span class="n">title0</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">f_bin</span> <span class="o">+</span> <span class="s1">&#39; : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sound</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
</span><span id="SoundPack.integral_plot-375"><a href="#SoundPack.integral_plot-375"><span class="linenos">375</span></a>                <span class="nb">int</span><span class="p">(</span><span class="n">sound</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; Hz, &#39;</span>
</span><span id="SoundPack.integral_plot-376"><a href="#SoundPack.integral_plot-376"><span class="linenos">376</span></a>            <span class="n">title1</span> <span class="o">=</span> <span class="s1">&#39;Norm. Factors : &#39;</span>
</span><span id="SoundPack.integral_plot-377"><a href="#SoundPack.integral_plot-377"><span class="linenos">377</span></a>            <span class="n">title2</span> <span class="o">=</span> <span class="s1">&#39;x, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">norm_factor</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="k">for</span> <span class="n">norm_factor</span> <span class="ow">in</span> <span class="n">norm_factors</span><span class="p">)</span>
</span><span id="SoundPack.integral_plot-378"><a href="#SoundPack.integral_plot-378"><span class="linenos">378</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title0</span> <span class="o">+</span> <span class="n">title1</span> <span class="o">+</span> <span class="n">title2</span><span class="p">)</span>
</span><span id="SoundPack.integral_plot-379"><a href="#SoundPack.integral_plot-379"><span class="linenos">379</span></a>
</span><span id="SoundPack.integral_plot-380"><a href="#SoundPack.integral_plot-380"><span class="linenos">380</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack.integral_plot-381"><a href="#SoundPack.integral_plot-381"><span class="linenos">381</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;invalid frequency bin&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Normalized cumulative bin power plot for the frequency bins.
See <code><a href="#Plot.integral">Plot.integral</a></code> for more information.</p>

<p>__ Multiple SoundPack Method __
Plots the cumulative integral plot of specified frequency bins
see help(<a href="#Plot.integral">Plot.integral</a>)</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>f_bin</strong>:  frequency bins to compare, Supported arguments are 
'all', 'bass', 'mid', 'highmid', 'uppermid', 'presence', 'brillance'</li>
</ul>
</div>


                            </div>
                            <div id="SoundPack.bin_power_table" class="classattr">
                                        <input id="SoundPack.bin_power_table-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">bin_power_table</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SoundPack.bin_power_table-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SoundPack.bin_power_table"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SoundPack.bin_power_table-383"><a href="#SoundPack.bin_power_table-383"><span class="linenos">383</span></a>    <span class="k">def</span> <span class="nf">bin_power_table</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SoundPack.bin_power_table-384"><a href="#SoundPack.bin_power_table-384"><span class="linenos">384</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack.bin_power_table-385"><a href="#SoundPack.bin_power_table-385"><span class="linenos">385</span></a><span class="sd">        Displays a table with the signal power contained in every frequency bin</span>
</span><span id="SoundPack.bin_power_table-386"><a href="#SoundPack.bin_power_table-386"><span class="linenos">386</span></a><span class="sd">        </span>
</span><span id="SoundPack.bin_power_table-387"><a href="#SoundPack.bin_power_table-387"><span class="linenos">387</span></a><span class="sd">        The power is computed as the time integral of the signal, such as :</span>
</span><span id="SoundPack.bin_power_table-388"><a href="#SoundPack.bin_power_table-388"><span class="linenos">388</span></a>
</span><span id="SoundPack.bin_power_table-389"><a href="#SoundPack.bin_power_table-389"><span class="linenos">389</span></a><span class="sd">            $ P = \int_0^{t_{max}} sig(t) dt $</span>
</span><span id="SoundPack.bin_power_table-390"><a href="#SoundPack.bin_power_table-390"><span class="linenos">390</span></a>
</span><span id="SoundPack.bin_power_table-391"><a href="#SoundPack.bin_power_table-391"><span class="linenos">391</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack.bin_power_table-392"><a href="#SoundPack.bin_power_table-392"><span class="linenos">392</span></a>        <span class="c1"># Bin power distribution table</span>
</span><span id="SoundPack.bin_power_table-393"><a href="#SoundPack.bin_power_table-393"><span class="linenos">393</span></a>        <span class="n">bin_strings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_strings</span>
</span><span id="SoundPack.bin_power_table-394"><a href="#SoundPack.bin_power_table-394"><span class="linenos">394</span></a>        <span class="n">integrals</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SoundPack.bin_power_table-395"><a href="#SoundPack.bin_power_table-395"><span class="linenos">395</span></a>
</span><span id="SoundPack.bin_power_table-396"><a href="#SoundPack.bin_power_table-396"><span class="linenos">396</span></a>        <span class="c1"># for every sound in the SoundPack</span>
</span><span id="SoundPack.bin_power_table-397"><a href="#SoundPack.bin_power_table-397"><span class="linenos">397</span></a>        <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="SoundPack.bin_power_table-398"><a href="#SoundPack.bin_power_table-398"><span class="linenos">398</span></a>
</span><span id="SoundPack.bin_power_table-399"><a href="#SoundPack.bin_power_table-399"><span class="linenos">399</span></a>            <span class="n">integral</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SoundPack.bin_power_table-400"><a href="#SoundPack.bin_power_table-400"><span class="linenos">400</span></a>            <span class="c1"># for every frequency bin in the sound</span>
</span><span id="SoundPack.bin_power_table-401"><a href="#SoundPack.bin_power_table-401"><span class="linenos">401</span></a>            <span class="k">for</span> <span class="n">f_bin</span> <span class="ow">in</span> <span class="n">bin_strings</span><span class="p">:</span>
</span><span id="SoundPack.bin_power_table-402"><a href="#SoundPack.bin_power_table-402"><span class="linenos">402</span></a>                <span class="n">log_envelope</span><span class="p">,</span> <span class="n">log_time</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="SoundPack.bin_power_table-403"><a href="#SoundPack.bin_power_table-403"><span class="linenos">403</span></a>                <span class="n">integral</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">log_envelope</span><span class="p">,</span> <span class="n">log_time</span><span class="p">))</span>
</span><span id="SoundPack.bin_power_table-404"><a href="#SoundPack.bin_power_table-404"><span class="linenos">404</span></a>
</span><span id="SoundPack.bin_power_table-405"><a href="#SoundPack.bin_power_table-405"><span class="linenos">405</span></a>            <span class="c1"># a list of dict for every sound</span>
</span><span id="SoundPack.bin_power_table-406"><a href="#SoundPack.bin_power_table-406"><span class="linenos">406</span></a>            <span class="n">integrals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span>
</span><span id="SoundPack.bin_power_table-407"><a href="#SoundPack.bin_power_table-407"><span class="linenos">407</span></a>
</span><span id="SoundPack.bin_power_table-408"><a href="#SoundPack.bin_power_table-408"><span class="linenos">408</span></a>        <span class="c1"># make the table</span>
</span><span id="SoundPack.bin_power_table-409"><a href="#SoundPack.bin_power_table-409"><span class="linenos">409</span></a>        <span class="n">table_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="n">bin_strings</span><span class="p">),</span> <span class="o">*</span><span class="n">integrals</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</span><span id="SoundPack.bin_power_table-410"><a href="#SoundPack.bin_power_table-410"><span class="linenos">410</span></a>        <span class="n">sound_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">sound</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">]</span>
</span><span id="SoundPack.bin_power_table-411"><a href="#SoundPack.bin_power_table-411"><span class="linenos">411</span></a>
</span><span id="SoundPack.bin_power_table-412"><a href="#SoundPack.bin_power_table-412"><span class="linenos">412</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;___ Signal Power Frequency Bin Distribution ___ </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="SoundPack.bin_power_table-413"><a href="#SoundPack.bin_power_table-413"><span class="linenos">413</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table_data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bin&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">sound_names</span><span class="p">]))</span>
</span></pre></div>


            <div class="docstring"><p>Displays a table with the signal power contained in every frequency bin</p>

<p>The power is computed as the time integral of the signal, such as :</p>

<pre><code>$ P = \int_0^{t_{max}} sig(t) dt $
</code></pre>
</div>


                            </div>
                            <div id="SoundPack.bin_power_hist" class="classattr">
                                        <input id="SoundPack.bin_power_hist-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">bin_power_hist</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SoundPack.bin_power_hist-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SoundPack.bin_power_hist"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SoundPack.bin_power_hist-415"><a href="#SoundPack.bin_power_hist-415"><span class="linenos">415</span></a>    <span class="k">def</span> <span class="nf">bin_power_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SoundPack.bin_power_hist-416"><a href="#SoundPack.bin_power_hist-416"><span class="linenos">416</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack.bin_power_hist-417"><a href="#SoundPack.bin_power_hist-417"><span class="linenos">417</span></a><span class="sd">        Histogram of the frequency bin power for multiple sounds</span>
</span><span id="SoundPack.bin_power_hist-418"><a href="#SoundPack.bin_power_hist-418"><span class="linenos">418</span></a>
</span><span id="SoundPack.bin_power_hist-419"><a href="#SoundPack.bin_power_hist-419"><span class="linenos">419</span></a><span class="sd">        frequency bin power is computed as the integral of the bin envelope, </span>
</span><span id="SoundPack.bin_power_hist-420"><a href="#SoundPack.bin_power_hist-420"><span class="linenos">420</span></a><span class="sd">        such as </span>
</span><span id="SoundPack.bin_power_hist-421"><a href="#SoundPack.bin_power_hist-421"><span class="linenos">421</span></a>
</span><span id="SoundPack.bin_power_hist-422"><a href="#SoundPack.bin_power_hist-422"><span class="linenos">422</span></a><span class="sd">            $ P = \int_0^{t_{max}} env(t) dt $</span>
</span><span id="SoundPack.bin_power_hist-423"><a href="#SoundPack.bin_power_hist-423"><span class="linenos">423</span></a>
</span><span id="SoundPack.bin_power_hist-424"><a href="#SoundPack.bin_power_hist-424"><span class="linenos">424</span></a>
</span><span id="SoundPack.bin_power_hist-425"><a href="#SoundPack.bin_power_hist-425"><span class="linenos">425</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack.bin_power_hist-426"><a href="#SoundPack.bin_power_hist-426"><span class="linenos">426</span></a>        <span class="c1"># Compute the bin powers</span>
</span><span id="SoundPack.bin_power_hist-427"><a href="#SoundPack.bin_power_hist-427"><span class="linenos">427</span></a>        <span class="n">bin_strings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_strings</span>
</span><span id="SoundPack.bin_power_hist-428"><a href="#SoundPack.bin_power_hist-428"><span class="linenos">428</span></a>        <span class="n">integrals</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SoundPack.bin_power_hist-429"><a href="#SoundPack.bin_power_hist-429"><span class="linenos">429</span></a>
</span><span id="SoundPack.bin_power_hist-430"><a href="#SoundPack.bin_power_hist-430"><span class="linenos">430</span></a>        <span class="c1"># for every sound in the SoundPack</span>
</span><span id="SoundPack.bin_power_hist-431"><a href="#SoundPack.bin_power_hist-431"><span class="linenos">431</span></a>        <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="SoundPack.bin_power_hist-432"><a href="#SoundPack.bin_power_hist-432"><span class="linenos">432</span></a>
</span><span id="SoundPack.bin_power_hist-433"><a href="#SoundPack.bin_power_hist-433"><span class="linenos">433</span></a>            <span class="n">integral</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SoundPack.bin_power_hist-434"><a href="#SoundPack.bin_power_hist-434"><span class="linenos">434</span></a>            <span class="c1"># for every frequency bin in the sound</span>
</span><span id="SoundPack.bin_power_hist-435"><a href="#SoundPack.bin_power_hist-435"><span class="linenos">435</span></a>            <span class="k">for</span> <span class="n">f_bin</span> <span class="ow">in</span> <span class="n">bin_strings</span><span class="p">:</span>
</span><span id="SoundPack.bin_power_hist-436"><a href="#SoundPack.bin_power_hist-436"><span class="linenos">436</span></a>                <span class="n">log_envelope</span><span class="p">,</span> <span class="n">log_time</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="SoundPack.bin_power_hist-437"><a href="#SoundPack.bin_power_hist-437"><span class="linenos">437</span></a>                <span class="n">integral</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">log_envelope</span><span class="p">,</span> <span class="n">log_time</span><span class="p">))</span>
</span><span id="SoundPack.bin_power_hist-438"><a href="#SoundPack.bin_power_hist-438"><span class="linenos">438</span></a>
</span><span id="SoundPack.bin_power_hist-439"><a href="#SoundPack.bin_power_hist-439"><span class="linenos">439</span></a>            <span class="c1"># a list of dict for every sound</span>
</span><span id="SoundPack.bin_power_hist-440"><a href="#SoundPack.bin_power_hist-440"><span class="linenos">440</span></a>            <span class="n">integral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span>
</span><span id="SoundPack.bin_power_hist-441"><a href="#SoundPack.bin_power_hist-441"><span class="linenos">441</span></a>            <span class="n">integral</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span>
</span><span id="SoundPack.bin_power_hist-442"><a href="#SoundPack.bin_power_hist-442"><span class="linenos">442</span></a>            <span class="n">integrals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span>
</span><span id="SoundPack.bin_power_hist-443"><a href="#SoundPack.bin_power_hist-443"><span class="linenos">443</span></a>
</span><span id="SoundPack.bin_power_hist-444"><a href="#SoundPack.bin_power_hist-444"><span class="linenos">444</span></a>        <span class="c1"># create the bar plotting vectors</span>
</span><span id="SoundPack.bin_power_hist-445"><a href="#SoundPack.bin_power_hist-445"><span class="linenos">445</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="SoundPack.bin_power_hist-446"><a href="#SoundPack.bin_power_hist-446"><span class="linenos">446</span></a>
</span><span id="SoundPack.bin_power_hist-447"><a href="#SoundPack.bin_power_hist-447"><span class="linenos">447</span></a>        <span class="c1"># make the bar plot</span>
</span><span id="SoundPack.bin_power_hist-448"><a href="#SoundPack.bin_power_hist-448"><span class="linenos">448</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">)</span>
</span><span id="SoundPack.bin_power_hist-449"><a href="#SoundPack.bin_power_hist-449"><span class="linenos">449</span></a>        <span class="n">width</span> <span class="o">=</span> <span class="mf">0.8</span> <span class="o">/</span> <span class="n">n</span>
</span><span id="SoundPack.bin_power_hist-450"><a href="#SoundPack.bin_power_hist-450"><span class="linenos">450</span></a>        <span class="c1"># get nice colors</span>
</span><span id="SoundPack.bin_power_hist-451"><a href="#SoundPack.bin_power_hist-451"><span class="linenos">451</span></a>        <span class="n">cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;Set2&#39;</span><span class="p">)</span>
</span><span id="SoundPack.bin_power_hist-452"><a href="#SoundPack.bin_power_hist-452"><span class="linenos">452</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sound</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">):</span>
</span><span id="SoundPack.bin_power_hist-453"><a href="#SoundPack.bin_power_hist-453"><span class="linenos">453</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">width</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">bin_strings</span><span class="p">)</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">width</span><span class="p">)</span>
</span><span id="SoundPack.bin_power_hist-454"><a href="#SoundPack.bin_power_hist-454"><span class="linenos">454</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">integrals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="SoundPack.bin_power_hist-455"><a href="#SoundPack.bin_power_hist-455"><span class="linenos">455</span></a>            <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="SoundPack.bin_power_hist-456"><a href="#SoundPack.bin_power_hist-456"><span class="linenos">456</span></a>                <span class="n">color</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="SoundPack.bin_power_hist-457"><a href="#SoundPack.bin_power_hist-457"><span class="linenos">457</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack.bin_power_hist-458"><a href="#SoundPack.bin_power_hist-458"><span class="linenos">458</span></a>                <span class="n">color</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SoundPack.bin_power_hist-459"><a href="#SoundPack.bin_power_hist-459"><span class="linenos">459</span></a>
</span><span id="SoundPack.bin_power_hist-460"><a href="#SoundPack.bin_power_hist-460"><span class="linenos">460</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="SoundPack.bin_power_hist-461"><a href="#SoundPack.bin_power_hist-461"><span class="linenos">461</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">tick_label</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">bin_strings</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">sound</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="SoundPack.bin_power_hist-462"><a href="#SoundPack.bin_power_hist-462"><span class="linenos">462</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack.bin_power_hist-463"><a href="#SoundPack.bin_power_hist-463"><span class="linenos">463</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">sound</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="SoundPack.bin_power_hist-464"><a href="#SoundPack.bin_power_hist-464"><span class="linenos">464</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;frequency bin name&#39;</span><span class="p">)</span>
</span><span id="SoundPack.bin_power_hist-465"><a href="#SoundPack.bin_power_hist-465"><span class="linenos">465</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;normalized power&#39;</span><span class="p">)</span>
</span><span id="SoundPack.bin_power_hist-466"><a href="#SoundPack.bin_power_hist-466"><span class="linenos">466</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Histogram of the frequency bin power for multiple sounds</p>

<p>frequency bin power is computed as the integral of the bin envelope, 
such as </p>

<pre><code>$ P = \int_0^{t_{max}} env(t) dt $
</code></pre>
</div>


                            </div>
                            <div id="SoundPack.listen" class="classattr">
                                        <input id="SoundPack.listen-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">listen</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SoundPack.listen-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SoundPack.listen"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SoundPack.listen-468"><a href="#SoundPack.listen-468"><span class="linenos">468</span></a>    <span class="k">def</span> <span class="nf">listen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SoundPack.listen-469"><a href="#SoundPack.listen-469"><span class="linenos">469</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack.listen-470"><a href="#SoundPack.listen-470"><span class="linenos">470</span></a><span class="sd">        Listen to all the sounds in the SoundPack inside the Jupyter Notebook </span>
</span><span id="SoundPack.listen-471"><a href="#SoundPack.listen-471"><span class="linenos">471</span></a><span class="sd">        environment</span>
</span><span id="SoundPack.listen-472"><a href="#SoundPack.listen-472"><span class="linenos">472</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack.listen-473"><a href="#SoundPack.listen-473"><span class="linenos">473</span></a>        <span class="k">for</span> <span class="n">sound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">:</span>
</span><span id="SoundPack.listen-474"><a href="#SoundPack.listen-474"><span class="linenos">474</span></a>            <span class="n">sound</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">listen</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Listen to all the sounds in the SoundPack inside the Jupyter Notebook 
environment</p>
</div>


                            </div>
                            <div id="SoundPack.compare_peaks" class="classattr">
                                        <input id="SoundPack.compare_peaks-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">compare_peaks</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SoundPack.compare_peaks-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SoundPack.compare_peaks"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SoundPack.compare_peaks-480"><a href="#SoundPack.compare_peaks-480"><span class="linenos">480</span></a>    <span class="k">def</span> <span class="nf">compare_peaks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SoundPack.compare_peaks-481"><a href="#SoundPack.compare_peaks-481"><span class="linenos">481</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack.compare_peaks-482"><a href="#SoundPack.compare_peaks-482"><span class="linenos">482</span></a><span class="sd">        Plot to compare the FFT peaks values of two sounds</span>
</span><span id="SoundPack.compare_peaks-483"><a href="#SoundPack.compare_peaks-483"><span class="linenos">483</span></a>
</span><span id="SoundPack.compare_peaks-484"><a href="#SoundPack.compare_peaks-484"><span class="linenos">484</span></a><span class="sd">        __ Dual SoundPack Method __</span>
</span><span id="SoundPack.compare_peaks-485"><a href="#SoundPack.compare_peaks-485"><span class="linenos">485</span></a><span class="sd">        Compares the peaks in the Fourier Transform of two Sounds,</span>
</span><span id="SoundPack.compare_peaks-486"><a href="#SoundPack.compare_peaks-486"><span class="linenos">486</span></a><span class="sd">        the peaks having the highest difference are highlighted. If no peaks</span>
</span><span id="SoundPack.compare_peaks-487"><a href="#SoundPack.compare_peaks-487"><span class="linenos">487</span></a><span class="sd">        are found to have a significant difference, only the two normalized </span>
</span><span id="SoundPack.compare_peaks-488"><a href="#SoundPack.compare_peaks-488"><span class="linenos">488</span></a><span class="sd">        Fourier transform are plotted in a mirror configuration to visualize</span>
</span><span id="SoundPack.compare_peaks-489"><a href="#SoundPack.compare_peaks-489"><span class="linenos">489</span></a><span class="sd">        them.</span>
</span><span id="SoundPack.compare_peaks-490"><a href="#SoundPack.compare_peaks-490"><span class="linenos">490</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack.compare_peaks-491"><a href="#SoundPack.compare_peaks-491"><span class="linenos">491</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;dual&#39;</span><span class="p">:</span>
</span><span id="SoundPack.compare_peaks-492"><a href="#SoundPack.compare_peaks-492"><span class="linenos">492</span></a>            <span class="n">son1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SoundPack.compare_peaks-493"><a href="#SoundPack.compare_peaks-493"><span class="linenos">493</span></a>            <span class="n">son2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SoundPack.compare_peaks-494"><a href="#SoundPack.compare_peaks-494"><span class="linenos">494</span></a>            <span class="n">index1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">son1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">fft_range</span><span class="o">.</span><span class="n">value</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SoundPack.compare_peaks-495"><a href="#SoundPack.compare_peaks-495"><span class="linenos">495</span></a>            <span class="n">index2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">son2</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">fft_range</span><span class="o">.</span><span class="n">value</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SoundPack.compare_peaks-496"><a href="#SoundPack.compare_peaks-496"><span class="linenos">496</span></a>
</span><span id="SoundPack.compare_peaks-497"><a href="#SoundPack.compare_peaks-497"><span class="linenos">497</span></a>            <span class="c1"># Get the peak data from the sounds</span>
</span><span id="SoundPack.compare_peaks-498"><a href="#SoundPack.compare_peaks-498"><span class="linenos">498</span></a>            <span class="n">peaks1</span> <span class="o">=</span> <span class="n">son1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">peaks</span><span class="p">()</span>
</span><span id="SoundPack.compare_peaks-499"><a href="#SoundPack.compare_peaks-499"><span class="linenos">499</span></a>            <span class="n">peaks2</span> <span class="o">=</span> <span class="n">son2</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">peaks</span><span class="p">()</span>
</span><span id="SoundPack.compare_peaks-500"><a href="#SoundPack.compare_peaks-500"><span class="linenos">500</span></a>            <span class="n">freq1</span> <span class="o">=</span> <span class="n">son1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[:</span><span class="n">index1</span><span class="p">]</span>
</span><span id="SoundPack.compare_peaks-501"><a href="#SoundPack.compare_peaks-501"><span class="linenos">501</span></a>            <span class="n">freq2</span> <span class="o">=</span> <span class="n">son2</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[:</span><span class="n">index2</span><span class="p">]</span>
</span><span id="SoundPack.compare_peaks-502"><a href="#SoundPack.compare_peaks-502"><span class="linenos">502</span></a>            <span class="n">fft1</span> <span class="o">=</span> <span class="n">son1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft</span><span class="p">()[:</span><span class="n">index1</span><span class="p">]</span>
</span><span id="SoundPack.compare_peaks-503"><a href="#SoundPack.compare_peaks-503"><span class="linenos">503</span></a>            <span class="n">fft2</span> <span class="o">=</span> <span class="n">son2</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft</span><span class="p">()[:</span><span class="n">index2</span><span class="p">]</span>
</span><span id="SoundPack.compare_peaks-504"><a href="#SoundPack.compare_peaks-504"><span class="linenos">504</span></a>
</span><span id="SoundPack.compare_peaks-505"><a href="#SoundPack.compare_peaks-505"><span class="linenos">505</span></a>            <span class="n">short_peaks_1</span> <span class="o">=</span> <span class="p">[</span><span class="n">peak</span> <span class="k">for</span> <span class="n">peak</span> <span class="ow">in</span> <span class="n">peaks1</span> <span class="k">if</span> <span class="n">peak</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">freq1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="SoundPack.compare_peaks-506"><a href="#SoundPack.compare_peaks-506"><span class="linenos">506</span></a>            <span class="n">short_peaks_2</span> <span class="o">=</span> <span class="p">[</span><span class="n">peak</span> <span class="k">for</span> <span class="n">peak</span> <span class="ow">in</span> <span class="n">peaks2</span> <span class="k">if</span> <span class="n">peak</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">freq1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="SoundPack.compare_peaks-507"><a href="#SoundPack.compare_peaks-507"><span class="linenos">507</span></a>            <span class="n">peak_distance1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">freq1</span><span class="p">[</span><span class="n">peaks1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">-</span> <span class="n">freq1</span><span class="p">[</span><span class="n">peaks1</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">short_peaks_1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)])</span> <span class="o">/</span> <span class="mi">4</span>
</span><span id="SoundPack.compare_peaks-508"><a href="#SoundPack.compare_peaks-508"><span class="linenos">508</span></a>            <span class="n">peak_distance2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">freq2</span><span class="p">[</span><span class="n">peaks2</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">-</span> <span class="n">freq2</span><span class="p">[</span><span class="n">peaks2</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">short_peaks_2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)])</span> <span class="o">/</span> <span class="mi">4</span>
</span><span id="SoundPack.compare_peaks-509"><a href="#SoundPack.compare_peaks-509"><span class="linenos">509</span></a>            <span class="n">peak_distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">peak_distance1</span><span class="p">,</span> <span class="n">peak_distance2</span><span class="p">]))</span>
</span><span id="SoundPack.compare_peaks-510"><a href="#SoundPack.compare_peaks-510"><span class="linenos">510</span></a>
</span><span id="SoundPack.compare_peaks-511"><a href="#SoundPack.compare_peaks-511"><span class="linenos">511</span></a>            <span class="c1"># Align  the two peak vectors</span>
</span><span id="SoundPack.compare_peaks-512"><a href="#SoundPack.compare_peaks-512"><span class="linenos">512</span></a>            <span class="n">new_peaks1</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SoundPack.compare_peaks-513"><a href="#SoundPack.compare_peaks-513"><span class="linenos">513</span></a>            <span class="n">new_peaks2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SoundPack.compare_peaks-514"><a href="#SoundPack.compare_peaks-514"><span class="linenos">514</span></a>            <span class="k">for</span> <span class="n">peak1</span> <span class="ow">in</span> <span class="n">short_peaks_1</span><span class="p">:</span>
</span><span id="SoundPack.compare_peaks-515"><a href="#SoundPack.compare_peaks-515"><span class="linenos">515</span></a>                <span class="k">for</span> <span class="n">peak2</span> <span class="ow">in</span> <span class="n">short_peaks_2</span><span class="p">:</span>
</span><span id="SoundPack.compare_peaks-516"><a href="#SoundPack.compare_peaks-516"><span class="linenos">516</span></a>                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">freq1</span><span class="p">[</span><span class="n">peak1</span><span class="p">]</span> <span class="o">-</span> <span class="n">freq2</span><span class="p">[</span><span class="n">peak2</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">peak_distance</span><span class="p">:</span>
</span><span id="SoundPack.compare_peaks-517"><a href="#SoundPack.compare_peaks-517"><span class="linenos">517</span></a>                        <span class="n">new_peaks1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">peak1</span><span class="p">)</span>
</span><span id="SoundPack.compare_peaks-518"><a href="#SoundPack.compare_peaks-518"><span class="linenos">518</span></a>                        <span class="n">new_peaks2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">peak2</span><span class="p">)</span>
</span><span id="SoundPack.compare_peaks-519"><a href="#SoundPack.compare_peaks-519"><span class="linenos">519</span></a>            <span class="n">new_peaks1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">new_peaks1</span><span class="p">))</span>
</span><span id="SoundPack.compare_peaks-520"><a href="#SoundPack.compare_peaks-520"><span class="linenos">520</span></a>            <span class="n">new_peaks2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">new_peaks2</span><span class="p">))</span>
</span><span id="SoundPack.compare_peaks-521"><a href="#SoundPack.compare_peaks-521"><span class="linenos">521</span></a>
</span><span id="SoundPack.compare_peaks-522"><a href="#SoundPack.compare_peaks-522"><span class="linenos">522</span></a>            <span class="n">different_peaks1</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SoundPack.compare_peaks-523"><a href="#SoundPack.compare_peaks-523"><span class="linenos">523</span></a>            <span class="n">different_peaks2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SoundPack.compare_peaks-524"><a href="#SoundPack.compare_peaks-524"><span class="linenos">524</span></a>            <span class="n">difference_threshold</span> <span class="o">=</span> <span class="mf">0.5</span>
</span><span id="SoundPack.compare_peaks-525"><a href="#SoundPack.compare_peaks-525"><span class="linenos">525</span></a>            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">different_peaks1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="SoundPack.compare_peaks-526"><a href="#SoundPack.compare_peaks-526"><span class="linenos">526</span></a>                <span class="k">for</span> <span class="n">peak1</span><span class="p">,</span> <span class="n">peak2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">new_peaks1</span><span class="p">,</span> <span class="n">new_peaks2</span><span class="p">):</span>
</span><span id="SoundPack.compare_peaks-527"><a href="#SoundPack.compare_peaks-527"><span class="linenos">527</span></a>                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fft1</span><span class="p">[</span><span class="n">peak1</span><span class="p">]</span> <span class="o">-</span> <span class="n">fft2</span><span class="p">[</span><span class="n">peak2</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">difference_threshold</span><span class="p">:</span>
</span><span id="SoundPack.compare_peaks-528"><a href="#SoundPack.compare_peaks-528"><span class="linenos">528</span></a>                        <span class="n">different_peaks1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">peak1</span><span class="p">)</span>
</span><span id="SoundPack.compare_peaks-529"><a href="#SoundPack.compare_peaks-529"><span class="linenos">529</span></a>                        <span class="n">different_peaks2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">peak2</span><span class="p">)</span>
</span><span id="SoundPack.compare_peaks-530"><a href="#SoundPack.compare_peaks-530"><span class="linenos">530</span></a>                <span class="n">difference_threshold</span> <span class="o">-=</span> <span class="mf">0.01</span>
</span><span id="SoundPack.compare_peaks-531"><a href="#SoundPack.compare_peaks-531"><span class="linenos">531</span></a>                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">difference_threshold</span><span class="p">,</span> <span class="mf">0.</span><span class="p">):</span>
</span><span id="SoundPack.compare_peaks-532"><a href="#SoundPack.compare_peaks-532"><span class="linenos">532</span></a>                    <span class="k">break</span>
</span><span id="SoundPack.compare_peaks-533"><a href="#SoundPack.compare_peaks-533"><span class="linenos">533</span></a>
</span><span id="SoundPack.compare_peaks-534"><a href="#SoundPack.compare_peaks-534"><span class="linenos">534</span></a>            <span class="c1"># Plot the output</span>
</span><span id="SoundPack.compare_peaks-535"><a href="#SoundPack.compare_peaks-535"><span class="linenos">535</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="SoundPack.compare_peaks-536"><a href="#SoundPack.compare_peaks-536"><span class="linenos">536</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;symlog&#39;</span><span class="p">,</span> <span class="n">linthresh</span><span class="o">=</span><span class="mf">10e-1</span><span class="p">)</span>
</span><span id="SoundPack.compare_peaks-537"><a href="#SoundPack.compare_peaks-537"><span class="linenos">537</span></a>
</span><span id="SoundPack.compare_peaks-538"><a href="#SoundPack.compare_peaks-538"><span class="linenos">538</span></a>            <span class="c1"># Sound 1</span>
</span><span id="SoundPack.compare_peaks-539"><a href="#SoundPack.compare_peaks-539"><span class="linenos">539</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq1</span><span class="p">,</span> <span class="n">fft1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#919191&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">son1</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack.compare_peaks-540"><a href="#SoundPack.compare_peaks-540"><span class="linenos">540</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">freq1</span><span class="p">[</span><span class="n">new_peaks1</span><span class="p">],</span> <span class="n">fft1</span><span class="p">[</span><span class="n">new_peaks1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;peaks&#39;</span><span class="p">)</span>
</span><span id="SoundPack.compare_peaks-541"><a href="#SoundPack.compare_peaks-541"><span class="linenos">541</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">different_peaks1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="SoundPack.compare_peaks-542"><a href="#SoundPack.compare_peaks-542"><span class="linenos">542</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">freq1</span><span class="p">[</span><span class="n">different_peaks1</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">fft1</span><span class="p">[</span><span class="n">different_peaks1</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;diff peaks&#39;</span><span class="p">)</span>
</span><span id="SoundPack.compare_peaks-543"><a href="#SoundPack.compare_peaks-543"><span class="linenos">543</span></a>                <span class="n">annotation_string</span> <span class="o">=</span> <span class="s1">&#39;Peaks with &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">difference_threshold</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; difference&#39;</span>
</span><span id="SoundPack.compare_peaks-544"><a href="#SoundPack.compare_peaks-544"><span class="linenos">544</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">annotation_string</span><span class="p">,</span> <span class="p">(</span><span class="n">freq1</span><span class="p">[</span><span class="n">different_peaks1</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">peak_distance</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">fft1</span><span class="p">[</span><span class="n">different_peaks1</span><span class="p">[</span><span class="mi">0</span><span class="p">]]))</span>
</span><span id="SoundPack.compare_peaks-545"><a href="#SoundPack.compare_peaks-545"><span class="linenos">545</span></a>
</span><span id="SoundPack.compare_peaks-546"><a href="#SoundPack.compare_peaks-546"><span class="linenos">546</span></a>            <span class="c1"># Sound2</span>
</span><span id="SoundPack.compare_peaks-547"><a href="#SoundPack.compare_peaks-547"><span class="linenos">547</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq2</span><span class="p">,</span> <span class="o">-</span><span class="n">fft2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#3d3d3d&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">son2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack.compare_peaks-548"><a href="#SoundPack.compare_peaks-548"><span class="linenos">548</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">freq2</span><span class="p">[</span><span class="n">new_peaks2</span><span class="p">],</span> <span class="o">-</span><span class="n">fft2</span><span class="p">[</span><span class="n">new_peaks2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
</span><span id="SoundPack.compare_peaks-549"><a href="#SoundPack.compare_peaks-549"><span class="linenos">549</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">different_peaks2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="SoundPack.compare_peaks-550"><a href="#SoundPack.compare_peaks-550"><span class="linenos">550</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">freq2</span><span class="p">[</span><span class="n">different_peaks2</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="o">-</span><span class="n">fft2</span><span class="p">[</span><span class="n">different_peaks2</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
</span><span id="SoundPack.compare_peaks-551"><a href="#SoundPack.compare_peaks-551"><span class="linenos">551</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Fourier Transform Peak Analysis for &#39;</span> <span class="o">+</span> <span class="n">son1</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; and &#39;</span> <span class="o">+</span> <span class="n">son2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack.compare_peaks-552"><a href="#SoundPack.compare_peaks-552"><span class="linenos">552</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="SoundPack.compare_peaks-553"><a href="#SoundPack.compare_peaks-553"><span class="linenos">553</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="SoundPack.compare_peaks-554"><a href="#SoundPack.compare_peaks-554"><span class="linenos">554</span></a>            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="SoundPack.compare_peaks-555"><a href="#SoundPack.compare_peaks-555"><span class="linenos">555</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
</span><span id="SoundPack.compare_peaks-556"><a href="#SoundPack.compare_peaks-556"><span class="linenos">556</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;mirror amplitude (0-1)&#39;</span><span class="p">)</span>
</span><span id="SoundPack.compare_peaks-557"><a href="#SoundPack.compare_peaks-557"><span class="linenos">557</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack.compare_peaks-558"><a href="#SoundPack.compare_peaks-558"><span class="linenos">558</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Unsupported for multiple sounds SoundPacks&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plot to compare the FFT peaks values of two sounds</p>

<p>__ Dual SoundPack Method __
Compares the peaks in the Fourier Transform of two Sounds,
the peaks having the highest difference are highlighted. If no peaks
are found to have a significant difference, only the two normalized 
Fourier transform are plotted in a mirror configuration to visualize
them.</p>
</div>


                            </div>
                            <div id="SoundPack.fft_mirror" class="classattr">
                                        <input id="SoundPack.fft_mirror-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fft_mirror</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SoundPack.fft_mirror-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SoundPack.fft_mirror"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SoundPack.fft_mirror-560"><a href="#SoundPack.fft_mirror-560"><span class="linenos">560</span></a>    <span class="k">def</span> <span class="nf">fft_mirror</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SoundPack.fft_mirror-561"><a href="#SoundPack.fft_mirror-561"><span class="linenos">561</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack.fft_mirror-562"><a href="#SoundPack.fft_mirror-562"><span class="linenos">562</span></a><span class="sd">        Plot the Fourier Transforms of two sounds on opposed axis to compare the spectral content</span>
</span><span id="SoundPack.fft_mirror-563"><a href="#SoundPack.fft_mirror-563"><span class="linenos">563</span></a>
</span><span id="SoundPack.fft_mirror-564"><a href="#SoundPack.fft_mirror-564"><span class="linenos">564</span></a><span class="sd">        __ Dual SoundPack Method __</span>
</span><span id="SoundPack.fft_mirror-565"><a href="#SoundPack.fft_mirror-565"><span class="linenos">565</span></a><span class="sd">        The fourier transforms are plotted normalized between 0 and 1. </span>
</span><span id="SoundPack.fft_mirror-566"><a href="#SoundPack.fft_mirror-566"><span class="linenos">566</span></a><span class="sd">        The y scale is symmetric logarithmic, so that a signal is plotted </span>
</span><span id="SoundPack.fft_mirror-567"><a href="#SoundPack.fft_mirror-567"><span class="linenos">567</span></a><span class="sd">        between 0 and -1, and the other is plotted between 0 and 1. </span>
</span><span id="SoundPack.fft_mirror-568"><a href="#SoundPack.fft_mirror-568"><span class="linenos">568</span></a><span class="sd">        :return: None</span>
</span><span id="SoundPack.fft_mirror-569"><a href="#SoundPack.fft_mirror-569"><span class="linenos">569</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack.fft_mirror-570"><a href="#SoundPack.fft_mirror-570"><span class="linenos">570</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;dual&#39;</span><span class="p">:</span>
</span><span id="SoundPack.fft_mirror-571"><a href="#SoundPack.fft_mirror-571"><span class="linenos">571</span></a>            <span class="n">son1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SoundPack.fft_mirror-572"><a href="#SoundPack.fft_mirror-572"><span class="linenos">572</span></a>            <span class="n">son2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SoundPack.fft_mirror-573"><a href="#SoundPack.fft_mirror-573"><span class="linenos">573</span></a>            <span class="n">fft_range_value</span> <span class="o">=</span> <span class="n">sound_parameters</span><span class="p">()</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">fft_range</span><span class="o">.</span><span class="n">value</span>
</span><span id="SoundPack.fft_mirror-574"><a href="#SoundPack.fft_mirror-574"><span class="linenos">574</span></a>            <span class="n">fft_freq_value</span> <span class="o">=</span> <span class="n">son1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span>
</span><span id="SoundPack.fft_mirror-575"><a href="#SoundPack.fft_mirror-575"><span class="linenos">575</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fft_freq_value</span> <span class="o">&gt;</span> <span class="n">fft_range_value</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SoundPack.fft_mirror-576"><a href="#SoundPack.fft_mirror-576"><span class="linenos">576</span></a>
</span><span id="SoundPack.fft_mirror-577"><a href="#SoundPack.fft_mirror-577"><span class="linenos">577</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="SoundPack.fft_mirror-578"><a href="#SoundPack.fft_mirror-578"><span class="linenos">578</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;symlog&#39;</span><span class="p">)</span>
</span><span id="SoundPack.fft_mirror-579"><a href="#SoundPack.fft_mirror-579"><span class="linenos">579</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="SoundPack.fft_mirror-580"><a href="#SoundPack.fft_mirror-580"><span class="linenos">580</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">son1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[:</span><span class="n">index</span><span class="p">],</span> <span class="n">son1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft</span><span class="p">()[:</span><span class="n">index</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">son1</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack.fft_mirror-581"><a href="#SoundPack.fft_mirror-581"><span class="linenos">581</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">son2</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[:</span><span class="n">index</span><span class="p">],</span> <span class="o">-</span><span class="n">son2</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft</span><span class="p">()[:</span><span class="n">index</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">son2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack.fft_mirror-582"><a href="#SoundPack.fft_mirror-582"><span class="linenos">582</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
</span><span id="SoundPack.fft_mirror-583"><a href="#SoundPack.fft_mirror-583"><span class="linenos">583</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;mirror amplitude (normalized)&#39;</span><span class="p">)</span>
</span><span id="SoundPack.fft_mirror-584"><a href="#SoundPack.fft_mirror-584"><span class="linenos">584</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Mirror Fourier Transform for &#39;</span> <span class="o">+</span> <span class="n">son1</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; and &#39;</span> <span class="o">+</span> <span class="n">son2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack.fft_mirror-585"><a href="#SoundPack.fft_mirror-585"><span class="linenos">585</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="SoundPack.fft_mirror-586"><a href="#SoundPack.fft_mirror-586"><span class="linenos">586</span></a>
</span><span id="SoundPack.fft_mirror-587"><a href="#SoundPack.fft_mirror-587"><span class="linenos">587</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack.fft_mirror-588"><a href="#SoundPack.fft_mirror-588"><span class="linenos">588</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Unsupported for multiple sounds SoundPacks&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plot the Fourier Transforms of two sounds on opposed axis to compare the spectral content</p>

<p>__ Dual SoundPack Method __
The fourier transforms are plotted normalized between 0 and 1. 
The y scale is symmetric logarithmic, so that a signal is plotted 
between 0 and -1, and the other is plotted between 0 and 1. </p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="SoundPack.fft_diff" class="classattr">
                                        <input id="SoundPack.fft_diff-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fft_diff</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">fraction</span><span class="o">=</span><span class="mi">3</span>, </span><span class="param"><span class="n">ticks</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SoundPack.fft_diff-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SoundPack.fft_diff"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SoundPack.fft_diff-590"><a href="#SoundPack.fft_diff-590"><span class="linenos">590</span></a>    <span class="k">def</span> <span class="nf">fft_diff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="SoundPack.fft_diff-591"><a href="#SoundPack.fft_diff-591"><span class="linenos">591</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack.fft_diff-592"><a href="#SoundPack.fft_diff-592"><span class="linenos">592</span></a><span class="sd">        Plot the difference between the spectral distribution in the two sounds</span>
</span><span id="SoundPack.fft_diff-593"><a href="#SoundPack.fft_diff-593"><span class="linenos">593</span></a>
</span><span id="SoundPack.fft_diff-594"><a href="#SoundPack.fft_diff-594"><span class="linenos">594</span></a><span class="sd">        __ Dual SoundPack Method __</span>
</span><span id="SoundPack.fft_diff-595"><a href="#SoundPack.fft_diff-595"><span class="linenos">595</span></a><span class="sd">        Compare the Fourier Transform of two sounds by computing the differences of the octave bins heights.</span>
</span><span id="SoundPack.fft_diff-596"><a href="#SoundPack.fft_diff-596"><span class="linenos">596</span></a><span class="sd">        The two FTs are superimposed on the first plot to show differences</span>
</span><span id="SoundPack.fft_diff-597"><a href="#SoundPack.fft_diff-597"><span class="linenos">597</span></a><span class="sd">        The difference between the two FTs is plotted on the second plot</span>
</span><span id="SoundPack.fft_diff-598"><a href="#SoundPack.fft_diff-598"><span class="linenos">598</span></a>
</span><span id="SoundPack.fft_diff-599"><a href="#SoundPack.fft_diff-599"><span class="linenos">599</span></a><span class="sd">        :param fraction: octave fraction value used to compute the frequency bins A higher number will show</span>
</span><span id="SoundPack.fft_diff-600"><a href="#SoundPack.fft_diff-600"><span class="linenos">600</span></a><span class="sd">        a more precise comparison, but conclusions may be harder to draw.</span>
</span><span id="SoundPack.fft_diff-601"><a href="#SoundPack.fft_diff-601"><span class="linenos">601</span></a><span class="sd">        :param ticks:  If equal to &#39;bins&#39; the frequency bins intervals are used as X axis ticks</span>
</span><span id="SoundPack.fft_diff-602"><a href="#SoundPack.fft_diff-602"><span class="linenos">602</span></a><span class="sd">        :return: None</span>
</span><span id="SoundPack.fft_diff-603"><a href="#SoundPack.fft_diff-603"><span class="linenos">603</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SoundPack.fft_diff-604"><a href="#SoundPack.fft_diff-604"><span class="linenos">604</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;dual&#39;</span><span class="p">:</span>
</span><span id="SoundPack.fft_diff-605"><a href="#SoundPack.fft_diff-605"><span class="linenos">605</span></a>            <span class="c1"># Separate the sounds</span>
</span><span id="SoundPack.fft_diff-606"><a href="#SoundPack.fft_diff-606"><span class="linenos">606</span></a>            <span class="n">son1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SoundPack.fft_diff-607"><a href="#SoundPack.fft_diff-607"><span class="linenos">607</span></a>            <span class="n">son2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SoundPack.fft_diff-608"><a href="#SoundPack.fft_diff-608"><span class="linenos">608</span></a>
</span><span id="SoundPack.fft_diff-609"><a href="#SoundPack.fft_diff-609"><span class="linenos">609</span></a>            <span class="c1"># Compute plotting bins</span>
</span><span id="SoundPack.fft_diff-610"><a href="#SoundPack.fft_diff-610"><span class="linenos">610</span></a>            <span class="n">x_values</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">octave_values</span><span class="p">(</span><span class="n">fraction</span><span class="p">)</span>
</span><span id="SoundPack.fft_diff-611"><a href="#SoundPack.fft_diff-611"><span class="linenos">611</span></a>            <span class="n">hist_bins</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">octave_histogram</span><span class="p">(</span><span class="n">fraction</span><span class="p">)</span>
</span><span id="SoundPack.fft_diff-612"><a href="#SoundPack.fft_diff-612"><span class="linenos">612</span></a>            <span class="n">bar_widths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">hist_bins</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">hist_bins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">hist_bins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)])</span>
</span><span id="SoundPack.fft_diff-613"><a href="#SoundPack.fft_diff-613"><span class="linenos">613</span></a>
</span><span id="SoundPack.fft_diff-614"><a href="#SoundPack.fft_diff-614"><span class="linenos">614</span></a>            <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="SoundPack.fft_diff-615"><a href="#SoundPack.fft_diff-615"><span class="linenos">615</span></a>            <span class="n">plot1</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">son1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_bins</span><span class="p">(),</span> <span class="n">utils</span><span class="o">.</span><span class="n">octave_histogram</span><span class="p">(</span><span class="n">fraction</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
</span><span id="SoundPack.fft_diff-616"><a href="#SoundPack.fft_diff-616"><span class="linenos">616</span></a>                             <span class="n">label</span><span class="o">=</span><span class="n">son1</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack.fft_diff-617"><a href="#SoundPack.fft_diff-617"><span class="linenos">617</span></a>            <span class="n">plot2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">son2</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_bins</span><span class="p">(),</span> <span class="n">utils</span><span class="o">.</span><span class="n">octave_histogram</span><span class="p">(</span><span class="n">fraction</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
</span><span id="SoundPack.fft_diff-618"><a href="#SoundPack.fft_diff-618"><span class="linenos">618</span></a>                             <span class="n">label</span><span class="o">=</span><span class="n">son2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack.fft_diff-619"><a href="#SoundPack.fft_diff-619"><span class="linenos">619</span></a>            <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;FT Histogram for &#39;</span> <span class="o">+</span> <span class="n">son1</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; and &#39;</span> <span class="o">+</span> <span class="n">son2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack.fft_diff-620"><a href="#SoundPack.fft_diff-620"><span class="linenos">620</span></a>            <span class="n">ax1</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="SoundPack.fft_diff-621"><a href="#SoundPack.fft_diff-621"><span class="linenos">621</span></a>            <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
</span><span id="SoundPack.fft_diff-622"><a href="#SoundPack.fft_diff-622"><span class="linenos">622</span></a>            <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;amplitude&#39;</span><span class="p">)</span>
</span><span id="SoundPack.fft_diff-623"><a href="#SoundPack.fft_diff-623"><span class="linenos">623</span></a>            <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="SoundPack.fft_diff-624"><a href="#SoundPack.fft_diff-624"><span class="linenos">624</span></a>            <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="SoundPack.fft_diff-625"><a href="#SoundPack.fft_diff-625"><span class="linenos">625</span></a>
</span><span id="SoundPack.fft_diff-626"><a href="#SoundPack.fft_diff-626"><span class="linenos">626</span></a>            <span class="n">diff</span> <span class="o">=</span> <span class="n">plot1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">plot2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SoundPack.fft_diff-627"><a href="#SoundPack.fft_diff-627"><span class="linenos">627</span></a>            <span class="n">n_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">diff</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SoundPack.fft_diff-628"><a href="#SoundPack.fft_diff-628"><span class="linenos">628</span></a>            <span class="n">p_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">diff</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SoundPack.fft_diff-629"><a href="#SoundPack.fft_diff-629"><span class="linenos">629</span></a>
</span><span id="SoundPack.fft_diff-630"><a href="#SoundPack.fft_diff-630"><span class="linenos">630</span></a>            <span class="c1"># Negative difference corresponding to sound 2</span>
</span><span id="SoundPack.fft_diff-631"><a href="#SoundPack.fft_diff-631"><span class="linenos">631</span></a>            <span class="n">ax2</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x_values</span><span class="p">[</span><span class="n">n_index</span><span class="p">],</span> <span class="n">diff</span><span class="p">[</span><span class="n">n_index</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="n">bar_widths</span><span class="p">[</span><span class="n">n_index</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</span><span id="SoundPack.fft_diff-632"><a href="#SoundPack.fft_diff-632"><span class="linenos">632</span></a>            <span class="c1"># Positive difference corresponding to sound1</span>
</span><span id="SoundPack.fft_diff-633"><a href="#SoundPack.fft_diff-633"><span class="linenos">633</span></a>            <span class="n">ax2</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x_values</span><span class="p">[</span><span class="n">p_index</span><span class="p">],</span> <span class="n">diff</span><span class="p">[</span><span class="n">p_index</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="n">bar_widths</span><span class="p">[</span><span class="n">p_index</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</span><span id="SoundPack.fft_diff-634"><a href="#SoundPack.fft_diff-634"><span class="linenos">634</span></a>            <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Difference &#39;</span> <span class="o">+</span> <span class="n">son1</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="n">son2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="SoundPack.fft_diff-635"><a href="#SoundPack.fft_diff-635"><span class="linenos">635</span></a>            <span class="n">ax2</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="SoundPack.fft_diff-636"><a href="#SoundPack.fft_diff-636"><span class="linenos">636</span></a>            <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
</span><span id="SoundPack.fft_diff-637"><a href="#SoundPack.fft_diff-637"><span class="linenos">637</span></a>            <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&lt;- sound 2 : sound 1 -&gt;&#39;</span><span class="p">)</span>
</span><span id="SoundPack.fft_diff-638"><a href="#SoundPack.fft_diff-638"><span class="linenos">638</span></a>            <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="SoundPack.fft_diff-639"><a href="#SoundPack.fft_diff-639"><span class="linenos">639</span></a>
</span><span id="SoundPack.fft_diff-640"><a href="#SoundPack.fft_diff-640"><span class="linenos">640</span></a>            <span class="k">if</span> <span class="n">ticks</span> <span class="o">==</span> <span class="s1">&#39;bins&#39;</span><span class="p">:</span>
</span><span id="SoundPack.fft_diff-641"><a href="#SoundPack.fft_diff-641"><span class="linenos">641</span></a>                <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">label</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="vm">__dict__</span> <span class="k">if</span> <span class="n">label</span> <span class="o">!=</span> <span class="s1">&#39;name&#39;</span><span class="p">]</span>
</span><span id="SoundPack.fft_diff-642"><a href="#SoundPack.fft_diff-642"><span class="linenos">642</span></a>                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;brillance&#39;</span><span class="p">)</span>
</span><span id="SoundPack.fft_diff-643"><a href="#SoundPack.fft_diff-643"><span class="linenos">643</span></a>                <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">param</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">param</span> <span class="o">!=</span> <span class="s1">&#39;bins&#39;</span><span class="p">]</span>
</span><span id="SoundPack.fft_diff-644"><a href="#SoundPack.fft_diff-644"><span class="linenos">644</span></a>                <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">11250</span><span class="p">)</span>
</span><span id="SoundPack.fft_diff-645"><a href="#SoundPack.fft_diff-645"><span class="linenos">645</span></a>                <span class="n">x_formatter</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FixedFormatter</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</span><span id="SoundPack.fft_diff-646"><a href="#SoundPack.fft_diff-646"><span class="linenos">646</span></a>                <span class="n">x_locator</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="SoundPack.fft_diff-647"><a href="#SoundPack.fft_diff-647"><span class="linenos">647</span></a>                <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">x_locator</span><span class="p">)</span>
</span><span id="SoundPack.fft_diff-648"><a href="#SoundPack.fft_diff-648"><span class="linenos">648</span></a>                <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">x_formatter</span><span class="p">)</span>
</span><span id="SoundPack.fft_diff-649"><a href="#SoundPack.fft_diff-649"><span class="linenos">649</span></a>                <span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelrotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
</span><span id="SoundPack.fft_diff-650"><a href="#SoundPack.fft_diff-650"><span class="linenos">650</span></a>                <span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">x_locator</span><span class="p">)</span>
</span><span id="SoundPack.fft_diff-651"><a href="#SoundPack.fft_diff-651"><span class="linenos">651</span></a>                <span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">x_formatter</span><span class="p">)</span>
</span><span id="SoundPack.fft_diff-652"><a href="#SoundPack.fft_diff-652"><span class="linenos">652</span></a>                <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelrotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
</span><span id="SoundPack.fft_diff-653"><a href="#SoundPack.fft_diff-653"><span class="linenos">653</span></a>
</span><span id="SoundPack.fft_diff-654"><a href="#SoundPack.fft_diff-654"><span class="linenos">654</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack.fft_diff-655"><a href="#SoundPack.fft_diff-655"><span class="linenos">655</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Unsupported for multiple sounds SoundPacks&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plot the difference between the spectral distribution in the two sounds</p>

<p>__ Dual SoundPack Method __
Compare the Fourier Transform of two sounds by computing the differences of the octave bins heights.
The two FTs are superimposed on the first plot to show differences
The difference between the two FTs is plotted on the second plot</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>fraction</strong>:  octave fraction value used to compute the frequency bins A higher number will show
a more precise comparison, but conclusions may be harder to draw.</li>
<li><strong>ticks</strong>:   If equal to 'bins' the frequency bins intervals are used as X axis ticks</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="SoundPack.integral_compare" class="classattr">
                                        <input id="SoundPack.integral_compare-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">integral_compare</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">f_bin</span><span class="o">=</span><span class="s1">&#39;all&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SoundPack.integral_compare-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SoundPack.integral_compare"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SoundPack.integral_compare-657"><a href="#SoundPack.integral_compare-657"><span class="linenos">657</span></a>    <span class="k">def</span> <span class="nf">integral_compare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f_bin</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">):</span>
</span><span id="SoundPack.integral_compare-658"><a href="#SoundPack.integral_compare-658"><span class="linenos">658</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SoundPack.integral_compare-659"><a href="#SoundPack.integral_compare-659"><span class="linenos">659</span></a><span class="sd">          Cumulative bin envelope integral comparison for two signals</span>
</span><span id="SoundPack.integral_compare-660"><a href="#SoundPack.integral_compare-660"><span class="linenos">660</span></a>
</span><span id="SoundPack.integral_compare-661"><a href="#SoundPack.integral_compare-661"><span class="linenos">661</span></a><span class="sd">          __ Dual SoundPack Method __</span>
</span><span id="SoundPack.integral_compare-662"><a href="#SoundPack.integral_compare-662"><span class="linenos">662</span></a><span class="sd">          Plots the cumulative integral plot of specified frequency bins</span>
</span><span id="SoundPack.integral_compare-663"><a href="#SoundPack.integral_compare-663"><span class="linenos">663</span></a><span class="sd">          and their difference as surfaces</span>
</span><span id="SoundPack.integral_compare-664"><a href="#SoundPack.integral_compare-664"><span class="linenos">664</span></a>
</span><span id="SoundPack.integral_compare-665"><a href="#SoundPack.integral_compare-665"><span class="linenos">665</span></a><span class="sd">          f_bin: frequency bins to compare, Supported arguments are :</span>
</span><span id="SoundPack.integral_compare-666"><a href="#SoundPack.integral_compare-666"><span class="linenos">666</span></a><span class="sd">          &#39;all&#39;, &#39;bass&#39;, &#39;mid&#39;, &#39;highmid&#39;, &#39;uppermid&#39;, &#39;presence&#39;, &#39;brillance&#39;</span>
</span><span id="SoundPack.integral_compare-667"><a href="#SoundPack.integral_compare-667"><span class="linenos">667</span></a><span class="sd">          &quot;&quot;&quot;</span>
</span><span id="SoundPack.integral_compare-668"><a href="#SoundPack.integral_compare-668"><span class="linenos">668</span></a>
</span><span id="SoundPack.integral_compare-669"><a href="#SoundPack.integral_compare-669"><span class="linenos">669</span></a>        <span class="c1"># Case when plotting all the frequency bins</span>
</span><span id="SoundPack.integral_compare-670"><a href="#SoundPack.integral_compare-670"><span class="linenos">670</span></a>        <span class="k">if</span> <span class="n">f_bin</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
</span><span id="SoundPack.integral_compare-671"><a href="#SoundPack.integral_compare-671"><span class="linenos">671</span></a>            <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
</span><span id="SoundPack.integral_compare-672"><a href="#SoundPack.integral_compare-672"><span class="linenos">672</span></a>            <span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="SoundPack.integral_compare-673"><a href="#SoundPack.integral_compare-673"><span class="linenos">673</span></a>
</span><span id="SoundPack.integral_compare-674"><a href="#SoundPack.integral_compare-674"><span class="linenos">674</span></a>            <span class="c1"># get the bins frequency values</span>
</span><span id="SoundPack.integral_compare-675"><a href="#SoundPack.integral_compare-675"><span class="linenos">675</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">bin_strings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="SoundPack.integral_compare-676"><a href="#SoundPack.integral_compare-676"><span class="linenos">676</span></a>            <span class="n">bins1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="SoundPack.integral_compare-677"><a href="#SoundPack.integral_compare-677"><span class="linenos">677</span></a>            <span class="n">bins2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="SoundPack.integral_compare-678"><a href="#SoundPack.integral_compare-678"><span class="linenos">678</span></a>
</span><span id="SoundPack.integral_compare-679"><a href="#SoundPack.integral_compare-679"><span class="linenos">679</span></a>            <span class="k">for</span> <span class="n">signal1</span><span class="p">,</span> <span class="n">signal2</span><span class="p">,</span> <span class="n">bin_string</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bins1</span><span class="p">,</span> <span class="n">bins2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_strings</span><span class="p">,</span> <span class="n">axs</span><span class="p">):</span>
</span><span id="SoundPack.integral_compare-680"><a href="#SoundPack.integral_compare-680"><span class="linenos">680</span></a>                <span class="c1"># Compute the log time and envelopes integrals</span>
</span><span id="SoundPack.integral_compare-681"><a href="#SoundPack.integral_compare-681"><span class="linenos">681</span></a>                <span class="n">log_envelope1</span><span class="p">,</span> <span class="n">log_time1</span> <span class="o">=</span> <span class="n">signal1</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="SoundPack.integral_compare-682"><a href="#SoundPack.integral_compare-682"><span class="linenos">682</span></a>                <span class="n">log_envelope2</span><span class="p">,</span> <span class="n">log_time2</span> <span class="o">=</span> <span class="n">signal2</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="SoundPack.integral_compare-683"><a href="#SoundPack.integral_compare-683"><span class="linenos">683</span></a>                <span class="n">env_range1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">log_envelope1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="SoundPack.integral_compare-684"><a href="#SoundPack.integral_compare-684"><span class="linenos">684</span></a>                <span class="n">env_range2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">log_envelope2</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="SoundPack.integral_compare-685"><a href="#SoundPack.integral_compare-685"><span class="linenos">685</span></a>                <span class="n">integral1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">log_envelope1</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">log_time1</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">env_range1</span><span class="p">])</span>
</span><span id="SoundPack.integral_compare-686"><a href="#SoundPack.integral_compare-686"><span class="linenos">686</span></a>                <span class="n">integral2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">log_envelope2</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">log_time2</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">env_range2</span><span class="p">])</span>
</span><span id="SoundPack.integral_compare-687"><a href="#SoundPack.integral_compare-687"><span class="linenos">687</span></a>                <span class="n">time1</span> <span class="o">=</span> <span class="n">log_time1</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">log_time1</span><span class="p">):</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SoundPack.integral_compare-688"><a href="#SoundPack.integral_compare-688"><span class="linenos">688</span></a>                <span class="n">time2</span> <span class="o">=</span> <span class="n">log_time2</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">log_time2</span><span class="p">):</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SoundPack.integral_compare-689"><a href="#SoundPack.integral_compare-689"><span class="linenos">689</span></a>
</span><span id="SoundPack.integral_compare-690"><a href="#SoundPack.integral_compare-690"><span class="linenos">690</span></a>                <span class="c1"># resize arrays to match shape</span>
</span><span id="SoundPack.integral_compare-691"><a href="#SoundPack.integral_compare-691"><span class="linenos">691</span></a>                <span class="n">common_len</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">time2</span><span class="p">))</span>
</span><span id="SoundPack.integral_compare-692"><a href="#SoundPack.integral_compare-692"><span class="linenos">692</span></a>                <span class="n">time1</span> <span class="o">=</span> <span class="n">time1</span><span class="p">[:</span><span class="n">common_len</span><span class="p">]</span>
</span><span id="SoundPack.integral_compare-693"><a href="#SoundPack.integral_compare-693"><span class="linenos">693</span></a>                <span class="n">time2</span> <span class="o">=</span> <span class="n">time2</span><span class="p">[:</span><span class="n">common_len</span><span class="p">]</span>
</span><span id="SoundPack.integral_compare-694"><a href="#SoundPack.integral_compare-694"><span class="linenos">694</span></a>                <span class="n">integral1</span> <span class="o">=</span> <span class="n">integral1</span><span class="p">[:</span><span class="n">common_len</span><span class="p">]</span>
</span><span id="SoundPack.integral_compare-695"><a href="#SoundPack.integral_compare-695"><span class="linenos">695</span></a>                <span class="n">integral2</span> <span class="o">=</span> <span class="n">integral2</span><span class="p">[:</span><span class="n">common_len</span><span class="p">]</span>
</span><span id="SoundPack.integral_compare-696"><a href="#SoundPack.integral_compare-696"><span class="linenos">696</span></a>                <span class="c1"># Normalize</span>
</span><span id="SoundPack.integral_compare-697"><a href="#SoundPack.integral_compare-697"><span class="linenos">697</span></a>                <span class="n">max_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">integral1</span><span class="p">,</span> <span class="n">integral2</span><span class="p">]))</span>
</span><span id="SoundPack.integral_compare-698"><a href="#SoundPack.integral_compare-698"><span class="linenos">698</span></a>                <span class="n">integral1</span> <span class="o">/=</span> <span class="n">max_value</span>
</span><span id="SoundPack.integral_compare-699"><a href="#SoundPack.integral_compare-699"><span class="linenos">699</span></a>                <span class="n">integral2</span> <span class="o">/=</span> <span class="n">max_value</span>
</span><span id="SoundPack.integral_compare-700"><a href="#SoundPack.integral_compare-700"><span class="linenos">700</span></a>
</span><span id="SoundPack.integral_compare-701"><a href="#SoundPack.integral_compare-701"><span class="linenos">701</span></a>                <span class="c1"># plot the integral area curves</span>
</span><span id="SoundPack.integral_compare-702"><a href="#SoundPack.integral_compare-702"><span class="linenos">702</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">time1</span><span class="p">,</span> <span class="n">integral1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</span><span id="SoundPack.integral_compare-703"><a href="#SoundPack.integral_compare-703"><span class="linenos">703</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">time2</span><span class="p">,</span> <span class="o">-</span><span class="n">integral2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</span><span id="SoundPack.integral_compare-704"><a href="#SoundPack.integral_compare-704"><span class="linenos">704</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">time2</span><span class="p">,</span> <span class="n">integral1</span> <span class="o">-</span> <span class="n">integral2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;int diff&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</span><span id="SoundPack.integral_compare-705"><a href="#SoundPack.integral_compare-705"><span class="linenos">705</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
</span><span id="SoundPack.integral_compare-706"><a href="#SoundPack.integral_compare-706"><span class="linenos">706</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;mirror cumulative power (normalized)&#39;</span><span class="p">)</span>
</span><span id="SoundPack.integral_compare-707"><a href="#SoundPack.integral_compare-707"><span class="linenos">707</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="SoundPack.integral_compare-708"><a href="#SoundPack.integral_compare-708"><span class="linenos">708</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">bin_string</span><span class="p">)</span>
</span><span id="SoundPack.integral_compare-709"><a href="#SoundPack.integral_compare-709"><span class="linenos">709</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="SoundPack.integral_compare-710"><a href="#SoundPack.integral_compare-710"><span class="linenos">710</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="SoundPack.integral_compare-711"><a href="#SoundPack.integral_compare-711"><span class="linenos">711</span></a>
</span><span id="SoundPack.integral_compare-712"><a href="#SoundPack.integral_compare-712"><span class="linenos">712</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="SoundPack.integral_compare-713"><a href="#SoundPack.integral_compare-713"><span class="linenos">713</span></a>
</span><span id="SoundPack.integral_compare-714"><a href="#SoundPack.integral_compare-714"><span class="linenos">714</span></a>        <span class="k">elif</span> <span class="n">f_bin</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_strings</span><span class="p">:</span>
</span><span id="SoundPack.integral_compare-715"><a href="#SoundPack.integral_compare-715"><span class="linenos">715</span></a>
</span><span id="SoundPack.integral_compare-716"><a href="#SoundPack.integral_compare-716"><span class="linenos">716</span></a>            <span class="c1"># Compute the log envelopes and areau curves</span>
</span><span id="SoundPack.integral_compare-717"><a href="#SoundPack.integral_compare-717"><span class="linenos">717</span></a>            <span class="n">signal1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span>
</span><span id="SoundPack.integral_compare-718"><a href="#SoundPack.integral_compare-718"><span class="linenos">718</span></a>            <span class="n">signal2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span>
</span><span id="SoundPack.integral_compare-719"><a href="#SoundPack.integral_compare-719"><span class="linenos">719</span></a>            <span class="n">log_envelope1</span><span class="p">,</span> <span class="n">log_time1</span> <span class="o">=</span> <span class="n">signal1</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="SoundPack.integral_compare-720"><a href="#SoundPack.integral_compare-720"><span class="linenos">720</span></a>            <span class="n">log_envelope2</span><span class="p">,</span> <span class="n">log_time2</span> <span class="o">=</span> <span class="n">signal2</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="SoundPack.integral_compare-721"><a href="#SoundPack.integral_compare-721"><span class="linenos">721</span></a>            <span class="n">integral1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">log_envelope1</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">log_time1</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">log_envelope1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)])</span>
</span><span id="SoundPack.integral_compare-722"><a href="#SoundPack.integral_compare-722"><span class="linenos">722</span></a>            <span class="n">integral2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">log_envelope2</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">log_time2</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">log_envelope2</span><span class="p">),</span> <span class="mi">1</span><span class="p">)])</span>
</span><span id="SoundPack.integral_compare-723"><a href="#SoundPack.integral_compare-723"><span class="linenos">723</span></a>            <span class="n">time1</span> <span class="o">=</span> <span class="n">log_time1</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">log_time1</span><span class="p">):</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SoundPack.integral_compare-724"><a href="#SoundPack.integral_compare-724"><span class="linenos">724</span></a>            <span class="n">time2</span> <span class="o">=</span> <span class="n">log_time2</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">log_time2</span><span class="p">):</span><span class="mi">1</span><span class="p">]</span>
</span><span id="SoundPack.integral_compare-725"><a href="#SoundPack.integral_compare-725"><span class="linenos">725</span></a>
</span><span id="SoundPack.integral_compare-726"><a href="#SoundPack.integral_compare-726"><span class="linenos">726</span></a>            <span class="c1"># resize arrays to match shape</span>
</span><span id="SoundPack.integral_compare-727"><a href="#SoundPack.integral_compare-727"><span class="linenos">727</span></a>            <span class="n">common_len</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">time2</span><span class="p">))</span>
</span><span id="SoundPack.integral_compare-728"><a href="#SoundPack.integral_compare-728"><span class="linenos">728</span></a>            <span class="n">time1</span> <span class="o">=</span> <span class="n">time1</span><span class="p">[:</span><span class="n">common_len</span><span class="p">]</span>
</span><span id="SoundPack.integral_compare-729"><a href="#SoundPack.integral_compare-729"><span class="linenos">729</span></a>            <span class="n">time2</span> <span class="o">=</span> <span class="n">time2</span><span class="p">[:</span><span class="n">common_len</span><span class="p">]</span>
</span><span id="SoundPack.integral_compare-730"><a href="#SoundPack.integral_compare-730"><span class="linenos">730</span></a>            <span class="n">integral1</span> <span class="o">=</span> <span class="n">integral1</span><span class="p">[:</span><span class="n">common_len</span><span class="p">]</span>
</span><span id="SoundPack.integral_compare-731"><a href="#SoundPack.integral_compare-731"><span class="linenos">731</span></a>            <span class="n">integral2</span> <span class="o">=</span> <span class="n">integral2</span><span class="p">[:</span><span class="n">common_len</span><span class="p">]</span>
</span><span id="SoundPack.integral_compare-732"><a href="#SoundPack.integral_compare-732"><span class="linenos">732</span></a>            <span class="c1"># Normalize</span>
</span><span id="SoundPack.integral_compare-733"><a href="#SoundPack.integral_compare-733"><span class="linenos">733</span></a>            <span class="n">max_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">integral1</span><span class="p">,</span> <span class="n">integral2</span><span class="p">]))</span>
</span><span id="SoundPack.integral_compare-734"><a href="#SoundPack.integral_compare-734"><span class="linenos">734</span></a>            <span class="n">integral1</span> <span class="o">/=</span> <span class="n">max_value</span>
</span><span id="SoundPack.integral_compare-735"><a href="#SoundPack.integral_compare-735"><span class="linenos">735</span></a>            <span class="n">integral2</span> <span class="o">/=</span> <span class="n">max_value</span>
</span><span id="SoundPack.integral_compare-736"><a href="#SoundPack.integral_compare-736"><span class="linenos">736</span></a>
</span><span id="SoundPack.integral_compare-737"><a href="#SoundPack.integral_compare-737"><span class="linenos">737</span></a>            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="SoundPack.integral_compare-738"><a href="#SoundPack.integral_compare-738"><span class="linenos">738</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">time1</span><span class="p">,</span> <span class="n">integral1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</span><span id="SoundPack.integral_compare-739"><a href="#SoundPack.integral_compare-739"><span class="linenos">739</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">time2</span><span class="p">,</span> <span class="o">-</span><span class="n">integral2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</span><span id="SoundPack.integral_compare-740"><a href="#SoundPack.integral_compare-740"><span class="linenos">740</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">time2</span><span class="p">,</span> <span class="n">integral1</span> <span class="o">-</span> <span class="n">integral2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;int diff&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</span><span id="SoundPack.integral_compare-741"><a href="#SoundPack.integral_compare-741"><span class="linenos">741</span></a>
</span><span id="SoundPack.integral_compare-742"><a href="#SoundPack.integral_compare-742"><span class="linenos">742</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
</span><span id="SoundPack.integral_compare-743"><a href="#SoundPack.integral_compare-743"><span class="linenos">743</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;mirror cumulative power (normalized)&#39;</span><span class="p">)</span>
</span><span id="SoundPack.integral_compare-744"><a href="#SoundPack.integral_compare-744"><span class="linenos">744</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="SoundPack.integral_compare-745"><a href="#SoundPack.integral_compare-745"><span class="linenos">745</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">f_bin</span><span class="p">)</span>
</span><span id="SoundPack.integral_compare-746"><a href="#SoundPack.integral_compare-746"><span class="linenos">746</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
</span><span id="SoundPack.integral_compare-747"><a href="#SoundPack.integral_compare-747"><span class="linenos">747</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="SoundPack.integral_compare-748"><a href="#SoundPack.integral_compare-748"><span class="linenos">748</span></a>
</span><span id="SoundPack.integral_compare-749"><a href="#SoundPack.integral_compare-749"><span class="linenos">749</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SoundPack.integral_compare-750"><a href="#SoundPack.integral_compare-750"><span class="linenos">750</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;invalid frequency bin&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Cumulative bin envelope integral comparison for two signals</p>

<p>__ Dual SoundPack Method __
Plots the cumulative integral plot of specified frequency bins
and their difference as surfaces</p>

<p>f_bin: frequency bins to compare, Supported arguments are :
'all', 'bass', 'mid', 'highmid', 'uppermid', 'presence', 'brillance'</p>
</div>


                            </div>
                </section>
                <section id="Sound">
                            <input id="Sound-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Sound</span>:

                <label class="view-source-button" for="Sound-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Sound"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Sound-753"><a href="#Sound-753"><span class="linenos">753</span></a><span class="k">class</span> <span class="nc">Sound</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="Sound-754"><a href="#Sound-754"><span class="linenos">754</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Sound-755"><a href="#Sound-755"><span class="linenos">755</span></a><span class="sd">    A class to store audio signals obtained from a sound and compare them</span>
</span><span id="Sound-756"><a href="#Sound-756"><span class="linenos">756</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Sound-757"><a href="#Sound-757"><span class="linenos">757</span></a>
</span><span id="Sound-758"><a href="#Sound-758"><span class="linenos">758</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">condition</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">auto_trim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Sound-759"><a href="#Sound-759"><span class="linenos">759</span></a>                 <span class="n">use_raw_signal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">normalize_raw_signal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
</span><span id="Sound-760"><a href="#Sound-760"><span class="linenos">760</span></a>                 <span class="n">fundamental</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">SoundParams</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Sound-761"><a href="#Sound-761"><span class="linenos">761</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Sound-762"><a href="#Sound-762"><span class="linenos">762</span></a><span class="sd">        Creates a Sound instance from a .wav file, name as a string and </span>
</span><span id="Sound-763"><a href="#Sound-763"><span class="linenos">763</span></a><span class="sd">        fundamental frequency value can be user specified.</span>
</span><span id="Sound-764"><a href="#Sound-764"><span class="linenos">764</span></a>
</span><span id="Sound-765"><a href="#Sound-765"><span class="linenos">765</span></a><span class="sd">        :param data: data path to the .wav data</span>
</span><span id="Sound-766"><a href="#Sound-766"><span class="linenos">766</span></a><span class="sd">        :param name: Sound instance name to use in plot legend and titles</span>
</span><span id="Sound-767"><a href="#Sound-767"><span class="linenos">767</span></a><span class="sd">        :param condition: Bool, whether to condition or not the Sound instance </span>
</span><span id="Sound-768"><a href="#Sound-768"><span class="linenos">768</span></a><span class="sd">        if `True`, the `Sound` instance is conditioned in the constructor</span>
</span><span id="Sound-769"><a href="#Sound-769"><span class="linenos">769</span></a><span class="sd">        :param auto_trim: Bool, whether to trim the end of the sound or not </span>
</span><span id="Sound-770"><a href="#Sound-770"><span class="linenos">770</span></a><span class="sd">        according to predefined sound length correlated to the fundamental.</span>
</span><span id="Sound-771"><a href="#Sound-771"><span class="linenos">771</span></a><span class="sd">        :param use_raw_signal: Do not condition the `Sound` and instead </span>
</span><span id="Sound-772"><a href="#Sound-772"><span class="linenos">772</span></a><span class="sd">        use the raw signal</span>
</span><span id="Sound-773"><a href="#Sound-773"><span class="linenos">773</span></a><span class="sd">        :param normalize_raw_signal: If `use_raw_signal` is `True`, setting </span>
</span><span id="Sound-774"><a href="#Sound-774"><span class="linenos">774</span></a><span class="sd">        `normalize_raw_signal` to `True` will normalize the raw signal before it</span>
</span><span id="Sound-775"><a href="#Sound-775"><span class="linenos">775</span></a><span class="sd">        is used in the `Sound` class</span>
</span><span id="Sound-776"><a href="#Sound-776"><span class="linenos">776</span></a><span class="sd">        :param fundamental: Fundamental frequency value if None the value is </span>
</span><span id="Sound-777"><a href="#Sound-777"><span class="linenos">777</span></a><span class="sd">        estimated</span>
</span><span id="Sound-778"><a href="#Sound-778"><span class="linenos">778</span></a><span class="sd">        from the FFT (see `Signal.fundamental`).</span>
</span><span id="Sound-779"><a href="#Sound-779"><span class="linenos">779</span></a><span class="sd">        :param SoundParams: SoundParameters to use in the Sound instance</span>
</span><span id="Sound-780"><a href="#Sound-780"><span class="linenos">780</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Sound-781"><a href="#Sound-781"><span class="linenos">781</span></a>        <span class="c1"># create a reference of the parameters</span>
</span><span id="Sound-782"><a href="#Sound-782"><span class="linenos">782</span></a>        <span class="k">if</span> <span class="n">SoundParams</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Sound-783"><a href="#Sound-783"><span class="linenos">783</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">SP</span> <span class="o">=</span> <span class="n">sound_parameters</span><span class="p">()</span>
</span><span id="Sound-784"><a href="#Sound-784"><span class="linenos">784</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Sound-785"><a href="#Sound-785"><span class="linenos">785</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">SP</span> <span class="o">=</span> <span class="n">SoundParams</span>
</span><span id="Sound-786"><a href="#Sound-786"><span class="linenos">786</span></a>
</span><span id="Sound-787"><a href="#Sound-787"><span class="linenos">787</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Sound-788"><a href="#Sound-788"><span class="linenos">788</span></a>            <span class="c1"># Load the sound data using librosa</span>
</span><span id="Sound-789"><a href="#Sound-789"><span class="linenos">789</span></a>            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;wav&#39;</span><span class="p">:</span>
</span><span id="Sound-790"><a href="#Sound-790"><span class="linenos">790</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Only .wav are supported&#39;</span><span class="p">)</span>
</span><span id="Sound-791"><a href="#Sound-791"><span class="linenos">791</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Sound-792"><a href="#Sound-792"><span class="linenos">792</span></a>                <span class="n">signal</span><span class="p">,</span> <span class="n">sr</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">load_wav</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="Sound-793"><a href="#Sound-793"><span class="linenos">793</span></a>
</span><span id="Sound-794"><a href="#Sound-794"><span class="linenos">794</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="Sound-795"><a href="#Sound-795"><span class="linenos">795</span></a>            <span class="n">signal</span><span class="p">,</span> <span class="n">sr</span> <span class="o">=</span> <span class="n">data</span>
</span><span id="Sound-796"><a href="#Sound-796"><span class="linenos">796</span></a>
</span><span id="Sound-797"><a href="#Sound-797"><span class="linenos">797</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Sound-798"><a href="#Sound-798"><span class="linenos">798</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span>
</span><span id="Sound-799"><a href="#Sound-799"><span class="linenos">799</span></a>
</span><span id="Sound-800"><a href="#Sound-800"><span class="linenos">800</span></a>        <span class="c1"># create a Signal class from the signal and sample rate</span>
</span><span id="Sound-801"><a href="#Sound-801"><span class="linenos">801</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">raw_signal</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">)</span>
</span><span id="Sound-802"><a href="#Sound-802"><span class="linenos">802</span></a>        <span class="c1"># create an empty plot attribute</span>
</span><span id="Sound-803"><a href="#Sound-803"><span class="linenos">803</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sound-804"><a href="#Sound-804"><span class="linenos">804</span></a>        <span class="c1"># Allow user specified fundamental</span>
</span><span id="Sound-805"><a href="#Sound-805"><span class="linenos">805</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fundamental</span> <span class="o">=</span> <span class="n">fundamental</span>
</span><span id="Sound-806"><a href="#Sound-806"><span class="linenos">806</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="Sound-807"><a href="#Sound-807"><span class="linenos">807</span></a>        <span class="c1"># create an empty signal attribute</span>
</span><span id="Sound-808"><a href="#Sound-808"><span class="linenos">808</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sound-809"><a href="#Sound-809"><span class="linenos">809</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trimmed_signal</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sound-810"><a href="#Sound-810"><span class="linenos">810</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bins</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sound-811"><a href="#Sound-811"><span class="linenos">811</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bass</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sound-812"><a href="#Sound-812"><span class="linenos">812</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mid</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sound-813"><a href="#Sound-813"><span class="linenos">813</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">highmid</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sound-814"><a href="#Sound-814"><span class="linenos">814</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">uppermid</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sound-815"><a href="#Sound-815"><span class="linenos">815</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">presence</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sound-816"><a href="#Sound-816"><span class="linenos">816</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">brillance</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sound-817"><a href="#Sound-817"><span class="linenos">817</span></a>
</span><span id="Sound-818"><a href="#Sound-818"><span class="linenos">818</span></a>        <span class="k">if</span> <span class="n">condition</span><span class="p">:</span>
</span><span id="Sound-819"><a href="#Sound-819"><span class="linenos">819</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Sound-820"><a href="#Sound-820"><span class="linenos">820</span></a>                           <span class="n">return_self</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Sound-821"><a href="#Sound-821"><span class="linenos">821</span></a>                           <span class="n">auto_trim</span><span class="o">=</span><span class="n">auto_trim</span><span class="p">,</span>
</span><span id="Sound-822"><a href="#Sound-822"><span class="linenos">822</span></a>                           <span class="n">resample</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Sound-823"><a href="#Sound-823"><span class="linenos">823</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Sound-824"><a href="#Sound-824"><span class="linenos">824</span></a>            <span class="k">if</span> <span class="n">use_raw_signal</span><span class="p">:</span>
</span><span id="Sound-825"><a href="#Sound-825"><span class="linenos">825</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">use_raw_signal</span><span class="p">(</span><span class="n">normalized</span><span class="o">=</span><span class="n">normalize_raw_signal</span><span class="p">,</span>
</span><span id="Sound-826"><a href="#Sound-826"><span class="linenos">826</span></a>                                    <span class="n">return_self</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Sound-827"><a href="#Sound-827"><span class="linenos">827</span></a>
</span><span id="Sound-828"><a href="#Sound-828"><span class="linenos">828</span></a>    <span class="k">def</span> <span class="nf">condition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_self</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">auto_trim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">resample</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Sound-829"><a href="#Sound-829"><span class="linenos">829</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Sound-830"><a href="#Sound-830"><span class="linenos">830</span></a><span class="sd">        A method conditioning the Sound instance.</span>
</span><span id="Sound-831"><a href="#Sound-831"><span class="linenos">831</span></a><span class="sd">        - Trimming to just before the onset</span>
</span><span id="Sound-832"><a href="#Sound-832"><span class="linenos">832</span></a><span class="sd">        :param verbose: if True problem with trimming are reported</span>
</span><span id="Sound-833"><a href="#Sound-833"><span class="linenos">833</span></a><span class="sd">        :param return_self: If True the method returns the conditioned Sound instance</span>
</span><span id="Sound-834"><a href="#Sound-834"><span class="linenos">834</span></a><span class="sd">        :param auto_trim: If True, the sound is trimmed to a fixed length according to its fundamental</span>
</span><span id="Sound-835"><a href="#Sound-835"><span class="linenos">835</span></a><span class="sd">        :param resample: If True, the signal is resampled to 22050 Hz</span>
</span><span id="Sound-836"><a href="#Sound-836"><span class="linenos">836</span></a><span class="sd">        :return: a conditioned Sound instance if `return_self = True`</span>
</span><span id="Sound-837"><a href="#Sound-837"><span class="linenos">837</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Sound-838"><a href="#Sound-838"><span class="linenos">838</span></a>        <span class="c1"># Resample only if the sample rate is not 22050</span>
</span><span id="Sound-839"><a href="#Sound-839"><span class="linenos">839</span></a>        <span class="k">if</span> <span class="n">resample</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_signal</span><span class="o">.</span><span class="n">sr</span> <span class="o">!=</span> <span class="mi">22050</span><span class="p">):</span>
</span><span id="Sound-840"><a href="#Sound-840"><span class="linenos">840</span></a>            <span class="n">signal</span><span class="p">,</span> <span class="n">sr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_signal</span><span class="o">.</span><span class="n">signal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_signal</span><span class="o">.</span><span class="n">sr</span>
</span><span id="Sound-841"><a href="#Sound-841"><span class="linenos">841</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">raw_signal</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="mi">22050</span><span class="p">),</span> <span class="mi">22050</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">)</span>
</span><span id="Sound-842"><a href="#Sound-842"><span class="linenos">842</span></a>
</span><span id="Sound-843"><a href="#Sound-843"><span class="linenos">843</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trim_signal</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="Sound-844"><a href="#Sound-844"><span class="linenos">844</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trimmed_signal</span>
</span><span id="Sound-845"><a href="#Sound-845"><span class="linenos">845</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fundamental</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Sound-846"><a href="#Sound-846"><span class="linenos">846</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fundamental</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fundamental</span><span class="p">()</span>
</span><span id="Sound-847"><a href="#Sound-847"><span class="linenos">847</span></a>        <span class="k">if</span> <span class="n">auto_trim</span><span class="p">:</span>
</span><span id="Sound-848"><a href="#Sound-848"><span class="linenos">848</span></a>            <span class="n">time</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">freq2trim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fundamental</span><span class="p">)</span>
</span><span id="Sound-849"><a href="#Sound-849"><span class="linenos">849</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">trim_time</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
</span><span id="Sound-850"><a href="#Sound-850"><span class="linenos">850</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">plot</span>
</span><span id="Sound-851"><a href="#Sound-851"><span class="linenos">851</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bin_divide</span><span class="p">()</span>
</span><span id="Sound-852"><a href="#Sound-852"><span class="linenos">852</span></a>        <span class="k">if</span> <span class="n">return_self</span><span class="p">:</span>
</span><span id="Sound-853"><a href="#Sound-853"><span class="linenos">853</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Sound-854"><a href="#Sound-854"><span class="linenos">854</span></a>
</span><span id="Sound-855"><a href="#Sound-855"><span class="linenos">855</span></a>    <span class="k">def</span> <span class="nf">use_raw_signal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_self</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Sound-856"><a href="#Sound-856"><span class="linenos">856</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Sound-857"><a href="#Sound-857"><span class="linenos">857</span></a><span class="sd">        Assigns the raw signal to the `signal` attribute of the Sound instance to</span>
</span><span id="Sound-858"><a href="#Sound-858"><span class="linenos">858</span></a><span class="sd">        analyze it</span>
</span><span id="Sound-859"><a href="#Sound-859"><span class="linenos">859</span></a><span class="sd">        :param normalized: if True, the raw signal is first normalized</span>
</span><span id="Sound-860"><a href="#Sound-860"><span class="linenos">860</span></a><span class="sd">        :param return_self: if True the Sound instance is return after the signal attribute is defined</span>
</span><span id="Sound-861"><a href="#Sound-861"><span class="linenos">861</span></a><span class="sd">        :return: None, self if return_self is True</span>
</span><span id="Sound-862"><a href="#Sound-862"><span class="linenos">862</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Sound-863"><a href="#Sound-863"><span class="linenos">863</span></a>        <span class="k">if</span> <span class="n">normalized</span><span class="p">:</span>
</span><span id="Sound-864"><a href="#Sound-864"><span class="linenos">864</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_signal</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
</span><span id="Sound-865"><a href="#Sound-865"><span class="linenos">865</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Sound-866"><a href="#Sound-866"><span class="linenos">866</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_signal</span>
</span><span id="Sound-867"><a href="#Sound-867"><span class="linenos">867</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bin_divide</span><span class="p">()</span>
</span><span id="Sound-868"><a href="#Sound-868"><span class="linenos">868</span></a>        <span class="k">if</span> <span class="n">return_self</span><span class="p">:</span>
</span><span id="Sound-869"><a href="#Sound-869"><span class="linenos">869</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Sound-870"><a href="#Sound-870"><span class="linenos">870</span></a>
</span><span id="Sound-871"><a href="#Sound-871"><span class="linenos">871</span></a>    <span class="k">def</span> <span class="nf">bin_divide</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Sound-872"><a href="#Sound-872"><span class="linenos">872</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Sound-873"><a href="#Sound-873"><span class="linenos">873</span></a><span class="sd">        Calls the `.make_freq_bins` method of the signal to create the signals associated</span>
</span><span id="Sound-874"><a href="#Sound-874"><span class="linenos">874</span></a><span class="sd">        to the frequency bins. The bins are all stored in the `.bin` attribute and also as</span>
</span><span id="Sound-875"><a href="#Sound-875"><span class="linenos">875</span></a><span class="sd">        their names (Ex: `Sound.mid` contains the mid signal).</span>
</span><span id="Sound-876"><a href="#Sound-876"><span class="linenos">876</span></a><span class="sd">        :return: None</span>
</span><span id="Sound-877"><a href="#Sound-877"><span class="linenos">877</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Sound-878"><a href="#Sound-878"><span class="linenos">878</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; a method to divide the main signal into frequency bins&quot;&quot;&quot;</span>
</span><span id="Sound-879"><a href="#Sound-879"><span class="linenos">879</span></a>        <span class="c1"># divide in frequency bins</span>
</span><span id="Sound-880"><a href="#Sound-880"><span class="linenos">880</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">make_freq_bins</span><span class="p">()</span>
</span><span id="Sound-881"><a href="#Sound-881"><span class="linenos">881</span></a>        <span class="c1"># unpack the bins</span>
</span><span id="Sound-882"><a href="#Sound-882"><span class="linenos">882</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bass</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">highmid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">uppermid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">presence</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">brillance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="Sound-883"><a href="#Sound-883"><span class="linenos">883</span></a>
</span><span id="Sound-884"><a href="#Sound-884"><span class="linenos">884</span></a>    <span class="k">def</span> <span class="nf">trim_signal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Sound-885"><a href="#Sound-885"><span class="linenos">885</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Sound-886"><a href="#Sound-886"><span class="linenos">886</span></a><span class="sd">        A method to trim the signal to a specific time before the onset. The time value</span>
</span><span id="Sound-887"><a href="#Sound-887"><span class="linenos">887</span></a><span class="sd">        can be changed in the SoundParameters.</span>
</span><span id="Sound-888"><a href="#Sound-888"><span class="linenos">888</span></a><span class="sd">        :param verbose: if True problems encountered are printed to the terminal</span>
</span><span id="Sound-889"><a href="#Sound-889"><span class="linenos">889</span></a><span class="sd">        :return: None</span>
</span><span id="Sound-890"><a href="#Sound-890"><span class="linenos">890</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Sound-891"><a href="#Sound-891"><span class="linenos">891</span></a>        <span class="c1"># Trim the signal in the signal class</span>
</span><span id="Sound-892"><a href="#Sound-892"><span class="linenos">892</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trimmed_signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_signal</span><span class="o">.</span><span class="n">trim_onset</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="Sound-893"><a href="#Sound-893"><span class="linenos">893</span></a>
</span><span id="Sound-894"><a href="#Sound-894"><span class="linenos">894</span></a>    <span class="k">def</span> <span class="nf">listen_freq_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Sound-895"><a href="#Sound-895"><span class="linenos">895</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Sound-896"><a href="#Sound-896"><span class="linenos">896</span></a><span class="sd">        Method to listen to all the frequency bins of a sound</span>
</span><span id="Sound-897"><a href="#Sound-897"><span class="linenos">897</span></a>
</span><span id="Sound-898"><a href="#Sound-898"><span class="linenos">898</span></a><span class="sd">        The bins signals are obtained by filtering the sound signal</span>
</span><span id="Sound-899"><a href="#Sound-899"><span class="linenos">899</span></a><span class="sd">        with band pass filters.</span>
</span><span id="Sound-900"><a href="#Sound-900"><span class="linenos">900</span></a>
</span><span id="Sound-901"><a href="#Sound-901"><span class="linenos">901</span></a><span class="sd">        See guitarsounds.parameters.sound_parameters().bins.info() for the</span>
</span><span id="Sound-902"><a href="#Sound-902"><span class="linenos">902</span></a><span class="sd">        frequency bin intervals.</span>
</span><span id="Sound-903"><a href="#Sound-903"><span class="linenos">903</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Sound-904"><a href="#Sound-904"><span class="linenos">904</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Sound-905"><a href="#Sound-905"><span class="linenos">905</span></a>            <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="Sound-906"><a href="#Sound-906"><span class="linenos">906</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">listen</span><span class="p">()</span>
</span><span id="Sound-907"><a href="#Sound-907"><span class="linenos">907</span></a>
</span><span id="Sound-908"><a href="#Sound-908"><span class="linenos">908</span></a>    <span class="k">def</span> <span class="nf">plot_freq_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">):</span>
</span><span id="Sound-909"><a href="#Sound-909"><span class="linenos">909</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Sound-910"><a href="#Sound-910"><span class="linenos">910</span></a><span class="sd">        Method to plot all the frequency bins logarithmic envelopes of a sound</span>
</span><span id="Sound-911"><a href="#Sound-911"><span class="linenos">911</span></a>
</span><span id="Sound-912"><a href="#Sound-912"><span class="linenos">912</span></a><span class="sd">        The parameter `bins` allows choosing specific frequency bins to plot</span>
</span><span id="Sound-913"><a href="#Sound-913"><span class="linenos">913</span></a><span class="sd">        By default the function plots all the bins</span>
</span><span id="Sound-914"><a href="#Sound-914"><span class="linenos">914</span></a><span class="sd">        Supported bins arguments are :</span>
</span><span id="Sound-915"><a href="#Sound-915"><span class="linenos">915</span></a><span class="sd">        &#39;all&#39;, &#39;bass&#39;, &#39;mid&#39;, &#39;highmid&#39;, &#39;uppermid&#39;, &#39;presence&#39;, &#39;brillance&#39;</span>
</span><span id="Sound-916"><a href="#Sound-916"><span class="linenos">916</span></a>
</span><span id="Sound-917"><a href="#Sound-917"><span class="linenos">917</span></a><span class="sd">        Example :</span>
</span><span id="Sound-918"><a href="#Sound-918"><span class="linenos">918</span></a><span class="sd">        `Sound.plot_freq_bins(bins=&#39;all&#39;)` plots all the frequency bins</span>
</span><span id="Sound-919"><a href="#Sound-919"><span class="linenos">919</span></a><span class="sd">        `Sound.plot_freq_bins(bins=[&#39;bass&#39;, &#39;mid&#39;])` plots the bass and mid bins</span>
</span><span id="Sound-920"><a href="#Sound-920"><span class="linenos">920</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Sound-921"><a href="#Sound-921"><span class="linenos">921</span></a>
</span><span id="Sound-922"><a href="#Sound-922"><span class="linenos">922</span></a>        <span class="k">if</span> <span class="n">bins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
</span><span id="Sound-923"><a href="#Sound-923"><span class="linenos">923</span></a>            <span class="n">bins</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span>
</span><span id="Sound-924"><a href="#Sound-924"><span class="linenos">924</span></a>
</span><span id="Sound-925"><a href="#Sound-925"><span class="linenos">925</span></a>        <span class="k">if</span> <span class="n">bins</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
</span><span id="Sound-926"><a href="#Sound-926"><span class="linenos">926</span></a>            <span class="n">bins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="Sound-927"><a href="#Sound-927"><span class="linenos">927</span></a>
</span><span id="Sound-928"><a href="#Sound-928"><span class="linenos">928</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">bins</span><span class="p">:</span>
</span><span id="Sound-929"><a href="#Sound-929"><span class="linenos">929</span></a>            <span class="n">lab</span> <span class="o">=</span> <span class="n">key</span> <span class="o">+</span> <span class="s1">&#39; : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; Hz&#39;</span>
</span><span id="Sound-930"><a href="#Sound-930"><span class="linenos">930</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">old_plot</span><span class="p">(</span><span class="s1">&#39;log envelope&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">lab</span><span class="p">)</span>
</span><span id="Sound-931"><a href="#Sound-931"><span class="linenos">931</span></a>
</span><span id="Sound-932"><a href="#Sound-932"><span class="linenos">932</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="Sound-933"><a href="#Sound-933"><span class="linenos">933</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="Sound-934"><a href="#Sound-934"><span class="linenos">934</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;x-small&quot;</span><span class="p">)</span>  <span class="c1"># using a named size</span>
</span><span id="Sound-935"><a href="#Sound-935"><span class="linenos">935</span></a>
</span><span id="Sound-936"><a href="#Sound-936"><span class="linenos">936</span></a>    <span class="k">def</span> <span class="nf">peak_damping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Sound-937"><a href="#Sound-937"><span class="linenos">937</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Sound-938"><a href="#Sound-938"><span class="linenos">938</span></a><span class="sd">        Prints a table with peak damping values and peak frequency values</span>
</span><span id="Sound-939"><a href="#Sound-939"><span class="linenos">939</span></a>
</span><span id="Sound-940"><a href="#Sound-940"><span class="linenos">940</span></a><span class="sd">        The peaks are found with the `signal.peaks()` function and the damping</span>
</span><span id="Sound-941"><a href="#Sound-941"><span class="linenos">941</span></a><span class="sd">        values are computed with the half power bandwidth method.</span>
</span><span id="Sound-942"><a href="#Sound-942"><span class="linenos">942</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Sound-943"><a href="#Sound-943"><span class="linenos">943</span></a>        <span class="n">peak_indexes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">peaks</span><span class="p">()</span>
</span><span id="Sound-944"><a href="#Sound-944"><span class="linenos">944</span></a>        <span class="n">frequencies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[</span><span class="n">peak_indexes</span><span class="p">]</span>
</span><span id="Sound-945"><a href="#Sound-945"><span class="linenos">945</span></a>        <span class="n">damping</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">peak_damping</span><span class="p">()</span>
</span><span id="Sound-946"><a href="#Sound-946"><span class="linenos">946</span></a>        <span class="n">table_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">damping</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</span><span id="Sound-947"><a href="#Sound-947"><span class="linenos">947</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table_data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">,</span> <span class="s1">&#39;Damping ratio (%)&#39;</span><span class="p">]))</span>
</span><span id="Sound-948"><a href="#Sound-948"><span class="linenos">948</span></a>
</span><span id="Sound-949"><a href="#Sound-949"><span class="linenos">949</span></a>    <span class="k">def</span> <span class="nf">bin_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Sound-950"><a href="#Sound-950"><span class="linenos">950</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Sound-951"><a href="#Sound-951"><span class="linenos">951</span></a><span class="sd">        Histogram of the frequency bin power</span>
</span><span id="Sound-952"><a href="#Sound-952"><span class="linenos">952</span></a>
</span><span id="Sound-953"><a href="#Sound-953"><span class="linenos">953</span></a><span class="sd">        frequency bin power is computed as the integral of the bin envelope.</span>
</span><span id="Sound-954"><a href="#Sound-954"><span class="linenos">954</span></a><span class="sd">        See guitarsounds.parameters.sound_parameters().bins.info() for the</span>
</span><span id="Sound-955"><a href="#Sound-955"><span class="linenos">955</span></a><span class="sd">        frequency bin intervals.</span>
</span><span id="Sound-956"><a href="#Sound-956"><span class="linenos">956</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Sound-957"><a href="#Sound-957"><span class="linenos">957</span></a>        <span class="c1"># Compute the bin powers</span>
</span><span id="Sound-958"><a href="#Sound-958"><span class="linenos">958</span></a>        <span class="n">bin_strings</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="Sound-959"><a href="#Sound-959"><span class="linenos">959</span></a>        <span class="n">integrals</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Sound-960"><a href="#Sound-960"><span class="linenos">960</span></a>
</span><span id="Sound-961"><a href="#Sound-961"><span class="linenos">961</span></a>        <span class="k">for</span> <span class="n">f_bin</span> <span class="ow">in</span> <span class="n">bin_strings</span><span class="p">:</span>
</span><span id="Sound-962"><a href="#Sound-962"><span class="linenos">962</span></a>            <span class="n">log_envelope</span><span class="p">,</span> <span class="n">log_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="Sound-963"><a href="#Sound-963"><span class="linenos">963</span></a>            <span class="n">integral</span> <span class="o">=</span> <span class="n">trapezoid</span><span class="p">(</span><span class="n">log_envelope</span><span class="p">,</span> <span class="n">log_time</span><span class="p">)</span>
</span><span id="Sound-964"><a href="#Sound-964"><span class="linenos">964</span></a>            <span class="n">integrals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span>
</span><span id="Sound-965"><a href="#Sound-965"><span class="linenos">965</span></a>        <span class="n">max_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">integrals</span><span class="p">)</span>
</span><span id="Sound-966"><a href="#Sound-966"><span class="linenos">966</span></a>        <span class="n">integrals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">integrals</span><span class="p">)</span><span class="o">/</span><span class="n">max_value</span>
</span><span id="Sound-967"><a href="#Sound-967"><span class="linenos">967</span></a>
</span><span id="Sound-968"><a href="#Sound-968"><span class="linenos">968</span></a>        <span class="c1"># create the bar plotting vectors</span>
</span><span id="Sound-969"><a href="#Sound-969"><span class="linenos">969</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Sound-970"><a href="#Sound-970"><span class="linenos">970</span></a>
</span><span id="Sound-971"><a href="#Sound-971"><span class="linenos">971</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">bin_strings</span><span class="p">))</span>
</span><span id="Sound-972"><a href="#Sound-972"><span class="linenos">972</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">integrals</span>
</span><span id="Sound-973"><a href="#Sound-973"><span class="linenos">973</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">tick_label</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">bin_strings</span><span class="p">))</span>
</span><span id="Sound-974"><a href="#Sound-974"><span class="linenos">974</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;frequency bin name&quot;</span><span class="p">)</span>
</span><span id="Sound-975"><a href="#Sound-975"><span class="linenos">975</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;frequency bin power (normalized)&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>A class to store audio signals obtained from a sound and compare them</p>
</div>


                            <div id="Sound.__init__" class="classattr">
                                        <input id="Sound.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Sound</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data</span>,</span><span class="param">	<span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">condition</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">auto_trim</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">use_raw_signal</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">normalize_raw_signal</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">fundamental</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">SoundParams</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Sound.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Sound.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Sound.__init__-758"><a href="#Sound.__init__-758"><span class="linenos">758</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">condition</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">auto_trim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Sound.__init__-759"><a href="#Sound.__init__-759"><span class="linenos">759</span></a>                 <span class="n">use_raw_signal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">normalize_raw_signal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
</span><span id="Sound.__init__-760"><a href="#Sound.__init__-760"><span class="linenos">760</span></a>                 <span class="n">fundamental</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">SoundParams</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Sound.__init__-761"><a href="#Sound.__init__-761"><span class="linenos">761</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Sound.__init__-762"><a href="#Sound.__init__-762"><span class="linenos">762</span></a><span class="sd">        Creates a Sound instance from a .wav file, name as a string and </span>
</span><span id="Sound.__init__-763"><a href="#Sound.__init__-763"><span class="linenos">763</span></a><span class="sd">        fundamental frequency value can be user specified.</span>
</span><span id="Sound.__init__-764"><a href="#Sound.__init__-764"><span class="linenos">764</span></a>
</span><span id="Sound.__init__-765"><a href="#Sound.__init__-765"><span class="linenos">765</span></a><span class="sd">        :param data: data path to the .wav data</span>
</span><span id="Sound.__init__-766"><a href="#Sound.__init__-766"><span class="linenos">766</span></a><span class="sd">        :param name: Sound instance name to use in plot legend and titles</span>
</span><span id="Sound.__init__-767"><a href="#Sound.__init__-767"><span class="linenos">767</span></a><span class="sd">        :param condition: Bool, whether to condition or not the Sound instance </span>
</span><span id="Sound.__init__-768"><a href="#Sound.__init__-768"><span class="linenos">768</span></a><span class="sd">        if `True`, the `Sound` instance is conditioned in the constructor</span>
</span><span id="Sound.__init__-769"><a href="#Sound.__init__-769"><span class="linenos">769</span></a><span class="sd">        :param auto_trim: Bool, whether to trim the end of the sound or not </span>
</span><span id="Sound.__init__-770"><a href="#Sound.__init__-770"><span class="linenos">770</span></a><span class="sd">        according to predefined sound length correlated to the fundamental.</span>
</span><span id="Sound.__init__-771"><a href="#Sound.__init__-771"><span class="linenos">771</span></a><span class="sd">        :param use_raw_signal: Do not condition the `Sound` and instead </span>
</span><span id="Sound.__init__-772"><a href="#Sound.__init__-772"><span class="linenos">772</span></a><span class="sd">        use the raw signal</span>
</span><span id="Sound.__init__-773"><a href="#Sound.__init__-773"><span class="linenos">773</span></a><span class="sd">        :param normalize_raw_signal: If `use_raw_signal` is `True`, setting </span>
</span><span id="Sound.__init__-774"><a href="#Sound.__init__-774"><span class="linenos">774</span></a><span class="sd">        `normalize_raw_signal` to `True` will normalize the raw signal before it</span>
</span><span id="Sound.__init__-775"><a href="#Sound.__init__-775"><span class="linenos">775</span></a><span class="sd">        is used in the `Sound` class</span>
</span><span id="Sound.__init__-776"><a href="#Sound.__init__-776"><span class="linenos">776</span></a><span class="sd">        :param fundamental: Fundamental frequency value if None the value is </span>
</span><span id="Sound.__init__-777"><a href="#Sound.__init__-777"><span class="linenos">777</span></a><span class="sd">        estimated</span>
</span><span id="Sound.__init__-778"><a href="#Sound.__init__-778"><span class="linenos">778</span></a><span class="sd">        from the FFT (see `Signal.fundamental`).</span>
</span><span id="Sound.__init__-779"><a href="#Sound.__init__-779"><span class="linenos">779</span></a><span class="sd">        :param SoundParams: SoundParameters to use in the Sound instance</span>
</span><span id="Sound.__init__-780"><a href="#Sound.__init__-780"><span class="linenos">780</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Sound.__init__-781"><a href="#Sound.__init__-781"><span class="linenos">781</span></a>        <span class="c1"># create a reference of the parameters</span>
</span><span id="Sound.__init__-782"><a href="#Sound.__init__-782"><span class="linenos">782</span></a>        <span class="k">if</span> <span class="n">SoundParams</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Sound.__init__-783"><a href="#Sound.__init__-783"><span class="linenos">783</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">SP</span> <span class="o">=</span> <span class="n">sound_parameters</span><span class="p">()</span>
</span><span id="Sound.__init__-784"><a href="#Sound.__init__-784"><span class="linenos">784</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Sound.__init__-785"><a href="#Sound.__init__-785"><span class="linenos">785</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">SP</span> <span class="o">=</span> <span class="n">SoundParams</span>
</span><span id="Sound.__init__-786"><a href="#Sound.__init__-786"><span class="linenos">786</span></a>
</span><span id="Sound.__init__-787"><a href="#Sound.__init__-787"><span class="linenos">787</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Sound.__init__-788"><a href="#Sound.__init__-788"><span class="linenos">788</span></a>            <span class="c1"># Load the sound data using librosa</span>
</span><span id="Sound.__init__-789"><a href="#Sound.__init__-789"><span class="linenos">789</span></a>            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;wav&#39;</span><span class="p">:</span>
</span><span id="Sound.__init__-790"><a href="#Sound.__init__-790"><span class="linenos">790</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Only .wav are supported&#39;</span><span class="p">)</span>
</span><span id="Sound.__init__-791"><a href="#Sound.__init__-791"><span class="linenos">791</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Sound.__init__-792"><a href="#Sound.__init__-792"><span class="linenos">792</span></a>                <span class="n">signal</span><span class="p">,</span> <span class="n">sr</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">load_wav</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="Sound.__init__-793"><a href="#Sound.__init__-793"><span class="linenos">793</span></a>
</span><span id="Sound.__init__-794"><a href="#Sound.__init__-794"><span class="linenos">794</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="Sound.__init__-795"><a href="#Sound.__init__-795"><span class="linenos">795</span></a>            <span class="n">signal</span><span class="p">,</span> <span class="n">sr</span> <span class="o">=</span> <span class="n">data</span>
</span><span id="Sound.__init__-796"><a href="#Sound.__init__-796"><span class="linenos">796</span></a>
</span><span id="Sound.__init__-797"><a href="#Sound.__init__-797"><span class="linenos">797</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Sound.__init__-798"><a href="#Sound.__init__-798"><span class="linenos">798</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span>
</span><span id="Sound.__init__-799"><a href="#Sound.__init__-799"><span class="linenos">799</span></a>
</span><span id="Sound.__init__-800"><a href="#Sound.__init__-800"><span class="linenos">800</span></a>        <span class="c1"># create a Signal class from the signal and sample rate</span>
</span><span id="Sound.__init__-801"><a href="#Sound.__init__-801"><span class="linenos">801</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">raw_signal</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">)</span>
</span><span id="Sound.__init__-802"><a href="#Sound.__init__-802"><span class="linenos">802</span></a>        <span class="c1"># create an empty plot attribute</span>
</span><span id="Sound.__init__-803"><a href="#Sound.__init__-803"><span class="linenos">803</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sound.__init__-804"><a href="#Sound.__init__-804"><span class="linenos">804</span></a>        <span class="c1"># Allow user specified fundamental</span>
</span><span id="Sound.__init__-805"><a href="#Sound.__init__-805"><span class="linenos">805</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fundamental</span> <span class="o">=</span> <span class="n">fundamental</span>
</span><span id="Sound.__init__-806"><a href="#Sound.__init__-806"><span class="linenos">806</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="Sound.__init__-807"><a href="#Sound.__init__-807"><span class="linenos">807</span></a>        <span class="c1"># create an empty signal attribute</span>
</span><span id="Sound.__init__-808"><a href="#Sound.__init__-808"><span class="linenos">808</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sound.__init__-809"><a href="#Sound.__init__-809"><span class="linenos">809</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trimmed_signal</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sound.__init__-810"><a href="#Sound.__init__-810"><span class="linenos">810</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bins</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sound.__init__-811"><a href="#Sound.__init__-811"><span class="linenos">811</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bass</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sound.__init__-812"><a href="#Sound.__init__-812"><span class="linenos">812</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mid</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sound.__init__-813"><a href="#Sound.__init__-813"><span class="linenos">813</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">highmid</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sound.__init__-814"><a href="#Sound.__init__-814"><span class="linenos">814</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">uppermid</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sound.__init__-815"><a href="#Sound.__init__-815"><span class="linenos">815</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">presence</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sound.__init__-816"><a href="#Sound.__init__-816"><span class="linenos">816</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">brillance</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Sound.__init__-817"><a href="#Sound.__init__-817"><span class="linenos">817</span></a>
</span><span id="Sound.__init__-818"><a href="#Sound.__init__-818"><span class="linenos">818</span></a>        <span class="k">if</span> <span class="n">condition</span><span class="p">:</span>
</span><span id="Sound.__init__-819"><a href="#Sound.__init__-819"><span class="linenos">819</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Sound.__init__-820"><a href="#Sound.__init__-820"><span class="linenos">820</span></a>                           <span class="n">return_self</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Sound.__init__-821"><a href="#Sound.__init__-821"><span class="linenos">821</span></a>                           <span class="n">auto_trim</span><span class="o">=</span><span class="n">auto_trim</span><span class="p">,</span>
</span><span id="Sound.__init__-822"><a href="#Sound.__init__-822"><span class="linenos">822</span></a>                           <span class="n">resample</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Sound.__init__-823"><a href="#Sound.__init__-823"><span class="linenos">823</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Sound.__init__-824"><a href="#Sound.__init__-824"><span class="linenos">824</span></a>            <span class="k">if</span> <span class="n">use_raw_signal</span><span class="p">:</span>
</span><span id="Sound.__init__-825"><a href="#Sound.__init__-825"><span class="linenos">825</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">use_raw_signal</span><span class="p">(</span><span class="n">normalized</span><span class="o">=</span><span class="n">normalize_raw_signal</span><span class="p">,</span>
</span><span id="Sound.__init__-826"><a href="#Sound.__init__-826"><span class="linenos">826</span></a>                                    <span class="n">return_self</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Creates a Sound instance from a .wav file, name as a string and 
fundamental frequency value can be user specified.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>data</strong>:  data path to the .wav data</li>
<li><strong>name</strong>:  Sound instance name to use in plot legend and titles</li>
<li><strong>condition</strong>:  Bool, whether to condition or not the Sound instance 
if <code>True</code>, the <code><a href="#Sound">Sound</a></code> instance is conditioned in the constructor</li>
<li><strong>auto_trim</strong>:  Bool, whether to trim the end of the sound or not 
according to predefined sound length correlated to the fundamental.</li>
<li><strong>use_raw_signal</strong>:  Do not condition the <code><a href="#Sound">Sound</a></code> and instead 
use the raw signal</li>
<li><strong>normalize_raw_signal</strong>:  If <code><a href="#Sound.use_raw_signal">use_raw_signal</a></code> is <code>True</code>, setting 
<code>normalize_raw_signal</code> to <code>True</code> will normalize the raw signal before it
is used in the <code><a href="#Sound">Sound</a></code> class</li>
<li><strong>fundamental</strong>:  Fundamental frequency value if None the value is 
estimated
from the FFT (see <code><a href="#Signal.fundamental">Signal.fundamental</a></code>).</li>
<li><strong>SoundParams</strong>:  SoundParameters to use in the Sound instance</li>
</ul>
</div>


                            </div>
                            <div id="Sound.condition" class="classattr">
                                        <input id="Sound.condition-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">condition</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">return_self</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">auto_trim</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">resample</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Sound.condition-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Sound.condition"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Sound.condition-828"><a href="#Sound.condition-828"><span class="linenos">828</span></a>    <span class="k">def</span> <span class="nf">condition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_self</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">auto_trim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">resample</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Sound.condition-829"><a href="#Sound.condition-829"><span class="linenos">829</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Sound.condition-830"><a href="#Sound.condition-830"><span class="linenos">830</span></a><span class="sd">        A method conditioning the Sound instance.</span>
</span><span id="Sound.condition-831"><a href="#Sound.condition-831"><span class="linenos">831</span></a><span class="sd">        - Trimming to just before the onset</span>
</span><span id="Sound.condition-832"><a href="#Sound.condition-832"><span class="linenos">832</span></a><span class="sd">        :param verbose: if True problem with trimming are reported</span>
</span><span id="Sound.condition-833"><a href="#Sound.condition-833"><span class="linenos">833</span></a><span class="sd">        :param return_self: If True the method returns the conditioned Sound instance</span>
</span><span id="Sound.condition-834"><a href="#Sound.condition-834"><span class="linenos">834</span></a><span class="sd">        :param auto_trim: If True, the sound is trimmed to a fixed length according to its fundamental</span>
</span><span id="Sound.condition-835"><a href="#Sound.condition-835"><span class="linenos">835</span></a><span class="sd">        :param resample: If True, the signal is resampled to 22050 Hz</span>
</span><span id="Sound.condition-836"><a href="#Sound.condition-836"><span class="linenos">836</span></a><span class="sd">        :return: a conditioned Sound instance if `return_self = True`</span>
</span><span id="Sound.condition-837"><a href="#Sound.condition-837"><span class="linenos">837</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Sound.condition-838"><a href="#Sound.condition-838"><span class="linenos">838</span></a>        <span class="c1"># Resample only if the sample rate is not 22050</span>
</span><span id="Sound.condition-839"><a href="#Sound.condition-839"><span class="linenos">839</span></a>        <span class="k">if</span> <span class="n">resample</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_signal</span><span class="o">.</span><span class="n">sr</span> <span class="o">!=</span> <span class="mi">22050</span><span class="p">):</span>
</span><span id="Sound.condition-840"><a href="#Sound.condition-840"><span class="linenos">840</span></a>            <span class="n">signal</span><span class="p">,</span> <span class="n">sr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_signal</span><span class="o">.</span><span class="n">signal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_signal</span><span class="o">.</span><span class="n">sr</span>
</span><span id="Sound.condition-841"><a href="#Sound.condition-841"><span class="linenos">841</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">raw_signal</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="mi">22050</span><span class="p">),</span> <span class="mi">22050</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">)</span>
</span><span id="Sound.condition-842"><a href="#Sound.condition-842"><span class="linenos">842</span></a>
</span><span id="Sound.condition-843"><a href="#Sound.condition-843"><span class="linenos">843</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trim_signal</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="Sound.condition-844"><a href="#Sound.condition-844"><span class="linenos">844</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trimmed_signal</span>
</span><span id="Sound.condition-845"><a href="#Sound.condition-845"><span class="linenos">845</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fundamental</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Sound.condition-846"><a href="#Sound.condition-846"><span class="linenos">846</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fundamental</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fundamental</span><span class="p">()</span>
</span><span id="Sound.condition-847"><a href="#Sound.condition-847"><span class="linenos">847</span></a>        <span class="k">if</span> <span class="n">auto_trim</span><span class="p">:</span>
</span><span id="Sound.condition-848"><a href="#Sound.condition-848"><span class="linenos">848</span></a>            <span class="n">time</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">freq2trim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fundamental</span><span class="p">)</span>
</span><span id="Sound.condition-849"><a href="#Sound.condition-849"><span class="linenos">849</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">trim_time</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
</span><span id="Sound.condition-850"><a href="#Sound.condition-850"><span class="linenos">850</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">plot</span>
</span><span id="Sound.condition-851"><a href="#Sound.condition-851"><span class="linenos">851</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bin_divide</span><span class="p">()</span>
</span><span id="Sound.condition-852"><a href="#Sound.condition-852"><span class="linenos">852</span></a>        <span class="k">if</span> <span class="n">return_self</span><span class="p">:</span>
</span><span id="Sound.condition-853"><a href="#Sound.condition-853"><span class="linenos">853</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>A method conditioning the Sound instance.</p>

<ul>
<li>Trimming to just before the onset</li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>verbose</strong>:  if True problem with trimming are reported</li>
<li><strong>return_self</strong>:  If True the method returns the conditioned Sound instance</li>
<li><strong>auto_trim</strong>:  If True, the sound is trimmed to a fixed length according to its fundamental</li>
<li><strong>resample</strong>:  If True, the signal is resampled to 22050 Hz</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>a conditioned Sound instance if <code>return_self = True</code></p>
</blockquote>
</div>


                            </div>
                            <div id="Sound.use_raw_signal" class="classattr">
                                        <input id="Sound.use_raw_signal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">use_raw_signal</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">normalized</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="n">return_self</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Sound.use_raw_signal-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Sound.use_raw_signal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Sound.use_raw_signal-855"><a href="#Sound.use_raw_signal-855"><span class="linenos">855</span></a>    <span class="k">def</span> <span class="nf">use_raw_signal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_self</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Sound.use_raw_signal-856"><a href="#Sound.use_raw_signal-856"><span class="linenos">856</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Sound.use_raw_signal-857"><a href="#Sound.use_raw_signal-857"><span class="linenos">857</span></a><span class="sd">        Assigns the raw signal to the `signal` attribute of the Sound instance to</span>
</span><span id="Sound.use_raw_signal-858"><a href="#Sound.use_raw_signal-858"><span class="linenos">858</span></a><span class="sd">        analyze it</span>
</span><span id="Sound.use_raw_signal-859"><a href="#Sound.use_raw_signal-859"><span class="linenos">859</span></a><span class="sd">        :param normalized: if True, the raw signal is first normalized</span>
</span><span id="Sound.use_raw_signal-860"><a href="#Sound.use_raw_signal-860"><span class="linenos">860</span></a><span class="sd">        :param return_self: if True the Sound instance is return after the signal attribute is defined</span>
</span><span id="Sound.use_raw_signal-861"><a href="#Sound.use_raw_signal-861"><span class="linenos">861</span></a><span class="sd">        :return: None, self if return_self is True</span>
</span><span id="Sound.use_raw_signal-862"><a href="#Sound.use_raw_signal-862"><span class="linenos">862</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Sound.use_raw_signal-863"><a href="#Sound.use_raw_signal-863"><span class="linenos">863</span></a>        <span class="k">if</span> <span class="n">normalized</span><span class="p">:</span>
</span><span id="Sound.use_raw_signal-864"><a href="#Sound.use_raw_signal-864"><span class="linenos">864</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_signal</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
</span><span id="Sound.use_raw_signal-865"><a href="#Sound.use_raw_signal-865"><span class="linenos">865</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Sound.use_raw_signal-866"><a href="#Sound.use_raw_signal-866"><span class="linenos">866</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_signal</span>
</span><span id="Sound.use_raw_signal-867"><a href="#Sound.use_raw_signal-867"><span class="linenos">867</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bin_divide</span><span class="p">()</span>
</span><span id="Sound.use_raw_signal-868"><a href="#Sound.use_raw_signal-868"><span class="linenos">868</span></a>        <span class="k">if</span> <span class="n">return_self</span><span class="p">:</span>
</span><span id="Sound.use_raw_signal-869"><a href="#Sound.use_raw_signal-869"><span class="linenos">869</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Assigns the raw signal to the <code>signal</code> attribute of the Sound instance to
analyze it</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>normalized</strong>:  if True, the raw signal is first normalized</li>
<li><strong>return_self</strong>:  if True the Sound instance is return after the signal attribute is defined</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None, self if return_self is True</p>
</blockquote>
</div>


                            </div>
                            <div id="Sound.bin_divide" class="classattr">
                                        <input id="Sound.bin_divide-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">bin_divide</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Sound.bin_divide-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Sound.bin_divide"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Sound.bin_divide-871"><a href="#Sound.bin_divide-871"><span class="linenos">871</span></a>    <span class="k">def</span> <span class="nf">bin_divide</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Sound.bin_divide-872"><a href="#Sound.bin_divide-872"><span class="linenos">872</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Sound.bin_divide-873"><a href="#Sound.bin_divide-873"><span class="linenos">873</span></a><span class="sd">        Calls the `.make_freq_bins` method of the signal to create the signals associated</span>
</span><span id="Sound.bin_divide-874"><a href="#Sound.bin_divide-874"><span class="linenos">874</span></a><span class="sd">        to the frequency bins. The bins are all stored in the `.bin` attribute and also as</span>
</span><span id="Sound.bin_divide-875"><a href="#Sound.bin_divide-875"><span class="linenos">875</span></a><span class="sd">        their names (Ex: `Sound.mid` contains the mid signal).</span>
</span><span id="Sound.bin_divide-876"><a href="#Sound.bin_divide-876"><span class="linenos">876</span></a><span class="sd">        :return: None</span>
</span><span id="Sound.bin_divide-877"><a href="#Sound.bin_divide-877"><span class="linenos">877</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Sound.bin_divide-878"><a href="#Sound.bin_divide-878"><span class="linenos">878</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; a method to divide the main signal into frequency bins&quot;&quot;&quot;</span>
</span><span id="Sound.bin_divide-879"><a href="#Sound.bin_divide-879"><span class="linenos">879</span></a>        <span class="c1"># divide in frequency bins</span>
</span><span id="Sound.bin_divide-880"><a href="#Sound.bin_divide-880"><span class="linenos">880</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">make_freq_bins</span><span class="p">()</span>
</span><span id="Sound.bin_divide-881"><a href="#Sound.bin_divide-881"><span class="linenos">881</span></a>        <span class="c1"># unpack the bins</span>
</span><span id="Sound.bin_divide-882"><a href="#Sound.bin_divide-882"><span class="linenos">882</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bass</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">highmid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">uppermid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">presence</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">brillance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Calls the <code>.make_freq_bins</code> method of the signal to create the signals associated
to the frequency bins. The bins are all stored in the <code>.bin</code> attribute and also as
their names (Ex: <code>Sound.mid</code> contains the mid signal).</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="Sound.trim_signal" class="classattr">
                                        <input id="Sound.trim_signal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">trim_signal</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Sound.trim_signal-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Sound.trim_signal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Sound.trim_signal-884"><a href="#Sound.trim_signal-884"><span class="linenos">884</span></a>    <span class="k">def</span> <span class="nf">trim_signal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Sound.trim_signal-885"><a href="#Sound.trim_signal-885"><span class="linenos">885</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Sound.trim_signal-886"><a href="#Sound.trim_signal-886"><span class="linenos">886</span></a><span class="sd">        A method to trim the signal to a specific time before the onset. The time value</span>
</span><span id="Sound.trim_signal-887"><a href="#Sound.trim_signal-887"><span class="linenos">887</span></a><span class="sd">        can be changed in the SoundParameters.</span>
</span><span id="Sound.trim_signal-888"><a href="#Sound.trim_signal-888"><span class="linenos">888</span></a><span class="sd">        :param verbose: if True problems encountered are printed to the terminal</span>
</span><span id="Sound.trim_signal-889"><a href="#Sound.trim_signal-889"><span class="linenos">889</span></a><span class="sd">        :return: None</span>
</span><span id="Sound.trim_signal-890"><a href="#Sound.trim_signal-890"><span class="linenos">890</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Sound.trim_signal-891"><a href="#Sound.trim_signal-891"><span class="linenos">891</span></a>        <span class="c1"># Trim the signal in the signal class</span>
</span><span id="Sound.trim_signal-892"><a href="#Sound.trim_signal-892"><span class="linenos">892</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trimmed_signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_signal</span><span class="o">.</span><span class="n">trim_onset</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>A method to trim the signal to a specific time before the onset. The time value
can be changed in the SoundParameters.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>verbose</strong>:  if True problems encountered are printed to the terminal</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="Sound.listen_freq_bins" class="classattr">
                                        <input id="Sound.listen_freq_bins-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">listen_freq_bins</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Sound.listen_freq_bins-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Sound.listen_freq_bins"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Sound.listen_freq_bins-894"><a href="#Sound.listen_freq_bins-894"><span class="linenos">894</span></a>    <span class="k">def</span> <span class="nf">listen_freq_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Sound.listen_freq_bins-895"><a href="#Sound.listen_freq_bins-895"><span class="linenos">895</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Sound.listen_freq_bins-896"><a href="#Sound.listen_freq_bins-896"><span class="linenos">896</span></a><span class="sd">        Method to listen to all the frequency bins of a sound</span>
</span><span id="Sound.listen_freq_bins-897"><a href="#Sound.listen_freq_bins-897"><span class="linenos">897</span></a>
</span><span id="Sound.listen_freq_bins-898"><a href="#Sound.listen_freq_bins-898"><span class="linenos">898</span></a><span class="sd">        The bins signals are obtained by filtering the sound signal</span>
</span><span id="Sound.listen_freq_bins-899"><a href="#Sound.listen_freq_bins-899"><span class="linenos">899</span></a><span class="sd">        with band pass filters.</span>
</span><span id="Sound.listen_freq_bins-900"><a href="#Sound.listen_freq_bins-900"><span class="linenos">900</span></a>
</span><span id="Sound.listen_freq_bins-901"><a href="#Sound.listen_freq_bins-901"><span class="linenos">901</span></a><span class="sd">        See guitarsounds.parameters.sound_parameters().bins.info() for the</span>
</span><span id="Sound.listen_freq_bins-902"><a href="#Sound.listen_freq_bins-902"><span class="linenos">902</span></a><span class="sd">        frequency bin intervals.</span>
</span><span id="Sound.listen_freq_bins-903"><a href="#Sound.listen_freq_bins-903"><span class="linenos">903</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Sound.listen_freq_bins-904"><a href="#Sound.listen_freq_bins-904"><span class="linenos">904</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Sound.listen_freq_bins-905"><a href="#Sound.listen_freq_bins-905"><span class="linenos">905</span></a>            <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="Sound.listen_freq_bins-906"><a href="#Sound.listen_freq_bins-906"><span class="linenos">906</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">listen</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Method to listen to all the frequency bins of a sound</p>

<p>The bins signals are obtained by filtering the sound signal
with band pass filters.</p>

<p>See <a href="parameters.html#sound_parameters">guitarsounds.parameters.sound_parameters()</a>.bins.info() for the
frequency bin intervals.</p>
</div>


                            </div>
                            <div id="Sound.plot_freq_bins" class="classattr">
                                        <input id="Sound.plot_freq_bins-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_freq_bins</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">bins</span><span class="o">=</span><span class="s1">&#39;all&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Sound.plot_freq_bins-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Sound.plot_freq_bins"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Sound.plot_freq_bins-908"><a href="#Sound.plot_freq_bins-908"><span class="linenos">908</span></a>    <span class="k">def</span> <span class="nf">plot_freq_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">):</span>
</span><span id="Sound.plot_freq_bins-909"><a href="#Sound.plot_freq_bins-909"><span class="linenos">909</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Sound.plot_freq_bins-910"><a href="#Sound.plot_freq_bins-910"><span class="linenos">910</span></a><span class="sd">        Method to plot all the frequency bins logarithmic envelopes of a sound</span>
</span><span id="Sound.plot_freq_bins-911"><a href="#Sound.plot_freq_bins-911"><span class="linenos">911</span></a>
</span><span id="Sound.plot_freq_bins-912"><a href="#Sound.plot_freq_bins-912"><span class="linenos">912</span></a><span class="sd">        The parameter `bins` allows choosing specific frequency bins to plot</span>
</span><span id="Sound.plot_freq_bins-913"><a href="#Sound.plot_freq_bins-913"><span class="linenos">913</span></a><span class="sd">        By default the function plots all the bins</span>
</span><span id="Sound.plot_freq_bins-914"><a href="#Sound.plot_freq_bins-914"><span class="linenos">914</span></a><span class="sd">        Supported bins arguments are :</span>
</span><span id="Sound.plot_freq_bins-915"><a href="#Sound.plot_freq_bins-915"><span class="linenos">915</span></a><span class="sd">        &#39;all&#39;, &#39;bass&#39;, &#39;mid&#39;, &#39;highmid&#39;, &#39;uppermid&#39;, &#39;presence&#39;, &#39;brillance&#39;</span>
</span><span id="Sound.plot_freq_bins-916"><a href="#Sound.plot_freq_bins-916"><span class="linenos">916</span></a>
</span><span id="Sound.plot_freq_bins-917"><a href="#Sound.plot_freq_bins-917"><span class="linenos">917</span></a><span class="sd">        Example :</span>
</span><span id="Sound.plot_freq_bins-918"><a href="#Sound.plot_freq_bins-918"><span class="linenos">918</span></a><span class="sd">        `Sound.plot_freq_bins(bins=&#39;all&#39;)` plots all the frequency bins</span>
</span><span id="Sound.plot_freq_bins-919"><a href="#Sound.plot_freq_bins-919"><span class="linenos">919</span></a><span class="sd">        `Sound.plot_freq_bins(bins=[&#39;bass&#39;, &#39;mid&#39;])` plots the bass and mid bins</span>
</span><span id="Sound.plot_freq_bins-920"><a href="#Sound.plot_freq_bins-920"><span class="linenos">920</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Sound.plot_freq_bins-921"><a href="#Sound.plot_freq_bins-921"><span class="linenos">921</span></a>
</span><span id="Sound.plot_freq_bins-922"><a href="#Sound.plot_freq_bins-922"><span class="linenos">922</span></a>        <span class="k">if</span> <span class="n">bins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
</span><span id="Sound.plot_freq_bins-923"><a href="#Sound.plot_freq_bins-923"><span class="linenos">923</span></a>            <span class="n">bins</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span>
</span><span id="Sound.plot_freq_bins-924"><a href="#Sound.plot_freq_bins-924"><span class="linenos">924</span></a>
</span><span id="Sound.plot_freq_bins-925"><a href="#Sound.plot_freq_bins-925"><span class="linenos">925</span></a>        <span class="k">if</span> <span class="n">bins</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
</span><span id="Sound.plot_freq_bins-926"><a href="#Sound.plot_freq_bins-926"><span class="linenos">926</span></a>            <span class="n">bins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="Sound.plot_freq_bins-927"><a href="#Sound.plot_freq_bins-927"><span class="linenos">927</span></a>
</span><span id="Sound.plot_freq_bins-928"><a href="#Sound.plot_freq_bins-928"><span class="linenos">928</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">bins</span><span class="p">:</span>
</span><span id="Sound.plot_freq_bins-929"><a href="#Sound.plot_freq_bins-929"><span class="linenos">929</span></a>            <span class="n">lab</span> <span class="o">=</span> <span class="n">key</span> <span class="o">+</span> <span class="s1">&#39; : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; Hz&#39;</span>
</span><span id="Sound.plot_freq_bins-930"><a href="#Sound.plot_freq_bins-930"><span class="linenos">930</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">old_plot</span><span class="p">(</span><span class="s1">&#39;log envelope&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">lab</span><span class="p">)</span>
</span><span id="Sound.plot_freq_bins-931"><a href="#Sound.plot_freq_bins-931"><span class="linenos">931</span></a>
</span><span id="Sound.plot_freq_bins-932"><a href="#Sound.plot_freq_bins-932"><span class="linenos">932</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="Sound.plot_freq_bins-933"><a href="#Sound.plot_freq_bins-933"><span class="linenos">933</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="Sound.plot_freq_bins-934"><a href="#Sound.plot_freq_bins-934"><span class="linenos">934</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;x-small&quot;</span><span class="p">)</span>  <span class="c1"># using a named size</span>
</span></pre></div>


            <div class="docstring"><p>Method to plot all the frequency bins logarithmic envelopes of a sound</p>

<p>The parameter <code>bins</code> allows choosing specific frequency bins to plot
By default the function plots all the bins
Supported bins arguments are :
'all', 'bass', 'mid', 'highmid', 'uppermid', 'presence', 'brillance'</p>

<p>Example :
<code><a href="#Sound.plot_freq_bins">Sound.plot_freq_bins</a>(bins='all')</code> plots all the frequency bins
<code><a href="#Sound.plot_freq_bins">Sound.plot_freq_bins</a>(bins=['bass', 'mid'])</code> plots the bass and mid bins</p>
</div>


                            </div>
                            <div id="Sound.peak_damping" class="classattr">
                                        <input id="Sound.peak_damping-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">peak_damping</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Sound.peak_damping-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Sound.peak_damping"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Sound.peak_damping-936"><a href="#Sound.peak_damping-936"><span class="linenos">936</span></a>    <span class="k">def</span> <span class="nf">peak_damping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Sound.peak_damping-937"><a href="#Sound.peak_damping-937"><span class="linenos">937</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Sound.peak_damping-938"><a href="#Sound.peak_damping-938"><span class="linenos">938</span></a><span class="sd">        Prints a table with peak damping values and peak frequency values</span>
</span><span id="Sound.peak_damping-939"><a href="#Sound.peak_damping-939"><span class="linenos">939</span></a>
</span><span id="Sound.peak_damping-940"><a href="#Sound.peak_damping-940"><span class="linenos">940</span></a><span class="sd">        The peaks are found with the `signal.peaks()` function and the damping</span>
</span><span id="Sound.peak_damping-941"><a href="#Sound.peak_damping-941"><span class="linenos">941</span></a><span class="sd">        values are computed with the half power bandwidth method.</span>
</span><span id="Sound.peak_damping-942"><a href="#Sound.peak_damping-942"><span class="linenos">942</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Sound.peak_damping-943"><a href="#Sound.peak_damping-943"><span class="linenos">943</span></a>        <span class="n">peak_indexes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">peaks</span><span class="p">()</span>
</span><span id="Sound.peak_damping-944"><a href="#Sound.peak_damping-944"><span class="linenos">944</span></a>        <span class="n">frequencies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[</span><span class="n">peak_indexes</span><span class="p">]</span>
</span><span id="Sound.peak_damping-945"><a href="#Sound.peak_damping-945"><span class="linenos">945</span></a>        <span class="n">damping</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">peak_damping</span><span class="p">()</span>
</span><span id="Sound.peak_damping-946"><a href="#Sound.peak_damping-946"><span class="linenos">946</span></a>        <span class="n">table_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">damping</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</span><span id="Sound.peak_damping-947"><a href="#Sound.peak_damping-947"><span class="linenos">947</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table_data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">,</span> <span class="s1">&#39;Damping ratio (%)&#39;</span><span class="p">]))</span>
</span></pre></div>


            <div class="docstring"><p>Prints a table with peak damping values and peak frequency values</p>

<p>The peaks are found with the <code>signal.peaks()</code> function and the damping
values are computed with the half power bandwidth method.</p>
</div>


                            </div>
                            <div id="Sound.bin_hist" class="classattr">
                                        <input id="Sound.bin_hist-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">bin_hist</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Sound.bin_hist-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Sound.bin_hist"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Sound.bin_hist-949"><a href="#Sound.bin_hist-949"><span class="linenos">949</span></a>    <span class="k">def</span> <span class="nf">bin_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Sound.bin_hist-950"><a href="#Sound.bin_hist-950"><span class="linenos">950</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Sound.bin_hist-951"><a href="#Sound.bin_hist-951"><span class="linenos">951</span></a><span class="sd">        Histogram of the frequency bin power</span>
</span><span id="Sound.bin_hist-952"><a href="#Sound.bin_hist-952"><span class="linenos">952</span></a>
</span><span id="Sound.bin_hist-953"><a href="#Sound.bin_hist-953"><span class="linenos">953</span></a><span class="sd">        frequency bin power is computed as the integral of the bin envelope.</span>
</span><span id="Sound.bin_hist-954"><a href="#Sound.bin_hist-954"><span class="linenos">954</span></a><span class="sd">        See guitarsounds.parameters.sound_parameters().bins.info() for the</span>
</span><span id="Sound.bin_hist-955"><a href="#Sound.bin_hist-955"><span class="linenos">955</span></a><span class="sd">        frequency bin intervals.</span>
</span><span id="Sound.bin_hist-956"><a href="#Sound.bin_hist-956"><span class="linenos">956</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Sound.bin_hist-957"><a href="#Sound.bin_hist-957"><span class="linenos">957</span></a>        <span class="c1"># Compute the bin powers</span>
</span><span id="Sound.bin_hist-958"><a href="#Sound.bin_hist-958"><span class="linenos">958</span></a>        <span class="n">bin_strings</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="Sound.bin_hist-959"><a href="#Sound.bin_hist-959"><span class="linenos">959</span></a>        <span class="n">integrals</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Sound.bin_hist-960"><a href="#Sound.bin_hist-960"><span class="linenos">960</span></a>
</span><span id="Sound.bin_hist-961"><a href="#Sound.bin_hist-961"><span class="linenos">961</span></a>        <span class="k">for</span> <span class="n">f_bin</span> <span class="ow">in</span> <span class="n">bin_strings</span><span class="p">:</span>
</span><span id="Sound.bin_hist-962"><a href="#Sound.bin_hist-962"><span class="linenos">962</span></a>            <span class="n">log_envelope</span><span class="p">,</span> <span class="n">log_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">f_bin</span><span class="p">]</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="Sound.bin_hist-963"><a href="#Sound.bin_hist-963"><span class="linenos">963</span></a>            <span class="n">integral</span> <span class="o">=</span> <span class="n">trapezoid</span><span class="p">(</span><span class="n">log_envelope</span><span class="p">,</span> <span class="n">log_time</span><span class="p">)</span>
</span><span id="Sound.bin_hist-964"><a href="#Sound.bin_hist-964"><span class="linenos">964</span></a>            <span class="n">integrals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span>
</span><span id="Sound.bin_hist-965"><a href="#Sound.bin_hist-965"><span class="linenos">965</span></a>        <span class="n">max_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">integrals</span><span class="p">)</span>
</span><span id="Sound.bin_hist-966"><a href="#Sound.bin_hist-966"><span class="linenos">966</span></a>        <span class="n">integrals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">integrals</span><span class="p">)</span><span class="o">/</span><span class="n">max_value</span>
</span><span id="Sound.bin_hist-967"><a href="#Sound.bin_hist-967"><span class="linenos">967</span></a>
</span><span id="Sound.bin_hist-968"><a href="#Sound.bin_hist-968"><span class="linenos">968</span></a>        <span class="c1"># create the bar plotting vectors</span>
</span><span id="Sound.bin_hist-969"><a href="#Sound.bin_hist-969"><span class="linenos">969</span></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="Sound.bin_hist-970"><a href="#Sound.bin_hist-970"><span class="linenos">970</span></a>
</span><span id="Sound.bin_hist-971"><a href="#Sound.bin_hist-971"><span class="linenos">971</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">bin_strings</span><span class="p">))</span>
</span><span id="Sound.bin_hist-972"><a href="#Sound.bin_hist-972"><span class="linenos">972</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">integrals</span>
</span><span id="Sound.bin_hist-973"><a href="#Sound.bin_hist-973"><span class="linenos">973</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">tick_label</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">bin_strings</span><span class="p">))</span>
</span><span id="Sound.bin_hist-974"><a href="#Sound.bin_hist-974"><span class="linenos">974</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;frequency bin name&quot;</span><span class="p">)</span>
</span><span id="Sound.bin_hist-975"><a href="#Sound.bin_hist-975"><span class="linenos">975</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;frequency bin power (normalized)&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Histogram of the frequency bin power</p>

<p>frequency bin power is computed as the integral of the bin envelope.
See <a href="parameters.html#sound_parameters">guitarsounds.parameters.sound_parameters()</a>.bins.info() for the
frequency bin intervals.</p>
</div>


                            </div>
                </section>
                <section id="Signal">
                            <input id="Signal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Signal</span>:

                <label class="view-source-button" for="Signal-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Signal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Signal-978"><a href="#Signal-978"><span class="linenos"> 978</span></a><span class="k">class</span> <span class="nc">Signal</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="Signal-979"><a href="#Signal-979"><span class="linenos"> 979</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal-980"><a href="#Signal-980"><span class="linenos"> 980</span></a><span class="sd">    A Class to do computations on an audio signal.</span>
</span><span id="Signal-981"><a href="#Signal-981"><span class="linenos"> 981</span></a>
</span><span id="Signal-982"><a href="#Signal-982"><span class="linenos"> 982</span></a><span class="sd">    The signal is never changed in the class, when transformations are made, a new instance is returned.</span>
</span><span id="Signal-983"><a href="#Signal-983"><span class="linenos"> 983</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Signal-984"><a href="#Signal-984"><span class="linenos"> 984</span></a>
</span><span id="Signal-985"><a href="#Signal-985"><span class="linenos"> 985</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">SoundParam</span><span class="p">,</span> <span class="n">freq_range</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Signal-986"><a href="#Signal-986"><span class="linenos"> 986</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
</span><span id="Signal-987"><a href="#Signal-987"><span class="linenos"> 987</span></a><span class="sd">        Create a Signal class from a vector of samples and a sample rate</span>
</span><span id="Signal-988"><a href="#Signal-988"><span class="linenos"> 988</span></a><span class="sd">        :param signal: vector containing the signal samples</span>
</span><span id="Signal-989"><a href="#Signal-989"><span class="linenos"> 989</span></a><span class="sd">        :param sr: sample rate of the signal (Hz)</span>
</span><span id="Signal-990"><a href="#Signal-990"><span class="linenos"> 990</span></a><span class="sd">        :param SoundParam: Sound Parameter instance to use with the signal</span>
</span><span id="Signal-991"><a href="#Signal-991"><span class="linenos"> 991</span></a><span class="sd">        :para freq_range: Frequency range to use with the signal.</span>
</span><span id="Signal-992"><a href="#Signal-992"><span class="linenos"> 992</span></a><span class="sd">        This is the maximum frequency used when computing Fourier transform</span>
</span><span id="Signal-993"><a href="#Signal-993"><span class="linenos"> 993</span></a><span class="sd">        peaks and plotting Fourier transform related plots.</span>
</span><span id="Signal-994"><a href="#Signal-994"><span class="linenos"> 994</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal-995"><a href="#Signal-995"><span class="linenos"> 995</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">SP</span> <span class="o">=</span> <span class="n">SoundParam</span>
</span><span id="Signal-996"><a href="#Signal-996"><span class="linenos"> 996</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">onset</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Signal-997"><a href="#Signal-997"><span class="linenos"> 997</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="n">signal</span>
</span><span id="Signal-998"><a href="#Signal-998"><span class="linenos"> 998</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sr</span> <span class="o">=</span> <span class="n">sr</span>
</span><span id="Signal-999"><a href="#Signal-999"><span class="linenos"> 999</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">range</span> <span class="o">=</span> <span class="n">freq_range</span>
</span><span id="Signal-1000"><a href="#Signal-1000"><span class="linenos">1000</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span> <span class="o">=</span> <span class="n">Plot</span><span class="p">()</span>
</span><span id="Signal-1001"><a href="#Signal-1001"><span class="linenos">1001</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Signal-1002"><a href="#Signal-1002"><span class="linenos">1002</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">norm_factor</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Signal-1003"><a href="#Signal-1003"><span class="linenos">1003</span></a>
</span><span id="Signal-1004"><a href="#Signal-1004"><span class="linenos">1004</span></a>    <span class="k">def</span> <span class="nf">time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal-1005"><a href="#Signal-1005"><span class="linenos">1005</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal-1006"><a href="#Signal-1006"><span class="linenos">1006</span></a><span class="sd">        Returns the time vector associated with the signal</span>
</span><span id="Signal-1007"><a href="#Signal-1007"><span class="linenos">1007</span></a><span class="sd">        :return: numpy array corresponding to the time values</span>
</span><span id="Signal-1008"><a href="#Signal-1008"><span class="linenos">1008</span></a><span class="sd">        of the signal samples in seconds</span>
</span><span id="Signal-1009"><a href="#Signal-1009"><span class="linenos">1009</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal-1010"><a href="#Signal-1010"><span class="linenos">1010</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Signal-1011"><a href="#Signal-1011"><span class="linenos">1011</span></a>                           <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">),</span>
</span><span id="Signal-1012"><a href="#Signal-1012"><span class="linenos">1012</span></a>                           <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">))</span>
</span><span id="Signal-1013"><a href="#Signal-1013"><span class="linenos">1013</span></a>
</span><span id="Signal-1014"><a href="#Signal-1014"><span class="linenos">1014</span></a>    <span class="k">def</span> <span class="nf">listen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal-1015"><a href="#Signal-1015"><span class="linenos">1015</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal-1016"><a href="#Signal-1016"><span class="linenos">1016</span></a><span class="sd">        Method to listen the sound signal in a Jupyter Notebook</span>
</span><span id="Signal-1017"><a href="#Signal-1017"><span class="linenos">1017</span></a>
</span><span id="Signal-1018"><a href="#Signal-1018"><span class="linenos">1018</span></a><span class="sd">        Listening to the sounds imported in the analysis tool allows the</span>
</span><span id="Signal-1019"><a href="#Signal-1019"><span class="linenos">1019</span></a><span class="sd">        user to validate if the sound was well trimmed and filtered</span>
</span><span id="Signal-1020"><a href="#Signal-1020"><span class="linenos">1020</span></a>
</span><span id="Signal-1021"><a href="#Signal-1021"><span class="linenos">1021</span></a><span class="sd">        A temporary file is created, the IPython display Audio function is</span>
</span><span id="Signal-1022"><a href="#Signal-1022"><span class="linenos">1022</span></a><span class="sd">        called on it and then the file is removed</span>
</span><span id="Signal-1023"><a href="#Signal-1023"><span class="linenos">1023</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal-1024"><a href="#Signal-1024"><span class="linenos">1024</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="s1">&#39;temp.wav&#39;</span>
</span><span id="Signal-1025"><a href="#Signal-1025"><span class="linenos">1025</span></a>        <span class="n">write</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">)</span>
</span><span id="Signal-1026"><a href="#Signal-1026"><span class="linenos">1026</span></a>        <span class="n">ipd</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">ipd</span><span class="o">.</span><span class="n">Audio</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>
</span><span id="Signal-1027"><a href="#Signal-1027"><span class="linenos">1027</span></a>        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span><span id="Signal-1028"><a href="#Signal-1028"><span class="linenos">1028</span></a>
</span><span id="Signal-1029"><a href="#Signal-1029"><span class="linenos">1029</span></a>    <span class="k">def</span> <span class="nf">old_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Signal-1030"><a href="#Signal-1030"><span class="linenos">1030</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal-1031"><a href="#Signal-1031"><span class="linenos">1031</span></a><span class="sd">        Convenience function for the different signal plots</span>
</span><span id="Signal-1032"><a href="#Signal-1032"><span class="linenos">1032</span></a>
</span><span id="Signal-1033"><a href="#Signal-1033"><span class="linenos">1033</span></a><span class="sd">        Calls the function corresponding to Plot.kind()</span>
</span><span id="Signal-1034"><a href="#Signal-1034"><span class="linenos">1034</span></a><span class="sd">        See help(guitarsounds.analysis.Plot) for info on the different plots</span>
</span><span id="Signal-1035"><a href="#Signal-1035"><span class="linenos">1035</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal-1036"><a href="#Signal-1036"><span class="linenos">1036</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">method_dict</span><span class="p">[</span><span class="n">kind</span><span class="p">](</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Signal-1037"><a href="#Signal-1037"><span class="linenos">1037</span></a>
</span><span id="Signal-1038"><a href="#Signal-1038"><span class="linenos">1038</span></a>    <span class="k">def</span> <span class="nf">fft</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal-1039"><a href="#Signal-1039"><span class="linenos">1039</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal-1040"><a href="#Signal-1040"><span class="linenos">1040</span></a><span class="sd">        Computes the Fast Fourier Transform of the signal and returns the vector.</span>
</span><span id="Signal-1041"><a href="#Signal-1041"><span class="linenos">1041</span></a><span class="sd">        :return: Fast Fourier Transform amplitude values in a numpy array</span>
</span><span id="Signal-1042"><a href="#Signal-1042"><span class="linenos">1042</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal-1043"><a href="#Signal-1043"><span class="linenos">1043</span></a>        <span class="n">fft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">)</span>
</span><span id="Signal-1044"><a href="#Signal-1044"><span class="linenos">1044</span></a>        <span class="n">fft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fft</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fft</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)])</span>  <span class="c1"># Only the symmetric part of the absolute value</span>
</span><span id="Signal-1045"><a href="#Signal-1045"><span class="linenos">1045</span></a>        <span class="k">return</span> <span class="n">fft</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">fft</span><span class="p">)</span>
</span><span id="Signal-1046"><a href="#Signal-1046"><span class="linenos">1046</span></a>
</span><span id="Signal-1047"><a href="#Signal-1047"><span class="linenos">1047</span></a>    <span class="k">def</span> <span class="nf">spectral_centroid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal-1048"><a href="#Signal-1048"><span class="linenos">1048</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal-1049"><a href="#Signal-1049"><span class="linenos">1049</span></a><span class="sd">        Spectral centroid of the frequency content of the signal</span>
</span><span id="Signal-1050"><a href="#Signal-1050"><span class="linenos">1050</span></a><span class="sd">        :return: Spectral centroid of the signal (float)</span>
</span><span id="Signal-1051"><a href="#Signal-1051"><span class="linenos">1051</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal-1052"><a href="#Signal-1052"><span class="linenos">1052</span></a>        <span class="n">SC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">()</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">())</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">())</span>
</span><span id="Signal-1053"><a href="#Signal-1053"><span class="linenos">1053</span></a>        <span class="k">return</span> <span class="n">SC</span>
</span><span id="Signal-1054"><a href="#Signal-1054"><span class="linenos">1054</span></a>
</span><span id="Signal-1055"><a href="#Signal-1055"><span class="linenos">1055</span></a>
</span><span id="Signal-1056"><a href="#Signal-1056"><span class="linenos">1056</span></a>    <span class="k">def</span> <span class="nf">peaks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">result</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Signal-1057"><a href="#Signal-1057"><span class="linenos">1057</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal-1058"><a href="#Signal-1058"><span class="linenos">1058</span></a><span class="sd">        Computes the harmonic peaks indexes from the FFT of the signal</span>
</span><span id="Signal-1059"><a href="#Signal-1059"><span class="linenos">1059</span></a><span class="sd">        :param max_freq: Supply a max frequency value overriding the one in</span>
</span><span id="Signal-1060"><a href="#Signal-1060"><span class="linenos">1060</span></a><span class="sd">        guitarsounds_parameters</span>
</span><span id="Signal-1061"><a href="#Signal-1061"><span class="linenos">1061</span></a><span class="sd">        :param height: if True the height threshold is returned to be used</span>
</span><span id="Signal-1062"><a href="#Signal-1062"><span class="linenos">1062</span></a><span class="sd">        in the &#39;peaks&#39; plot</span>
</span><span id="Signal-1063"><a href="#Signal-1063"><span class="linenos">1063</span></a><span class="sd">        :param result: if True the Scipy peak finding results dictionary</span>
</span><span id="Signal-1064"><a href="#Signal-1064"><span class="linenos">1064</span></a><span class="sd">        is returned</span>
</span><span id="Signal-1065"><a href="#Signal-1065"><span class="linenos">1065</span></a><span class="sd">        :return: peak indexes</span>
</span><span id="Signal-1066"><a href="#Signal-1066"><span class="linenos">1066</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal-1067"><a href="#Signal-1067"><span class="linenos">1067</span></a>        <span class="c1"># Replace None by the default value</span>
</span><span id="Signal-1068"><a href="#Signal-1068"><span class="linenos">1068</span></a>        <span class="k">if</span> <span class="n">max_freq</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Signal-1069"><a href="#Signal-1069"><span class="linenos">1069</span></a>            <span class="n">max_freq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">fft_range</span><span class="o">.</span><span class="n">value</span>
</span><span id="Signal-1070"><a href="#Signal-1070"><span class="linenos">1070</span></a>
</span><span id="Signal-1071"><a href="#Signal-1071"><span class="linenos">1071</span></a>        <span class="c1"># Get the fft and fft frequencies from the signal</span>
</span><span id="Signal-1072"><a href="#Signal-1072"><span class="linenos">1072</span></a>        <span class="n">fft</span><span class="p">,</span> <span class="n">fft_freq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span>
</span><span id="Signal-1073"><a href="#Signal-1073"><span class="linenos">1073</span></a>
</span><span id="Signal-1074"><a href="#Signal-1074"><span class="linenos">1074</span></a>        <span class="c1"># Find the max index</span>
</span><span id="Signal-1075"><a href="#Signal-1075"><span class="linenos">1075</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Signal-1076"><a href="#Signal-1076"><span class="linenos">1076</span></a>            <span class="n">max_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fft_freq</span> <span class="o">&gt;=</span> <span class="n">max_freq</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Signal-1077"><a href="#Signal-1077"><span class="linenos">1077</span></a>        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
</span><span id="Signal-1078"><a href="#Signal-1078"><span class="linenos">1078</span></a>            <span class="n">max_index</span> <span class="o">=</span> <span class="n">fft_freq</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> 
</span><span id="Signal-1079"><a href="#Signal-1079"><span class="linenos">1079</span></a>
</span><span id="Signal-1080"><a href="#Signal-1080"><span class="linenos">1080</span></a>        <span class="c1"># Find an approximation of the distance between peaks, this only works for harmonic signals</span>
</span><span id="Signal-1081"><a href="#Signal-1081"><span class="linenos">1081</span></a>        <span class="n">peak_distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">fft</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="Signal-1082"><a href="#Signal-1082"><span class="linenos">1082</span></a>
</span><span id="Signal-1083"><a href="#Signal-1083"><span class="linenos">1083</span></a>        <span class="c1"># Maximum of the signal in a small region on both ends</span>
</span><span id="Signal-1084"><a href="#Signal-1084"><span class="linenos">1084</span></a>        <span class="n">fft_max_start</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">fft</span><span class="p">[:</span><span class="n">peak_distance</span><span class="p">])</span>
</span><span id="Signal-1085"><a href="#Signal-1085"><span class="linenos">1085</span></a>        <span class="n">fft_max_end</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">fft</span><span class="p">[</span><span class="n">max_index</span> <span class="o">-</span> <span class="n">peak_distance</span><span class="p">:</span><span class="n">max_index</span><span class="p">])</span>
</span><span id="Signal-1086"><a href="#Signal-1086"><span class="linenos">1086</span></a>
</span><span id="Signal-1087"><a href="#Signal-1087"><span class="linenos">1087</span></a>        <span class="c1"># Build the curve below the peaks but above the noise</span>
</span><span id="Signal-1088"><a href="#Signal-1088"><span class="linenos">1088</span></a>        <span class="n">exponents</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fft_max_start</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fft_max_end</span><span class="p">),</span> <span class="n">max_index</span><span class="p">)</span>
</span><span id="Signal-1089"><a href="#Signal-1089"><span class="linenos">1089</span></a>        <span class="n">intersect</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">exponents</span><span class="p">[</span><span class="n">peak_distance</span><span class="p">]</span>
</span><span id="Signal-1090"><a href="#Signal-1090"><span class="linenos">1090</span></a>        <span class="n">diff_start</span> <span class="o">=</span> <span class="n">fft_max_start</span> <span class="o">-</span> <span class="n">intersect</span>  <span class="c1"># offset by a small distance so that the first max is not a peak</span>
</span><span id="Signal-1091"><a href="#Signal-1091"><span class="linenos">1091</span></a>        <span class="n">min_height</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fft_max_start</span> <span class="o">+</span> <span class="n">diff_start</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fft_max_end</span><span class="p">),</span> <span class="n">max_index</span><span class="p">)</span>
</span><span id="Signal-1092"><a href="#Signal-1092"><span class="linenos">1092</span></a>
</span><span id="Signal-1093"><a href="#Signal-1093"><span class="linenos">1093</span></a>        <span class="n">first_peak_indexes</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">find_peaks</span><span class="p">(</span><span class="n">fft</span><span class="p">[:</span><span class="n">max_index</span><span class="p">],</span> <span class="n">height</span><span class="o">=</span><span class="n">min_height</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="n">peak_distance</span><span class="p">)</span>
</span><span id="Signal-1094"><a href="#Signal-1094"><span class="linenos">1094</span></a>
</span><span id="Signal-1095"><a href="#Signal-1095"><span class="linenos">1095</span></a>        <span class="n">number_of_peaks</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_peak_indexes</span><span class="p">)</span>
</span><span id="Signal-1096"><a href="#Signal-1096"><span class="linenos">1096</span></a>        <span class="k">if</span> <span class="n">number_of_peaks</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Signal-1097"><a href="#Signal-1097"><span class="linenos">1097</span></a>            <span class="n">average_len</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">max_index</span> <span class="o">/</span> <span class="n">number_of_peaks</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span>
</span><span id="Signal-1098"><a href="#Signal-1098"><span class="linenos">1098</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Signal-1099"><a href="#Signal-1099"><span class="linenos">1099</span></a>            <span class="n">average_len</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">max_index</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="Signal-1100"><a href="#Signal-1100"><span class="linenos">1100</span></a>
</span><span id="Signal-1101"><a href="#Signal-1101"><span class="linenos">1101</span></a>        <span class="k">if</span> <span class="n">average_len</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Signal-1102"><a href="#Signal-1102"><span class="linenos">1102</span></a>            <span class="n">average_len</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Signal-1103"><a href="#Signal-1103"><span class="linenos">1103</span></a>
</span><span id="Signal-1104"><a href="#Signal-1104"><span class="linenos">1104</span></a>        <span class="n">average_fft</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">savgol_filter</span><span class="p">(</span><span class="n">fft</span><span class="p">[:</span><span class="n">max_index</span><span class="p">],</span> <span class="n">average_len</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;mirror&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.9</span>
</span><span id="Signal-1105"><a href="#Signal-1105"><span class="linenos">1105</span></a>        <span class="n">min_freq_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fft_freq</span> <span class="o">&gt;=</span> <span class="mi">70</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Signal-1106"><a href="#Signal-1106"><span class="linenos">1106</span></a>        <span class="n">average_fft</span><span class="p">[:</span><span class="n">min_freq_index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Signal-1107"><a href="#Signal-1107"><span class="linenos">1107</span></a>
</span><span id="Signal-1108"><a href="#Signal-1108"><span class="linenos">1108</span></a>        <span class="n">peak_indexes</span><span class="p">,</span> <span class="n">res</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">find_peaks</span><span class="p">(</span><span class="n">fft</span><span class="p">[:</span><span class="n">max_index</span><span class="p">],</span> <span class="n">height</span><span class="o">=</span><span class="n">average_fft</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="n">min_freq_index</span><span class="p">)</span>
</span><span id="Signal-1109"><a href="#Signal-1109"><span class="linenos">1109</span></a>
</span><span id="Signal-1110"><a href="#Signal-1110"><span class="linenos">1110</span></a>        <span class="c1"># Remove noisy peaks at the low frequencies</span>
</span><span id="Signal-1111"><a href="#Signal-1111"><span class="linenos">1111</span></a>        <span class="k">while</span> <span class="n">fft</span><span class="p">[</span><span class="n">peak_indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">&lt;</span> <span class="mf">5e-2</span><span class="p">:</span>
</span><span id="Signal-1112"><a href="#Signal-1112"><span class="linenos">1112</span></a>            <span class="n">peak_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">peak_indexes</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Signal-1113"><a href="#Signal-1113"><span class="linenos">1113</span></a>        <span class="k">while</span> <span class="n">fft</span><span class="p">[</span><span class="n">peak_indexes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">&lt;</span> <span class="mf">1e-4</span><span class="p">:</span>
</span><span id="Signal-1114"><a href="#Signal-1114"><span class="linenos">1114</span></a>            <span class="n">peak_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">peak_indexes</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Signal-1115"><a href="#Signal-1115"><span class="linenos">1115</span></a>
</span><span id="Signal-1116"><a href="#Signal-1116"><span class="linenos">1116</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">height</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">result</span><span class="p">:</span>
</span><span id="Signal-1117"><a href="#Signal-1117"><span class="linenos">1117</span></a>            <span class="k">return</span> <span class="n">peak_indexes</span>
</span><span id="Signal-1118"><a href="#Signal-1118"><span class="linenos">1118</span></a>        <span class="k">elif</span> <span class="n">height</span><span class="p">:</span>
</span><span id="Signal-1119"><a href="#Signal-1119"><span class="linenos">1119</span></a>            <span class="k">return</span> <span class="n">peak_indexes</span><span class="p">,</span> <span class="n">average_fft</span>
</span><span id="Signal-1120"><a href="#Signal-1120"><span class="linenos">1120</span></a>        <span class="k">elif</span> <span class="n">result</span><span class="p">:</span>
</span><span id="Signal-1121"><a href="#Signal-1121"><span class="linenos">1121</span></a>            <span class="k">return</span> <span class="n">peak_indexes</span><span class="p">,</span> <span class="n">res</span>
</span><span id="Signal-1122"><a href="#Signal-1122"><span class="linenos">1122</span></a>        <span class="k">elif</span> <span class="n">height</span> <span class="ow">and</span> <span class="n">result</span><span class="p">:</span>
</span><span id="Signal-1123"><a href="#Signal-1123"><span class="linenos">1123</span></a>            <span class="k">return</span> <span class="n">peak_indexes</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">res</span>
</span><span id="Signal-1124"><a href="#Signal-1124"><span class="linenos">1124</span></a>
</span><span id="Signal-1125"><a href="#Signal-1125"><span class="linenos">1125</span></a>    <span class="k">def</span> <span class="nf">time_damping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal-1126"><a href="#Signal-1126"><span class="linenos">1126</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal-1127"><a href="#Signal-1127"><span class="linenos">1127</span></a><span class="sd">        Computes the time wise damping ratio of the signal by fitting a negative exponential curve</span>
</span><span id="Signal-1128"><a href="#Signal-1128"><span class="linenos">1128</span></a><span class="sd">        to the Signal envelope and computing the ratio with the Signal fundamental frequency.</span>
</span><span id="Signal-1129"><a href="#Signal-1129"><span class="linenos">1129</span></a><span class="sd">        :return: The damping ratio, a scalar.</span>
</span><span id="Signal-1130"><a href="#Signal-1130"><span class="linenos">1130</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal-1131"><a href="#Signal-1131"><span class="linenos">1131</span></a>        <span class="c1"># Get the envelope data</span>
</span><span id="Signal-1132"><a href="#Signal-1132"><span class="linenos">1132</span></a>        <span class="n">envelope</span><span class="p">,</span> <span class="n">envelope_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">envelope</span><span class="p">()</span> 
</span><span id="Signal-1133"><a href="#Signal-1133"><span class="linenos">1133</span></a>
</span><span id="Signal-1134"><a href="#Signal-1134"><span class="linenos">1134</span></a>        <span class="c1"># First point is the maximum because e^-kt is strictly decreasing</span>
</span><span id="Signal-1135"><a href="#Signal-1135"><span class="linenos">1135</span></a>        <span class="n">first_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">envelope</span><span class="p">)</span>
</span><span id="Signal-1136"><a href="#Signal-1136"><span class="linenos">1136</span></a>
</span><span id="Signal-1137"><a href="#Signal-1137"><span class="linenos">1137</span></a>        <span class="c1"># The second point is the first point where the signal crosses the lower_threshold line</span>
</span><span id="Signal-1138"><a href="#Signal-1138"><span class="linenos">1138</span></a>        <span class="n">second_point_thresh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">damping</span><span class="o">.</span><span class="n">lower_threshold</span><span class="o">.</span><span class="n">value</span>
</span><span id="Signal-1139"><a href="#Signal-1139"><span class="linenos">1139</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Signal-1140"><a href="#Signal-1140"><span class="linenos">1140</span></a>            <span class="n">second_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flatnonzero</span><span class="p">(</span><span class="n">envelope</span><span class="p">[</span><span class="n">first_index</span><span class="p">:]</span> <span class="o">&lt;=</span> <span class="n">second_point_thresh</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Signal-1141"><a href="#Signal-1141"><span class="linenos">1141</span></a>        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
</span><span id="Signal-1142"><a href="#Signal-1142"><span class="linenos">1142</span></a>            <span class="n">second_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flatnonzero</span><span class="p">(</span><span class="n">envelope</span><span class="p">[</span><span class="n">first_index</span><span class="p">:]</span> <span class="o">&lt;=</span> <span class="n">second_point_thresh</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Signal-1143"><a href="#Signal-1143"><span class="linenos">1143</span></a>
</span><span id="Signal-1144"><a href="#Signal-1144"><span class="linenos">1144</span></a>        <span class="c1"># Function to compute the residual for the exponential curve fit</span>
</span><span id="Signal-1145"><a href="#Signal-1145"><span class="linenos">1145</span></a>        <span class="k">def</span> <span class="nf">residual_function</span><span class="p">(</span><span class="n">zeta_w</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
</span><span id="Signal-1146"><a href="#Signal-1146"><span class="linenos">1146</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal-1147"><a href="#Signal-1147"><span class="linenos">1147</span></a><span class="sd">            Function computing the residual to curve fit a negative exponential to the signal envelope</span>
</span><span id="Signal-1148"><a href="#Signal-1148"><span class="linenos">1148</span></a><span class="sd">            :param zeta_w: zeta*omega constant</span>
</span><span id="Signal-1149"><a href="#Signal-1149"><span class="linenos">1149</span></a><span class="sd">            :param t: time vector</span>
</span><span id="Signal-1150"><a href="#Signal-1150"><span class="linenos">1150</span></a><span class="sd">            :param s: signal</span>
</span><span id="Signal-1151"><a href="#Signal-1151"><span class="linenos">1151</span></a><span class="sd">            :return: residual</span>
</span><span id="Signal-1152"><a href="#Signal-1152"><span class="linenos">1152</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="Signal-1153"><a href="#Signal-1153"><span class="linenos">1153</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">zeta_w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">s</span>
</span><span id="Signal-1154"><a href="#Signal-1154"><span class="linenos">1154</span></a>
</span><span id="Signal-1155"><a href="#Signal-1155"><span class="linenos">1155</span></a>        <span class="n">zeta_guess</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">]</span>
</span><span id="Signal-1156"><a href="#Signal-1156"><span class="linenos">1156</span></a>
</span><span id="Signal-1157"><a href="#Signal-1157"><span class="linenos">1157</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">least_squares</span><span class="p">(</span><span class="n">residual_function</span><span class="p">,</span> <span class="n">zeta_guess</span><span class="p">,</span>
</span><span id="Signal-1158"><a href="#Signal-1158"><span class="linenos">1158</span></a>                                              <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">envelope_time</span><span class="p">[</span><span class="n">first_index</span><span class="p">:</span><span class="n">second_index</span><span class="p">],</span>
</span><span id="Signal-1159"><a href="#Signal-1159"><span class="linenos">1159</span></a>                                                    <span class="n">envelope</span><span class="p">[</span><span class="n">first_index</span><span class="p">:</span><span class="n">second_index</span><span class="p">]))</span>
</span><span id="Signal-1160"><a href="#Signal-1160"><span class="linenos">1160</span></a>        <span class="c1"># Get the zeta*omega constant</span>
</span><span id="Signal-1161"><a href="#Signal-1161"><span class="linenos">1161</span></a>        <span class="n">zeta_omega</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Signal-1162"><a href="#Signal-1162"><span class="linenos">1162</span></a>
</span><span id="Signal-1163"><a href="#Signal-1163"><span class="linenos">1163</span></a>        <span class="c1"># Compute the fundamental frequency in radians of the signal</span>
</span><span id="Signal-1164"><a href="#Signal-1164"><span class="linenos">1164</span></a>        <span class="n">wd</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fundamental</span><span class="p">()</span>
</span><span id="Signal-1165"><a href="#Signal-1165"><span class="linenos">1165</span></a>        <span class="k">return</span> <span class="o">-</span><span class="n">zeta_omega</span> <span class="o">/</span> <span class="n">wd</span>
</span><span id="Signal-1166"><a href="#Signal-1166"><span class="linenos">1166</span></a>
</span><span id="Signal-1167"><a href="#Signal-1167"><span class="linenos">1167</span></a>    <span class="k">def</span> <span class="nf">peak_damping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal-1168"><a href="#Signal-1168"><span class="linenos">1168</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal-1169"><a href="#Signal-1169"><span class="linenos">1169</span></a><span class="sd">        Computes the frequency wise damping with the half bandwidth method on the Fourier Transform peaks</span>
</span><span id="Signal-1170"><a href="#Signal-1170"><span class="linenos">1170</span></a><span class="sd">        :return: an array containing the peak damping values</span>
</span><span id="Signal-1171"><a href="#Signal-1171"><span class="linenos">1171</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal-1172"><a href="#Signal-1172"><span class="linenos">1172</span></a>        <span class="n">zetas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Signal-1173"><a href="#Signal-1173"><span class="linenos">1173</span></a>        <span class="n">fft_freqs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span>
</span><span id="Signal-1174"><a href="#Signal-1174"><span class="linenos">1174</span></a>        <span class="n">fft</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">()[:</span><span class="nb">len</span><span class="p">(</span><span class="n">fft_freqs</span><span class="p">)]</span>
</span><span id="Signal-1175"><a href="#Signal-1175"><span class="linenos">1175</span></a>        <span class="k">for</span> <span class="n">peak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">():</span>
</span><span id="Signal-1176"><a href="#Signal-1176"><span class="linenos">1176</span></a>            <span class="n">peak_frequency</span> <span class="o">=</span> <span class="n">fft_freqs</span><span class="p">[</span><span class="n">peak</span><span class="p">]</span>
</span><span id="Signal-1177"><a href="#Signal-1177"><span class="linenos">1177</span></a>            <span class="n">peak_height</span> <span class="o">=</span> <span class="n">fft</span><span class="p">[</span><span class="n">peak</span><span class="p">]</span>
</span><span id="Signal-1178"><a href="#Signal-1178"><span class="linenos">1178</span></a>            <span class="n">root_height</span> <span class="o">=</span> <span class="n">peak_height</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Signal-1179"><a href="#Signal-1179"><span class="linenos">1179</span></a>            <span class="n">frequency_roots</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span><span class="n">fft_freqs</span><span class="p">,</span> <span class="n">fft</span> <span class="o">-</span> <span class="n">root_height</span><span class="p">)</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
</span><span id="Signal-1180"><a href="#Signal-1180"><span class="linenos">1180</span></a>            <span class="n">sorted_roots_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">frequency_roots</span> <span class="o">-</span> <span class="n">peak_frequency</span><span class="p">))</span>
</span><span id="Signal-1181"><a href="#Signal-1181"><span class="linenos">1181</span></a>            <span class="n">w2</span><span class="p">,</span> <span class="n">w1</span> <span class="o">=</span> <span class="n">frequency_roots</span><span class="p">[</span><span class="n">sorted_roots_indexes</span><span class="p">[:</span><span class="mi">2</span><span class="p">]]</span>
</span><span id="Signal-1182"><a href="#Signal-1182"><span class="linenos">1182</span></a>            <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">])</span>
</span><span id="Signal-1183"><a href="#Signal-1183"><span class="linenos">1183</span></a>            <span class="n">zeta</span> <span class="o">=</span> <span class="p">(</span><span class="n">w2</span> <span class="o">-</span> <span class="n">w1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">peak_frequency</span><span class="p">)</span>
</span><span id="Signal-1184"><a href="#Signal-1184"><span class="linenos">1184</span></a>            <span class="n">zetas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zeta</span><span class="p">)</span>
</span><span id="Signal-1185"><a href="#Signal-1185"><span class="linenos">1185</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">zetas</span><span class="p">)</span>
</span><span id="Signal-1186"><a href="#Signal-1186"><span class="linenos">1186</span></a>
</span><span id="Signal-1187"><a href="#Signal-1187"><span class="linenos">1187</span></a>    <span class="k">def</span> <span class="nf">fundamental</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal-1188"><a href="#Signal-1188"><span class="linenos">1188</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal-1189"><a href="#Signal-1189"><span class="linenos">1189</span></a><span class="sd">        Returns the fundamental approximated by the first peak of the fft</span>
</span><span id="Signal-1190"><a href="#Signal-1190"><span class="linenos">1190</span></a><span class="sd">        :return: fundamental value (Hz)</span>
</span><span id="Signal-1191"><a href="#Signal-1191"><span class="linenos">1191</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal-1192"><a href="#Signal-1192"><span class="linenos">1192</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Signal-1193"><a href="#Signal-1193"><span class="linenos">1193</span></a>        <span class="n">fundamental</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
</span><span id="Signal-1194"><a href="#Signal-1194"><span class="linenos">1194</span></a>        <span class="k">return</span> <span class="n">fundamental</span>
</span><span id="Signal-1195"><a href="#Signal-1195"><span class="linenos">1195</span></a>
</span><span id="Signal-1196"><a href="#Signal-1196"><span class="linenos">1196</span></a>    <span class="k">def</span> <span class="nf">cavity_peak</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal-1197"><a href="#Signal-1197"><span class="linenos">1197</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal-1198"><a href="#Signal-1198"><span class="linenos">1198</span></a><span class="sd">        Finds the Hemlotz cavity frequency index from the Fourier Transform by searching for a peak in the expected</span>
</span><span id="Signal-1199"><a href="#Signal-1199"><span class="linenos">1199</span></a><span class="sd">        range (80 - 100 Hz), if the fundamental is too close to the expected Hemlotz frequency a comment</span>
</span><span id="Signal-1200"><a href="#Signal-1200"><span class="linenos">1200</span></a><span class="sd">        is printed and None is returned.</span>
</span><span id="Signal-1201"><a href="#Signal-1201"><span class="linenos">1201</span></a><span class="sd">        :return: The index of the cavity peak</span>
</span><span id="Signal-1202"><a href="#Signal-1202"><span class="linenos">1202</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal-1203"><a href="#Signal-1203"><span class="linenos">1203</span></a>        <span class="n">first_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">80</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Signal-1204"><a href="#Signal-1204"><span class="linenos">1204</span></a>        <span class="n">second_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">110</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Signal-1205"><a href="#Signal-1205"><span class="linenos">1205</span></a>        <span class="n">cavity_peak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">()[</span><span class="n">first_index</span><span class="p">:</span><span class="n">second_index</span><span class="p">])</span> <span class="o">+</span> <span class="n">first_index</span>
</span><span id="Signal-1206"><a href="#Signal-1206"><span class="linenos">1206</span></a>        <span class="k">return</span> <span class="n">cavity_peak</span>
</span><span id="Signal-1207"><a href="#Signal-1207"><span class="linenos">1207</span></a>
</span><span id="Signal-1208"><a href="#Signal-1208"><span class="linenos">1208</span></a>    <span class="k">def</span> <span class="nf">cavity_frequency</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal-1209"><a href="#Signal-1209"><span class="linenos">1209</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal-1210"><a href="#Signal-1210"><span class="linenos">1210</span></a><span class="sd">        Finds the Hemlotz cavity frequency from the Fourier Transform by searching for a peak in the expected</span>
</span><span id="Signal-1211"><a href="#Signal-1211"><span class="linenos">1211</span></a><span class="sd">        range (80 - 100 Hz), if the fundamental is too close to the expected Hemlotz frequency a comment</span>
</span><span id="Signal-1212"><a href="#Signal-1212"><span class="linenos">1212</span></a><span class="sd">        is printed and None is returned.</span>
</span><span id="Signal-1213"><a href="#Signal-1213"><span class="linenos">1213</span></a><span class="sd">        :return: If successful, the cavity peak frequency</span>
</span><span id="Signal-1214"><a href="#Signal-1214"><span class="linenos">1214</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal-1215"><a href="#Signal-1215"><span class="linenos">1215</span></a>        <span class="n">cavity_peak</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cavity_peak</span><span class="p">()</span>
</span><span id="Signal-1216"><a href="#Signal-1216"><span class="linenos">1216</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fundamental</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[</span><span class="n">cavity_peak</span><span class="p">]:</span>
</span><span id="Signal-1217"><a href="#Signal-1217"><span class="linenos">1217</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cavity peak is obscured by the fundamental&#39;</span><span class="p">)</span>
</span><span id="Signal-1218"><a href="#Signal-1218"><span class="linenos">1218</span></a>            <span class="k">return</span> <span class="mi">0</span>
</span><span id="Signal-1219"><a href="#Signal-1219"><span class="linenos">1219</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Signal-1220"><a href="#Signal-1220"><span class="linenos">1220</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[</span><span class="n">cavity_peak</span><span class="p">]</span>
</span><span id="Signal-1221"><a href="#Signal-1221"><span class="linenos">1221</span></a>
</span><span id="Signal-1222"><a href="#Signal-1222"><span class="linenos">1222</span></a>    <span class="k">def</span> <span class="nf">fft_frequencies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal-1223"><a href="#Signal-1223"><span class="linenos">1223</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal-1224"><a href="#Signal-1224"><span class="linenos">1224</span></a><span class="sd">        Computes the frequency vector associated with the Signal Fourier Transform</span>
</span><span id="Signal-1225"><a href="#Signal-1225"><span class="linenos">1225</span></a><span class="sd">        :return: an array containing the frequency values.</span>
</span><span id="Signal-1226"><a href="#Signal-1226"><span class="linenos">1226</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal-1227"><a href="#Signal-1227"><span class="linenos">1227</span></a>        <span class="n">fft</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">()</span>
</span><span id="Signal-1228"><a href="#Signal-1228"><span class="linenos">1228</span></a>        <span class="n">fft_frequencies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fft</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">)</span>  <span class="c1"># Frequencies corresponding to the bins</span>
</span><span id="Signal-1229"><a href="#Signal-1229"><span class="linenos">1229</span></a>        <span class="k">return</span> <span class="n">fft_frequencies</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">fft</span><span class="p">)]</span>
</span><span id="Signal-1230"><a href="#Signal-1230"><span class="linenos">1230</span></a>
</span><span id="Signal-1231"><a href="#Signal-1231"><span class="linenos">1231</span></a>    <span class="k">def</span> <span class="nf">fft_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal-1232"><a href="#Signal-1232"><span class="linenos">1232</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal-1233"><a href="#Signal-1233"><span class="linenos">1233</span></a><span class="sd">        Transforms the Fourier transform array into a statistic distribution </span>
</span><span id="Signal-1234"><a href="#Signal-1234"><span class="linenos">1234</span></a><span class="sd">        ranging from 0 to 100. </span>
</span><span id="Signal-1235"><a href="#Signal-1235"><span class="linenos">1235</span></a><span class="sd">        Accordingly, the maximum of the Fourier transform with value 1.0 will</span>
</span><span id="Signal-1236"><a href="#Signal-1236"><span class="linenos">1236</span></a><span class="sd">        be equal to 100 and casted as an integer.</span>
</span><span id="Signal-1237"><a href="#Signal-1237"><span class="linenos">1237</span></a><span class="sd">        Values below 0.001 will be equal to 0. </span>
</span><span id="Signal-1238"><a href="#Signal-1238"><span class="linenos">1238</span></a><span class="sd">        This representation of the Fourier transform is used to construct</span>
</span><span id="Signal-1239"><a href="#Signal-1239"><span class="linenos">1239</span></a><span class="sd">        octave bands histograms.</span>
</span><span id="Signal-1240"><a href="#Signal-1240"><span class="linenos">1240</span></a><span class="sd">        :return : a list containing the frequency occurrences.</span>
</span><span id="Signal-1241"><a href="#Signal-1241"><span class="linenos">1241</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal-1242"><a href="#Signal-1242"><span class="linenos">1242</span></a>
</span><span id="Signal-1243"><a href="#Signal-1243"><span class="linenos">1243</span></a>        <span class="c1"># Make the FT values integers</span>
</span><span id="Signal-1244"><a href="#Signal-1244"><span class="linenos">1244</span></a>        <span class="n">fft_integers</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">sample</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">()]</span>
</span><span id="Signal-1245"><a href="#Signal-1245"><span class="linenos">1245</span></a>
</span><span id="Signal-1246"><a href="#Signal-1246"><span class="linenos">1246</span></a>        <span class="c1"># Create a list of the frequency occurrences in the signal</span>
</span><span id="Signal-1247"><a href="#Signal-1247"><span class="linenos">1247</span></a>        <span class="n">occurrences</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Signal-1248"><a href="#Signal-1248"><span class="linenos">1248</span></a>        <span class="k">for</span> <span class="n">freq</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">(),</span> <span class="n">fft_integers</span><span class="p">):</span>
</span><span id="Signal-1249"><a href="#Signal-1249"><span class="linenos">1249</span></a>            <span class="n">occurrences</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">freq</span><span class="p">]</span> <span class="o">*</span> <span class="n">count</span><span class="p">)</span>
</span><span id="Signal-1250"><a href="#Signal-1250"><span class="linenos">1250</span></a>
</span><span id="Signal-1251"><a href="#Signal-1251"><span class="linenos">1251</span></a>        <span class="c1"># flatten the list</span>
</span><span id="Signal-1252"><a href="#Signal-1252"><span class="linenos">1252</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">occurrences</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
</span><span id="Signal-1253"><a href="#Signal-1253"><span class="linenos">1253</span></a>
</span><span id="Signal-1254"><a href="#Signal-1254"><span class="linenos">1254</span></a>    <span class="k">def</span> <span class="nf">envelope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Signal-1255"><a href="#Signal-1255"><span class="linenos">1255</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal-1256"><a href="#Signal-1256"><span class="linenos">1256</span></a><span class="sd">        Method calculating the amplitude envelope of a signal as a</span>
</span><span id="Signal-1257"><a href="#Signal-1257"><span class="linenos">1257</span></a><span class="sd">        maximum of the absolute value of the signal. </span>
</span><span id="Signal-1258"><a href="#Signal-1258"><span class="linenos">1258</span></a><span class="sd">        The same `window` and `overlap` parameters should be used to compute </span>
</span><span id="Signal-1259"><a href="#Signal-1259"><span class="linenos">1259</span></a><span class="sd">        the signal and time arrays so that they contain the same </span>
</span><span id="Signal-1260"><a href="#Signal-1260"><span class="linenos">1260</span></a><span class="sd">        number of points (and can be plotted together).</span>
</span><span id="Signal-1261"><a href="#Signal-1261"><span class="linenos">1261</span></a><span class="sd">        :param window: integer, length in samples of the window used to</span>
</span><span id="Signal-1262"><a href="#Signal-1262"><span class="linenos">1262</span></a><span class="sd">        compute the signal envelope.</span>
</span><span id="Signal-1263"><a href="#Signal-1263"><span class="linenos">1263</span></a><span class="sd">        :param overlap: integer, overlap in samples used to overlap two</span>
</span><span id="Signal-1264"><a href="#Signal-1264"><span class="linenos">1264</span></a><span class="sd">        subsequent windows in the computation of the signal envelope.</span>
</span><span id="Signal-1265"><a href="#Signal-1265"><span class="linenos">1265</span></a><span class="sd">        The overlap value should be smaller than the window value.</span>
</span><span id="Signal-1266"><a href="#Signal-1266"><span class="linenos">1266</span></a><span class="sd">        :return: Amplitude envelope of the signal</span>
</span><span id="Signal-1267"><a href="#Signal-1267"><span class="linenos">1267</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal-1268"><a href="#Signal-1268"><span class="linenos">1268</span></a>        <span class="k">if</span> <span class="n">window</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Signal-1269"><a href="#Signal-1269"><span class="linenos">1269</span></a>            <span class="n">window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">envelope</span><span class="o">.</span><span class="n">frame_size</span><span class="o">.</span><span class="n">value</span>
</span><span id="Signal-1270"><a href="#Signal-1270"><span class="linenos">1270</span></a>        <span class="k">if</span> <span class="n">overlap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Signal-1271"><a href="#Signal-1271"><span class="linenos">1271</span></a>            <span class="n">overlap</span> <span class="o">=</span> <span class="n">window</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="Signal-1272"><a href="#Signal-1272"><span class="linenos">1272</span></a>        <span class="k">elif</span> <span class="n">overlap</span> <span class="o">&gt;=</span> <span class="n">window</span><span class="p">:</span>
</span><span id="Signal-1273"><a href="#Signal-1273"><span class="linenos">1273</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Overlap must be smaller than window&#39;</span><span class="p">)</span>
</span><span id="Signal-1274"><a href="#Signal-1274"><span class="linenos">1274</span></a>        <span class="n">signal_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">)</span>
</span><span id="Signal-1275"><a href="#Signal-1275"><span class="linenos">1275</span></a>        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="Signal-1276"><a href="#Signal-1276"><span class="linenos">1276</span></a>        <span class="c1"># Empty envelope and envelope time</span>
</span><span id="Signal-1277"><a href="#Signal-1277"><span class="linenos">1277</span></a>        <span class="n">env</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Signal-1278"><a href="#Signal-1278"><span class="linenos">1278</span></a>        <span class="n">env_time</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Signal-1279"><a href="#Signal-1279"><span class="linenos">1279</span></a>        <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Signal-1280"><a href="#Signal-1280"><span class="linenos">1280</span></a>        <span class="k">while</span> <span class="n">idx</span> <span class="o">+</span> <span class="n">window</span> <span class="o">&lt;</span> <span class="n">signal_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="Signal-1281"><a href="#Signal-1281"><span class="linenos">1281</span></a>            <span class="n">env</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">signal_array</span><span class="p">[</span><span class="n">idx</span><span class="p">:</span><span class="n">idx</span> <span class="o">+</span> <span class="n">window</span><span class="p">]))</span>
</span><span id="Signal-1282"><a href="#Signal-1282"><span class="linenos">1282</span></a>            <span class="n">pt_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">signal_array</span><span class="p">[</span><span class="n">idx</span><span class="p">:</span><span class="n">idx</span> <span class="o">+</span> <span class="n">window</span><span class="p">])</span> <span class="o">+</span> <span class="n">idx</span>
</span><span id="Signal-1283"><a href="#Signal-1283"><span class="linenos">1283</span></a>            <span class="n">env_time</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">pt_idx</span><span class="p">])</span>
</span><span id="Signal-1284"><a href="#Signal-1284"><span class="linenos">1284</span></a>            <span class="n">idx</span> <span class="o">+=</span> <span class="n">overlap</span>
</span><span id="Signal-1285"><a href="#Signal-1285"><span class="linenos">1285</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">unique_time_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">env_time</span><span class="p">,</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Signal-1286"><a href="#Signal-1286"><span class="linenos">1286</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">env</span><span class="p">)[</span><span class="n">unique_time_index</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">env_time</span><span class="p">)</span>
</span><span id="Signal-1287"><a href="#Signal-1287"><span class="linenos">1287</span></a>
</span><span id="Signal-1288"><a href="#Signal-1288"><span class="linenos">1288</span></a>    <span class="k">def</span> <span class="nf">log_envelope</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal-1289"><a href="#Signal-1289"><span class="linenos">1289</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal-1290"><a href="#Signal-1290"><span class="linenos">1290</span></a><span class="sd">        Computes the logarithmic scale envelope of the signal.</span>
</span><span id="Signal-1291"><a href="#Signal-1291"><span class="linenos">1291</span></a><span class="sd">        The width of the samples increases exponentially so that</span>
</span><span id="Signal-1292"><a href="#Signal-1292"><span class="linenos">1292</span></a><span class="sd">        the envelope appears having a constant window width on</span>
</span><span id="Signal-1293"><a href="#Signal-1293"><span class="linenos">1293</span></a><span class="sd">        an X axis logarithmic scale.</span>
</span><span id="Signal-1294"><a href="#Signal-1294"><span class="linenos">1294</span></a><span class="sd">        :return: The log envelope and the time vector associated in a tuple</span>
</span><span id="Signal-1295"><a href="#Signal-1295"><span class="linenos">1295</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal-1296"><a href="#Signal-1296"><span class="linenos">1296</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">onset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Signal-1297"><a href="#Signal-1297"><span class="linenos">1297</span></a>            <span class="n">onset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">))</span>
</span><span id="Signal-1298"><a href="#Signal-1298"><span class="linenos">1298</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Signal-1299"><a href="#Signal-1299"><span class="linenos">1299</span></a>            <span class="n">onset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">onset</span>
</span><span id="Signal-1300"><a href="#Signal-1300"><span class="linenos">1300</span></a>
</span><span id="Signal-1301"><a href="#Signal-1301"><span class="linenos">1301</span></a>        <span class="n">start_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">log_envelope</span><span class="o">.</span><span class="n">start_time</span><span class="o">.</span><span class="n">value</span>
</span><span id="Signal-1302"><a href="#Signal-1302"><span class="linenos">1302</span></a>        <span class="k">while</span> <span class="n">start_time</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">onset</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">):</span>
</span><span id="Signal-1303"><a href="#Signal-1303"><span class="linenos">1303</span></a>            <span class="n">start_time</span> <span class="o">/=</span> <span class="mf">10.</span>
</span><span id="Signal-1304"><a href="#Signal-1304"><span class="linenos">1304</span></a>
</span><span id="Signal-1305"><a href="#Signal-1305"><span class="linenos">1305</span></a>        <span class="n">start_exponent</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">start_time</span><span class="p">))</span>  <span class="c1"># closest 10^x value for smooth graph</span>
</span><span id="Signal-1306"><a href="#Signal-1306"><span class="linenos">1306</span></a>
</span><span id="Signal-1307"><a href="#Signal-1307"><span class="linenos">1307</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">log_envelope</span><span class="o">.</span><span class="n">min_window</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Signal-1308"><a href="#Signal-1308"><span class="linenos">1308</span></a>            <span class="n">min_window</span> <span class="o">=</span> <span class="mi">15</span> <span class="o">**</span> <span class="p">(</span><span class="n">start_exponent</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span>
</span><span id="Signal-1309"><a href="#Signal-1309"><span class="linenos">1309</span></a>            <span class="k">if</span> <span class="n">min_window</span> <span class="o">&lt;</span> <span class="mi">15</span><span class="p">:</span>  <span class="c1"># Value should at least be 10</span>
</span><span id="Signal-1310"><a href="#Signal-1310"><span class="linenos">1310</span></a>                <span class="n">min_window</span> <span class="o">=</span> <span class="mi">15</span>
</span><span id="Signal-1311"><a href="#Signal-1311"><span class="linenos">1311</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Signal-1312"><a href="#Signal-1312"><span class="linenos">1312</span></a>            <span class="n">min_window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">log_envelope</span><span class="o">.</span><span class="n">min_window</span><span class="o">.</span><span class="n">value</span>
</span><span id="Signal-1313"><a href="#Signal-1313"><span class="linenos">1313</span></a>
</span><span id="Signal-1314"><a href="#Signal-1314"><span class="linenos">1314</span></a>        <span class="c1"># initial values</span>
</span><span id="Signal-1315"><a href="#Signal-1315"><span class="linenos">1315</span></a>        <span class="n">current_exponent</span> <span class="o">=</span> <span class="n">start_exponent</span>
</span><span id="Signal-1316"><a href="#Signal-1316"><span class="linenos">1316</span></a>        <span class="n">current_time</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">current_exponent</span>  <span class="c1"># start time on log scale</span>
</span><span id="Signal-1317"><a href="#Signal-1317"><span class="linenos">1317</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">current_time</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">)</span>  <span class="c1"># Start at the specified time</span>
</span><span id="Signal-1318"><a href="#Signal-1318"><span class="linenos">1318</span></a>        <span class="n">window</span> <span class="o">=</span> <span class="n">min_window</span>  <span class="c1"># number of samples per window</span>
</span><span id="Signal-1319"><a href="#Signal-1319"><span class="linenos">1319</span></a>        <span class="n">overlap</span> <span class="o">=</span> <span class="n">window</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="Signal-1320"><a href="#Signal-1320"><span class="linenos">1320</span></a>        <span class="n">log_envelope</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Signal-1321"><a href="#Signal-1321"><span class="linenos">1321</span></a>        <span class="n">log_envelope_time</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># First value for comparison</span>
</span><span id="Signal-1322"><a href="#Signal-1322"><span class="linenos">1322</span></a>
</span><span id="Signal-1323"><a href="#Signal-1323"><span class="linenos">1323</span></a>        <span class="k">while</span> <span class="n">index</span> <span class="o">+</span> <span class="n">window</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">):</span>
</span><span id="Signal-1324"><a href="#Signal-1324"><span class="linenos">1324</span></a>
</span><span id="Signal-1325"><a href="#Signal-1325"><span class="linenos">1325</span></a>            <span class="k">while</span> <span class="n">log_envelope_time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">current_exponent</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="Signal-1326"><a href="#Signal-1326"><span class="linenos">1326</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="n">window</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">):</span>
</span><span id="Signal-1327"><a href="#Signal-1327"><span class="linenos">1327</span></a>                    <span class="n">log_envelope</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">index</span><span class="p">:</span><span class="n">index</span> <span class="o">+</span> <span class="n">window</span><span class="p">])))</span>
</span><span id="Signal-1328"><a href="#Signal-1328"><span class="linenos">1328</span></a>                    <span class="n">pt_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">index</span><span class="p">:</span><span class="n">index</span> <span class="o">+</span> <span class="n">window</span><span class="p">]))</span>
</span><span id="Signal-1329"><a href="#Signal-1329"><span class="linenos">1329</span></a>                    <span class="n">log_envelope_time</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">()[</span><span class="n">index</span> <span class="o">+</span> <span class="n">pt_idx</span><span class="p">])</span>
</span><span id="Signal-1330"><a href="#Signal-1330"><span class="linenos">1330</span></a>                    <span class="n">index</span> <span class="o">+=</span> <span class="n">overlap</span>
</span><span id="Signal-1331"><a href="#Signal-1331"><span class="linenos">1331</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Signal-1332"><a href="#Signal-1332"><span class="linenos">1332</span></a>                    <span class="k">break</span>
</span><span id="Signal-1333"><a href="#Signal-1333"><span class="linenos">1333</span></a>
</span><span id="Signal-1334"><a href="#Signal-1334"><span class="linenos">1334</span></a>            <span class="k">if</span> <span class="n">window</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">log_envelope</span><span class="o">.</span><span class="n">max_window</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
</span><span id="Signal-1335"><a href="#Signal-1335"><span class="linenos">1335</span></a>                <span class="n">window</span> <span class="o">=</span> <span class="n">window</span> <span class="o">*</span> <span class="mi">10</span>
</span><span id="Signal-1336"><a href="#Signal-1336"><span class="linenos">1336</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Signal-1337"><a href="#Signal-1337"><span class="linenos">1337</span></a>                <span class="n">window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">log_envelope</span><span class="o">.</span><span class="n">max_window</span><span class="o">.</span><span class="n">value</span>
</span><span id="Signal-1338"><a href="#Signal-1338"><span class="linenos">1338</span></a>            <span class="n">overlap</span> <span class="o">=</span> <span class="n">window</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="Signal-1339"><a href="#Signal-1339"><span class="linenos">1339</span></a>            <span class="n">current_exponent</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Signal-1340"><a href="#Signal-1340"><span class="linenos">1340</span></a>        <span class="n">time</span><span class="p">,</span> <span class="n">idxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">log_envelope_time</span><span class="p">,</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Signal-1341"><a href="#Signal-1341"><span class="linenos">1341</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">log_envelope</span><span class="p">)[</span><span class="n">idxs</span><span class="p">],</span> <span class="n">time</span>
</span><span id="Signal-1342"><a href="#Signal-1342"><span class="linenos">1342</span></a>
</span><span id="Signal-1343"><a href="#Signal-1343"><span class="linenos">1343</span></a>    <span class="k">def</span> <span class="nf">find_onset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Signal-1344"><a href="#Signal-1344"><span class="linenos">1344</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal-1345"><a href="#Signal-1345"><span class="linenos">1345</span></a><span class="sd">        Finds the onset as an increase in more of 50% with the maximum normalized value above 0.5</span>
</span><span id="Signal-1346"><a href="#Signal-1346"><span class="linenos">1346</span></a><span class="sd">        :param verbose: Prints a warning if the algorithm does not converge</span>
</span><span id="Signal-1347"><a href="#Signal-1347"><span class="linenos">1347</span></a><span class="sd">        :return: the index of the onset in the signal</span>
</span><span id="Signal-1348"><a href="#Signal-1348"><span class="linenos">1348</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal-1349"><a href="#Signal-1349"><span class="linenos">1349</span></a>        <span class="c1"># Index corresponding to the onset time interval</span>
</span><span id="Signal-1350"><a href="#Signal-1350"><span class="linenos">1350</span></a>        <span class="n">window_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">onset</span><span class="o">.</span><span class="n">onset_time</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="Signal-1351"><a href="#Signal-1351"><span class="linenos">1351</span></a>        <span class="c1"># Use the normalized signal to compare against a fixed value</span>
</span><span id="Signal-1352"><a href="#Signal-1352"><span class="linenos">1352</span></a>        <span class="n">onset_signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
</span><span id="Signal-1353"><a href="#Signal-1353"><span class="linenos">1353</span></a>        <span class="n">overlap</span> <span class="o">=</span> <span class="n">window_index</span> <span class="o">//</span> <span class="mi">2</span>  <span class="c1"># overlap for algorithm progression</span>
</span><span id="Signal-1354"><a href="#Signal-1354"><span class="linenos">1354</span></a>        <span class="c1"># Initial values</span>
</span><span id="Signal-1355"><a href="#Signal-1355"><span class="linenos">1355</span></a>        <span class="n">increase</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Signal-1356"><a href="#Signal-1356"><span class="linenos">1356</span></a>        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Signal-1357"><a href="#Signal-1357"><span class="linenos">1357</span></a>        <span class="n">broke</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Signal-1358"><a href="#Signal-1358"><span class="linenos">1358</span></a>        <span class="k">while</span> <span class="n">increase</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">:</span>
</span><span id="Signal-1359"><a href="#Signal-1359"><span class="linenos">1359</span></a>            <span class="n">signal_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">onset_signal</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_index</span><span class="p">]))</span>
</span><span id="Signal-1360"><a href="#Signal-1360"><span class="linenos">1360</span></a>            <span class="n">signal_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">onset_signal</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_index</span><span class="p">]))</span>
</span><span id="Signal-1361"><a href="#Signal-1361"><span class="linenos">1361</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">signal_max</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">signal_min</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="Signal-1362"><a href="#Signal-1362"><span class="linenos">1362</span></a>                <span class="n">increase</span> <span class="o">=</span> <span class="n">signal_max</span> <span class="o">/</span> <span class="n">signal_min</span>
</span><span id="Signal-1363"><a href="#Signal-1363"><span class="linenos">1363</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Signal-1364"><a href="#Signal-1364"><span class="linenos">1364</span></a>                <span class="n">increase</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Signal-1365"><a href="#Signal-1365"><span class="linenos">1365</span></a>            <span class="n">i</span> <span class="o">+=</span> <span class="n">overlap</span>
</span><span id="Signal-1366"><a href="#Signal-1366"><span class="linenos">1366</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="n">window_index</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">):</span>
</span><span id="Signal-1367"><a href="#Signal-1367"><span class="linenos">1367</span></a>                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Signal-1368"><a href="#Signal-1368"><span class="linenos">1368</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Onset detection did not converge </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Signal-1369"><a href="#Signal-1369"><span class="linenos">1369</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Approximating onset with signal max value </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Signal-1370"><a href="#Signal-1370"><span class="linenos">1370</span></a>                <span class="n">broke</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Signal-1371"><a href="#Signal-1371"><span class="linenos">1371</span></a>                <span class="k">break</span>
</span><span id="Signal-1372"><a href="#Signal-1372"><span class="linenos">1372</span></a>        <span class="k">if</span> <span class="n">broke</span><span class="p">:</span>
</span><span id="Signal-1373"><a href="#Signal-1373"><span class="linenos">1373</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">))</span>
</span><span id="Signal-1374"><a href="#Signal-1374"><span class="linenos">1374</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Signal-1375"><a href="#Signal-1375"><span class="linenos">1375</span></a>            <span class="n">i</span> <span class="o">-=</span> <span class="n">overlap</span>
</span><span id="Signal-1376"><a href="#Signal-1376"><span class="linenos">1376</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_index</span><span class="p">]))</span> <span class="o">+</span> <span class="n">i</span> 
</span><span id="Signal-1377"><a href="#Signal-1377"><span class="linenos">1377</span></a>
</span><span id="Signal-1378"><a href="#Signal-1378"><span class="linenos">1378</span></a>    <span class="k">def</span> <span class="nf">trim_onset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Signal-1379"><a href="#Signal-1379"><span class="linenos">1379</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal-1380"><a href="#Signal-1380"><span class="linenos">1380</span></a><span class="sd">        Trim the signal at the onset (max) minus the delay in milliseconds as</span>
</span><span id="Signal-1381"><a href="#Signal-1381"><span class="linenos">1381</span></a><span class="sd">        Specified in the SoundParameters</span>
</span><span id="Signal-1382"><a href="#Signal-1382"><span class="linenos">1382</span></a><span class="sd">        :param verbose: if False the warning comments are not displayed</span>
</span><span id="Signal-1383"><a href="#Signal-1383"><span class="linenos">1383</span></a><span class="sd">        :return : The trimmed signal</span>
</span><span id="Signal-1384"><a href="#Signal-1384"><span class="linenos">1384</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal-1385"><a href="#Signal-1385"><span class="linenos">1385</span></a>        <span class="c1"># nb of samples to keep before the onset</span>
</span><span id="Signal-1386"><a href="#Signal-1386"><span class="linenos">1386</span></a>        <span class="n">delay_samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">onset</span><span class="o">.</span><span class="n">onset_delay</span><span class="o">.</span><span class="n">value</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">)</span>
</span><span id="Signal-1387"><a href="#Signal-1387"><span class="linenos">1387</span></a>        <span class="n">onset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_onset</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>  <span class="c1"># find the onset</span>
</span><span id="Signal-1388"><a href="#Signal-1388"><span class="linenos">1388</span></a>
</span><span id="Signal-1389"><a href="#Signal-1389"><span class="linenos">1389</span></a>        <span class="k">if</span> <span class="n">onset</span> <span class="o">&gt;</span> <span class="n">delay_samples</span><span class="p">:</span>  <span class="c1"># To make sure the index is positive</span>
</span><span id="Signal-1390"><a href="#Signal-1390"><span class="linenos">1390</span></a>            <span class="n">new_signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">onset</span> <span class="o">-</span> <span class="n">delay_samples</span><span class="p">:]</span>
</span><span id="Signal-1391"><a href="#Signal-1391"><span class="linenos">1391</span></a>            <span class="n">new_signal</span><span class="p">[:</span><span class="n">delay_samples</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_signal</span><span class="p">[:</span><span class="n">delay_samples</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">delay_samples</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> 
</span><span id="Signal-1392"><a href="#Signal-1392"><span class="linenos">1392</span></a>            <span class="n">trimmed_signal</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">(</span><span class="n">new_signal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">)</span>
</span><span id="Signal-1393"><a href="#Signal-1393"><span class="linenos">1393</span></a>            <span class="n">trimmed_signal</span><span class="o">.</span><span class="n">onset</span> <span class="o">=</span> <span class="n">trimmed_signal</span><span class="o">.</span><span class="n">find_onset</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="Signal-1394"><a href="#Signal-1394"><span class="linenos">1394</span></a>            <span class="k">return</span> <span class="n">trimmed_signal</span>
</span><span id="Signal-1395"><a href="#Signal-1395"><span class="linenos">1395</span></a>
</span><span id="Signal-1396"><a href="#Signal-1396"><span class="linenos">1396</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Signal-1397"><a href="#Signal-1397"><span class="linenos">1397</span></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Signal-1398"><a href="#Signal-1398"><span class="linenos">1398</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Signal is too short to be trimmed before onset.&#39;</span><span class="p">)</span>
</span><span id="Signal-1399"><a href="#Signal-1399"><span class="linenos">1399</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="Signal-1400"><a href="#Signal-1400"><span class="linenos">1400</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Signal-1401"><a href="#Signal-1401"><span class="linenos">1401</span></a>
</span><span id="Signal-1402"><a href="#Signal-1402"><span class="linenos">1402</span></a>    <span class="k">def</span> <span class="nf">trim_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_length</span><span class="p">):</span>
</span><span id="Signal-1403"><a href="#Signal-1403"><span class="linenos">1403</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal-1404"><a href="#Signal-1404"><span class="linenos">1404</span></a><span class="sd">        Trims the signal to the specified length and returns a new Signal instance.</span>
</span><span id="Signal-1405"><a href="#Signal-1405"><span class="linenos">1405</span></a><span class="sd">        :param time_length: desired length of the new signal in seconds.</span>
</span><span id="Signal-1406"><a href="#Signal-1406"><span class="linenos">1406</span></a><span class="sd">        :return: A trimmed Signal</span>
</span><span id="Signal-1407"><a href="#Signal-1407"><span class="linenos">1407</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal-1408"><a href="#Signal-1408"><span class="linenos">1408</span></a>        <span class="n">max_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time_length</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">)</span>
</span><span id="Signal-1409"><a href="#Signal-1409"><span class="linenos">1409</span></a>        <span class="n">new_signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[:</span><span class="n">max_index</span><span class="p">]</span>
</span><span id="Signal-1410"><a href="#Signal-1410"><span class="linenos">1410</span></a>        <span class="n">new_signal</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:]</span> <span class="o">=</span> <span class="n">new_signal</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</span><span id="Signal-1411"><a href="#Signal-1411"><span class="linenos">1411</span></a>        <span class="n">time_trimmed_signal</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">(</span><span class="n">new_signal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">)</span>
</span><span id="Signal-1412"><a href="#Signal-1412"><span class="linenos">1412</span></a>        <span class="k">return</span> <span class="n">time_trimmed_signal</span>
</span><span id="Signal-1413"><a href="#Signal-1413"><span class="linenos">1413</span></a>
</span><span id="Signal-1414"><a href="#Signal-1414"><span class="linenos">1414</span></a>    <span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal-1415"><a href="#Signal-1415"><span class="linenos">1415</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal-1416"><a href="#Signal-1416"><span class="linenos">1416</span></a><span class="sd">        Normalizes the signal to [-1, 1] and returns the normalized instance.</span>
</span><span id="Signal-1417"><a href="#Signal-1417"><span class="linenos">1417</span></a><span class="sd">        return : A normalized signal</span>
</span><span id="Signal-1418"><a href="#Signal-1418"><span class="linenos">1418</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal-1419"><a href="#Signal-1419"><span class="linenos">1419</span></a>        <span class="n">factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">))</span>
</span><span id="Signal-1420"><a href="#Signal-1420"><span class="linenos">1420</span></a>        <span class="n">normalised_signal</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">/</span> <span class="n">factor</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">)</span>
</span><span id="Signal-1421"><a href="#Signal-1421"><span class="linenos">1421</span></a>        <span class="n">normalised_signal</span><span class="o">.</span><span class="n">norm_factor</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">factor</span><span class="p">)</span>
</span><span id="Signal-1422"><a href="#Signal-1422"><span class="linenos">1422</span></a>        <span class="k">return</span> <span class="n">normalised_signal</span>
</span><span id="Signal-1423"><a href="#Signal-1423"><span class="linenos">1423</span></a>
</span><span id="Signal-1424"><a href="#Signal-1424"><span class="linenos">1424</span></a>    <span class="k">def</span> <span class="nf">make_freq_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal-1425"><a href="#Signal-1425"><span class="linenos">1425</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal-1426"><a href="#Signal-1426"><span class="linenos">1426</span></a><span class="sd">        Method to divide a signal in frequency bins using butterworth filters</span>
</span><span id="Signal-1427"><a href="#Signal-1427"><span class="linenos">1427</span></a><span class="sd">        bins are passed as a dict, default values are :</span>
</span><span id="Signal-1428"><a href="#Signal-1428"><span class="linenos">1428</span></a><span class="sd">        - bass &lt; 100 Hz</span>
</span><span id="Signal-1429"><a href="#Signal-1429"><span class="linenos">1429</span></a><span class="sd">        - mid = 100 - 700 Hz</span>
</span><span id="Signal-1430"><a href="#Signal-1430"><span class="linenos">1430</span></a><span class="sd">        - highmid = 700 - 2000 Hz</span>
</span><span id="Signal-1431"><a href="#Signal-1431"><span class="linenos">1431</span></a><span class="sd">        - uppermid = 2000 - 4000 Hz</span>
</span><span id="Signal-1432"><a href="#Signal-1432"><span class="linenos">1432</span></a><span class="sd">        - presence = 4000 - 6000 Hz</span>
</span><span id="Signal-1433"><a href="#Signal-1433"><span class="linenos">1433</span></a><span class="sd">        - brillance &gt; 6000 Hz</span>
</span><span id="Signal-1434"><a href="#Signal-1434"><span class="linenos">1434</span></a><span class="sd">        :return : A dictionary with the divided signal as values and bin names as keys</span>
</span><span id="Signal-1435"><a href="#Signal-1435"><span class="linenos">1435</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal-1436"><a href="#Signal-1436"><span class="linenos">1436</span></a>
</span><span id="Signal-1437"><a href="#Signal-1437"><span class="linenos">1437</span></a>        <span class="n">bins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="vm">__dict__</span>
</span><span id="Signal-1438"><a href="#Signal-1438"><span class="linenos">1438</span></a>
</span><span id="Signal-1439"><a href="#Signal-1439"><span class="linenos">1439</span></a>        <span class="n">bass_filter</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s2">&quot;bass&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;lp&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
</span><span id="Signal-1440"><a href="#Signal-1440"><span class="linenos">1440</span></a>        <span class="n">mid_filter</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s2">&quot;bass&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s1">&#39;mid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">],</span> <span class="s1">&#39;bp&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
</span><span id="Signal-1441"><a href="#Signal-1441"><span class="linenos">1441</span></a>        <span class="n">himid_filter</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s2">&quot;mid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s1">&#39;highmid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">],</span> <span class="s1">&#39;bp&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
</span><span id="Signal-1442"><a href="#Signal-1442"><span class="linenos">1442</span></a>        <span class="n">upmid_filter</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s2">&quot;highmid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s1">&#39;uppermid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">],</span> <span class="s1">&#39;bp&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
</span><span id="Signal-1443"><a href="#Signal-1443"><span class="linenos">1443</span></a>        <span class="n">pres_filter</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s2">&quot;uppermid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s1">&#39;presence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">],</span> <span class="s1">&#39;bp&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
</span><span id="Signal-1444"><a href="#Signal-1444"><span class="linenos">1444</span></a>        <span class="n">bril_filter</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s1">&#39;presence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;hp&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
</span><span id="Signal-1445"><a href="#Signal-1445"><span class="linenos">1445</span></a>
</span><span id="Signal-1446"><a href="#Signal-1446"><span class="linenos">1446</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="Signal-1447"><a href="#Signal-1447"><span class="linenos">1447</span></a>            <span class="s2">&quot;bass&quot;</span><span class="p">:</span> <span class="n">Signal</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">bass_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">,</span>
</span><span id="Signal-1448"><a href="#Signal-1448"><span class="linenos">1448</span></a>                           <span class="n">freq_range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s2">&quot;bass&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">]),</span>
</span><span id="Signal-1449"><a href="#Signal-1449"><span class="linenos">1449</span></a>            <span class="s2">&quot;mid&quot;</span><span class="p">:</span> <span class="n">Signal</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">mid_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">,</span>
</span><span id="Signal-1450"><a href="#Signal-1450"><span class="linenos">1450</span></a>                          <span class="n">freq_range</span><span class="o">=</span><span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s2">&quot;bass&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s2">&quot;mid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">]),</span>
</span><span id="Signal-1451"><a href="#Signal-1451"><span class="linenos">1451</span></a>            <span class="s2">&quot;highmid&quot;</span><span class="p">:</span> <span class="n">Signal</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">himid_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">,</span>
</span><span id="Signal-1452"><a href="#Signal-1452"><span class="linenos">1452</span></a>                              <span class="n">freq_range</span><span class="o">=</span><span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s2">&quot;mid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s2">&quot;highmid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">]),</span>
</span><span id="Signal-1453"><a href="#Signal-1453"><span class="linenos">1453</span></a>            <span class="s2">&quot;uppermid&quot;</span><span class="p">:</span> <span class="n">Signal</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">upmid_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">,</span>
</span><span id="Signal-1454"><a href="#Signal-1454"><span class="linenos">1454</span></a>                               <span class="n">freq_range</span><span class="o">=</span><span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s2">&quot;highmid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s2">&quot;uppermid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">]),</span>
</span><span id="Signal-1455"><a href="#Signal-1455"><span class="linenos">1455</span></a>            <span class="s2">&quot;presence&quot;</span><span class="p">:</span> <span class="n">Signal</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">pres_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">,</span>
</span><span id="Signal-1456"><a href="#Signal-1456"><span class="linenos">1456</span></a>                               <span class="n">freq_range</span><span class="o">=</span><span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s1">&#39;uppermid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s2">&quot;presence&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">]),</span>
</span><span id="Signal-1457"><a href="#Signal-1457"><span class="linenos">1457</span></a>            <span class="s2">&quot;brillance&quot;</span><span class="p">:</span> <span class="n">Signal</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">bril_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">,</span>
</span><span id="Signal-1458"><a href="#Signal-1458"><span class="linenos">1458</span></a>                                <span class="n">freq_range</span><span class="o">=</span><span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s2">&quot;presence&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">())])}</span>
</span><span id="Signal-1459"><a href="#Signal-1459"><span class="linenos">1459</span></a>
</span><span id="Signal-1460"><a href="#Signal-1460"><span class="linenos">1460</span></a>    <span class="k">def</span> <span class="nf">save_wav</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
</span><span id="Signal-1461"><a href="#Signal-1461"><span class="linenos">1461</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal-1462"><a href="#Signal-1462"><span class="linenos">1462</span></a><span class="sd">        Create a soundfile from a signal</span>
</span><span id="Signal-1463"><a href="#Signal-1463"><span class="linenos">1463</span></a><span class="sd">        :param name: the name of the saved file</span>
</span><span id="Signal-1464"><a href="#Signal-1464"><span class="linenos">1464</span></a><span class="sd">        :param path: the path were the &#39;.wav&#39; file is saved</span>
</span><span id="Signal-1465"><a href="#Signal-1465"><span class="linenos">1465</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal-1466"><a href="#Signal-1466"><span class="linenos">1466</span></a>        <span class="n">write</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;.wav&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>A Class to do computations on an audio signal.</p>

<p>The signal is never changed in the class, when transformations are made, a new instance is returned.</p>
</div>


                            <div id="Signal.__init__" class="classattr">
                                        <input id="Signal.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Signal</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">signal</span>, </span><span class="param"><span class="n">sr</span>, </span><span class="param"><span class="n">SoundParam</span>, </span><span class="param"><span class="n">freq_range</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Signal.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Signal.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Signal.__init__-985"><a href="#Signal.__init__-985"><span class="linenos"> 985</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">SoundParam</span><span class="p">,</span> <span class="n">freq_range</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Signal.__init__-986"><a href="#Signal.__init__-986"><span class="linenos"> 986</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
</span><span id="Signal.__init__-987"><a href="#Signal.__init__-987"><span class="linenos"> 987</span></a><span class="sd">        Create a Signal class from a vector of samples and a sample rate</span>
</span><span id="Signal.__init__-988"><a href="#Signal.__init__-988"><span class="linenos"> 988</span></a><span class="sd">        :param signal: vector containing the signal samples</span>
</span><span id="Signal.__init__-989"><a href="#Signal.__init__-989"><span class="linenos"> 989</span></a><span class="sd">        :param sr: sample rate of the signal (Hz)</span>
</span><span id="Signal.__init__-990"><a href="#Signal.__init__-990"><span class="linenos"> 990</span></a><span class="sd">        :param SoundParam: Sound Parameter instance to use with the signal</span>
</span><span id="Signal.__init__-991"><a href="#Signal.__init__-991"><span class="linenos"> 991</span></a><span class="sd">        :para freq_range: Frequency range to use with the signal.</span>
</span><span id="Signal.__init__-992"><a href="#Signal.__init__-992"><span class="linenos"> 992</span></a><span class="sd">        This is the maximum frequency used when computing Fourier transform</span>
</span><span id="Signal.__init__-993"><a href="#Signal.__init__-993"><span class="linenos"> 993</span></a><span class="sd">        peaks and plotting Fourier transform related plots.</span>
</span><span id="Signal.__init__-994"><a href="#Signal.__init__-994"><span class="linenos"> 994</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal.__init__-995"><a href="#Signal.__init__-995"><span class="linenos"> 995</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">SP</span> <span class="o">=</span> <span class="n">SoundParam</span>
</span><span id="Signal.__init__-996"><a href="#Signal.__init__-996"><span class="linenos"> 996</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">onset</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Signal.__init__-997"><a href="#Signal.__init__-997"><span class="linenos"> 997</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="n">signal</span>
</span><span id="Signal.__init__-998"><a href="#Signal.__init__-998"><span class="linenos"> 998</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sr</span> <span class="o">=</span> <span class="n">sr</span>
</span><span id="Signal.__init__-999"><a href="#Signal.__init__-999"><span class="linenos"> 999</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">range</span> <span class="o">=</span> <span class="n">freq_range</span>
</span><span id="Signal.__init__-1000"><a href="#Signal.__init__-1000"><span class="linenos">1000</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span> <span class="o">=</span> <span class="n">Plot</span><span class="p">()</span>
</span><span id="Signal.__init__-1001"><a href="#Signal.__init__-1001"><span class="linenos">1001</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Signal.__init__-1002"><a href="#Signal.__init__-1002"><span class="linenos">1002</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">norm_factor</span> <span class="o">=</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Create a Signal class from a vector of samples and a sample rate</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>signal</strong>:  vector containing the signal samples</li>
<li><strong>sr</strong>:  sample rate of the signal (Hz)</li>
<li><strong>SoundParam</strong>:  Sound Parameter instance to use with the signal
:para freq_range: Frequency range to use with the signal.
This is the maximum frequency used when computing Fourier transform
peaks and plotting Fourier transform related plots.</li>
</ul>
</div>


                            </div>
                            <div id="Signal.time" class="classattr">
                                        <input id="Signal.time-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">time</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Signal.time-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Signal.time"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Signal.time-1004"><a href="#Signal.time-1004"><span class="linenos">1004</span></a>    <span class="k">def</span> <span class="nf">time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal.time-1005"><a href="#Signal.time-1005"><span class="linenos">1005</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal.time-1006"><a href="#Signal.time-1006"><span class="linenos">1006</span></a><span class="sd">        Returns the time vector associated with the signal</span>
</span><span id="Signal.time-1007"><a href="#Signal.time-1007"><span class="linenos">1007</span></a><span class="sd">        :return: numpy array corresponding to the time values</span>
</span><span id="Signal.time-1008"><a href="#Signal.time-1008"><span class="linenos">1008</span></a><span class="sd">        of the signal samples in seconds</span>
</span><span id="Signal.time-1009"><a href="#Signal.time-1009"><span class="linenos">1009</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal.time-1010"><a href="#Signal.time-1010"><span class="linenos">1010</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Signal.time-1011"><a href="#Signal.time-1011"><span class="linenos">1011</span></a>                           <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">),</span>
</span><span id="Signal.time-1012"><a href="#Signal.time-1012"><span class="linenos">1012</span></a>                           <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Returns the time vector associated with the signal</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>numpy array corresponding to the time values
  of the signal samples in seconds</p>
</blockquote>
</div>


                            </div>
                            <div id="Signal.listen" class="classattr">
                                        <input id="Signal.listen-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">listen</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Signal.listen-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Signal.listen"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Signal.listen-1014"><a href="#Signal.listen-1014"><span class="linenos">1014</span></a>    <span class="k">def</span> <span class="nf">listen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal.listen-1015"><a href="#Signal.listen-1015"><span class="linenos">1015</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal.listen-1016"><a href="#Signal.listen-1016"><span class="linenos">1016</span></a><span class="sd">        Method to listen the sound signal in a Jupyter Notebook</span>
</span><span id="Signal.listen-1017"><a href="#Signal.listen-1017"><span class="linenos">1017</span></a>
</span><span id="Signal.listen-1018"><a href="#Signal.listen-1018"><span class="linenos">1018</span></a><span class="sd">        Listening to the sounds imported in the analysis tool allows the</span>
</span><span id="Signal.listen-1019"><a href="#Signal.listen-1019"><span class="linenos">1019</span></a><span class="sd">        user to validate if the sound was well trimmed and filtered</span>
</span><span id="Signal.listen-1020"><a href="#Signal.listen-1020"><span class="linenos">1020</span></a>
</span><span id="Signal.listen-1021"><a href="#Signal.listen-1021"><span class="linenos">1021</span></a><span class="sd">        A temporary file is created, the IPython display Audio function is</span>
</span><span id="Signal.listen-1022"><a href="#Signal.listen-1022"><span class="linenos">1022</span></a><span class="sd">        called on it and then the file is removed</span>
</span><span id="Signal.listen-1023"><a href="#Signal.listen-1023"><span class="linenos">1023</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal.listen-1024"><a href="#Signal.listen-1024"><span class="linenos">1024</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="s1">&#39;temp.wav&#39;</span>
</span><span id="Signal.listen-1025"><a href="#Signal.listen-1025"><span class="linenos">1025</span></a>        <span class="n">write</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">)</span>
</span><span id="Signal.listen-1026"><a href="#Signal.listen-1026"><span class="linenos">1026</span></a>        <span class="n">ipd</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">ipd</span><span class="o">.</span><span class="n">Audio</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>
</span><span id="Signal.listen-1027"><a href="#Signal.listen-1027"><span class="linenos">1027</span></a>        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Method to listen the sound signal in a Jupyter Notebook</p>

<p>Listening to the sounds imported in the analysis tool allows the
user to validate if the sound was well trimmed and filtered</p>

<p>A temporary file is created, the IPython display Audio function is
called on it and then the file is removed</p>
</div>


                            </div>
                            <div id="Signal.old_plot" class="classattr">
                                        <input id="Signal.old_plot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">old_plot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">kind</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Signal.old_plot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Signal.old_plot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Signal.old_plot-1029"><a href="#Signal.old_plot-1029"><span class="linenos">1029</span></a>    <span class="k">def</span> <span class="nf">old_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Signal.old_plot-1030"><a href="#Signal.old_plot-1030"><span class="linenos">1030</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal.old_plot-1031"><a href="#Signal.old_plot-1031"><span class="linenos">1031</span></a><span class="sd">        Convenience function for the different signal plots</span>
</span><span id="Signal.old_plot-1032"><a href="#Signal.old_plot-1032"><span class="linenos">1032</span></a>
</span><span id="Signal.old_plot-1033"><a href="#Signal.old_plot-1033"><span class="linenos">1033</span></a><span class="sd">        Calls the function corresponding to Plot.kind()</span>
</span><span id="Signal.old_plot-1034"><a href="#Signal.old_plot-1034"><span class="linenos">1034</span></a><span class="sd">        See help(guitarsounds.analysis.Plot) for info on the different plots</span>
</span><span id="Signal.old_plot-1035"><a href="#Signal.old_plot-1035"><span class="linenos">1035</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal.old_plot-1036"><a href="#Signal.old_plot-1036"><span class="linenos">1036</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">method_dict</span><span class="p">[</span><span class="n">kind</span><span class="p">](</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Convenience function for the different signal plots</p>

<p>Calls the function corresponding to Plot.kind()
See help(<a href="#Plot">guitarsounds.analysis.Plot</a>) for info on the different plots</p>
</div>


                            </div>
                            <div id="Signal.fft" class="classattr">
                                        <input id="Signal.fft-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fft</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Signal.fft-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Signal.fft"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Signal.fft-1038"><a href="#Signal.fft-1038"><span class="linenos">1038</span></a>    <span class="k">def</span> <span class="nf">fft</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal.fft-1039"><a href="#Signal.fft-1039"><span class="linenos">1039</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal.fft-1040"><a href="#Signal.fft-1040"><span class="linenos">1040</span></a><span class="sd">        Computes the Fast Fourier Transform of the signal and returns the vector.</span>
</span><span id="Signal.fft-1041"><a href="#Signal.fft-1041"><span class="linenos">1041</span></a><span class="sd">        :return: Fast Fourier Transform amplitude values in a numpy array</span>
</span><span id="Signal.fft-1042"><a href="#Signal.fft-1042"><span class="linenos">1042</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal.fft-1043"><a href="#Signal.fft-1043"><span class="linenos">1043</span></a>        <span class="n">fft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">)</span>
</span><span id="Signal.fft-1044"><a href="#Signal.fft-1044"><span class="linenos">1044</span></a>        <span class="n">fft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fft</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fft</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)])</span>  <span class="c1"># Only the symmetric part of the absolute value</span>
</span><span id="Signal.fft-1045"><a href="#Signal.fft-1045"><span class="linenos">1045</span></a>        <span class="k">return</span> <span class="n">fft</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">fft</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Computes the Fast Fourier Transform of the signal and returns the vector.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Fast Fourier Transform amplitude values in a numpy array</p>
</blockquote>
</div>


                            </div>
                            <div id="Signal.spectral_centroid" class="classattr">
                                        <input id="Signal.spectral_centroid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">spectral_centroid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Signal.spectral_centroid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Signal.spectral_centroid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Signal.spectral_centroid-1047"><a href="#Signal.spectral_centroid-1047"><span class="linenos">1047</span></a>    <span class="k">def</span> <span class="nf">spectral_centroid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal.spectral_centroid-1048"><a href="#Signal.spectral_centroid-1048"><span class="linenos">1048</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal.spectral_centroid-1049"><a href="#Signal.spectral_centroid-1049"><span class="linenos">1049</span></a><span class="sd">        Spectral centroid of the frequency content of the signal</span>
</span><span id="Signal.spectral_centroid-1050"><a href="#Signal.spectral_centroid-1050"><span class="linenos">1050</span></a><span class="sd">        :return: Spectral centroid of the signal (float)</span>
</span><span id="Signal.spectral_centroid-1051"><a href="#Signal.spectral_centroid-1051"><span class="linenos">1051</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal.spectral_centroid-1052"><a href="#Signal.spectral_centroid-1052"><span class="linenos">1052</span></a>        <span class="n">SC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">()</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">())</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">())</span>
</span><span id="Signal.spectral_centroid-1053"><a href="#Signal.spectral_centroid-1053"><span class="linenos">1053</span></a>        <span class="k">return</span> <span class="n">SC</span>
</span></pre></div>


            <div class="docstring"><p>Spectral centroid of the frequency content of the signal</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Spectral centroid of the signal (float)</p>
</blockquote>
</div>


                            </div>
                            <div id="Signal.peaks" class="classattr">
                                        <input id="Signal.peaks-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">peaks</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">max_freq</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">height</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="n">result</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Signal.peaks-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Signal.peaks"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Signal.peaks-1056"><a href="#Signal.peaks-1056"><span class="linenos">1056</span></a>    <span class="k">def</span> <span class="nf">peaks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">result</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Signal.peaks-1057"><a href="#Signal.peaks-1057"><span class="linenos">1057</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal.peaks-1058"><a href="#Signal.peaks-1058"><span class="linenos">1058</span></a><span class="sd">        Computes the harmonic peaks indexes from the FFT of the signal</span>
</span><span id="Signal.peaks-1059"><a href="#Signal.peaks-1059"><span class="linenos">1059</span></a><span class="sd">        :param max_freq: Supply a max frequency value overriding the one in</span>
</span><span id="Signal.peaks-1060"><a href="#Signal.peaks-1060"><span class="linenos">1060</span></a><span class="sd">        guitarsounds_parameters</span>
</span><span id="Signal.peaks-1061"><a href="#Signal.peaks-1061"><span class="linenos">1061</span></a><span class="sd">        :param height: if True the height threshold is returned to be used</span>
</span><span id="Signal.peaks-1062"><a href="#Signal.peaks-1062"><span class="linenos">1062</span></a><span class="sd">        in the &#39;peaks&#39; plot</span>
</span><span id="Signal.peaks-1063"><a href="#Signal.peaks-1063"><span class="linenos">1063</span></a><span class="sd">        :param result: if True the Scipy peak finding results dictionary</span>
</span><span id="Signal.peaks-1064"><a href="#Signal.peaks-1064"><span class="linenos">1064</span></a><span class="sd">        is returned</span>
</span><span id="Signal.peaks-1065"><a href="#Signal.peaks-1065"><span class="linenos">1065</span></a><span class="sd">        :return: peak indexes</span>
</span><span id="Signal.peaks-1066"><a href="#Signal.peaks-1066"><span class="linenos">1066</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal.peaks-1067"><a href="#Signal.peaks-1067"><span class="linenos">1067</span></a>        <span class="c1"># Replace None by the default value</span>
</span><span id="Signal.peaks-1068"><a href="#Signal.peaks-1068"><span class="linenos">1068</span></a>        <span class="k">if</span> <span class="n">max_freq</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Signal.peaks-1069"><a href="#Signal.peaks-1069"><span class="linenos">1069</span></a>            <span class="n">max_freq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">fft_range</span><span class="o">.</span><span class="n">value</span>
</span><span id="Signal.peaks-1070"><a href="#Signal.peaks-1070"><span class="linenos">1070</span></a>
</span><span id="Signal.peaks-1071"><a href="#Signal.peaks-1071"><span class="linenos">1071</span></a>        <span class="c1"># Get the fft and fft frequencies from the signal</span>
</span><span id="Signal.peaks-1072"><a href="#Signal.peaks-1072"><span class="linenos">1072</span></a>        <span class="n">fft</span><span class="p">,</span> <span class="n">fft_freq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span>
</span><span id="Signal.peaks-1073"><a href="#Signal.peaks-1073"><span class="linenos">1073</span></a>
</span><span id="Signal.peaks-1074"><a href="#Signal.peaks-1074"><span class="linenos">1074</span></a>        <span class="c1"># Find the max index</span>
</span><span id="Signal.peaks-1075"><a href="#Signal.peaks-1075"><span class="linenos">1075</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Signal.peaks-1076"><a href="#Signal.peaks-1076"><span class="linenos">1076</span></a>            <span class="n">max_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fft_freq</span> <span class="o">&gt;=</span> <span class="n">max_freq</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Signal.peaks-1077"><a href="#Signal.peaks-1077"><span class="linenos">1077</span></a>        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
</span><span id="Signal.peaks-1078"><a href="#Signal.peaks-1078"><span class="linenos">1078</span></a>            <span class="n">max_index</span> <span class="o">=</span> <span class="n">fft_freq</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> 
</span><span id="Signal.peaks-1079"><a href="#Signal.peaks-1079"><span class="linenos">1079</span></a>
</span><span id="Signal.peaks-1080"><a href="#Signal.peaks-1080"><span class="linenos">1080</span></a>        <span class="c1"># Find an approximation of the distance between peaks, this only works for harmonic signals</span>
</span><span id="Signal.peaks-1081"><a href="#Signal.peaks-1081"><span class="linenos">1081</span></a>        <span class="n">peak_distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">fft</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="Signal.peaks-1082"><a href="#Signal.peaks-1082"><span class="linenos">1082</span></a>
</span><span id="Signal.peaks-1083"><a href="#Signal.peaks-1083"><span class="linenos">1083</span></a>        <span class="c1"># Maximum of the signal in a small region on both ends</span>
</span><span id="Signal.peaks-1084"><a href="#Signal.peaks-1084"><span class="linenos">1084</span></a>        <span class="n">fft_max_start</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">fft</span><span class="p">[:</span><span class="n">peak_distance</span><span class="p">])</span>
</span><span id="Signal.peaks-1085"><a href="#Signal.peaks-1085"><span class="linenos">1085</span></a>        <span class="n">fft_max_end</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">fft</span><span class="p">[</span><span class="n">max_index</span> <span class="o">-</span> <span class="n">peak_distance</span><span class="p">:</span><span class="n">max_index</span><span class="p">])</span>
</span><span id="Signal.peaks-1086"><a href="#Signal.peaks-1086"><span class="linenos">1086</span></a>
</span><span id="Signal.peaks-1087"><a href="#Signal.peaks-1087"><span class="linenos">1087</span></a>        <span class="c1"># Build the curve below the peaks but above the noise</span>
</span><span id="Signal.peaks-1088"><a href="#Signal.peaks-1088"><span class="linenos">1088</span></a>        <span class="n">exponents</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fft_max_start</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fft_max_end</span><span class="p">),</span> <span class="n">max_index</span><span class="p">)</span>
</span><span id="Signal.peaks-1089"><a href="#Signal.peaks-1089"><span class="linenos">1089</span></a>        <span class="n">intersect</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">exponents</span><span class="p">[</span><span class="n">peak_distance</span><span class="p">]</span>
</span><span id="Signal.peaks-1090"><a href="#Signal.peaks-1090"><span class="linenos">1090</span></a>        <span class="n">diff_start</span> <span class="o">=</span> <span class="n">fft_max_start</span> <span class="o">-</span> <span class="n">intersect</span>  <span class="c1"># offset by a small distance so that the first max is not a peak</span>
</span><span id="Signal.peaks-1091"><a href="#Signal.peaks-1091"><span class="linenos">1091</span></a>        <span class="n">min_height</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fft_max_start</span> <span class="o">+</span> <span class="n">diff_start</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fft_max_end</span><span class="p">),</span> <span class="n">max_index</span><span class="p">)</span>
</span><span id="Signal.peaks-1092"><a href="#Signal.peaks-1092"><span class="linenos">1092</span></a>
</span><span id="Signal.peaks-1093"><a href="#Signal.peaks-1093"><span class="linenos">1093</span></a>        <span class="n">first_peak_indexes</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">find_peaks</span><span class="p">(</span><span class="n">fft</span><span class="p">[:</span><span class="n">max_index</span><span class="p">],</span> <span class="n">height</span><span class="o">=</span><span class="n">min_height</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="n">peak_distance</span><span class="p">)</span>
</span><span id="Signal.peaks-1094"><a href="#Signal.peaks-1094"><span class="linenos">1094</span></a>
</span><span id="Signal.peaks-1095"><a href="#Signal.peaks-1095"><span class="linenos">1095</span></a>        <span class="n">number_of_peaks</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_peak_indexes</span><span class="p">)</span>
</span><span id="Signal.peaks-1096"><a href="#Signal.peaks-1096"><span class="linenos">1096</span></a>        <span class="k">if</span> <span class="n">number_of_peaks</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Signal.peaks-1097"><a href="#Signal.peaks-1097"><span class="linenos">1097</span></a>            <span class="n">average_len</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">max_index</span> <span class="o">/</span> <span class="n">number_of_peaks</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span>
</span><span id="Signal.peaks-1098"><a href="#Signal.peaks-1098"><span class="linenos">1098</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Signal.peaks-1099"><a href="#Signal.peaks-1099"><span class="linenos">1099</span></a>            <span class="n">average_len</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">max_index</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="Signal.peaks-1100"><a href="#Signal.peaks-1100"><span class="linenos">1100</span></a>
</span><span id="Signal.peaks-1101"><a href="#Signal.peaks-1101"><span class="linenos">1101</span></a>        <span class="k">if</span> <span class="n">average_len</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Signal.peaks-1102"><a href="#Signal.peaks-1102"><span class="linenos">1102</span></a>            <span class="n">average_len</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Signal.peaks-1103"><a href="#Signal.peaks-1103"><span class="linenos">1103</span></a>
</span><span id="Signal.peaks-1104"><a href="#Signal.peaks-1104"><span class="linenos">1104</span></a>        <span class="n">average_fft</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">savgol_filter</span><span class="p">(</span><span class="n">fft</span><span class="p">[:</span><span class="n">max_index</span><span class="p">],</span> <span class="n">average_len</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;mirror&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.9</span>
</span><span id="Signal.peaks-1105"><a href="#Signal.peaks-1105"><span class="linenos">1105</span></a>        <span class="n">min_freq_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fft_freq</span> <span class="o">&gt;=</span> <span class="mi">70</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Signal.peaks-1106"><a href="#Signal.peaks-1106"><span class="linenos">1106</span></a>        <span class="n">average_fft</span><span class="p">[:</span><span class="n">min_freq_index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Signal.peaks-1107"><a href="#Signal.peaks-1107"><span class="linenos">1107</span></a>
</span><span id="Signal.peaks-1108"><a href="#Signal.peaks-1108"><span class="linenos">1108</span></a>        <span class="n">peak_indexes</span><span class="p">,</span> <span class="n">res</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">find_peaks</span><span class="p">(</span><span class="n">fft</span><span class="p">[:</span><span class="n">max_index</span><span class="p">],</span> <span class="n">height</span><span class="o">=</span><span class="n">average_fft</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="n">min_freq_index</span><span class="p">)</span>
</span><span id="Signal.peaks-1109"><a href="#Signal.peaks-1109"><span class="linenos">1109</span></a>
</span><span id="Signal.peaks-1110"><a href="#Signal.peaks-1110"><span class="linenos">1110</span></a>        <span class="c1"># Remove noisy peaks at the low frequencies</span>
</span><span id="Signal.peaks-1111"><a href="#Signal.peaks-1111"><span class="linenos">1111</span></a>        <span class="k">while</span> <span class="n">fft</span><span class="p">[</span><span class="n">peak_indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">&lt;</span> <span class="mf">5e-2</span><span class="p">:</span>
</span><span id="Signal.peaks-1112"><a href="#Signal.peaks-1112"><span class="linenos">1112</span></a>            <span class="n">peak_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">peak_indexes</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Signal.peaks-1113"><a href="#Signal.peaks-1113"><span class="linenos">1113</span></a>        <span class="k">while</span> <span class="n">fft</span><span class="p">[</span><span class="n">peak_indexes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">&lt;</span> <span class="mf">1e-4</span><span class="p">:</span>
</span><span id="Signal.peaks-1114"><a href="#Signal.peaks-1114"><span class="linenos">1114</span></a>            <span class="n">peak_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">peak_indexes</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Signal.peaks-1115"><a href="#Signal.peaks-1115"><span class="linenos">1115</span></a>
</span><span id="Signal.peaks-1116"><a href="#Signal.peaks-1116"><span class="linenos">1116</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">height</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">result</span><span class="p">:</span>
</span><span id="Signal.peaks-1117"><a href="#Signal.peaks-1117"><span class="linenos">1117</span></a>            <span class="k">return</span> <span class="n">peak_indexes</span>
</span><span id="Signal.peaks-1118"><a href="#Signal.peaks-1118"><span class="linenos">1118</span></a>        <span class="k">elif</span> <span class="n">height</span><span class="p">:</span>
</span><span id="Signal.peaks-1119"><a href="#Signal.peaks-1119"><span class="linenos">1119</span></a>            <span class="k">return</span> <span class="n">peak_indexes</span><span class="p">,</span> <span class="n">average_fft</span>
</span><span id="Signal.peaks-1120"><a href="#Signal.peaks-1120"><span class="linenos">1120</span></a>        <span class="k">elif</span> <span class="n">result</span><span class="p">:</span>
</span><span id="Signal.peaks-1121"><a href="#Signal.peaks-1121"><span class="linenos">1121</span></a>            <span class="k">return</span> <span class="n">peak_indexes</span><span class="p">,</span> <span class="n">res</span>
</span><span id="Signal.peaks-1122"><a href="#Signal.peaks-1122"><span class="linenos">1122</span></a>        <span class="k">elif</span> <span class="n">height</span> <span class="ow">and</span> <span class="n">result</span><span class="p">:</span>
</span><span id="Signal.peaks-1123"><a href="#Signal.peaks-1123"><span class="linenos">1123</span></a>            <span class="k">return</span> <span class="n">peak_indexes</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Computes the harmonic peaks indexes from the FFT of the signal</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>max_freq</strong>:  Supply a max frequency value overriding the one in
guitarsounds_parameters</li>
<li><strong>height</strong>:  if True the height threshold is returned to be used
in the 'peaks' plot</li>
<li><strong>result</strong>:  if True the Scipy peak finding results dictionary
is returned</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>peak indexes</p>
</blockquote>
</div>


                            </div>
                            <div id="Signal.time_damping" class="classattr">
                                        <input id="Signal.time_damping-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">time_damping</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Signal.time_damping-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Signal.time_damping"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Signal.time_damping-1125"><a href="#Signal.time_damping-1125"><span class="linenos">1125</span></a>    <span class="k">def</span> <span class="nf">time_damping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal.time_damping-1126"><a href="#Signal.time_damping-1126"><span class="linenos">1126</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal.time_damping-1127"><a href="#Signal.time_damping-1127"><span class="linenos">1127</span></a><span class="sd">        Computes the time wise damping ratio of the signal by fitting a negative exponential curve</span>
</span><span id="Signal.time_damping-1128"><a href="#Signal.time_damping-1128"><span class="linenos">1128</span></a><span class="sd">        to the Signal envelope and computing the ratio with the Signal fundamental frequency.</span>
</span><span id="Signal.time_damping-1129"><a href="#Signal.time_damping-1129"><span class="linenos">1129</span></a><span class="sd">        :return: The damping ratio, a scalar.</span>
</span><span id="Signal.time_damping-1130"><a href="#Signal.time_damping-1130"><span class="linenos">1130</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal.time_damping-1131"><a href="#Signal.time_damping-1131"><span class="linenos">1131</span></a>        <span class="c1"># Get the envelope data</span>
</span><span id="Signal.time_damping-1132"><a href="#Signal.time_damping-1132"><span class="linenos">1132</span></a>        <span class="n">envelope</span><span class="p">,</span> <span class="n">envelope_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">envelope</span><span class="p">()</span> 
</span><span id="Signal.time_damping-1133"><a href="#Signal.time_damping-1133"><span class="linenos">1133</span></a>
</span><span id="Signal.time_damping-1134"><a href="#Signal.time_damping-1134"><span class="linenos">1134</span></a>        <span class="c1"># First point is the maximum because e^-kt is strictly decreasing</span>
</span><span id="Signal.time_damping-1135"><a href="#Signal.time_damping-1135"><span class="linenos">1135</span></a>        <span class="n">first_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">envelope</span><span class="p">)</span>
</span><span id="Signal.time_damping-1136"><a href="#Signal.time_damping-1136"><span class="linenos">1136</span></a>
</span><span id="Signal.time_damping-1137"><a href="#Signal.time_damping-1137"><span class="linenos">1137</span></a>        <span class="c1"># The second point is the first point where the signal crosses the lower_threshold line</span>
</span><span id="Signal.time_damping-1138"><a href="#Signal.time_damping-1138"><span class="linenos">1138</span></a>        <span class="n">second_point_thresh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">damping</span><span class="o">.</span><span class="n">lower_threshold</span><span class="o">.</span><span class="n">value</span>
</span><span id="Signal.time_damping-1139"><a href="#Signal.time_damping-1139"><span class="linenos">1139</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Signal.time_damping-1140"><a href="#Signal.time_damping-1140"><span class="linenos">1140</span></a>            <span class="n">second_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flatnonzero</span><span class="p">(</span><span class="n">envelope</span><span class="p">[</span><span class="n">first_index</span><span class="p">:]</span> <span class="o">&lt;=</span> <span class="n">second_point_thresh</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Signal.time_damping-1141"><a href="#Signal.time_damping-1141"><span class="linenos">1141</span></a>        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
</span><span id="Signal.time_damping-1142"><a href="#Signal.time_damping-1142"><span class="linenos">1142</span></a>            <span class="n">second_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flatnonzero</span><span class="p">(</span><span class="n">envelope</span><span class="p">[</span><span class="n">first_index</span><span class="p">:]</span> <span class="o">&lt;=</span> <span class="n">second_point_thresh</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Signal.time_damping-1143"><a href="#Signal.time_damping-1143"><span class="linenos">1143</span></a>
</span><span id="Signal.time_damping-1144"><a href="#Signal.time_damping-1144"><span class="linenos">1144</span></a>        <span class="c1"># Function to compute the residual for the exponential curve fit</span>
</span><span id="Signal.time_damping-1145"><a href="#Signal.time_damping-1145"><span class="linenos">1145</span></a>        <span class="k">def</span> <span class="nf">residual_function</span><span class="p">(</span><span class="n">zeta_w</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
</span><span id="Signal.time_damping-1146"><a href="#Signal.time_damping-1146"><span class="linenos">1146</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal.time_damping-1147"><a href="#Signal.time_damping-1147"><span class="linenos">1147</span></a><span class="sd">            Function computing the residual to curve fit a negative exponential to the signal envelope</span>
</span><span id="Signal.time_damping-1148"><a href="#Signal.time_damping-1148"><span class="linenos">1148</span></a><span class="sd">            :param zeta_w: zeta*omega constant</span>
</span><span id="Signal.time_damping-1149"><a href="#Signal.time_damping-1149"><span class="linenos">1149</span></a><span class="sd">            :param t: time vector</span>
</span><span id="Signal.time_damping-1150"><a href="#Signal.time_damping-1150"><span class="linenos">1150</span></a><span class="sd">            :param s: signal</span>
</span><span id="Signal.time_damping-1151"><a href="#Signal.time_damping-1151"><span class="linenos">1151</span></a><span class="sd">            :return: residual</span>
</span><span id="Signal.time_damping-1152"><a href="#Signal.time_damping-1152"><span class="linenos">1152</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="Signal.time_damping-1153"><a href="#Signal.time_damping-1153"><span class="linenos">1153</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">zeta_w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">s</span>
</span><span id="Signal.time_damping-1154"><a href="#Signal.time_damping-1154"><span class="linenos">1154</span></a>
</span><span id="Signal.time_damping-1155"><a href="#Signal.time_damping-1155"><span class="linenos">1155</span></a>        <span class="n">zeta_guess</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">]</span>
</span><span id="Signal.time_damping-1156"><a href="#Signal.time_damping-1156"><span class="linenos">1156</span></a>
</span><span id="Signal.time_damping-1157"><a href="#Signal.time_damping-1157"><span class="linenos">1157</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">least_squares</span><span class="p">(</span><span class="n">residual_function</span><span class="p">,</span> <span class="n">zeta_guess</span><span class="p">,</span>
</span><span id="Signal.time_damping-1158"><a href="#Signal.time_damping-1158"><span class="linenos">1158</span></a>                                              <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">envelope_time</span><span class="p">[</span><span class="n">first_index</span><span class="p">:</span><span class="n">second_index</span><span class="p">],</span>
</span><span id="Signal.time_damping-1159"><a href="#Signal.time_damping-1159"><span class="linenos">1159</span></a>                                                    <span class="n">envelope</span><span class="p">[</span><span class="n">first_index</span><span class="p">:</span><span class="n">second_index</span><span class="p">]))</span>
</span><span id="Signal.time_damping-1160"><a href="#Signal.time_damping-1160"><span class="linenos">1160</span></a>        <span class="c1"># Get the zeta*omega constant</span>
</span><span id="Signal.time_damping-1161"><a href="#Signal.time_damping-1161"><span class="linenos">1161</span></a>        <span class="n">zeta_omega</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Signal.time_damping-1162"><a href="#Signal.time_damping-1162"><span class="linenos">1162</span></a>
</span><span id="Signal.time_damping-1163"><a href="#Signal.time_damping-1163"><span class="linenos">1163</span></a>        <span class="c1"># Compute the fundamental frequency in radians of the signal</span>
</span><span id="Signal.time_damping-1164"><a href="#Signal.time_damping-1164"><span class="linenos">1164</span></a>        <span class="n">wd</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fundamental</span><span class="p">()</span>
</span><span id="Signal.time_damping-1165"><a href="#Signal.time_damping-1165"><span class="linenos">1165</span></a>        <span class="k">return</span> <span class="o">-</span><span class="n">zeta_omega</span> <span class="o">/</span> <span class="n">wd</span>
</span></pre></div>


            <div class="docstring"><p>Computes the time wise damping ratio of the signal by fitting a negative exponential curve
to the Signal envelope and computing the ratio with the Signal fundamental frequency.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The damping ratio, a scalar.</p>
</blockquote>
</div>


                            </div>
                            <div id="Signal.peak_damping" class="classattr">
                                        <input id="Signal.peak_damping-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">peak_damping</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Signal.peak_damping-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Signal.peak_damping"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Signal.peak_damping-1167"><a href="#Signal.peak_damping-1167"><span class="linenos">1167</span></a>    <span class="k">def</span> <span class="nf">peak_damping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal.peak_damping-1168"><a href="#Signal.peak_damping-1168"><span class="linenos">1168</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal.peak_damping-1169"><a href="#Signal.peak_damping-1169"><span class="linenos">1169</span></a><span class="sd">        Computes the frequency wise damping with the half bandwidth method on the Fourier Transform peaks</span>
</span><span id="Signal.peak_damping-1170"><a href="#Signal.peak_damping-1170"><span class="linenos">1170</span></a><span class="sd">        :return: an array containing the peak damping values</span>
</span><span id="Signal.peak_damping-1171"><a href="#Signal.peak_damping-1171"><span class="linenos">1171</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal.peak_damping-1172"><a href="#Signal.peak_damping-1172"><span class="linenos">1172</span></a>        <span class="n">zetas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Signal.peak_damping-1173"><a href="#Signal.peak_damping-1173"><span class="linenos">1173</span></a>        <span class="n">fft_freqs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span>
</span><span id="Signal.peak_damping-1174"><a href="#Signal.peak_damping-1174"><span class="linenos">1174</span></a>        <span class="n">fft</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">()[:</span><span class="nb">len</span><span class="p">(</span><span class="n">fft_freqs</span><span class="p">)]</span>
</span><span id="Signal.peak_damping-1175"><a href="#Signal.peak_damping-1175"><span class="linenos">1175</span></a>        <span class="k">for</span> <span class="n">peak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">():</span>
</span><span id="Signal.peak_damping-1176"><a href="#Signal.peak_damping-1176"><span class="linenos">1176</span></a>            <span class="n">peak_frequency</span> <span class="o">=</span> <span class="n">fft_freqs</span><span class="p">[</span><span class="n">peak</span><span class="p">]</span>
</span><span id="Signal.peak_damping-1177"><a href="#Signal.peak_damping-1177"><span class="linenos">1177</span></a>            <span class="n">peak_height</span> <span class="o">=</span> <span class="n">fft</span><span class="p">[</span><span class="n">peak</span><span class="p">]</span>
</span><span id="Signal.peak_damping-1178"><a href="#Signal.peak_damping-1178"><span class="linenos">1178</span></a>            <span class="n">root_height</span> <span class="o">=</span> <span class="n">peak_height</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Signal.peak_damping-1179"><a href="#Signal.peak_damping-1179"><span class="linenos">1179</span></a>            <span class="n">frequency_roots</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span><span class="n">fft_freqs</span><span class="p">,</span> <span class="n">fft</span> <span class="o">-</span> <span class="n">root_height</span><span class="p">)</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
</span><span id="Signal.peak_damping-1180"><a href="#Signal.peak_damping-1180"><span class="linenos">1180</span></a>            <span class="n">sorted_roots_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">frequency_roots</span> <span class="o">-</span> <span class="n">peak_frequency</span><span class="p">))</span>
</span><span id="Signal.peak_damping-1181"><a href="#Signal.peak_damping-1181"><span class="linenos">1181</span></a>            <span class="n">w2</span><span class="p">,</span> <span class="n">w1</span> <span class="o">=</span> <span class="n">frequency_roots</span><span class="p">[</span><span class="n">sorted_roots_indexes</span><span class="p">[:</span><span class="mi">2</span><span class="p">]]</span>
</span><span id="Signal.peak_damping-1182"><a href="#Signal.peak_damping-1182"><span class="linenos">1182</span></a>            <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">])</span>
</span><span id="Signal.peak_damping-1183"><a href="#Signal.peak_damping-1183"><span class="linenos">1183</span></a>            <span class="n">zeta</span> <span class="o">=</span> <span class="p">(</span><span class="n">w2</span> <span class="o">-</span> <span class="n">w1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">peak_frequency</span><span class="p">)</span>
</span><span id="Signal.peak_damping-1184"><a href="#Signal.peak_damping-1184"><span class="linenos">1184</span></a>            <span class="n">zetas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zeta</span><span class="p">)</span>
</span><span id="Signal.peak_damping-1185"><a href="#Signal.peak_damping-1185"><span class="linenos">1185</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">zetas</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Computes the frequency wise damping with the half bandwidth method on the Fourier Transform peaks</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>an array containing the peak damping values</p>
</blockquote>
</div>


                            </div>
                            <div id="Signal.fundamental" class="classattr">
                                        <input id="Signal.fundamental-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fundamental</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Signal.fundamental-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Signal.fundamental"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Signal.fundamental-1187"><a href="#Signal.fundamental-1187"><span class="linenos">1187</span></a>    <span class="k">def</span> <span class="nf">fundamental</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal.fundamental-1188"><a href="#Signal.fundamental-1188"><span class="linenos">1188</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal.fundamental-1189"><a href="#Signal.fundamental-1189"><span class="linenos">1189</span></a><span class="sd">        Returns the fundamental approximated by the first peak of the fft</span>
</span><span id="Signal.fundamental-1190"><a href="#Signal.fundamental-1190"><span class="linenos">1190</span></a><span class="sd">        :return: fundamental value (Hz)</span>
</span><span id="Signal.fundamental-1191"><a href="#Signal.fundamental-1191"><span class="linenos">1191</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal.fundamental-1192"><a href="#Signal.fundamental-1192"><span class="linenos">1192</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Signal.fundamental-1193"><a href="#Signal.fundamental-1193"><span class="linenos">1193</span></a>        <span class="n">fundamental</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
</span><span id="Signal.fundamental-1194"><a href="#Signal.fundamental-1194"><span class="linenos">1194</span></a>        <span class="k">return</span> <span class="n">fundamental</span>
</span></pre></div>


            <div class="docstring"><p>Returns the fundamental approximated by the first peak of the fft</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>fundamental value (Hz)</p>
</blockquote>
</div>


                            </div>
                            <div id="Signal.cavity_peak" class="classattr">
                                        <input id="Signal.cavity_peak-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">cavity_peak</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Signal.cavity_peak-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Signal.cavity_peak"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Signal.cavity_peak-1196"><a href="#Signal.cavity_peak-1196"><span class="linenos">1196</span></a>    <span class="k">def</span> <span class="nf">cavity_peak</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal.cavity_peak-1197"><a href="#Signal.cavity_peak-1197"><span class="linenos">1197</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal.cavity_peak-1198"><a href="#Signal.cavity_peak-1198"><span class="linenos">1198</span></a><span class="sd">        Finds the Hemlotz cavity frequency index from the Fourier Transform by searching for a peak in the expected</span>
</span><span id="Signal.cavity_peak-1199"><a href="#Signal.cavity_peak-1199"><span class="linenos">1199</span></a><span class="sd">        range (80 - 100 Hz), if the fundamental is too close to the expected Hemlotz frequency a comment</span>
</span><span id="Signal.cavity_peak-1200"><a href="#Signal.cavity_peak-1200"><span class="linenos">1200</span></a><span class="sd">        is printed and None is returned.</span>
</span><span id="Signal.cavity_peak-1201"><a href="#Signal.cavity_peak-1201"><span class="linenos">1201</span></a><span class="sd">        :return: The index of the cavity peak</span>
</span><span id="Signal.cavity_peak-1202"><a href="#Signal.cavity_peak-1202"><span class="linenos">1202</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal.cavity_peak-1203"><a href="#Signal.cavity_peak-1203"><span class="linenos">1203</span></a>        <span class="n">first_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">80</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Signal.cavity_peak-1204"><a href="#Signal.cavity_peak-1204"><span class="linenos">1204</span></a>        <span class="n">second_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">110</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Signal.cavity_peak-1205"><a href="#Signal.cavity_peak-1205"><span class="linenos">1205</span></a>        <span class="n">cavity_peak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">()[</span><span class="n">first_index</span><span class="p">:</span><span class="n">second_index</span><span class="p">])</span> <span class="o">+</span> <span class="n">first_index</span>
</span><span id="Signal.cavity_peak-1206"><a href="#Signal.cavity_peak-1206"><span class="linenos">1206</span></a>        <span class="k">return</span> <span class="n">cavity_peak</span>
</span></pre></div>


            <div class="docstring"><p>Finds the Hemlotz cavity frequency index from the Fourier Transform by searching for a peak in the expected
range (80 - 100 Hz), if the fundamental is too close to the expected Hemlotz frequency a comment
is printed and None is returned.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The index of the cavity peak</p>
</blockquote>
</div>


                            </div>
                            <div id="Signal.cavity_frequency" class="classattr">
                                        <input id="Signal.cavity_frequency-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">cavity_frequency</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Signal.cavity_frequency-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Signal.cavity_frequency"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Signal.cavity_frequency-1208"><a href="#Signal.cavity_frequency-1208"><span class="linenos">1208</span></a>    <span class="k">def</span> <span class="nf">cavity_frequency</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal.cavity_frequency-1209"><a href="#Signal.cavity_frequency-1209"><span class="linenos">1209</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal.cavity_frequency-1210"><a href="#Signal.cavity_frequency-1210"><span class="linenos">1210</span></a><span class="sd">        Finds the Hemlotz cavity frequency from the Fourier Transform by searching for a peak in the expected</span>
</span><span id="Signal.cavity_frequency-1211"><a href="#Signal.cavity_frequency-1211"><span class="linenos">1211</span></a><span class="sd">        range (80 - 100 Hz), if the fundamental is too close to the expected Hemlotz frequency a comment</span>
</span><span id="Signal.cavity_frequency-1212"><a href="#Signal.cavity_frequency-1212"><span class="linenos">1212</span></a><span class="sd">        is printed and None is returned.</span>
</span><span id="Signal.cavity_frequency-1213"><a href="#Signal.cavity_frequency-1213"><span class="linenos">1213</span></a><span class="sd">        :return: If successful, the cavity peak frequency</span>
</span><span id="Signal.cavity_frequency-1214"><a href="#Signal.cavity_frequency-1214"><span class="linenos">1214</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal.cavity_frequency-1215"><a href="#Signal.cavity_frequency-1215"><span class="linenos">1215</span></a>        <span class="n">cavity_peak</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cavity_peak</span><span class="p">()</span>
</span><span id="Signal.cavity_frequency-1216"><a href="#Signal.cavity_frequency-1216"><span class="linenos">1216</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fundamental</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[</span><span class="n">cavity_peak</span><span class="p">]:</span>
</span><span id="Signal.cavity_frequency-1217"><a href="#Signal.cavity_frequency-1217"><span class="linenos">1217</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cavity peak is obscured by the fundamental&#39;</span><span class="p">)</span>
</span><span id="Signal.cavity_frequency-1218"><a href="#Signal.cavity_frequency-1218"><span class="linenos">1218</span></a>            <span class="k">return</span> <span class="mi">0</span>
</span><span id="Signal.cavity_frequency-1219"><a href="#Signal.cavity_frequency-1219"><span class="linenos">1219</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Signal.cavity_frequency-1220"><a href="#Signal.cavity_frequency-1220"><span class="linenos">1220</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[</span><span class="n">cavity_peak</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Finds the Hemlotz cavity frequency from the Fourier Transform by searching for a peak in the expected
range (80 - 100 Hz), if the fundamental is too close to the expected Hemlotz frequency a comment
is printed and None is returned.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>If successful, the cavity peak frequency</p>
</blockquote>
</div>


                            </div>
                            <div id="Signal.fft_frequencies" class="classattr">
                                        <input id="Signal.fft_frequencies-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fft_frequencies</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Signal.fft_frequencies-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Signal.fft_frequencies"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Signal.fft_frequencies-1222"><a href="#Signal.fft_frequencies-1222"><span class="linenos">1222</span></a>    <span class="k">def</span> <span class="nf">fft_frequencies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal.fft_frequencies-1223"><a href="#Signal.fft_frequencies-1223"><span class="linenos">1223</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal.fft_frequencies-1224"><a href="#Signal.fft_frequencies-1224"><span class="linenos">1224</span></a><span class="sd">        Computes the frequency vector associated with the Signal Fourier Transform</span>
</span><span id="Signal.fft_frequencies-1225"><a href="#Signal.fft_frequencies-1225"><span class="linenos">1225</span></a><span class="sd">        :return: an array containing the frequency values.</span>
</span><span id="Signal.fft_frequencies-1226"><a href="#Signal.fft_frequencies-1226"><span class="linenos">1226</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal.fft_frequencies-1227"><a href="#Signal.fft_frequencies-1227"><span class="linenos">1227</span></a>        <span class="n">fft</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">()</span>
</span><span id="Signal.fft_frequencies-1228"><a href="#Signal.fft_frequencies-1228"><span class="linenos">1228</span></a>        <span class="n">fft_frequencies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fft</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">)</span>  <span class="c1"># Frequencies corresponding to the bins</span>
</span><span id="Signal.fft_frequencies-1229"><a href="#Signal.fft_frequencies-1229"><span class="linenos">1229</span></a>        <span class="k">return</span> <span class="n">fft_frequencies</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">fft</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>Computes the frequency vector associated with the Signal Fourier Transform</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>an array containing the frequency values.</p>
</blockquote>
</div>


                            </div>
                            <div id="Signal.fft_bins" class="classattr">
                                        <input id="Signal.fft_bins-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fft_bins</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Signal.fft_bins-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Signal.fft_bins"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Signal.fft_bins-1231"><a href="#Signal.fft_bins-1231"><span class="linenos">1231</span></a>    <span class="k">def</span> <span class="nf">fft_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal.fft_bins-1232"><a href="#Signal.fft_bins-1232"><span class="linenos">1232</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal.fft_bins-1233"><a href="#Signal.fft_bins-1233"><span class="linenos">1233</span></a><span class="sd">        Transforms the Fourier transform array into a statistic distribution </span>
</span><span id="Signal.fft_bins-1234"><a href="#Signal.fft_bins-1234"><span class="linenos">1234</span></a><span class="sd">        ranging from 0 to 100. </span>
</span><span id="Signal.fft_bins-1235"><a href="#Signal.fft_bins-1235"><span class="linenos">1235</span></a><span class="sd">        Accordingly, the maximum of the Fourier transform with value 1.0 will</span>
</span><span id="Signal.fft_bins-1236"><a href="#Signal.fft_bins-1236"><span class="linenos">1236</span></a><span class="sd">        be equal to 100 and casted as an integer.</span>
</span><span id="Signal.fft_bins-1237"><a href="#Signal.fft_bins-1237"><span class="linenos">1237</span></a><span class="sd">        Values below 0.001 will be equal to 0. </span>
</span><span id="Signal.fft_bins-1238"><a href="#Signal.fft_bins-1238"><span class="linenos">1238</span></a><span class="sd">        This representation of the Fourier transform is used to construct</span>
</span><span id="Signal.fft_bins-1239"><a href="#Signal.fft_bins-1239"><span class="linenos">1239</span></a><span class="sd">        octave bands histograms.</span>
</span><span id="Signal.fft_bins-1240"><a href="#Signal.fft_bins-1240"><span class="linenos">1240</span></a><span class="sd">        :return : a list containing the frequency occurrences.</span>
</span><span id="Signal.fft_bins-1241"><a href="#Signal.fft_bins-1241"><span class="linenos">1241</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal.fft_bins-1242"><a href="#Signal.fft_bins-1242"><span class="linenos">1242</span></a>
</span><span id="Signal.fft_bins-1243"><a href="#Signal.fft_bins-1243"><span class="linenos">1243</span></a>        <span class="c1"># Make the FT values integers</span>
</span><span id="Signal.fft_bins-1244"><a href="#Signal.fft_bins-1244"><span class="linenos">1244</span></a>        <span class="n">fft_integers</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">sample</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">()]</span>
</span><span id="Signal.fft_bins-1245"><a href="#Signal.fft_bins-1245"><span class="linenos">1245</span></a>
</span><span id="Signal.fft_bins-1246"><a href="#Signal.fft_bins-1246"><span class="linenos">1246</span></a>        <span class="c1"># Create a list of the frequency occurrences in the signal</span>
</span><span id="Signal.fft_bins-1247"><a href="#Signal.fft_bins-1247"><span class="linenos">1247</span></a>        <span class="n">occurrences</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Signal.fft_bins-1248"><a href="#Signal.fft_bins-1248"><span class="linenos">1248</span></a>        <span class="k">for</span> <span class="n">freq</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">(),</span> <span class="n">fft_integers</span><span class="p">):</span>
</span><span id="Signal.fft_bins-1249"><a href="#Signal.fft_bins-1249"><span class="linenos">1249</span></a>            <span class="n">occurrences</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">freq</span><span class="p">]</span> <span class="o">*</span> <span class="n">count</span><span class="p">)</span>
</span><span id="Signal.fft_bins-1250"><a href="#Signal.fft_bins-1250"><span class="linenos">1250</span></a>
</span><span id="Signal.fft_bins-1251"><a href="#Signal.fft_bins-1251"><span class="linenos">1251</span></a>        <span class="c1"># flatten the list</span>
</span><span id="Signal.fft_bins-1252"><a href="#Signal.fft_bins-1252"><span class="linenos">1252</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">occurrences</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Transforms the Fourier transform array into a statistic distribution 
ranging from 0 to 100. 
Accordingly, the maximum of the Fourier transform with value 1.0 will
be equal to 100 and casted as an integer.
Values below 0.001 will be equal to 0. 
This representation of the Fourier transform is used to construct
octave bands histograms.
:return : a list containing the frequency occurrences.</p>
</div>


                            </div>
                            <div id="Signal.envelope" class="classattr">
                                        <input id="Signal.envelope-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">envelope</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">window</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">overlap</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Signal.envelope-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Signal.envelope"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Signal.envelope-1254"><a href="#Signal.envelope-1254"><span class="linenos">1254</span></a>    <span class="k">def</span> <span class="nf">envelope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Signal.envelope-1255"><a href="#Signal.envelope-1255"><span class="linenos">1255</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal.envelope-1256"><a href="#Signal.envelope-1256"><span class="linenos">1256</span></a><span class="sd">        Method calculating the amplitude envelope of a signal as a</span>
</span><span id="Signal.envelope-1257"><a href="#Signal.envelope-1257"><span class="linenos">1257</span></a><span class="sd">        maximum of the absolute value of the signal. </span>
</span><span id="Signal.envelope-1258"><a href="#Signal.envelope-1258"><span class="linenos">1258</span></a><span class="sd">        The same `window` and `overlap` parameters should be used to compute </span>
</span><span id="Signal.envelope-1259"><a href="#Signal.envelope-1259"><span class="linenos">1259</span></a><span class="sd">        the signal and time arrays so that they contain the same </span>
</span><span id="Signal.envelope-1260"><a href="#Signal.envelope-1260"><span class="linenos">1260</span></a><span class="sd">        number of points (and can be plotted together).</span>
</span><span id="Signal.envelope-1261"><a href="#Signal.envelope-1261"><span class="linenos">1261</span></a><span class="sd">        :param window: integer, length in samples of the window used to</span>
</span><span id="Signal.envelope-1262"><a href="#Signal.envelope-1262"><span class="linenos">1262</span></a><span class="sd">        compute the signal envelope.</span>
</span><span id="Signal.envelope-1263"><a href="#Signal.envelope-1263"><span class="linenos">1263</span></a><span class="sd">        :param overlap: integer, overlap in samples used to overlap two</span>
</span><span id="Signal.envelope-1264"><a href="#Signal.envelope-1264"><span class="linenos">1264</span></a><span class="sd">        subsequent windows in the computation of the signal envelope.</span>
</span><span id="Signal.envelope-1265"><a href="#Signal.envelope-1265"><span class="linenos">1265</span></a><span class="sd">        The overlap value should be smaller than the window value.</span>
</span><span id="Signal.envelope-1266"><a href="#Signal.envelope-1266"><span class="linenos">1266</span></a><span class="sd">        :return: Amplitude envelope of the signal</span>
</span><span id="Signal.envelope-1267"><a href="#Signal.envelope-1267"><span class="linenos">1267</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal.envelope-1268"><a href="#Signal.envelope-1268"><span class="linenos">1268</span></a>        <span class="k">if</span> <span class="n">window</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Signal.envelope-1269"><a href="#Signal.envelope-1269"><span class="linenos">1269</span></a>            <span class="n">window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">envelope</span><span class="o">.</span><span class="n">frame_size</span><span class="o">.</span><span class="n">value</span>
</span><span id="Signal.envelope-1270"><a href="#Signal.envelope-1270"><span class="linenos">1270</span></a>        <span class="k">if</span> <span class="n">overlap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Signal.envelope-1271"><a href="#Signal.envelope-1271"><span class="linenos">1271</span></a>            <span class="n">overlap</span> <span class="o">=</span> <span class="n">window</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="Signal.envelope-1272"><a href="#Signal.envelope-1272"><span class="linenos">1272</span></a>        <span class="k">elif</span> <span class="n">overlap</span> <span class="o">&gt;=</span> <span class="n">window</span><span class="p">:</span>
</span><span id="Signal.envelope-1273"><a href="#Signal.envelope-1273"><span class="linenos">1273</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Overlap must be smaller than window&#39;</span><span class="p">)</span>
</span><span id="Signal.envelope-1274"><a href="#Signal.envelope-1274"><span class="linenos">1274</span></a>        <span class="n">signal_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">)</span>
</span><span id="Signal.envelope-1275"><a href="#Signal.envelope-1275"><span class="linenos">1275</span></a>        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="Signal.envelope-1276"><a href="#Signal.envelope-1276"><span class="linenos">1276</span></a>        <span class="c1"># Empty envelope and envelope time</span>
</span><span id="Signal.envelope-1277"><a href="#Signal.envelope-1277"><span class="linenos">1277</span></a>        <span class="n">env</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Signal.envelope-1278"><a href="#Signal.envelope-1278"><span class="linenos">1278</span></a>        <span class="n">env_time</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Signal.envelope-1279"><a href="#Signal.envelope-1279"><span class="linenos">1279</span></a>        <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Signal.envelope-1280"><a href="#Signal.envelope-1280"><span class="linenos">1280</span></a>        <span class="k">while</span> <span class="n">idx</span> <span class="o">+</span> <span class="n">window</span> <span class="o">&lt;</span> <span class="n">signal_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="Signal.envelope-1281"><a href="#Signal.envelope-1281"><span class="linenos">1281</span></a>            <span class="n">env</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">signal_array</span><span class="p">[</span><span class="n">idx</span><span class="p">:</span><span class="n">idx</span> <span class="o">+</span> <span class="n">window</span><span class="p">]))</span>
</span><span id="Signal.envelope-1282"><a href="#Signal.envelope-1282"><span class="linenos">1282</span></a>            <span class="n">pt_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">signal_array</span><span class="p">[</span><span class="n">idx</span><span class="p">:</span><span class="n">idx</span> <span class="o">+</span> <span class="n">window</span><span class="p">])</span> <span class="o">+</span> <span class="n">idx</span>
</span><span id="Signal.envelope-1283"><a href="#Signal.envelope-1283"><span class="linenos">1283</span></a>            <span class="n">env_time</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">pt_idx</span><span class="p">])</span>
</span><span id="Signal.envelope-1284"><a href="#Signal.envelope-1284"><span class="linenos">1284</span></a>            <span class="n">idx</span> <span class="o">+=</span> <span class="n">overlap</span>
</span><span id="Signal.envelope-1285"><a href="#Signal.envelope-1285"><span class="linenos">1285</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">unique_time_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">env_time</span><span class="p">,</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Signal.envelope-1286"><a href="#Signal.envelope-1286"><span class="linenos">1286</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">env</span><span class="p">)[</span><span class="n">unique_time_index</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">env_time</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Method calculating the amplitude envelope of a signal as a
maximum of the absolute value of the signal. 
The same <code>window</code> and <code>overlap</code> parameters should be used to compute 
the signal and time arrays so that they contain the same 
number of points (and can be plotted together).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>window</strong>:  integer, length in samples of the window used to
compute the signal envelope.</li>
<li><strong>overlap</strong>:  integer, overlap in samples used to overlap two
subsequent windows in the computation of the signal envelope.
The overlap value should be smaller than the window value.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Amplitude envelope of the signal</p>
</blockquote>
</div>


                            </div>
                            <div id="Signal.log_envelope" class="classattr">
                                        <input id="Signal.log_envelope-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">log_envelope</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Signal.log_envelope-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Signal.log_envelope"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Signal.log_envelope-1288"><a href="#Signal.log_envelope-1288"><span class="linenos">1288</span></a>    <span class="k">def</span> <span class="nf">log_envelope</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal.log_envelope-1289"><a href="#Signal.log_envelope-1289"><span class="linenos">1289</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal.log_envelope-1290"><a href="#Signal.log_envelope-1290"><span class="linenos">1290</span></a><span class="sd">        Computes the logarithmic scale envelope of the signal.</span>
</span><span id="Signal.log_envelope-1291"><a href="#Signal.log_envelope-1291"><span class="linenos">1291</span></a><span class="sd">        The width of the samples increases exponentially so that</span>
</span><span id="Signal.log_envelope-1292"><a href="#Signal.log_envelope-1292"><span class="linenos">1292</span></a><span class="sd">        the envelope appears having a constant window width on</span>
</span><span id="Signal.log_envelope-1293"><a href="#Signal.log_envelope-1293"><span class="linenos">1293</span></a><span class="sd">        an X axis logarithmic scale.</span>
</span><span id="Signal.log_envelope-1294"><a href="#Signal.log_envelope-1294"><span class="linenos">1294</span></a><span class="sd">        :return: The log envelope and the time vector associated in a tuple</span>
</span><span id="Signal.log_envelope-1295"><a href="#Signal.log_envelope-1295"><span class="linenos">1295</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal.log_envelope-1296"><a href="#Signal.log_envelope-1296"><span class="linenos">1296</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">onset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Signal.log_envelope-1297"><a href="#Signal.log_envelope-1297"><span class="linenos">1297</span></a>            <span class="n">onset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">))</span>
</span><span id="Signal.log_envelope-1298"><a href="#Signal.log_envelope-1298"><span class="linenos">1298</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Signal.log_envelope-1299"><a href="#Signal.log_envelope-1299"><span class="linenos">1299</span></a>            <span class="n">onset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">onset</span>
</span><span id="Signal.log_envelope-1300"><a href="#Signal.log_envelope-1300"><span class="linenos">1300</span></a>
</span><span id="Signal.log_envelope-1301"><a href="#Signal.log_envelope-1301"><span class="linenos">1301</span></a>        <span class="n">start_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">log_envelope</span><span class="o">.</span><span class="n">start_time</span><span class="o">.</span><span class="n">value</span>
</span><span id="Signal.log_envelope-1302"><a href="#Signal.log_envelope-1302"><span class="linenos">1302</span></a>        <span class="k">while</span> <span class="n">start_time</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">onset</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">):</span>
</span><span id="Signal.log_envelope-1303"><a href="#Signal.log_envelope-1303"><span class="linenos">1303</span></a>            <span class="n">start_time</span> <span class="o">/=</span> <span class="mf">10.</span>
</span><span id="Signal.log_envelope-1304"><a href="#Signal.log_envelope-1304"><span class="linenos">1304</span></a>
</span><span id="Signal.log_envelope-1305"><a href="#Signal.log_envelope-1305"><span class="linenos">1305</span></a>        <span class="n">start_exponent</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">start_time</span><span class="p">))</span>  <span class="c1"># closest 10^x value for smooth graph</span>
</span><span id="Signal.log_envelope-1306"><a href="#Signal.log_envelope-1306"><span class="linenos">1306</span></a>
</span><span id="Signal.log_envelope-1307"><a href="#Signal.log_envelope-1307"><span class="linenos">1307</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">log_envelope</span><span class="o">.</span><span class="n">min_window</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Signal.log_envelope-1308"><a href="#Signal.log_envelope-1308"><span class="linenos">1308</span></a>            <span class="n">min_window</span> <span class="o">=</span> <span class="mi">15</span> <span class="o">**</span> <span class="p">(</span><span class="n">start_exponent</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span>
</span><span id="Signal.log_envelope-1309"><a href="#Signal.log_envelope-1309"><span class="linenos">1309</span></a>            <span class="k">if</span> <span class="n">min_window</span> <span class="o">&lt;</span> <span class="mi">15</span><span class="p">:</span>  <span class="c1"># Value should at least be 10</span>
</span><span id="Signal.log_envelope-1310"><a href="#Signal.log_envelope-1310"><span class="linenos">1310</span></a>                <span class="n">min_window</span> <span class="o">=</span> <span class="mi">15</span>
</span><span id="Signal.log_envelope-1311"><a href="#Signal.log_envelope-1311"><span class="linenos">1311</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Signal.log_envelope-1312"><a href="#Signal.log_envelope-1312"><span class="linenos">1312</span></a>            <span class="n">min_window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">log_envelope</span><span class="o">.</span><span class="n">min_window</span><span class="o">.</span><span class="n">value</span>
</span><span id="Signal.log_envelope-1313"><a href="#Signal.log_envelope-1313"><span class="linenos">1313</span></a>
</span><span id="Signal.log_envelope-1314"><a href="#Signal.log_envelope-1314"><span class="linenos">1314</span></a>        <span class="c1"># initial values</span>
</span><span id="Signal.log_envelope-1315"><a href="#Signal.log_envelope-1315"><span class="linenos">1315</span></a>        <span class="n">current_exponent</span> <span class="o">=</span> <span class="n">start_exponent</span>
</span><span id="Signal.log_envelope-1316"><a href="#Signal.log_envelope-1316"><span class="linenos">1316</span></a>        <span class="n">current_time</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">current_exponent</span>  <span class="c1"># start time on log scale</span>
</span><span id="Signal.log_envelope-1317"><a href="#Signal.log_envelope-1317"><span class="linenos">1317</span></a>        <span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">current_time</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">)</span>  <span class="c1"># Start at the specified time</span>
</span><span id="Signal.log_envelope-1318"><a href="#Signal.log_envelope-1318"><span class="linenos">1318</span></a>        <span class="n">window</span> <span class="o">=</span> <span class="n">min_window</span>  <span class="c1"># number of samples per window</span>
</span><span id="Signal.log_envelope-1319"><a href="#Signal.log_envelope-1319"><span class="linenos">1319</span></a>        <span class="n">overlap</span> <span class="o">=</span> <span class="n">window</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="Signal.log_envelope-1320"><a href="#Signal.log_envelope-1320"><span class="linenos">1320</span></a>        <span class="n">log_envelope</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Signal.log_envelope-1321"><a href="#Signal.log_envelope-1321"><span class="linenos">1321</span></a>        <span class="n">log_envelope_time</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># First value for comparison</span>
</span><span id="Signal.log_envelope-1322"><a href="#Signal.log_envelope-1322"><span class="linenos">1322</span></a>
</span><span id="Signal.log_envelope-1323"><a href="#Signal.log_envelope-1323"><span class="linenos">1323</span></a>        <span class="k">while</span> <span class="n">index</span> <span class="o">+</span> <span class="n">window</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">):</span>
</span><span id="Signal.log_envelope-1324"><a href="#Signal.log_envelope-1324"><span class="linenos">1324</span></a>
</span><span id="Signal.log_envelope-1325"><a href="#Signal.log_envelope-1325"><span class="linenos">1325</span></a>            <span class="k">while</span> <span class="n">log_envelope_time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">current_exponent</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="Signal.log_envelope-1326"><a href="#Signal.log_envelope-1326"><span class="linenos">1326</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="n">window</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">):</span>
</span><span id="Signal.log_envelope-1327"><a href="#Signal.log_envelope-1327"><span class="linenos">1327</span></a>                    <span class="n">log_envelope</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">index</span><span class="p">:</span><span class="n">index</span> <span class="o">+</span> <span class="n">window</span><span class="p">])))</span>
</span><span id="Signal.log_envelope-1328"><a href="#Signal.log_envelope-1328"><span class="linenos">1328</span></a>                    <span class="n">pt_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">index</span><span class="p">:</span><span class="n">index</span> <span class="o">+</span> <span class="n">window</span><span class="p">]))</span>
</span><span id="Signal.log_envelope-1329"><a href="#Signal.log_envelope-1329"><span class="linenos">1329</span></a>                    <span class="n">log_envelope_time</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">()[</span><span class="n">index</span> <span class="o">+</span> <span class="n">pt_idx</span><span class="p">])</span>
</span><span id="Signal.log_envelope-1330"><a href="#Signal.log_envelope-1330"><span class="linenos">1330</span></a>                    <span class="n">index</span> <span class="o">+=</span> <span class="n">overlap</span>
</span><span id="Signal.log_envelope-1331"><a href="#Signal.log_envelope-1331"><span class="linenos">1331</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Signal.log_envelope-1332"><a href="#Signal.log_envelope-1332"><span class="linenos">1332</span></a>                    <span class="k">break</span>
</span><span id="Signal.log_envelope-1333"><a href="#Signal.log_envelope-1333"><span class="linenos">1333</span></a>
</span><span id="Signal.log_envelope-1334"><a href="#Signal.log_envelope-1334"><span class="linenos">1334</span></a>            <span class="k">if</span> <span class="n">window</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">log_envelope</span><span class="o">.</span><span class="n">max_window</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
</span><span id="Signal.log_envelope-1335"><a href="#Signal.log_envelope-1335"><span class="linenos">1335</span></a>                <span class="n">window</span> <span class="o">=</span> <span class="n">window</span> <span class="o">*</span> <span class="mi">10</span>
</span><span id="Signal.log_envelope-1336"><a href="#Signal.log_envelope-1336"><span class="linenos">1336</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Signal.log_envelope-1337"><a href="#Signal.log_envelope-1337"><span class="linenos">1337</span></a>                <span class="n">window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">log_envelope</span><span class="o">.</span><span class="n">max_window</span><span class="o">.</span><span class="n">value</span>
</span><span id="Signal.log_envelope-1338"><a href="#Signal.log_envelope-1338"><span class="linenos">1338</span></a>            <span class="n">overlap</span> <span class="o">=</span> <span class="n">window</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="Signal.log_envelope-1339"><a href="#Signal.log_envelope-1339"><span class="linenos">1339</span></a>            <span class="n">current_exponent</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Signal.log_envelope-1340"><a href="#Signal.log_envelope-1340"><span class="linenos">1340</span></a>        <span class="n">time</span><span class="p">,</span> <span class="n">idxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">log_envelope_time</span><span class="p">,</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Signal.log_envelope-1341"><a href="#Signal.log_envelope-1341"><span class="linenos">1341</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">log_envelope</span><span class="p">)[</span><span class="n">idxs</span><span class="p">],</span> <span class="n">time</span>
</span></pre></div>


            <div class="docstring"><p>Computes the logarithmic scale envelope of the signal.
The width of the samples increases exponentially so that
the envelope appears having a constant window width on
an X axis logarithmic scale.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The log envelope and the time vector associated in a tuple</p>
</blockquote>
</div>


                            </div>
                            <div id="Signal.find_onset" class="classattr">
                                        <input id="Signal.find_onset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">find_onset</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Signal.find_onset-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Signal.find_onset"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Signal.find_onset-1343"><a href="#Signal.find_onset-1343"><span class="linenos">1343</span></a>    <span class="k">def</span> <span class="nf">find_onset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Signal.find_onset-1344"><a href="#Signal.find_onset-1344"><span class="linenos">1344</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal.find_onset-1345"><a href="#Signal.find_onset-1345"><span class="linenos">1345</span></a><span class="sd">        Finds the onset as an increase in more of 50% with the maximum normalized value above 0.5</span>
</span><span id="Signal.find_onset-1346"><a href="#Signal.find_onset-1346"><span class="linenos">1346</span></a><span class="sd">        :param verbose: Prints a warning if the algorithm does not converge</span>
</span><span id="Signal.find_onset-1347"><a href="#Signal.find_onset-1347"><span class="linenos">1347</span></a><span class="sd">        :return: the index of the onset in the signal</span>
</span><span id="Signal.find_onset-1348"><a href="#Signal.find_onset-1348"><span class="linenos">1348</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal.find_onset-1349"><a href="#Signal.find_onset-1349"><span class="linenos">1349</span></a>        <span class="c1"># Index corresponding to the onset time interval</span>
</span><span id="Signal.find_onset-1350"><a href="#Signal.find_onset-1350"><span class="linenos">1350</span></a>        <span class="n">window_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">onset</span><span class="o">.</span><span class="n">onset_time</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="Signal.find_onset-1351"><a href="#Signal.find_onset-1351"><span class="linenos">1351</span></a>        <span class="c1"># Use the normalized signal to compare against a fixed value</span>
</span><span id="Signal.find_onset-1352"><a href="#Signal.find_onset-1352"><span class="linenos">1352</span></a>        <span class="n">onset_signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
</span><span id="Signal.find_onset-1353"><a href="#Signal.find_onset-1353"><span class="linenos">1353</span></a>        <span class="n">overlap</span> <span class="o">=</span> <span class="n">window_index</span> <span class="o">//</span> <span class="mi">2</span>  <span class="c1"># overlap for algorithm progression</span>
</span><span id="Signal.find_onset-1354"><a href="#Signal.find_onset-1354"><span class="linenos">1354</span></a>        <span class="c1"># Initial values</span>
</span><span id="Signal.find_onset-1355"><a href="#Signal.find_onset-1355"><span class="linenos">1355</span></a>        <span class="n">increase</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Signal.find_onset-1356"><a href="#Signal.find_onset-1356"><span class="linenos">1356</span></a>        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Signal.find_onset-1357"><a href="#Signal.find_onset-1357"><span class="linenos">1357</span></a>        <span class="n">broke</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Signal.find_onset-1358"><a href="#Signal.find_onset-1358"><span class="linenos">1358</span></a>        <span class="k">while</span> <span class="n">increase</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">:</span>
</span><span id="Signal.find_onset-1359"><a href="#Signal.find_onset-1359"><span class="linenos">1359</span></a>            <span class="n">signal_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">onset_signal</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_index</span><span class="p">]))</span>
</span><span id="Signal.find_onset-1360"><a href="#Signal.find_onset-1360"><span class="linenos">1360</span></a>            <span class="n">signal_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">onset_signal</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_index</span><span class="p">]))</span>
</span><span id="Signal.find_onset-1361"><a href="#Signal.find_onset-1361"><span class="linenos">1361</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">signal_max</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">signal_min</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="Signal.find_onset-1362"><a href="#Signal.find_onset-1362"><span class="linenos">1362</span></a>                <span class="n">increase</span> <span class="o">=</span> <span class="n">signal_max</span> <span class="o">/</span> <span class="n">signal_min</span>
</span><span id="Signal.find_onset-1363"><a href="#Signal.find_onset-1363"><span class="linenos">1363</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Signal.find_onset-1364"><a href="#Signal.find_onset-1364"><span class="linenos">1364</span></a>                <span class="n">increase</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Signal.find_onset-1365"><a href="#Signal.find_onset-1365"><span class="linenos">1365</span></a>            <span class="n">i</span> <span class="o">+=</span> <span class="n">overlap</span>
</span><span id="Signal.find_onset-1366"><a href="#Signal.find_onset-1366"><span class="linenos">1366</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="n">window_index</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">):</span>
</span><span id="Signal.find_onset-1367"><a href="#Signal.find_onset-1367"><span class="linenos">1367</span></a>                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Signal.find_onset-1368"><a href="#Signal.find_onset-1368"><span class="linenos">1368</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Onset detection did not converge </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Signal.find_onset-1369"><a href="#Signal.find_onset-1369"><span class="linenos">1369</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Approximating onset with signal max value </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Signal.find_onset-1370"><a href="#Signal.find_onset-1370"><span class="linenos">1370</span></a>                <span class="n">broke</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Signal.find_onset-1371"><a href="#Signal.find_onset-1371"><span class="linenos">1371</span></a>                <span class="k">break</span>
</span><span id="Signal.find_onset-1372"><a href="#Signal.find_onset-1372"><span class="linenos">1372</span></a>        <span class="k">if</span> <span class="n">broke</span><span class="p">:</span>
</span><span id="Signal.find_onset-1373"><a href="#Signal.find_onset-1373"><span class="linenos">1373</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">))</span>
</span><span id="Signal.find_onset-1374"><a href="#Signal.find_onset-1374"><span class="linenos">1374</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Signal.find_onset-1375"><a href="#Signal.find_onset-1375"><span class="linenos">1375</span></a>            <span class="n">i</span> <span class="o">-=</span> <span class="n">overlap</span>
</span><span id="Signal.find_onset-1376"><a href="#Signal.find_onset-1376"><span class="linenos">1376</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_index</span><span class="p">]))</span> <span class="o">+</span> <span class="n">i</span> 
</span></pre></div>


            <div class="docstring"><p>Finds the onset as an increase in more of 50% with the maximum normalized value above 0.5</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>verbose</strong>:  Prints a warning if the algorithm does not converge</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>the index of the onset in the signal</p>
</blockquote>
</div>


                            </div>
                            <div id="Signal.trim_onset" class="classattr">
                                        <input id="Signal.trim_onset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">trim_onset</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Signal.trim_onset-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Signal.trim_onset"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Signal.trim_onset-1378"><a href="#Signal.trim_onset-1378"><span class="linenos">1378</span></a>    <span class="k">def</span> <span class="nf">trim_onset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Signal.trim_onset-1379"><a href="#Signal.trim_onset-1379"><span class="linenos">1379</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal.trim_onset-1380"><a href="#Signal.trim_onset-1380"><span class="linenos">1380</span></a><span class="sd">        Trim the signal at the onset (max) minus the delay in milliseconds as</span>
</span><span id="Signal.trim_onset-1381"><a href="#Signal.trim_onset-1381"><span class="linenos">1381</span></a><span class="sd">        Specified in the SoundParameters</span>
</span><span id="Signal.trim_onset-1382"><a href="#Signal.trim_onset-1382"><span class="linenos">1382</span></a><span class="sd">        :param verbose: if False the warning comments are not displayed</span>
</span><span id="Signal.trim_onset-1383"><a href="#Signal.trim_onset-1383"><span class="linenos">1383</span></a><span class="sd">        :return : The trimmed signal</span>
</span><span id="Signal.trim_onset-1384"><a href="#Signal.trim_onset-1384"><span class="linenos">1384</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal.trim_onset-1385"><a href="#Signal.trim_onset-1385"><span class="linenos">1385</span></a>        <span class="c1"># nb of samples to keep before the onset</span>
</span><span id="Signal.trim_onset-1386"><a href="#Signal.trim_onset-1386"><span class="linenos">1386</span></a>        <span class="n">delay_samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">onset</span><span class="o">.</span><span class="n">onset_delay</span><span class="o">.</span><span class="n">value</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">)</span>
</span><span id="Signal.trim_onset-1387"><a href="#Signal.trim_onset-1387"><span class="linenos">1387</span></a>        <span class="n">onset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_onset</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>  <span class="c1"># find the onset</span>
</span><span id="Signal.trim_onset-1388"><a href="#Signal.trim_onset-1388"><span class="linenos">1388</span></a>
</span><span id="Signal.trim_onset-1389"><a href="#Signal.trim_onset-1389"><span class="linenos">1389</span></a>        <span class="k">if</span> <span class="n">onset</span> <span class="o">&gt;</span> <span class="n">delay_samples</span><span class="p">:</span>  <span class="c1"># To make sure the index is positive</span>
</span><span id="Signal.trim_onset-1390"><a href="#Signal.trim_onset-1390"><span class="linenos">1390</span></a>            <span class="n">new_signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[</span><span class="n">onset</span> <span class="o">-</span> <span class="n">delay_samples</span><span class="p">:]</span>
</span><span id="Signal.trim_onset-1391"><a href="#Signal.trim_onset-1391"><span class="linenos">1391</span></a>            <span class="n">new_signal</span><span class="p">[:</span><span class="n">delay_samples</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_signal</span><span class="p">[:</span><span class="n">delay_samples</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">delay_samples</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> 
</span><span id="Signal.trim_onset-1392"><a href="#Signal.trim_onset-1392"><span class="linenos">1392</span></a>            <span class="n">trimmed_signal</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">(</span><span class="n">new_signal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">)</span>
</span><span id="Signal.trim_onset-1393"><a href="#Signal.trim_onset-1393"><span class="linenos">1393</span></a>            <span class="n">trimmed_signal</span><span class="o">.</span><span class="n">onset</span> <span class="o">=</span> <span class="n">trimmed_signal</span><span class="o">.</span><span class="n">find_onset</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="Signal.trim_onset-1394"><a href="#Signal.trim_onset-1394"><span class="linenos">1394</span></a>            <span class="k">return</span> <span class="n">trimmed_signal</span>
</span><span id="Signal.trim_onset-1395"><a href="#Signal.trim_onset-1395"><span class="linenos">1395</span></a>
</span><span id="Signal.trim_onset-1396"><a href="#Signal.trim_onset-1396"><span class="linenos">1396</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Signal.trim_onset-1397"><a href="#Signal.trim_onset-1397"><span class="linenos">1397</span></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Signal.trim_onset-1398"><a href="#Signal.trim_onset-1398"><span class="linenos">1398</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Signal is too short to be trimmed before onset.&#39;</span><span class="p">)</span>
</span><span id="Signal.trim_onset-1399"><a href="#Signal.trim_onset-1399"><span class="linenos">1399</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="Signal.trim_onset-1400"><a href="#Signal.trim_onset-1400"><span class="linenos">1400</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Trim the signal at the onset (max) minus the delay in milliseconds as
Specified in the SoundParameters</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>verbose</strong>:  if False the warning comments are not displayed
:return : The trimmed signal</li>
</ul>
</div>


                            </div>
                            <div id="Signal.trim_time" class="classattr">
                                        <input id="Signal.trim_time-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">trim_time</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">time_length</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Signal.trim_time-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Signal.trim_time"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Signal.trim_time-1402"><a href="#Signal.trim_time-1402"><span class="linenos">1402</span></a>    <span class="k">def</span> <span class="nf">trim_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_length</span><span class="p">):</span>
</span><span id="Signal.trim_time-1403"><a href="#Signal.trim_time-1403"><span class="linenos">1403</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal.trim_time-1404"><a href="#Signal.trim_time-1404"><span class="linenos">1404</span></a><span class="sd">        Trims the signal to the specified length and returns a new Signal instance.</span>
</span><span id="Signal.trim_time-1405"><a href="#Signal.trim_time-1405"><span class="linenos">1405</span></a><span class="sd">        :param time_length: desired length of the new signal in seconds.</span>
</span><span id="Signal.trim_time-1406"><a href="#Signal.trim_time-1406"><span class="linenos">1406</span></a><span class="sd">        :return: A trimmed Signal</span>
</span><span id="Signal.trim_time-1407"><a href="#Signal.trim_time-1407"><span class="linenos">1407</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal.trim_time-1408"><a href="#Signal.trim_time-1408"><span class="linenos">1408</span></a>        <span class="n">max_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time_length</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">)</span>
</span><span id="Signal.trim_time-1409"><a href="#Signal.trim_time-1409"><span class="linenos">1409</span></a>        <span class="n">new_signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">[:</span><span class="n">max_index</span><span class="p">]</span>
</span><span id="Signal.trim_time-1410"><a href="#Signal.trim_time-1410"><span class="linenos">1410</span></a>        <span class="n">new_signal</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:]</span> <span class="o">=</span> <span class="n">new_signal</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</span><span id="Signal.trim_time-1411"><a href="#Signal.trim_time-1411"><span class="linenos">1411</span></a>        <span class="n">time_trimmed_signal</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">(</span><span class="n">new_signal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">)</span>
</span><span id="Signal.trim_time-1412"><a href="#Signal.trim_time-1412"><span class="linenos">1412</span></a>        <span class="k">return</span> <span class="n">time_trimmed_signal</span>
</span></pre></div>


            <div class="docstring"><p>Trims the signal to the specified length and returns a new Signal instance.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>time_length</strong>:  desired length of the new signal in seconds.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A trimmed Signal</p>
</blockquote>
</div>


                            </div>
                            <div id="Signal.normalize" class="classattr">
                                        <input id="Signal.normalize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">normalize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Signal.normalize-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Signal.normalize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Signal.normalize-1414"><a href="#Signal.normalize-1414"><span class="linenos">1414</span></a>    <span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal.normalize-1415"><a href="#Signal.normalize-1415"><span class="linenos">1415</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal.normalize-1416"><a href="#Signal.normalize-1416"><span class="linenos">1416</span></a><span class="sd">        Normalizes the signal to [-1, 1] and returns the normalized instance.</span>
</span><span id="Signal.normalize-1417"><a href="#Signal.normalize-1417"><span class="linenos">1417</span></a><span class="sd">        return : A normalized signal</span>
</span><span id="Signal.normalize-1418"><a href="#Signal.normalize-1418"><span class="linenos">1418</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal.normalize-1419"><a href="#Signal.normalize-1419"><span class="linenos">1419</span></a>        <span class="n">factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">))</span>
</span><span id="Signal.normalize-1420"><a href="#Signal.normalize-1420"><span class="linenos">1420</span></a>        <span class="n">normalised_signal</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">/</span> <span class="n">factor</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">)</span>
</span><span id="Signal.normalize-1421"><a href="#Signal.normalize-1421"><span class="linenos">1421</span></a>        <span class="n">normalised_signal</span><span class="o">.</span><span class="n">norm_factor</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">factor</span><span class="p">)</span>
</span><span id="Signal.normalize-1422"><a href="#Signal.normalize-1422"><span class="linenos">1422</span></a>        <span class="k">return</span> <span class="n">normalised_signal</span>
</span></pre></div>


            <div class="docstring"><p>Normalizes the signal to [-1, 1] and returns the normalized instance.
return : A normalized signal</p>
</div>


                            </div>
                            <div id="Signal.make_freq_bins" class="classattr">
                                        <input id="Signal.make_freq_bins-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">make_freq_bins</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Signal.make_freq_bins-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Signal.make_freq_bins"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Signal.make_freq_bins-1424"><a href="#Signal.make_freq_bins-1424"><span class="linenos">1424</span></a>    <span class="k">def</span> <span class="nf">make_freq_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Signal.make_freq_bins-1425"><a href="#Signal.make_freq_bins-1425"><span class="linenos">1425</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal.make_freq_bins-1426"><a href="#Signal.make_freq_bins-1426"><span class="linenos">1426</span></a><span class="sd">        Method to divide a signal in frequency bins using butterworth filters</span>
</span><span id="Signal.make_freq_bins-1427"><a href="#Signal.make_freq_bins-1427"><span class="linenos">1427</span></a><span class="sd">        bins are passed as a dict, default values are :</span>
</span><span id="Signal.make_freq_bins-1428"><a href="#Signal.make_freq_bins-1428"><span class="linenos">1428</span></a><span class="sd">        - bass &lt; 100 Hz</span>
</span><span id="Signal.make_freq_bins-1429"><a href="#Signal.make_freq_bins-1429"><span class="linenos">1429</span></a><span class="sd">        - mid = 100 - 700 Hz</span>
</span><span id="Signal.make_freq_bins-1430"><a href="#Signal.make_freq_bins-1430"><span class="linenos">1430</span></a><span class="sd">        - highmid = 700 - 2000 Hz</span>
</span><span id="Signal.make_freq_bins-1431"><a href="#Signal.make_freq_bins-1431"><span class="linenos">1431</span></a><span class="sd">        - uppermid = 2000 - 4000 Hz</span>
</span><span id="Signal.make_freq_bins-1432"><a href="#Signal.make_freq_bins-1432"><span class="linenos">1432</span></a><span class="sd">        - presence = 4000 - 6000 Hz</span>
</span><span id="Signal.make_freq_bins-1433"><a href="#Signal.make_freq_bins-1433"><span class="linenos">1433</span></a><span class="sd">        - brillance &gt; 6000 Hz</span>
</span><span id="Signal.make_freq_bins-1434"><a href="#Signal.make_freq_bins-1434"><span class="linenos">1434</span></a><span class="sd">        :return : A dictionary with the divided signal as values and bin names as keys</span>
</span><span id="Signal.make_freq_bins-1435"><a href="#Signal.make_freq_bins-1435"><span class="linenos">1435</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal.make_freq_bins-1436"><a href="#Signal.make_freq_bins-1436"><span class="linenos">1436</span></a>
</span><span id="Signal.make_freq_bins-1437"><a href="#Signal.make_freq_bins-1437"><span class="linenos">1437</span></a>        <span class="n">bins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="vm">__dict__</span>
</span><span id="Signal.make_freq_bins-1438"><a href="#Signal.make_freq_bins-1438"><span class="linenos">1438</span></a>
</span><span id="Signal.make_freq_bins-1439"><a href="#Signal.make_freq_bins-1439"><span class="linenos">1439</span></a>        <span class="n">bass_filter</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s2">&quot;bass&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;lp&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
</span><span id="Signal.make_freq_bins-1440"><a href="#Signal.make_freq_bins-1440"><span class="linenos">1440</span></a>        <span class="n">mid_filter</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s2">&quot;bass&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s1">&#39;mid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">],</span> <span class="s1">&#39;bp&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
</span><span id="Signal.make_freq_bins-1441"><a href="#Signal.make_freq_bins-1441"><span class="linenos">1441</span></a>        <span class="n">himid_filter</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s2">&quot;mid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s1">&#39;highmid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">],</span> <span class="s1">&#39;bp&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
</span><span id="Signal.make_freq_bins-1442"><a href="#Signal.make_freq_bins-1442"><span class="linenos">1442</span></a>        <span class="n">upmid_filter</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s2">&quot;highmid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s1">&#39;uppermid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">],</span> <span class="s1">&#39;bp&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
</span><span id="Signal.make_freq_bins-1443"><a href="#Signal.make_freq_bins-1443"><span class="linenos">1443</span></a>        <span class="n">pres_filter</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s2">&quot;uppermid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s1">&#39;presence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">],</span> <span class="s1">&#39;bp&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
</span><span id="Signal.make_freq_bins-1444"><a href="#Signal.make_freq_bins-1444"><span class="linenos">1444</span></a>        <span class="n">bril_filter</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s1">&#39;presence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;hp&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
</span><span id="Signal.make_freq_bins-1445"><a href="#Signal.make_freq_bins-1445"><span class="linenos">1445</span></a>
</span><span id="Signal.make_freq_bins-1446"><a href="#Signal.make_freq_bins-1446"><span class="linenos">1446</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="Signal.make_freq_bins-1447"><a href="#Signal.make_freq_bins-1447"><span class="linenos">1447</span></a>            <span class="s2">&quot;bass&quot;</span><span class="p">:</span> <span class="n">Signal</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">bass_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">,</span>
</span><span id="Signal.make_freq_bins-1448"><a href="#Signal.make_freq_bins-1448"><span class="linenos">1448</span></a>                           <span class="n">freq_range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s2">&quot;bass&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">]),</span>
</span><span id="Signal.make_freq_bins-1449"><a href="#Signal.make_freq_bins-1449"><span class="linenos">1449</span></a>            <span class="s2">&quot;mid&quot;</span><span class="p">:</span> <span class="n">Signal</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">mid_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">,</span>
</span><span id="Signal.make_freq_bins-1450"><a href="#Signal.make_freq_bins-1450"><span class="linenos">1450</span></a>                          <span class="n">freq_range</span><span class="o">=</span><span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s2">&quot;bass&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s2">&quot;mid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">]),</span>
</span><span id="Signal.make_freq_bins-1451"><a href="#Signal.make_freq_bins-1451"><span class="linenos">1451</span></a>            <span class="s2">&quot;highmid&quot;</span><span class="p">:</span> <span class="n">Signal</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">himid_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">,</span>
</span><span id="Signal.make_freq_bins-1452"><a href="#Signal.make_freq_bins-1452"><span class="linenos">1452</span></a>                              <span class="n">freq_range</span><span class="o">=</span><span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s2">&quot;mid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s2">&quot;highmid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">]),</span>
</span><span id="Signal.make_freq_bins-1453"><a href="#Signal.make_freq_bins-1453"><span class="linenos">1453</span></a>            <span class="s2">&quot;uppermid&quot;</span><span class="p">:</span> <span class="n">Signal</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">upmid_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">,</span>
</span><span id="Signal.make_freq_bins-1454"><a href="#Signal.make_freq_bins-1454"><span class="linenos">1454</span></a>                               <span class="n">freq_range</span><span class="o">=</span><span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s2">&quot;highmid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s2">&quot;uppermid&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">]),</span>
</span><span id="Signal.make_freq_bins-1455"><a href="#Signal.make_freq_bins-1455"><span class="linenos">1455</span></a>            <span class="s2">&quot;presence&quot;</span><span class="p">:</span> <span class="n">Signal</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">pres_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">,</span>
</span><span id="Signal.make_freq_bins-1456"><a href="#Signal.make_freq_bins-1456"><span class="linenos">1456</span></a>                               <span class="n">freq_range</span><span class="o">=</span><span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s1">&#39;uppermid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="p">[</span><span class="s2">&quot;presence&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">]),</span>
</span><span id="Signal.make_freq_bins-1457"><a href="#Signal.make_freq_bins-1457"><span class="linenos">1457</span></a>            <span class="s2">&quot;brillance&quot;</span><span class="p">:</span> <span class="n">Signal</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">bril_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SP</span><span class="p">,</span>
</span><span id="Signal.make_freq_bins-1458"><a href="#Signal.make_freq_bins-1458"><span class="linenos">1458</span></a>                                <span class="n">freq_range</span><span class="o">=</span><span class="p">[</span><span class="n">bins</span><span class="p">[</span><span class="s2">&quot;presence&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">())])}</span>
</span></pre></div>


            <div class="docstring"><p>Method to divide a signal in frequency bins using butterworth filters
bins are passed as a dict, default values are :</p>

<ul>
<li>bass &lt; 100 Hz</li>
<li>mid = 100 - 700 Hz</li>
<li>highmid = 700 - 2000 Hz</li>
<li>uppermid = 2000 - 4000 Hz</li>
<li>presence = 4000 - 6000 Hz</li>
<li>brillance &gt; 6000 Hz
:return : A dictionary with the divided signal as values and bin names as keys</li>
</ul>
</div>


                            </div>
                            <div id="Signal.save_wav" class="classattr">
                                        <input id="Signal.save_wav-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">save_wav</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">name</span>, </span><span class="param"><span class="n">path</span><span class="o">=</span><span class="s1">&#39;&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Signal.save_wav-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Signal.save_wav"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Signal.save_wav-1460"><a href="#Signal.save_wav-1460"><span class="linenos">1460</span></a>    <span class="k">def</span> <span class="nf">save_wav</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
</span><span id="Signal.save_wav-1461"><a href="#Signal.save_wav-1461"><span class="linenos">1461</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Signal.save_wav-1462"><a href="#Signal.save_wav-1462"><span class="linenos">1462</span></a><span class="sd">        Create a soundfile from a signal</span>
</span><span id="Signal.save_wav-1463"><a href="#Signal.save_wav-1463"><span class="linenos">1463</span></a><span class="sd">        :param name: the name of the saved file</span>
</span><span id="Signal.save_wav-1464"><a href="#Signal.save_wav-1464"><span class="linenos">1464</span></a><span class="sd">        :param path: the path were the &#39;.wav&#39; file is saved</span>
</span><span id="Signal.save_wav-1465"><a href="#Signal.save_wav-1465"><span class="linenos">1465</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Signal.save_wav-1466"><a href="#Signal.save_wav-1466"><span class="linenos">1466</span></a>        <span class="n">write</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;.wav&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sr</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a soundfile from a signal</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong>:  the name of the saved file</li>
<li><strong>path</strong>:  the path were the '.wav' file is saved</li>
</ul>
</div>


                            </div>
                </section>
                <section id="Plot">
                            <input id="Plot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Plot</span>:

                <label class="view-source-button" for="Plot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Plot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Plot-1469"><a href="#Plot-1469"><span class="linenos">1469</span></a><span class="k">class</span> <span class="nc">Plot</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="Plot-1470"><a href="#Plot-1470"><span class="linenos">1470</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plot-1471"><a href="#Plot-1471"><span class="linenos">1471</span></a><span class="sd">        A class to handle all the plotting functions of the Signal and to allow a nice call signature :</span>
</span><span id="Plot-1472"><a href="#Plot-1472"><span class="linenos">1472</span></a><span class="sd">        Signal.plot.envelope()</span>
</span><span id="Plot-1473"><a href="#Plot-1473"><span class="linenos">1473</span></a>
</span><span id="Plot-1474"><a href="#Plot-1474"><span class="linenos">1474</span></a><span class="sd">        Supported plots are :</span>
</span><span id="Plot-1475"><a href="#Plot-1475"><span class="linenos">1475</span></a><span class="sd">        &#39;signal&#39;, &#39;envelope&#39;, &#39;log envelope&#39;, &#39;fft&#39;, &#39;fft hist&#39;, &#39;peaks&#39;,</span>
</span><span id="Plot-1476"><a href="#Plot-1476"><span class="linenos">1476</span></a><span class="sd">        &#39;peak damping&#39;, &#39;time damping&#39;, &#39;integral&#39;</span>
</span><span id="Plot-1477"><a href="#Plot-1477"><span class="linenos">1477</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Plot-1478"><a href="#Plot-1478"><span class="linenos">1478</span></a>
</span><span id="Plot-1479"><a href="#Plot-1479"><span class="linenos">1479</span></a>    <span class="c1"># Illegal plot key word arguments</span>
</span><span id="Plot-1480"><a href="#Plot-1480"><span class="linenos">1480</span></a>    <span class="n">illegal_kwargs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;max_time&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="s1">&#39;normalize&#39;</span><span class="p">,</span> <span class="s1">&#39;inverse&#39;</span><span class="p">,</span>
</span><span id="Plot-1481"><a href="#Plot-1481"><span class="linenos">1481</span></a>                      <span class="s1">&#39;peak_height&#39;</span><span class="p">,</span> <span class="s1">&#39;fill&#39;</span><span class="p">]</span>
</span><span id="Plot-1482"><a href="#Plot-1482"><span class="linenos">1482</span></a>
</span><span id="Plot-1483"><a href="#Plot-1483"><span class="linenos">1483</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Plot-1484"><a href="#Plot-1484"><span class="linenos">1484</span></a>        <span class="c1"># define the parent attribute</span>
</span><span id="Plot-1485"><a href="#Plot-1485"><span class="linenos">1485</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Plot-1486"><a href="#Plot-1486"><span class="linenos">1486</span></a>
</span><span id="Plot-1487"><a href="#Plot-1487"><span class="linenos">1487</span></a>        <span class="c1"># dictionary with methods and keywords</span>
</span><span id="Plot-1488"><a href="#Plot-1488"><span class="linenos">1488</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">method_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;signal&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">,</span>
</span><span id="Plot-1489"><a href="#Plot-1489"><span class="linenos">1489</span></a>                            <span class="s1">&#39;envelope&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">envelope</span><span class="p">,</span>
</span><span id="Plot-1490"><a href="#Plot-1490"><span class="linenos">1490</span></a>                            <span class="s1">&#39;log envelope&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">,</span>
</span><span id="Plot-1491"><a href="#Plot-1491"><span class="linenos">1491</span></a>                            <span class="s1">&#39;fft&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">,</span>
</span><span id="Plot-1492"><a href="#Plot-1492"><span class="linenos">1492</span></a>                            <span class="s1">&#39;fft hist&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft_hist</span><span class="p">,</span>
</span><span id="Plot-1493"><a href="#Plot-1493"><span class="linenos">1493</span></a>                            <span class="s1">&#39;peaks&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span>
</span><span id="Plot-1494"><a href="#Plot-1494"><span class="linenos">1494</span></a>                            <span class="s1">&#39;peak damping&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_damping</span><span class="p">,</span>
</span><span id="Plot-1495"><a href="#Plot-1495"><span class="linenos">1495</span></a>                            <span class="s1">&#39;time damping&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_damping</span><span class="p">,</span>
</span><span id="Plot-1496"><a href="#Plot-1496"><span class="linenos">1496</span></a>                            <span class="s1">&#39;integral&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">integral</span><span class="p">,</span> <span class="p">}</span>
</span><span id="Plot-1497"><a href="#Plot-1497"><span class="linenos">1497</span></a>
</span><span id="Plot-1498"><a href="#Plot-1498"><span class="linenos">1498</span></a>    <span class="k">def</span> <span class="nf">sanitize_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
</span><span id="Plot-1499"><a href="#Plot-1499"><span class="linenos">1499</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plot-1500"><a href="#Plot-1500"><span class="linenos">1500</span></a><span class="sd">        Remove illegal keywords to supply the key word arguments to matplotlib</span>
</span><span id="Plot-1501"><a href="#Plot-1501"><span class="linenos">1501</span></a><span class="sd">        :param kwargs: a dictionary of key word arguments</span>
</span><span id="Plot-1502"><a href="#Plot-1502"><span class="linenos">1502</span></a><span class="sd">        :return: sanitized kwargs</span>
</span><span id="Plot-1503"><a href="#Plot-1503"><span class="linenos">1503</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plot-1504"><a href="#Plot-1504"><span class="linenos">1504</span></a>        <span class="k">return</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">illegal_kwargs</span><span class="p">}</span>
</span><span id="Plot-1505"><a href="#Plot-1505"><span class="linenos">1505</span></a>
</span><span id="Plot-1506"><a href="#Plot-1506"><span class="linenos">1506</span></a>    <span class="k">def</span> <span class="nf">set_bin_ticks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Plot-1507"><a href="#Plot-1507"><span class="linenos">1507</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Applies the frequency bin ticks to the current plot &quot;&quot;&quot;</span>
</span><span id="Plot-1508"><a href="#Plot-1508"><span class="linenos">1508</span></a>        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">label</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="vm">__dict__</span> <span class="k">if</span> <span class="n">label</span> <span class="o">!=</span> <span class="s1">&#39;name&#39;</span><span class="p">]</span>
</span><span id="Plot-1509"><a href="#Plot-1509"><span class="linenos">1509</span></a>        <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;brillance&#39;</span><span class="p">)</span>
</span><span id="Plot-1510"><a href="#Plot-1510"><span class="linenos">1510</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">param</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">param</span> <span class="o">!=</span> <span class="s1">&#39;bins&#39;</span><span class="p">]</span>
</span><span id="Plot-1511"><a href="#Plot-1511"><span class="linenos">1511</span></a>        <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">11025</span><span class="p">)</span>
</span><span id="Plot-1512"><a href="#Plot-1512"><span class="linenos">1512</span></a>        <span class="n">x_formatter</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FixedFormatter</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</span><span id="Plot-1513"><a href="#Plot-1513"><span class="linenos">1513</span></a>        <span class="n">x_locator</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Plot-1514"><a href="#Plot-1514"><span class="linenos">1514</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="Plot-1515"><a href="#Plot-1515"><span class="linenos">1515</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">x_locator</span><span class="p">)</span>
</span><span id="Plot-1516"><a href="#Plot-1516"><span class="linenos">1516</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">x_formatter</span><span class="p">)</span>
</span><span id="Plot-1517"><a href="#Plot-1517"><span class="linenos">1517</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelrotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
</span><span id="Plot-1518"><a href="#Plot-1518"><span class="linenos">1518</span></a>
</span><span id="Plot-1519"><a href="#Plot-1519"><span class="linenos">1519</span></a>    <span class="k">def</span> <span class="nf">signal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Plot-1520"><a href="#Plot-1520"><span class="linenos">1520</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Plots the time varying real signal as amplitude vs time. &quot;&quot;&quot;</span>
</span><span id="Plot-1521"><a href="#Plot-1521"><span class="linenos">1521</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Plot-1522"><a href="#Plot-1522"><span class="linenos">1522</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">signal</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="Plot-1523"><a href="#Plot-1523"><span class="linenos">1523</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
</span><span id="Plot-1524"><a href="#Plot-1524"><span class="linenos">1524</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;amplitude [-1, 1]&#39;</span><span class="p">)</span>
</span><span id="Plot-1525"><a href="#Plot-1525"><span class="linenos">1525</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="Plot-1526"><a href="#Plot-1526"><span class="linenos">1526</span></a>
</span><span id="Plot-1527"><a href="#Plot-1527"><span class="linenos">1527</span></a>    <span class="k">def</span> <span class="nf">envelope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Plot-1528"><a href="#Plot-1528"><span class="linenos">1528</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plot-1529"><a href="#Plot-1529"><span class="linenos">1529</span></a><span class="sd">        Plots the envelope of the signal as amplitude vs time.</span>
</span><span id="Plot-1530"><a href="#Plot-1530"><span class="linenos">1530</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plot-1531"><a href="#Plot-1531"><span class="linenos">1531</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Plot-1532"><a href="#Plot-1532"><span class="linenos">1532</span></a>        <span class="n">envelope_arr</span><span class="p">,</span> <span class="n">envelope_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">envelope</span><span class="p">()</span>
</span><span id="Plot-1533"><a href="#Plot-1533"><span class="linenos">1533</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">envelope_time</span><span class="p">,</span> <span class="n">envelope_arr</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="Plot-1534"><a href="#Plot-1534"><span class="linenos">1534</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time (s)&quot;</span><span class="p">)</span>
</span><span id="Plot-1535"><a href="#Plot-1535"><span class="linenos">1535</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;amplitude [0, 1]&quot;</span><span class="p">)</span>
</span><span id="Plot-1536"><a href="#Plot-1536"><span class="linenos">1536</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="Plot-1537"><a href="#Plot-1537"><span class="linenos">1537</span></a>
</span><span id="Plot-1538"><a href="#Plot-1538"><span class="linenos">1538</span></a>    <span class="k">def</span> <span class="nf">log_envelope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Plot-1539"><a href="#Plot-1539"><span class="linenos">1539</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plot-1540"><a href="#Plot-1540"><span class="linenos">1540</span></a><span class="sd">        Plots the signal envelope with logarithmic window widths on a logarithmic x-axis scale.</span>
</span><span id="Plot-1541"><a href="#Plot-1541"><span class="linenos">1541</span></a><span class="sd">        :param max_time: maximum time used for the x-axis in the plot (seconds)</span>
</span><span id="Plot-1542"><a href="#Plot-1542"><span class="linenos">1542</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plot-1543"><a href="#Plot-1543"><span class="linenos">1543</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Plot-1544"><a href="#Plot-1544"><span class="linenos">1544</span></a>        <span class="n">log_envelope</span><span class="p">,</span> <span class="n">log_envelope_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="Plot-1545"><a href="#Plot-1545"><span class="linenos">1545</span></a>
</span><span id="Plot-1546"><a href="#Plot-1546"><span class="linenos">1546</span></a>        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;max_time&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;max_time&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">log_envelope_time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="Plot-1547"><a href="#Plot-1547"><span class="linenos">1547</span></a>            <span class="n">max_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">log_envelope_time</span> <span class="o">&gt;=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;max_time&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Plot-1548"><a href="#Plot-1548"><span class="linenos">1548</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Plot-1549"><a href="#Plot-1549"><span class="linenos">1549</span></a>            <span class="n">max_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">log_envelope_time</span><span class="p">)</span>
</span><span id="Plot-1550"><a href="#Plot-1550"><span class="linenos">1550</span></a>
</span><span id="Plot-1551"><a href="#Plot-1551"><span class="linenos">1551</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">log_envelope_time</span><span class="p">[:</span><span class="n">max_index</span><span class="p">],</span> <span class="n">log_envelope</span><span class="p">[:</span><span class="n">max_index</span><span class="p">],</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="Plot-1552"><a href="#Plot-1552"><span class="linenos">1552</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time (s)&quot;</span><span class="p">)</span>
</span><span id="Plot-1553"><a href="#Plot-1553"><span class="linenos">1553</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;amplitude [0, 1]&quot;</span><span class="p">)</span>
</span><span id="Plot-1554"><a href="#Plot-1554"><span class="linenos">1554</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="Plot-1555"><a href="#Plot-1555"><span class="linenos">1555</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="Plot-1556"><a href="#Plot-1556"><span class="linenos">1556</span></a>
</span><span id="Plot-1557"><a href="#Plot-1557"><span class="linenos">1557</span></a>    <span class="k">def</span> <span class="nf">fft</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Plot-1558"><a href="#Plot-1558"><span class="linenos">1558</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plot-1559"><a href="#Plot-1559"><span class="linenos">1559</span></a><span class="sd">        Plots the Fourier Transform of the Signal.</span>
</span><span id="Plot-1560"><a href="#Plot-1560"><span class="linenos">1560</span></a>
</span><span id="Plot-1561"><a href="#Plot-1561"><span class="linenos">1561</span></a><span class="sd">        If `ticks = &#39;bins&#39;` is supplied in the keyword arguments, the frequency ticks are replaced</span>
</span><span id="Plot-1562"><a href="#Plot-1562"><span class="linenos">1562</span></a><span class="sd">        with the frequency bin values.</span>
</span><span id="Plot-1563"><a href="#Plot-1563"><span class="linenos">1563</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plot-1564"><a href="#Plot-1564"><span class="linenos">1564</span></a>
</span><span id="Plot-1565"><a href="#Plot-1565"><span class="linenos">1565</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Plot-1566"><a href="#Plot-1566"><span class="linenos">1566</span></a>
</span><span id="Plot-1567"><a href="#Plot-1567"><span class="linenos">1567</span></a>        <span class="c1"># find the index corresponding to the fft range</span>
</span><span id="Plot-1568"><a href="#Plot-1568"><span class="linenos">1568</span></a>        <span class="n">fft_frequencies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span>
</span><span id="Plot-1569"><a href="#Plot-1569"><span class="linenos">1569</span></a>        <span class="n">fft_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">fft_range</span><span class="o">.</span><span class="n">value</span>
</span><span id="Plot-1570"><a href="#Plot-1570"><span class="linenos">1570</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fft_frequencies</span> <span class="o">&gt;=</span> <span class="n">fft_range</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Plot-1571"><a href="#Plot-1571"><span class="linenos">1571</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Plot-1572"><a href="#Plot-1572"><span class="linenos">1572</span></a>            <span class="n">last_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fft_frequencies</span><span class="p">)</span>
</span><span id="Plot-1573"><a href="#Plot-1573"><span class="linenos">1573</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Plot-1574"><a href="#Plot-1574"><span class="linenos">1574</span></a>            <span class="n">last_index</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Plot-1575"><a href="#Plot-1575"><span class="linenos">1575</span></a>
</span><span id="Plot-1576"><a href="#Plot-1576"><span class="linenos">1576</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[:</span><span class="n">last_index</span><span class="p">],</span>
</span><span id="Plot-1577"><a href="#Plot-1577"><span class="linenos">1577</span></a>                 <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fft</span><span class="p">()[:</span><span class="n">last_index</span><span class="p">],</span>
</span><span id="Plot-1578"><a href="#Plot-1578"><span class="linenos">1578</span></a>                 <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="Plot-1579"><a href="#Plot-1579"><span class="linenos">1579</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;frequency (Hz)&quot;</span><span class="p">),</span>
</span><span id="Plot-1580"><a href="#Plot-1580"><span class="linenos">1580</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;amplitude (normalized)&quot;</span><span class="p">),</span>
</span><span id="Plot-1581"><a href="#Plot-1581"><span class="linenos">1581</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="Plot-1582"><a href="#Plot-1582"><span class="linenos">1582</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="Plot-1583"><a href="#Plot-1583"><span class="linenos">1583</span></a>
</span><span id="Plot-1584"><a href="#Plot-1584"><span class="linenos">1584</span></a>        <span class="k">if</span> <span class="s1">&#39;ticks&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bins&#39;</span><span class="p">:</span>
</span><span id="Plot-1585"><a href="#Plot-1585"><span class="linenos">1585</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_bin_ticks</span><span class="p">()</span>
</span><span id="Plot-1586"><a href="#Plot-1586"><span class="linenos">1586</span></a>
</span><span id="Plot-1587"><a href="#Plot-1587"><span class="linenos">1587</span></a>    <span class="k">def</span> <span class="nf">fft_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Plot-1588"><a href="#Plot-1588"><span class="linenos">1588</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plot-1589"><a href="#Plot-1589"><span class="linenos">1589</span></a><span class="sd">            Plots the octave based Fourier Transform Histogram.</span>
</span><span id="Plot-1590"><a href="#Plot-1590"><span class="linenos">1590</span></a><span class="sd">            Both axes are on a log scale.</span>
</span><span id="Plot-1591"><a href="#Plot-1591"><span class="linenos">1591</span></a>
</span><span id="Plot-1592"><a href="#Plot-1592"><span class="linenos">1592</span></a><span class="sd">            If `ticks = &#39;bins&#39;` is supplied in the keyword arguments, the frequency ticks are replaced</span>
</span><span id="Plot-1593"><a href="#Plot-1593"><span class="linenos">1593</span></a><span class="sd">            with the frequency bin values</span>
</span><span id="Plot-1594"><a href="#Plot-1594"><span class="linenos">1594</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="Plot-1595"><a href="#Plot-1595"><span class="linenos">1595</span></a>
</span><span id="Plot-1596"><a href="#Plot-1596"><span class="linenos">1596</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Plot-1597"><a href="#Plot-1597"><span class="linenos">1597</span></a>
</span><span id="Plot-1598"><a href="#Plot-1598"><span class="linenos">1598</span></a>        <span class="c1"># Histogram of frequency values occurrences in octave bins</span>
</span><span id="Plot-1599"><a href="#Plot-1599"><span class="linenos">1599</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fft_bins</span><span class="p">(),</span> <span class="n">utils</span><span class="o">.</span><span class="n">octave_histogram</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">octave_fraction</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="Plot-1600"><a href="#Plot-1600"><span class="linenos">1600</span></a>                 <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="Plot-1601"><a href="#Plot-1601"><span class="linenos">1601</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
</span><span id="Plot-1602"><a href="#Plot-1602"><span class="linenos">1602</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;amplitude (normalized)&#39;</span><span class="p">)</span>
</span><span id="Plot-1603"><a href="#Plot-1603"><span class="linenos">1603</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="Plot-1604"><a href="#Plot-1604"><span class="linenos">1604</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="Plot-1605"><a href="#Plot-1605"><span class="linenos">1605</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="Plot-1606"><a href="#Plot-1606"><span class="linenos">1606</span></a>
</span><span id="Plot-1607"><a href="#Plot-1607"><span class="linenos">1607</span></a>        <span class="k">if</span> <span class="s1">&#39;ticks&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bins&#39;</span><span class="p">:</span>
</span><span id="Plot-1608"><a href="#Plot-1608"><span class="linenos">1608</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_bin_ticks</span><span class="p">()</span>
</span><span id="Plot-1609"><a href="#Plot-1609"><span class="linenos">1609</span></a>
</span><span id="Plot-1610"><a href="#Plot-1610"><span class="linenos">1610</span></a>    <span class="k">def</span> <span class="nf">peaks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Plot-1611"><a href="#Plot-1611"><span class="linenos">1611</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plot-1612"><a href="#Plot-1612"><span class="linenos">1612</span></a><span class="sd">            Plots the Fourier Transform of the Signal, with the peaks detected</span>
</span><span id="Plot-1613"><a href="#Plot-1613"><span class="linenos">1613</span></a><span class="sd">            with the `Signal.peaks()` method.</span>
</span><span id="Plot-1614"><a href="#Plot-1614"><span class="linenos">1614</span></a>
</span><span id="Plot-1615"><a href="#Plot-1615"><span class="linenos">1615</span></a><span class="sd">            If `peak_height = True` is supplied in the keyword arguments the</span>
</span><span id="Plot-1616"><a href="#Plot-1616"><span class="linenos">1616</span></a><span class="sd">            computed height threshold is</span>
</span><span id="Plot-1617"><a href="#Plot-1617"><span class="linenos">1617</span></a><span class="sd">            shown on the plot.</span>
</span><span id="Plot-1618"><a href="#Plot-1618"><span class="linenos">1618</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="Plot-1619"><a href="#Plot-1619"><span class="linenos">1619</span></a>
</span><span id="Plot-1620"><a href="#Plot-1620"><span class="linenos">1620</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Plot-1621"><a href="#Plot-1621"><span class="linenos">1621</span></a>
</span><span id="Plot-1622"><a href="#Plot-1622"><span class="linenos">1622</span></a>        <span class="n">fft_freqs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span>
</span><span id="Plot-1623"><a href="#Plot-1623"><span class="linenos">1623</span></a>        <span class="n">fft</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fft</span><span class="p">()</span>
</span><span id="Plot-1624"><a href="#Plot-1624"><span class="linenos">1624</span></a>        <span class="n">fft_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">fft_range</span><span class="o">.</span><span class="n">value</span>
</span><span id="Plot-1625"><a href="#Plot-1625"><span class="linenos">1625</span></a>        <span class="n">max_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fft_freqs</span> <span class="o">&gt;=</span> <span class="n">fft_range</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Plot-1626"><a href="#Plot-1626"><span class="linenos">1626</span></a>        <span class="n">peak_indexes</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">peaks</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Plot-1627"><a href="#Plot-1627"><span class="linenos">1627</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
</span><span id="Plot-1628"><a href="#Plot-1628"><span class="linenos">1628</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;amplitude&#39;</span><span class="p">)</span>
</span><span id="Plot-1629"><a href="#Plot-1629"><span class="linenos">1629</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="Plot-1630"><a href="#Plot-1630"><span class="linenos">1630</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="Plot-1631"><a href="#Plot-1631"><span class="linenos">1631</span></a>
</span><span id="Plot-1632"><a href="#Plot-1632"><span class="linenos">1632</span></a>        <span class="k">if</span> <span class="s1">&#39;color&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">plot_kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Plot-1633"><a href="#Plot-1633"><span class="linenos">1633</span></a>            <span class="n">plot_kwargs</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span>
</span><span id="Plot-1634"><a href="#Plot-1634"><span class="linenos">1634</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fft_freqs</span><span class="p">[:</span><span class="n">max_index</span><span class="p">],</span> <span class="n">fft</span><span class="p">[:</span><span class="n">max_index</span><span class="p">],</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="Plot-1635"><a href="#Plot-1635"><span class="linenos">1635</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">fft_freqs</span><span class="p">[</span><span class="n">peak_indexes</span><span class="p">],</span> <span class="n">fft</span><span class="p">[</span><span class="n">peak_indexes</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span><span id="Plot-1636"><a href="#Plot-1636"><span class="linenos">1636</span></a>        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;peak_height&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;peak_height&#39;</span><span class="p">]):</span>
</span><span id="Plot-1637"><a href="#Plot-1637"><span class="linenos">1637</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fft_freqs</span><span class="p">[:</span><span class="n">max_index</span><span class="p">],</span> <span class="n">height</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span><span id="Plot-1638"><a href="#Plot-1638"><span class="linenos">1638</span></a>
</span><span id="Plot-1639"><a href="#Plot-1639"><span class="linenos">1639</span></a>    <span class="k">def</span> <span class="nf">peak_damping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Plot-1640"><a href="#Plot-1640"><span class="linenos">1640</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plot-1641"><a href="#Plot-1641"><span class="linenos">1641</span></a><span class="sd">            Plots the frequency vs damping scatter of the damping ratio computed from the</span>
</span><span id="Plot-1642"><a href="#Plot-1642"><span class="linenos">1642</span></a><span class="sd">            Fourier Transform peak shapes. A polynomial curve fit is added to help visualisation.</span>
</span><span id="Plot-1643"><a href="#Plot-1643"><span class="linenos">1643</span></a>
</span><span id="Plot-1644"><a href="#Plot-1644"><span class="linenos">1644</span></a><span class="sd">            Supported key word arguments are :</span>
</span><span id="Plot-1645"><a href="#Plot-1645"><span class="linenos">1645</span></a>
</span><span id="Plot-1646"><a href="#Plot-1646"><span class="linenos">1646</span></a><span class="sd">            `n=5` : The order of the fitted polynomial curve, default is 5,</span>
</span><span id="Plot-1647"><a href="#Plot-1647"><span class="linenos">1647</span></a><span class="sd">            if the supplied value is too high, it will be reduced until the</span>
</span><span id="Plot-1648"><a href="#Plot-1648"><span class="linenos">1648</span></a><span class="sd">            number of peaks is sufficient to fit the polynomial.</span>
</span><span id="Plot-1649"><a href="#Plot-1649"><span class="linenos">1649</span></a>
</span><span id="Plot-1650"><a href="#Plot-1650"><span class="linenos">1650</span></a><span class="sd">            `inverse=True` : Default value is True, if False, the damping ratio is shown instead</span>
</span><span id="Plot-1651"><a href="#Plot-1651"><span class="linenos">1651</span></a><span class="sd">            of its inverse.</span>
</span><span id="Plot-1652"><a href="#Plot-1652"><span class="linenos">1652</span></a>
</span><span id="Plot-1653"><a href="#Plot-1653"><span class="linenos">1653</span></a><span class="sd">            `normalize=False` : Default value is False, if True the damping values are normalized</span>
</span><span id="Plot-1654"><a href="#Plot-1654"><span class="linenos">1654</span></a><span class="sd">            from 0 to 1, to help analyze results and compare Sounds.</span>
</span><span id="Plot-1655"><a href="#Plot-1655"><span class="linenos">1655</span></a>
</span><span id="Plot-1656"><a href="#Plot-1656"><span class="linenos">1656</span></a><span class="sd">            `ticks=None` : Default value is None, if `ticks=&#39;bins&#39;` the x-axis ticks are replaced with</span>
</span><span id="Plot-1657"><a href="#Plot-1657"><span class="linenos">1657</span></a><span class="sd">            frequency bin values.</span>
</span><span id="Plot-1658"><a href="#Plot-1658"><span class="linenos">1658</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="Plot-1659"><a href="#Plot-1659"><span class="linenos">1659</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Plot-1660"><a href="#Plot-1660"><span class="linenos">1660</span></a>        <span class="c1"># Get the damping ratio and peak frequencies</span>
</span><span id="Plot-1661"><a href="#Plot-1661"><span class="linenos">1661</span></a>        <span class="k">if</span> <span class="s1">&#39;inverse&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;inverse&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="Plot-1662"><a href="#Plot-1662"><span class="linenos">1662</span></a>            <span class="n">zetas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">peak_damping</span><span class="p">())</span>
</span><span id="Plot-1663"><a href="#Plot-1663"><span class="linenos">1663</span></a>            <span class="n">ylabel</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;damping $\zeta$&#39;</span>
</span><span id="Plot-1664"><a href="#Plot-1664"><span class="linenos">1664</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Plot-1665"><a href="#Plot-1665"><span class="linenos">1665</span></a>            <span class="n">zetas</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">peak_damping</span><span class="p">())</span>
</span><span id="Plot-1666"><a href="#Plot-1666"><span class="linenos">1666</span></a>            <span class="n">ylabel</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;inverse damping $1/\zeta$&#39;</span>
</span><span id="Plot-1667"><a href="#Plot-1667"><span class="linenos">1667</span></a>
</span><span id="Plot-1668"><a href="#Plot-1668"><span class="linenos">1668</span></a>        <span class="n">peak_freqs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">peaks</span><span class="p">()]</span>
</span><span id="Plot-1669"><a href="#Plot-1669"><span class="linenos">1669</span></a>
</span><span id="Plot-1670"><a href="#Plot-1670"><span class="linenos">1670</span></a>        <span class="c1"># If a polynomial order is supplied assign it, if not default is 5</span>
</span><span id="Plot-1671"><a href="#Plot-1671"><span class="linenos">1671</span></a>        <span class="k">if</span> <span class="s1">&#39;n&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Plot-1672"><a href="#Plot-1672"><span class="linenos">1672</span></a>            <span class="n">n</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span>
</span><span id="Plot-1673"><a href="#Plot-1673"><span class="linenos">1673</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Plot-1674"><a href="#Plot-1674"><span class="linenos">1674</span></a>            <span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="Plot-1675"><a href="#Plot-1675"><span class="linenos">1675</span></a>
</span><span id="Plot-1676"><a href="#Plot-1676"><span class="linenos">1676</span></a>        <span class="c1"># If labels are supplied the default color are used</span>
</span><span id="Plot-1677"><a href="#Plot-1677"><span class="linenos">1677</span></a>        <span class="k">if</span> <span class="s1">&#39;label&#39;</span> <span class="ow">in</span> <span class="n">plot_kwargs</span><span class="p">:</span>
</span><span id="Plot-1678"><a href="#Plot-1678"><span class="linenos">1678</span></a>            <span class="n">plot_kwargs</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Plot-1679"><a href="#Plot-1679"><span class="linenos">1679</span></a>            <span class="n">plot2_kwargs</span> <span class="o">=</span> <span class="n">plot_kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Plot-1680"><a href="#Plot-1680"><span class="linenos">1680</span></a>            <span class="n">plot2_kwargs</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Plot-1681"><a href="#Plot-1681"><span class="linenos">1681</span></a>
</span><span id="Plot-1682"><a href="#Plot-1682"><span class="linenos">1682</span></a>        <span class="c1"># If not black and red are used</span>
</span><span id="Plot-1683"><a href="#Plot-1683"><span class="linenos">1683</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Plot-1684"><a href="#Plot-1684"><span class="linenos">1684</span></a>            <span class="n">plot_kwargs</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span>
</span><span id="Plot-1685"><a href="#Plot-1685"><span class="linenos">1685</span></a>            <span class="n">plot2_kwargs</span> <span class="o">=</span> <span class="n">plot_kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Plot-1686"><a href="#Plot-1686"><span class="linenos">1686</span></a>            <span class="n">plot2_kwargs</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span>
</span><span id="Plot-1687"><a href="#Plot-1687"><span class="linenos">1687</span></a>
</span><span id="Plot-1688"><a href="#Plot-1688"><span class="linenos">1688</span></a>        <span class="k">if</span> <span class="s1">&#39;normalize&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;normalize&#39;</span><span class="p">]:</span>
</span><span id="Plot-1689"><a href="#Plot-1689"><span class="linenos">1689</span></a>            <span class="n">zetas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">zetas</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">zetas</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">initial</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Plot-1690"><a href="#Plot-1690"><span class="linenos">1690</span></a>
</span><span id="Plot-1691"><a href="#Plot-1691"><span class="linenos">1691</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">peak_freqs</span><span class="p">,</span> <span class="n">zetas</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="Plot-1692"><a href="#Plot-1692"><span class="linenos">1692</span></a>        <span class="n">fun</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">nth_order_polynomial_fit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">peak_freqs</span><span class="p">,</span> <span class="n">zetas</span><span class="p">)</span>
</span><span id="Plot-1693"><a href="#Plot-1693"><span class="linenos">1693</span></a>        <span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">peak_freqs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">peak_freqs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
</span><span id="Plot-1694"><a href="#Plot-1694"><span class="linenos">1694</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">fun</span><span class="p">(</span><span class="n">freq</span><span class="p">),</span> <span class="o">**</span><span class="n">plot2_kwargs</span><span class="p">)</span>
</span><span id="Plot-1695"><a href="#Plot-1695"><span class="linenos">1695</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="Plot-1696"><a href="#Plot-1696"><span class="linenos">1696</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequency vs Damping Factor with Order &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span><span id="Plot-1697"><a href="#Plot-1697"><span class="linenos">1697</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
</span><span id="Plot-1698"><a href="#Plot-1698"><span class="linenos">1698</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
</span><span id="Plot-1699"><a href="#Plot-1699"><span class="linenos">1699</span></a>
</span><span id="Plot-1700"><a href="#Plot-1700"><span class="linenos">1700</span></a>        <span class="k">if</span> <span class="s1">&#39;ticks&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bins&#39;</span><span class="p">:</span>
</span><span id="Plot-1701"><a href="#Plot-1701"><span class="linenos">1701</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_bin_ticks</span><span class="p">()</span>
</span><span id="Plot-1702"><a href="#Plot-1702"><span class="linenos">1702</span></a>
</span><span id="Plot-1703"><a href="#Plot-1703"><span class="linenos">1703</span></a>    <span class="k">def</span> <span class="nf">time_damping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Plot-1704"><a href="#Plot-1704"><span class="linenos">1704</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plot-1705"><a href="#Plot-1705"><span class="linenos">1705</span></a><span class="sd">        Shows the signal envelope with the fitted negative exponential</span>
</span><span id="Plot-1706"><a href="#Plot-1706"><span class="linenos">1706</span></a><span class="sd">        curve used to determine the time damping ratio of the signal.</span>
</span><span id="Plot-1707"><a href="#Plot-1707"><span class="linenos">1707</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plot-1708"><a href="#Plot-1708"><span class="linenos">1708</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Plot-1709"><a href="#Plot-1709"><span class="linenos">1709</span></a>        <span class="c1"># Get the envelope data</span>
</span><span id="Plot-1710"><a href="#Plot-1710"><span class="linenos">1710</span></a>        <span class="n">envelope</span><span class="p">,</span> <span class="n">envelope_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">envelope</span><span class="p">()</span> 
</span><span id="Plot-1711"><a href="#Plot-1711"><span class="linenos">1711</span></a>
</span><span id="Plot-1712"><a href="#Plot-1712"><span class="linenos">1712</span></a>        <span class="c1"># First point is the maximum because e^-kt is strictly decreasing</span>
</span><span id="Plot-1713"><a href="#Plot-1713"><span class="linenos">1713</span></a>        <span class="n">first_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">envelope</span><span class="p">)</span>
</span><span id="Plot-1714"><a href="#Plot-1714"><span class="linenos">1714</span></a>
</span><span id="Plot-1715"><a href="#Plot-1715"><span class="linenos">1715</span></a>        <span class="c1"># The second point is the first point where the signal crosses the lower_threshold line</span>
</span><span id="Plot-1716"><a href="#Plot-1716"><span class="linenos">1716</span></a>        <span class="n">second_point_thresh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">damping</span><span class="o">.</span><span class="n">lower_threshold</span><span class="o">.</span><span class="n">value</span>
</span><span id="Plot-1717"><a href="#Plot-1717"><span class="linenos">1717</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Plot-1718"><a href="#Plot-1718"><span class="linenos">1718</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="Plot-1719"><a href="#Plot-1719"><span class="linenos">1719</span></a>                <span class="n">second_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flatnonzero</span><span class="p">(</span><span class="n">envelope</span><span class="p">[</span><span class="n">first_index</span><span class="p">:]</span> <span class="o">&lt;=</span> <span class="n">second_point_thresh</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Plot-1720"><a href="#Plot-1720"><span class="linenos">1720</span></a>                <span class="k">break</span>
</span><span id="Plot-1721"><a href="#Plot-1721"><span class="linenos">1721</span></a>            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
</span><span id="Plot-1722"><a href="#Plot-1722"><span class="linenos">1722</span></a>                <span class="n">second_point_thresh</span> <span class="o">*=</span> <span class="mi">2</span>
</span><span id="Plot-1723"><a href="#Plot-1723"><span class="linenos">1723</span></a>                <span class="k">if</span> <span class="n">second_point_thresh</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Plot-1724"><a href="#Plot-1724"><span class="linenos">1724</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid second point threshold encountered, something went wrong&quot;</span><span class="p">)</span>
</span><span id="Plot-1725"><a href="#Plot-1725"><span class="linenos">1725</span></a>
</span><span id="Plot-1726"><a href="#Plot-1726"><span class="linenos">1726</span></a>        <span class="c1"># Function to compute the residual for the exponential curve fit</span>
</span><span id="Plot-1727"><a href="#Plot-1727"><span class="linenos">1727</span></a>        <span class="k">def</span> <span class="nf">residual_function</span><span class="p">(</span><span class="n">zeta_w</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
</span><span id="Plot-1728"><a href="#Plot-1728"><span class="linenos">1728</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">zeta_w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">s</span>
</span><span id="Plot-1729"><a href="#Plot-1729"><span class="linenos">1729</span></a>
</span><span id="Plot-1730"><a href="#Plot-1730"><span class="linenos">1730</span></a>        <span class="n">zeta_guess</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">]</span>
</span><span id="Plot-1731"><a href="#Plot-1731"><span class="linenos">1731</span></a>
</span><span id="Plot-1732"><a href="#Plot-1732"><span class="linenos">1732</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">least_squares</span><span class="p">(</span><span class="n">residual_function</span><span class="p">,</span> <span class="n">zeta_guess</span><span class="p">,</span>
</span><span id="Plot-1733"><a href="#Plot-1733"><span class="linenos">1733</span></a>                                              <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">envelope_time</span><span class="p">[</span><span class="n">first_index</span><span class="p">:</span><span class="n">second_index</span><span class="p">],</span>
</span><span id="Plot-1734"><a href="#Plot-1734"><span class="linenos">1734</span></a>                                                    <span class="n">envelope</span><span class="p">[</span><span class="n">first_index</span><span class="p">:</span><span class="n">second_index</span><span class="p">]))</span>
</span><span id="Plot-1735"><a href="#Plot-1735"><span class="linenos">1735</span></a>        <span class="c1"># Get the zeta*omega constant</span>
</span><span id="Plot-1736"><a href="#Plot-1736"><span class="linenos">1736</span></a>        <span class="n">zeta_omega</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Plot-1737"><a href="#Plot-1737"><span class="linenos">1737</span></a>
</span><span id="Plot-1738"><a href="#Plot-1738"><span class="linenos">1738</span></a>        <span class="c1"># Compute the fundamental frequency in radians of the signal</span>
</span><span id="Plot-1739"><a href="#Plot-1739"><span class="linenos">1739</span></a>        <span class="n">wd</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fundamental</span><span class="p">()</span>
</span><span id="Plot-1740"><a href="#Plot-1740"><span class="linenos">1740</span></a>
</span><span id="Plot-1741"><a href="#Plot-1741"><span class="linenos">1741</span></a>        <span class="c1"># Plot the two points used for the regression</span>
</span><span id="Plot-1742"><a href="#Plot-1742"><span class="linenos">1742</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">envelope_time</span><span class="p">[[</span><span class="n">first_index</span><span class="p">,</span> <span class="n">first_index</span> <span class="o">+</span> <span class="n">second_index</span><span class="p">]],</span> 
</span><span id="Plot-1743"><a href="#Plot-1743"><span class="linenos">1743</span></a>                    <span class="n">envelope</span><span class="p">[[</span><span class="n">first_index</span><span class="p">,</span> <span class="n">first_index</span> <span class="o">+</span> <span class="n">second_index</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span><span id="Plot-1744"><a href="#Plot-1744"><span class="linenos">1744</span></a>
</span><span id="Plot-1745"><a href="#Plot-1745"><span class="linenos">1745</span></a>        <span class="c1"># get the current ax</span>
</span><span id="Plot-1746"><a href="#Plot-1746"><span class="linenos">1746</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="Plot-1747"><a href="#Plot-1747"><span class="linenos">1747</span></a>
</span><span id="Plot-1748"><a href="#Plot-1748"><span class="linenos">1748</span></a>        <span class="c1"># Plot the damping curve</span>
</span><span id="Plot-1749"><a href="#Plot-1749"><span class="linenos">1749</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">envelope_time</span><span class="p">[</span><span class="n">first_index</span><span class="p">:</span><span class="n">second_index</span> <span class="o">+</span> <span class="n">first_index</span><span class="p">],</span>
</span><span id="Plot-1750"><a href="#Plot-1750"><span class="linenos">1750</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">zeta_omega</span> <span class="o">*</span> <span class="n">envelope_time</span><span class="p">[</span><span class="n">first_index</span><span class="p">:</span><span class="n">second_index</span> <span class="o">+</span> <span class="n">first_index</span><span class="p">]),</span> 
</span><span id="Plot-1751"><a href="#Plot-1751"><span class="linenos">1751</span></a>                <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
</span><span id="Plot-1752"><a href="#Plot-1752"><span class="linenos">1752</span></a>                <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
</span><span id="Plot-1753"><a href="#Plot-1753"><span class="linenos">1753</span></a>
</span><span id="Plot-1754"><a href="#Plot-1754"><span class="linenos">1754</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</span><span id="Plot-1755"><a href="#Plot-1755"><span class="linenos">1755</span></a>        <span class="k">if</span> <span class="s1">&#39;alpha&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">plot_kwargs</span><span class="p">:</span>
</span><span id="Plot-1756"><a href="#Plot-1756"><span class="linenos">1756</span></a>            <span class="n">plot_kwargs</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.6</span>
</span><span id="Plot-1757"><a href="#Plot-1757"><span class="linenos">1757</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">envelope</span><span class="p">(</span><span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="Plot-1758"><a href="#Plot-1758"><span class="linenos">1758</span></a>
</span><span id="Plot-1759"><a href="#Plot-1759"><span class="linenos">1759</span></a>        <span class="k">if</span> <span class="s1">&#39;label&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">plot_kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Plot-1760"><a href="#Plot-1760"><span class="linenos">1760</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;damping curve&#39;</span><span class="p">,</span> <span class="s1">&#39;signal envelope&#39;</span><span class="p">])</span>
</span><span id="Plot-1761"><a href="#Plot-1761"><span class="linenos">1761</span></a>
</span><span id="Plot-1762"><a href="#Plot-1762"><span class="linenos">1762</span></a>        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Zeta : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="o">-</span><span class="n">zeta_omega</span> <span class="o">/</span> <span class="n">wd</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; Fundamental &#39;</span> <span class="o">+</span> \
</span><span id="Plot-1763"><a href="#Plot-1763"><span class="linenos">1763</span></a>                <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fundamental</span><span class="p">(),</span> <span class="mi">0</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;Hz&#39;</span>
</span><span id="Plot-1764"><a href="#Plot-1764"><span class="linenos">1764</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
</span><span id="Plot-1765"><a href="#Plot-1765"><span class="linenos">1765</span></a>
</span><span id="Plot-1766"><a href="#Plot-1766"><span class="linenos">1766</span></a>    <span class="k">def</span> <span class="nf">integral</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Plot-1767"><a href="#Plot-1767"><span class="linenos">1767</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plot-1768"><a href="#Plot-1768"><span class="linenos">1768</span></a><span class="sd">        Cumulative integral plot of the normalized signal log envelope</span>
</span><span id="Plot-1769"><a href="#Plot-1769"><span class="linenos">1769</span></a>
</span><span id="Plot-1770"><a href="#Plot-1770"><span class="linenos">1770</span></a><span class="sd">        Represents the power distribution variation in time for the signal.</span>
</span><span id="Plot-1771"><a href="#Plot-1771"><span class="linenos">1771</span></a><span class="sd">        This is a plot of the function $F(x)$ such as :</span>
</span><span id="Plot-1772"><a href="#Plot-1772"><span class="linenos">1772</span></a>
</span><span id="Plot-1773"><a href="#Plot-1773"><span class="linenos">1773</span></a><span class="sd">        $ F(x) = \int_0^x env(x) dx $</span>
</span><span id="Plot-1774"><a href="#Plot-1774"><span class="linenos">1774</span></a>
</span><span id="Plot-1775"><a href="#Plot-1775"><span class="linenos">1775</span></a><span class="sd">        Where e(x) is the signal envelope.</span>
</span><span id="Plot-1776"><a href="#Plot-1776"><span class="linenos">1776</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plot-1777"><a href="#Plot-1777"><span class="linenos">1777</span></a>        <span class="c1"># sanitize the kwargs</span>
</span><span id="Plot-1778"><a href="#Plot-1778"><span class="linenos">1778</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Plot-1779"><a href="#Plot-1779"><span class="linenos">1779</span></a>
</span><span id="Plot-1780"><a href="#Plot-1780"><span class="linenos">1780</span></a>        <span class="c1"># Compute log envelope and log time</span>
</span><span id="Plot-1781"><a href="#Plot-1781"><span class="linenos">1781</span></a>        <span class="n">log_envelope</span><span class="p">,</span> <span class="n">log_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="Plot-1782"><a href="#Plot-1782"><span class="linenos">1782</span></a>
</span><span id="Plot-1783"><a href="#Plot-1783"><span class="linenos">1783</span></a>
</span><span id="Plot-1784"><a href="#Plot-1784"><span class="linenos">1784</span></a>        <span class="c1"># compute the cumulative integral</span>
</span><span id="Plot-1785"><a href="#Plot-1785"><span class="linenos">1785</span></a>        <span class="n">integral</span> <span class="o">=</span> <span class="p">[</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">log_envelope</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">log_time</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">log_envelope</span><span class="p">),</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="Plot-1786"><a href="#Plot-1786"><span class="linenos">1786</span></a>        <span class="n">integral</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span>
</span><span id="Plot-1787"><a href="#Plot-1787"><span class="linenos">1787</span></a>
</span><span id="Plot-1788"><a href="#Plot-1788"><span class="linenos">1788</span></a>        <span class="c1"># plot the integral</span>
</span><span id="Plot-1789"><a href="#Plot-1789"><span class="linenos">1789</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">log_time</span><span class="p">[</span><span class="mi">2</span><span class="p">:],</span> <span class="n">integral</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="Plot-1790"><a href="#Plot-1790"><span class="linenos">1790</span></a>
</span><span id="Plot-1791"><a href="#Plot-1791"><span class="linenos">1791</span></a>        <span class="c1"># Add labels and scale</span>
</span><span id="Plot-1792"><a href="#Plot-1792"><span class="linenos">1792</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
</span><span id="Plot-1793"><a href="#Plot-1793"><span class="linenos">1793</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;cumulative power (normalized)&#39;</span><span class="p">)</span>
</span><span id="Plot-1794"><a href="#Plot-1794"><span class="linenos">1794</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="Plot-1795"><a href="#Plot-1795"><span class="linenos">1795</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>A class to handle all the plotting functions of the Signal and to allow a nice call signature :
Signal.plot.envelope()</p>

<p>Supported plots are :
'signal', 'envelope', 'log envelope', 'fft', 'fft hist', 'peaks',
'peak damping', 'time damping', 'integral'</p>
</div>


                            <div id="Plot.__init__" class="classattr">
                                        <input id="Plot.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Plot</span><span class="signature pdoc-code condensed">()</span>

                <label class="view-source-button" for="Plot.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Plot.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Plot.__init__-1483"><a href="#Plot.__init__-1483"><span class="linenos">1483</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Plot.__init__-1484"><a href="#Plot.__init__-1484"><span class="linenos">1484</span></a>        <span class="c1"># define the parent attribute</span>
</span><span id="Plot.__init__-1485"><a href="#Plot.__init__-1485"><span class="linenos">1485</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Plot.__init__-1486"><a href="#Plot.__init__-1486"><span class="linenos">1486</span></a>
</span><span id="Plot.__init__-1487"><a href="#Plot.__init__-1487"><span class="linenos">1487</span></a>        <span class="c1"># dictionary with methods and keywords</span>
</span><span id="Plot.__init__-1488"><a href="#Plot.__init__-1488"><span class="linenos">1488</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">method_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;signal&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">,</span>
</span><span id="Plot.__init__-1489"><a href="#Plot.__init__-1489"><span class="linenos">1489</span></a>                            <span class="s1">&#39;envelope&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">envelope</span><span class="p">,</span>
</span><span id="Plot.__init__-1490"><a href="#Plot.__init__-1490"><span class="linenos">1490</span></a>                            <span class="s1">&#39;log envelope&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">,</span>
</span><span id="Plot.__init__-1491"><a href="#Plot.__init__-1491"><span class="linenos">1491</span></a>                            <span class="s1">&#39;fft&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">,</span>
</span><span id="Plot.__init__-1492"><a href="#Plot.__init__-1492"><span class="linenos">1492</span></a>                            <span class="s1">&#39;fft hist&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft_hist</span><span class="p">,</span>
</span><span id="Plot.__init__-1493"><a href="#Plot.__init__-1493"><span class="linenos">1493</span></a>                            <span class="s1">&#39;peaks&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span>
</span><span id="Plot.__init__-1494"><a href="#Plot.__init__-1494"><span class="linenos">1494</span></a>                            <span class="s1">&#39;peak damping&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_damping</span><span class="p">,</span>
</span><span id="Plot.__init__-1495"><a href="#Plot.__init__-1495"><span class="linenos">1495</span></a>                            <span class="s1">&#39;time damping&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_damping</span><span class="p">,</span>
</span><span id="Plot.__init__-1496"><a href="#Plot.__init__-1496"><span class="linenos">1496</span></a>                            <span class="s1">&#39;integral&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">integral</span><span class="p">,</span> <span class="p">}</span>
</span></pre></div>


    

                            </div>
                            <div id="Plot.sanitize_kwargs" class="classattr">
                                        <input id="Plot.sanitize_kwargs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sanitize_kwargs</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Plot.sanitize_kwargs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Plot.sanitize_kwargs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Plot.sanitize_kwargs-1498"><a href="#Plot.sanitize_kwargs-1498"><span class="linenos">1498</span></a>    <span class="k">def</span> <span class="nf">sanitize_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
</span><span id="Plot.sanitize_kwargs-1499"><a href="#Plot.sanitize_kwargs-1499"><span class="linenos">1499</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plot.sanitize_kwargs-1500"><a href="#Plot.sanitize_kwargs-1500"><span class="linenos">1500</span></a><span class="sd">        Remove illegal keywords to supply the key word arguments to matplotlib</span>
</span><span id="Plot.sanitize_kwargs-1501"><a href="#Plot.sanitize_kwargs-1501"><span class="linenos">1501</span></a><span class="sd">        :param kwargs: a dictionary of key word arguments</span>
</span><span id="Plot.sanitize_kwargs-1502"><a href="#Plot.sanitize_kwargs-1502"><span class="linenos">1502</span></a><span class="sd">        :return: sanitized kwargs</span>
</span><span id="Plot.sanitize_kwargs-1503"><a href="#Plot.sanitize_kwargs-1503"><span class="linenos">1503</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plot.sanitize_kwargs-1504"><a href="#Plot.sanitize_kwargs-1504"><span class="linenos">1504</span></a>        <span class="k">return</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">illegal_kwargs</span><span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Remove illegal keywords to supply the key word arguments to matplotlib</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>kwargs</strong>:  a dictionary of key word arguments</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>sanitized kwargs</p>
</blockquote>
</div>


                            </div>
                            <div id="Plot.set_bin_ticks" class="classattr">
                                        <input id="Plot.set_bin_ticks-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_bin_ticks</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Plot.set_bin_ticks-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Plot.set_bin_ticks"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Plot.set_bin_ticks-1506"><a href="#Plot.set_bin_ticks-1506"><span class="linenos">1506</span></a>    <span class="k">def</span> <span class="nf">set_bin_ticks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Plot.set_bin_ticks-1507"><a href="#Plot.set_bin_ticks-1507"><span class="linenos">1507</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Applies the frequency bin ticks to the current plot &quot;&quot;&quot;</span>
</span><span id="Plot.set_bin_ticks-1508"><a href="#Plot.set_bin_ticks-1508"><span class="linenos">1508</span></a>        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">label</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="vm">__dict__</span> <span class="k">if</span> <span class="n">label</span> <span class="o">!=</span> <span class="s1">&#39;name&#39;</span><span class="p">]</span>
</span><span id="Plot.set_bin_ticks-1509"><a href="#Plot.set_bin_ticks-1509"><span class="linenos">1509</span></a>        <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;brillance&#39;</span><span class="p">)</span>
</span><span id="Plot.set_bin_ticks-1510"><a href="#Plot.set_bin_ticks-1510"><span class="linenos">1510</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">param</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">param</span> <span class="o">!=</span> <span class="s1">&#39;bins&#39;</span><span class="p">]</span>
</span><span id="Plot.set_bin_ticks-1511"><a href="#Plot.set_bin_ticks-1511"><span class="linenos">1511</span></a>        <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">11025</span><span class="p">)</span>
</span><span id="Plot.set_bin_ticks-1512"><a href="#Plot.set_bin_ticks-1512"><span class="linenos">1512</span></a>        <span class="n">x_formatter</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FixedFormatter</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</span><span id="Plot.set_bin_ticks-1513"><a href="#Plot.set_bin_ticks-1513"><span class="linenos">1513</span></a>        <span class="n">x_locator</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Plot.set_bin_ticks-1514"><a href="#Plot.set_bin_ticks-1514"><span class="linenos">1514</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="Plot.set_bin_ticks-1515"><a href="#Plot.set_bin_ticks-1515"><span class="linenos">1515</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">x_locator</span><span class="p">)</span>
</span><span id="Plot.set_bin_ticks-1516"><a href="#Plot.set_bin_ticks-1516"><span class="linenos">1516</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">x_formatter</span><span class="p">)</span>
</span><span id="Plot.set_bin_ticks-1517"><a href="#Plot.set_bin_ticks-1517"><span class="linenos">1517</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelrotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Applies the frequency bin ticks to the current plot</p>
</div>


                            </div>
                            <div id="Plot.signal" class="classattr">
                                        <input id="Plot.signal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">signal</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Plot.signal-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Plot.signal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Plot.signal-1519"><a href="#Plot.signal-1519"><span class="linenos">1519</span></a>    <span class="k">def</span> <span class="nf">signal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Plot.signal-1520"><a href="#Plot.signal-1520"><span class="linenos">1520</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Plots the time varying real signal as amplitude vs time. &quot;&quot;&quot;</span>
</span><span id="Plot.signal-1521"><a href="#Plot.signal-1521"><span class="linenos">1521</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Plot.signal-1522"><a href="#Plot.signal-1522"><span class="linenos">1522</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">signal</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="Plot.signal-1523"><a href="#Plot.signal-1523"><span class="linenos">1523</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
</span><span id="Plot.signal-1524"><a href="#Plot.signal-1524"><span class="linenos">1524</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;amplitude [-1, 1]&#39;</span><span class="p">)</span>
</span><span id="Plot.signal-1525"><a href="#Plot.signal-1525"><span class="linenos">1525</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plots the time varying real signal as amplitude vs time.</p>
</div>


                            </div>
                            <div id="Plot.envelope" class="classattr">
                                        <input id="Plot.envelope-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">envelope</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Plot.envelope-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Plot.envelope"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Plot.envelope-1527"><a href="#Plot.envelope-1527"><span class="linenos">1527</span></a>    <span class="k">def</span> <span class="nf">envelope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Plot.envelope-1528"><a href="#Plot.envelope-1528"><span class="linenos">1528</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plot.envelope-1529"><a href="#Plot.envelope-1529"><span class="linenos">1529</span></a><span class="sd">        Plots the envelope of the signal as amplitude vs time.</span>
</span><span id="Plot.envelope-1530"><a href="#Plot.envelope-1530"><span class="linenos">1530</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plot.envelope-1531"><a href="#Plot.envelope-1531"><span class="linenos">1531</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Plot.envelope-1532"><a href="#Plot.envelope-1532"><span class="linenos">1532</span></a>        <span class="n">envelope_arr</span><span class="p">,</span> <span class="n">envelope_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">envelope</span><span class="p">()</span>
</span><span id="Plot.envelope-1533"><a href="#Plot.envelope-1533"><span class="linenos">1533</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">envelope_time</span><span class="p">,</span> <span class="n">envelope_arr</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="Plot.envelope-1534"><a href="#Plot.envelope-1534"><span class="linenos">1534</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time (s)&quot;</span><span class="p">)</span>
</span><span id="Plot.envelope-1535"><a href="#Plot.envelope-1535"><span class="linenos">1535</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;amplitude [0, 1]&quot;</span><span class="p">)</span>
</span><span id="Plot.envelope-1536"><a href="#Plot.envelope-1536"><span class="linenos">1536</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plots the envelope of the signal as amplitude vs time.</p>
</div>


                            </div>
                            <div id="Plot.log_envelope" class="classattr">
                                        <input id="Plot.log_envelope-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">log_envelope</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Plot.log_envelope-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Plot.log_envelope"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Plot.log_envelope-1538"><a href="#Plot.log_envelope-1538"><span class="linenos">1538</span></a>    <span class="k">def</span> <span class="nf">log_envelope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Plot.log_envelope-1539"><a href="#Plot.log_envelope-1539"><span class="linenos">1539</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plot.log_envelope-1540"><a href="#Plot.log_envelope-1540"><span class="linenos">1540</span></a><span class="sd">        Plots the signal envelope with logarithmic window widths on a logarithmic x-axis scale.</span>
</span><span id="Plot.log_envelope-1541"><a href="#Plot.log_envelope-1541"><span class="linenos">1541</span></a><span class="sd">        :param max_time: maximum time used for the x-axis in the plot (seconds)</span>
</span><span id="Plot.log_envelope-1542"><a href="#Plot.log_envelope-1542"><span class="linenos">1542</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plot.log_envelope-1543"><a href="#Plot.log_envelope-1543"><span class="linenos">1543</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Plot.log_envelope-1544"><a href="#Plot.log_envelope-1544"><span class="linenos">1544</span></a>        <span class="n">log_envelope</span><span class="p">,</span> <span class="n">log_envelope_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="Plot.log_envelope-1545"><a href="#Plot.log_envelope-1545"><span class="linenos">1545</span></a>
</span><span id="Plot.log_envelope-1546"><a href="#Plot.log_envelope-1546"><span class="linenos">1546</span></a>        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;max_time&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;max_time&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">log_envelope_time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="Plot.log_envelope-1547"><a href="#Plot.log_envelope-1547"><span class="linenos">1547</span></a>            <span class="n">max_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">log_envelope_time</span> <span class="o">&gt;=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;max_time&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Plot.log_envelope-1548"><a href="#Plot.log_envelope-1548"><span class="linenos">1548</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Plot.log_envelope-1549"><a href="#Plot.log_envelope-1549"><span class="linenos">1549</span></a>            <span class="n">max_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">log_envelope_time</span><span class="p">)</span>
</span><span id="Plot.log_envelope-1550"><a href="#Plot.log_envelope-1550"><span class="linenos">1550</span></a>
</span><span id="Plot.log_envelope-1551"><a href="#Plot.log_envelope-1551"><span class="linenos">1551</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">log_envelope_time</span><span class="p">[:</span><span class="n">max_index</span><span class="p">],</span> <span class="n">log_envelope</span><span class="p">[:</span><span class="n">max_index</span><span class="p">],</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="Plot.log_envelope-1552"><a href="#Plot.log_envelope-1552"><span class="linenos">1552</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time (s)&quot;</span><span class="p">)</span>
</span><span id="Plot.log_envelope-1553"><a href="#Plot.log_envelope-1553"><span class="linenos">1553</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;amplitude [0, 1]&quot;</span><span class="p">)</span>
</span><span id="Plot.log_envelope-1554"><a href="#Plot.log_envelope-1554"><span class="linenos">1554</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="Plot.log_envelope-1555"><a href="#Plot.log_envelope-1555"><span class="linenos">1555</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plots the signal envelope with logarithmic window widths on a logarithmic x-axis scale.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>max_time</strong>:  maximum time used for the x-axis in the plot (seconds)</li>
</ul>
</div>


                            </div>
                            <div id="Plot.fft" class="classattr">
                                        <input id="Plot.fft-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fft</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Plot.fft-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Plot.fft"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Plot.fft-1557"><a href="#Plot.fft-1557"><span class="linenos">1557</span></a>    <span class="k">def</span> <span class="nf">fft</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Plot.fft-1558"><a href="#Plot.fft-1558"><span class="linenos">1558</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plot.fft-1559"><a href="#Plot.fft-1559"><span class="linenos">1559</span></a><span class="sd">        Plots the Fourier Transform of the Signal.</span>
</span><span id="Plot.fft-1560"><a href="#Plot.fft-1560"><span class="linenos">1560</span></a>
</span><span id="Plot.fft-1561"><a href="#Plot.fft-1561"><span class="linenos">1561</span></a><span class="sd">        If `ticks = &#39;bins&#39;` is supplied in the keyword arguments, the frequency ticks are replaced</span>
</span><span id="Plot.fft-1562"><a href="#Plot.fft-1562"><span class="linenos">1562</span></a><span class="sd">        with the frequency bin values.</span>
</span><span id="Plot.fft-1563"><a href="#Plot.fft-1563"><span class="linenos">1563</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plot.fft-1564"><a href="#Plot.fft-1564"><span class="linenos">1564</span></a>
</span><span id="Plot.fft-1565"><a href="#Plot.fft-1565"><span class="linenos">1565</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Plot.fft-1566"><a href="#Plot.fft-1566"><span class="linenos">1566</span></a>
</span><span id="Plot.fft-1567"><a href="#Plot.fft-1567"><span class="linenos">1567</span></a>        <span class="c1"># find the index corresponding to the fft range</span>
</span><span id="Plot.fft-1568"><a href="#Plot.fft-1568"><span class="linenos">1568</span></a>        <span class="n">fft_frequencies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span>
</span><span id="Plot.fft-1569"><a href="#Plot.fft-1569"><span class="linenos">1569</span></a>        <span class="n">fft_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">fft_range</span><span class="o">.</span><span class="n">value</span>
</span><span id="Plot.fft-1570"><a href="#Plot.fft-1570"><span class="linenos">1570</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fft_frequencies</span> <span class="o">&gt;=</span> <span class="n">fft_range</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Plot.fft-1571"><a href="#Plot.fft-1571"><span class="linenos">1571</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Plot.fft-1572"><a href="#Plot.fft-1572"><span class="linenos">1572</span></a>            <span class="n">last_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fft_frequencies</span><span class="p">)</span>
</span><span id="Plot.fft-1573"><a href="#Plot.fft-1573"><span class="linenos">1573</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Plot.fft-1574"><a href="#Plot.fft-1574"><span class="linenos">1574</span></a>            <span class="n">last_index</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Plot.fft-1575"><a href="#Plot.fft-1575"><span class="linenos">1575</span></a>
</span><span id="Plot.fft-1576"><a href="#Plot.fft-1576"><span class="linenos">1576</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[:</span><span class="n">last_index</span><span class="p">],</span>
</span><span id="Plot.fft-1577"><a href="#Plot.fft-1577"><span class="linenos">1577</span></a>                 <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fft</span><span class="p">()[:</span><span class="n">last_index</span><span class="p">],</span>
</span><span id="Plot.fft-1578"><a href="#Plot.fft-1578"><span class="linenos">1578</span></a>                 <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="Plot.fft-1579"><a href="#Plot.fft-1579"><span class="linenos">1579</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;frequency (Hz)&quot;</span><span class="p">),</span>
</span><span id="Plot.fft-1580"><a href="#Plot.fft-1580"><span class="linenos">1580</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;amplitude (normalized)&quot;</span><span class="p">),</span>
</span><span id="Plot.fft-1581"><a href="#Plot.fft-1581"><span class="linenos">1581</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="Plot.fft-1582"><a href="#Plot.fft-1582"><span class="linenos">1582</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="Plot.fft-1583"><a href="#Plot.fft-1583"><span class="linenos">1583</span></a>
</span><span id="Plot.fft-1584"><a href="#Plot.fft-1584"><span class="linenos">1584</span></a>        <span class="k">if</span> <span class="s1">&#39;ticks&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bins&#39;</span><span class="p">:</span>
</span><span id="Plot.fft-1585"><a href="#Plot.fft-1585"><span class="linenos">1585</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_bin_ticks</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Plots the Fourier Transform of the Signal.</p>

<p>If <code>ticks = 'bins'</code> is supplied in the keyword arguments, the frequency ticks are replaced
with the frequency bin values.</p>
</div>


                            </div>
                            <div id="Plot.fft_hist" class="classattr">
                                        <input id="Plot.fft_hist-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fft_hist</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Plot.fft_hist-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Plot.fft_hist"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Plot.fft_hist-1587"><a href="#Plot.fft_hist-1587"><span class="linenos">1587</span></a>    <span class="k">def</span> <span class="nf">fft_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Plot.fft_hist-1588"><a href="#Plot.fft_hist-1588"><span class="linenos">1588</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plot.fft_hist-1589"><a href="#Plot.fft_hist-1589"><span class="linenos">1589</span></a><span class="sd">            Plots the octave based Fourier Transform Histogram.</span>
</span><span id="Plot.fft_hist-1590"><a href="#Plot.fft_hist-1590"><span class="linenos">1590</span></a><span class="sd">            Both axes are on a log scale.</span>
</span><span id="Plot.fft_hist-1591"><a href="#Plot.fft_hist-1591"><span class="linenos">1591</span></a>
</span><span id="Plot.fft_hist-1592"><a href="#Plot.fft_hist-1592"><span class="linenos">1592</span></a><span class="sd">            If `ticks = &#39;bins&#39;` is supplied in the keyword arguments, the frequency ticks are replaced</span>
</span><span id="Plot.fft_hist-1593"><a href="#Plot.fft_hist-1593"><span class="linenos">1593</span></a><span class="sd">            with the frequency bin values</span>
</span><span id="Plot.fft_hist-1594"><a href="#Plot.fft_hist-1594"><span class="linenos">1594</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="Plot.fft_hist-1595"><a href="#Plot.fft_hist-1595"><span class="linenos">1595</span></a>
</span><span id="Plot.fft_hist-1596"><a href="#Plot.fft_hist-1596"><span class="linenos">1596</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Plot.fft_hist-1597"><a href="#Plot.fft_hist-1597"><span class="linenos">1597</span></a>
</span><span id="Plot.fft_hist-1598"><a href="#Plot.fft_hist-1598"><span class="linenos">1598</span></a>        <span class="c1"># Histogram of frequency values occurrences in octave bins</span>
</span><span id="Plot.fft_hist-1599"><a href="#Plot.fft_hist-1599"><span class="linenos">1599</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fft_bins</span><span class="p">(),</span> <span class="n">utils</span><span class="o">.</span><span class="n">octave_histogram</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">octave_fraction</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
</span><span id="Plot.fft_hist-1600"><a href="#Plot.fft_hist-1600"><span class="linenos">1600</span></a>                 <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="Plot.fft_hist-1601"><a href="#Plot.fft_hist-1601"><span class="linenos">1601</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
</span><span id="Plot.fft_hist-1602"><a href="#Plot.fft_hist-1602"><span class="linenos">1602</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;amplitude (normalized)&#39;</span><span class="p">)</span>
</span><span id="Plot.fft_hist-1603"><a href="#Plot.fft_hist-1603"><span class="linenos">1603</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="Plot.fft_hist-1604"><a href="#Plot.fft_hist-1604"><span class="linenos">1604</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="Plot.fft_hist-1605"><a href="#Plot.fft_hist-1605"><span class="linenos">1605</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="Plot.fft_hist-1606"><a href="#Plot.fft_hist-1606"><span class="linenos">1606</span></a>
</span><span id="Plot.fft_hist-1607"><a href="#Plot.fft_hist-1607"><span class="linenos">1607</span></a>        <span class="k">if</span> <span class="s1">&#39;ticks&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bins&#39;</span><span class="p">:</span>
</span><span id="Plot.fft_hist-1608"><a href="#Plot.fft_hist-1608"><span class="linenos">1608</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_bin_ticks</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Plots the octave based Fourier Transform Histogram.
Both axes are on a log scale.</p>

<p>If <code>ticks = 'bins'</code> is supplied in the keyword arguments, the frequency ticks are replaced
with the frequency bin values</p>
</div>


                            </div>
                            <div id="Plot.peaks" class="classattr">
                                        <input id="Plot.peaks-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">peaks</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Plot.peaks-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Plot.peaks"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Plot.peaks-1610"><a href="#Plot.peaks-1610"><span class="linenos">1610</span></a>    <span class="k">def</span> <span class="nf">peaks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Plot.peaks-1611"><a href="#Plot.peaks-1611"><span class="linenos">1611</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plot.peaks-1612"><a href="#Plot.peaks-1612"><span class="linenos">1612</span></a><span class="sd">            Plots the Fourier Transform of the Signal, with the peaks detected</span>
</span><span id="Plot.peaks-1613"><a href="#Plot.peaks-1613"><span class="linenos">1613</span></a><span class="sd">            with the `Signal.peaks()` method.</span>
</span><span id="Plot.peaks-1614"><a href="#Plot.peaks-1614"><span class="linenos">1614</span></a>
</span><span id="Plot.peaks-1615"><a href="#Plot.peaks-1615"><span class="linenos">1615</span></a><span class="sd">            If `peak_height = True` is supplied in the keyword arguments the</span>
</span><span id="Plot.peaks-1616"><a href="#Plot.peaks-1616"><span class="linenos">1616</span></a><span class="sd">            computed height threshold is</span>
</span><span id="Plot.peaks-1617"><a href="#Plot.peaks-1617"><span class="linenos">1617</span></a><span class="sd">            shown on the plot.</span>
</span><span id="Plot.peaks-1618"><a href="#Plot.peaks-1618"><span class="linenos">1618</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="Plot.peaks-1619"><a href="#Plot.peaks-1619"><span class="linenos">1619</span></a>
</span><span id="Plot.peaks-1620"><a href="#Plot.peaks-1620"><span class="linenos">1620</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Plot.peaks-1621"><a href="#Plot.peaks-1621"><span class="linenos">1621</span></a>
</span><span id="Plot.peaks-1622"><a href="#Plot.peaks-1622"><span class="linenos">1622</span></a>        <span class="n">fft_freqs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()</span>
</span><span id="Plot.peaks-1623"><a href="#Plot.peaks-1623"><span class="linenos">1623</span></a>        <span class="n">fft</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fft</span><span class="p">()</span>
</span><span id="Plot.peaks-1624"><a href="#Plot.peaks-1624"><span class="linenos">1624</span></a>        <span class="n">fft_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">fft_range</span><span class="o">.</span><span class="n">value</span>
</span><span id="Plot.peaks-1625"><a href="#Plot.peaks-1625"><span class="linenos">1625</span></a>        <span class="n">max_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">fft_freqs</span> <span class="o">&gt;=</span> <span class="n">fft_range</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Plot.peaks-1626"><a href="#Plot.peaks-1626"><span class="linenos">1626</span></a>        <span class="n">peak_indexes</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">peaks</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Plot.peaks-1627"><a href="#Plot.peaks-1627"><span class="linenos">1627</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
</span><span id="Plot.peaks-1628"><a href="#Plot.peaks-1628"><span class="linenos">1628</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;amplitude&#39;</span><span class="p">)</span>
</span><span id="Plot.peaks-1629"><a href="#Plot.peaks-1629"><span class="linenos">1629</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="Plot.peaks-1630"><a href="#Plot.peaks-1630"><span class="linenos">1630</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="Plot.peaks-1631"><a href="#Plot.peaks-1631"><span class="linenos">1631</span></a>
</span><span id="Plot.peaks-1632"><a href="#Plot.peaks-1632"><span class="linenos">1632</span></a>        <span class="k">if</span> <span class="s1">&#39;color&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">plot_kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Plot.peaks-1633"><a href="#Plot.peaks-1633"><span class="linenos">1633</span></a>            <span class="n">plot_kwargs</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span>
</span><span id="Plot.peaks-1634"><a href="#Plot.peaks-1634"><span class="linenos">1634</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fft_freqs</span><span class="p">[:</span><span class="n">max_index</span><span class="p">],</span> <span class="n">fft</span><span class="p">[:</span><span class="n">max_index</span><span class="p">],</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="Plot.peaks-1635"><a href="#Plot.peaks-1635"><span class="linenos">1635</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">fft_freqs</span><span class="p">[</span><span class="n">peak_indexes</span><span class="p">],</span> <span class="n">fft</span><span class="p">[</span><span class="n">peak_indexes</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span><span id="Plot.peaks-1636"><a href="#Plot.peaks-1636"><span class="linenos">1636</span></a>        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;peak_height&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;peak_height&#39;</span><span class="p">]):</span>
</span><span id="Plot.peaks-1637"><a href="#Plot.peaks-1637"><span class="linenos">1637</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fft_freqs</span><span class="p">[:</span><span class="n">max_index</span><span class="p">],</span> <span class="n">height</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plots the Fourier Transform of the Signal, with the peaks detected
with the <code><a href="#Signal.peaks">Signal.peaks()</a></code> method.</p>

<p>If <code>peak_height = True</code> is supplied in the keyword arguments the
computed height threshold is
shown on the plot.</p>
</div>


                            </div>
                            <div id="Plot.peak_damping" class="classattr">
                                        <input id="Plot.peak_damping-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">peak_damping</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Plot.peak_damping-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Plot.peak_damping"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Plot.peak_damping-1639"><a href="#Plot.peak_damping-1639"><span class="linenos">1639</span></a>    <span class="k">def</span> <span class="nf">peak_damping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Plot.peak_damping-1640"><a href="#Plot.peak_damping-1640"><span class="linenos">1640</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plot.peak_damping-1641"><a href="#Plot.peak_damping-1641"><span class="linenos">1641</span></a><span class="sd">            Plots the frequency vs damping scatter of the damping ratio computed from the</span>
</span><span id="Plot.peak_damping-1642"><a href="#Plot.peak_damping-1642"><span class="linenos">1642</span></a><span class="sd">            Fourier Transform peak shapes. A polynomial curve fit is added to help visualisation.</span>
</span><span id="Plot.peak_damping-1643"><a href="#Plot.peak_damping-1643"><span class="linenos">1643</span></a>
</span><span id="Plot.peak_damping-1644"><a href="#Plot.peak_damping-1644"><span class="linenos">1644</span></a><span class="sd">            Supported key word arguments are :</span>
</span><span id="Plot.peak_damping-1645"><a href="#Plot.peak_damping-1645"><span class="linenos">1645</span></a>
</span><span id="Plot.peak_damping-1646"><a href="#Plot.peak_damping-1646"><span class="linenos">1646</span></a><span class="sd">            `n=5` : The order of the fitted polynomial curve, default is 5,</span>
</span><span id="Plot.peak_damping-1647"><a href="#Plot.peak_damping-1647"><span class="linenos">1647</span></a><span class="sd">            if the supplied value is too high, it will be reduced until the</span>
</span><span id="Plot.peak_damping-1648"><a href="#Plot.peak_damping-1648"><span class="linenos">1648</span></a><span class="sd">            number of peaks is sufficient to fit the polynomial.</span>
</span><span id="Plot.peak_damping-1649"><a href="#Plot.peak_damping-1649"><span class="linenos">1649</span></a>
</span><span id="Plot.peak_damping-1650"><a href="#Plot.peak_damping-1650"><span class="linenos">1650</span></a><span class="sd">            `inverse=True` : Default value is True, if False, the damping ratio is shown instead</span>
</span><span id="Plot.peak_damping-1651"><a href="#Plot.peak_damping-1651"><span class="linenos">1651</span></a><span class="sd">            of its inverse.</span>
</span><span id="Plot.peak_damping-1652"><a href="#Plot.peak_damping-1652"><span class="linenos">1652</span></a>
</span><span id="Plot.peak_damping-1653"><a href="#Plot.peak_damping-1653"><span class="linenos">1653</span></a><span class="sd">            `normalize=False` : Default value is False, if True the damping values are normalized</span>
</span><span id="Plot.peak_damping-1654"><a href="#Plot.peak_damping-1654"><span class="linenos">1654</span></a><span class="sd">            from 0 to 1, to help analyze results and compare Sounds.</span>
</span><span id="Plot.peak_damping-1655"><a href="#Plot.peak_damping-1655"><span class="linenos">1655</span></a>
</span><span id="Plot.peak_damping-1656"><a href="#Plot.peak_damping-1656"><span class="linenos">1656</span></a><span class="sd">            `ticks=None` : Default value is None, if `ticks=&#39;bins&#39;` the x-axis ticks are replaced with</span>
</span><span id="Plot.peak_damping-1657"><a href="#Plot.peak_damping-1657"><span class="linenos">1657</span></a><span class="sd">            frequency bin values.</span>
</span><span id="Plot.peak_damping-1658"><a href="#Plot.peak_damping-1658"><span class="linenos">1658</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="Plot.peak_damping-1659"><a href="#Plot.peak_damping-1659"><span class="linenos">1659</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Plot.peak_damping-1660"><a href="#Plot.peak_damping-1660"><span class="linenos">1660</span></a>        <span class="c1"># Get the damping ratio and peak frequencies</span>
</span><span id="Plot.peak_damping-1661"><a href="#Plot.peak_damping-1661"><span class="linenos">1661</span></a>        <span class="k">if</span> <span class="s1">&#39;inverse&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;inverse&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="Plot.peak_damping-1662"><a href="#Plot.peak_damping-1662"><span class="linenos">1662</span></a>            <span class="n">zetas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">peak_damping</span><span class="p">())</span>
</span><span id="Plot.peak_damping-1663"><a href="#Plot.peak_damping-1663"><span class="linenos">1663</span></a>            <span class="n">ylabel</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;damping $\zeta$&#39;</span>
</span><span id="Plot.peak_damping-1664"><a href="#Plot.peak_damping-1664"><span class="linenos">1664</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Plot.peak_damping-1665"><a href="#Plot.peak_damping-1665"><span class="linenos">1665</span></a>            <span class="n">zetas</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">peak_damping</span><span class="p">())</span>
</span><span id="Plot.peak_damping-1666"><a href="#Plot.peak_damping-1666"><span class="linenos">1666</span></a>            <span class="n">ylabel</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;inverse damping $1/\zeta$&#39;</span>
</span><span id="Plot.peak_damping-1667"><a href="#Plot.peak_damping-1667"><span class="linenos">1667</span></a>
</span><span id="Plot.peak_damping-1668"><a href="#Plot.peak_damping-1668"><span class="linenos">1668</span></a>        <span class="n">peak_freqs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fft_frequencies</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">peaks</span><span class="p">()]</span>
</span><span id="Plot.peak_damping-1669"><a href="#Plot.peak_damping-1669"><span class="linenos">1669</span></a>
</span><span id="Plot.peak_damping-1670"><a href="#Plot.peak_damping-1670"><span class="linenos">1670</span></a>        <span class="c1"># If a polynomial order is supplied assign it, if not default is 5</span>
</span><span id="Plot.peak_damping-1671"><a href="#Plot.peak_damping-1671"><span class="linenos">1671</span></a>        <span class="k">if</span> <span class="s1">&#39;n&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Plot.peak_damping-1672"><a href="#Plot.peak_damping-1672"><span class="linenos">1672</span></a>            <span class="n">n</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span>
</span><span id="Plot.peak_damping-1673"><a href="#Plot.peak_damping-1673"><span class="linenos">1673</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Plot.peak_damping-1674"><a href="#Plot.peak_damping-1674"><span class="linenos">1674</span></a>            <span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="Plot.peak_damping-1675"><a href="#Plot.peak_damping-1675"><span class="linenos">1675</span></a>
</span><span id="Plot.peak_damping-1676"><a href="#Plot.peak_damping-1676"><span class="linenos">1676</span></a>        <span class="c1"># If labels are supplied the default color are used</span>
</span><span id="Plot.peak_damping-1677"><a href="#Plot.peak_damping-1677"><span class="linenos">1677</span></a>        <span class="k">if</span> <span class="s1">&#39;label&#39;</span> <span class="ow">in</span> <span class="n">plot_kwargs</span><span class="p">:</span>
</span><span id="Plot.peak_damping-1678"><a href="#Plot.peak_damping-1678"><span class="linenos">1678</span></a>            <span class="n">plot_kwargs</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Plot.peak_damping-1679"><a href="#Plot.peak_damping-1679"><span class="linenos">1679</span></a>            <span class="n">plot2_kwargs</span> <span class="o">=</span> <span class="n">plot_kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Plot.peak_damping-1680"><a href="#Plot.peak_damping-1680"><span class="linenos">1680</span></a>            <span class="n">plot2_kwargs</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Plot.peak_damping-1681"><a href="#Plot.peak_damping-1681"><span class="linenos">1681</span></a>
</span><span id="Plot.peak_damping-1682"><a href="#Plot.peak_damping-1682"><span class="linenos">1682</span></a>        <span class="c1"># If not black and red are used</span>
</span><span id="Plot.peak_damping-1683"><a href="#Plot.peak_damping-1683"><span class="linenos">1683</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Plot.peak_damping-1684"><a href="#Plot.peak_damping-1684"><span class="linenos">1684</span></a>            <span class="n">plot_kwargs</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span>
</span><span id="Plot.peak_damping-1685"><a href="#Plot.peak_damping-1685"><span class="linenos">1685</span></a>            <span class="n">plot2_kwargs</span> <span class="o">=</span> <span class="n">plot_kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Plot.peak_damping-1686"><a href="#Plot.peak_damping-1686"><span class="linenos">1686</span></a>            <span class="n">plot2_kwargs</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span>
</span><span id="Plot.peak_damping-1687"><a href="#Plot.peak_damping-1687"><span class="linenos">1687</span></a>
</span><span id="Plot.peak_damping-1688"><a href="#Plot.peak_damping-1688"><span class="linenos">1688</span></a>        <span class="k">if</span> <span class="s1">&#39;normalize&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;normalize&#39;</span><span class="p">]:</span>
</span><span id="Plot.peak_damping-1689"><a href="#Plot.peak_damping-1689"><span class="linenos">1689</span></a>            <span class="n">zetas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">zetas</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">zetas</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">initial</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Plot.peak_damping-1690"><a href="#Plot.peak_damping-1690"><span class="linenos">1690</span></a>
</span><span id="Plot.peak_damping-1691"><a href="#Plot.peak_damping-1691"><span class="linenos">1691</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">peak_freqs</span><span class="p">,</span> <span class="n">zetas</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="Plot.peak_damping-1692"><a href="#Plot.peak_damping-1692"><span class="linenos">1692</span></a>        <span class="n">fun</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">nth_order_polynomial_fit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">peak_freqs</span><span class="p">,</span> <span class="n">zetas</span><span class="p">)</span>
</span><span id="Plot.peak_damping-1693"><a href="#Plot.peak_damping-1693"><span class="linenos">1693</span></a>        <span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">peak_freqs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">peak_freqs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
</span><span id="Plot.peak_damping-1694"><a href="#Plot.peak_damping-1694"><span class="linenos">1694</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">fun</span><span class="p">(</span><span class="n">freq</span><span class="p">),</span> <span class="o">**</span><span class="n">plot2_kwargs</span><span class="p">)</span>
</span><span id="Plot.peak_damping-1695"><a href="#Plot.peak_damping-1695"><span class="linenos">1695</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span><span id="Plot.peak_damping-1696"><a href="#Plot.peak_damping-1696"><span class="linenos">1696</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequency vs Damping Factor with Order &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span><span id="Plot.peak_damping-1697"><a href="#Plot.peak_damping-1697"><span class="linenos">1697</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
</span><span id="Plot.peak_damping-1698"><a href="#Plot.peak_damping-1698"><span class="linenos">1698</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
</span><span id="Plot.peak_damping-1699"><a href="#Plot.peak_damping-1699"><span class="linenos">1699</span></a>
</span><span id="Plot.peak_damping-1700"><a href="#Plot.peak_damping-1700"><span class="linenos">1700</span></a>        <span class="k">if</span> <span class="s1">&#39;ticks&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bins&#39;</span><span class="p">:</span>
</span><span id="Plot.peak_damping-1701"><a href="#Plot.peak_damping-1701"><span class="linenos">1701</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set_bin_ticks</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Plots the frequency vs damping scatter of the damping ratio computed from the
Fourier Transform peak shapes. A polynomial curve fit is added to help visualisation.</p>

<p>Supported key word arguments are :</p>

<p><code>n=5</code> : The order of the fitted polynomial curve, default is 5,
if the supplied value is too high, it will be reduced until the
number of peaks is sufficient to fit the polynomial.</p>

<p><code>inverse=True</code> : Default value is True, if False, the damping ratio is shown instead
of its inverse.</p>

<p><code>normalize=False</code> : Default value is False, if True the damping values are normalized
from 0 to 1, to help analyze results and compare Sounds.</p>

<p><code>ticks=None</code> : Default value is None, if <code>ticks='bins'</code> the x-axis ticks are replaced with
frequency bin values.</p>
</div>


                            </div>
                            <div id="Plot.time_damping" class="classattr">
                                        <input id="Plot.time_damping-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">time_damping</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Plot.time_damping-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Plot.time_damping"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Plot.time_damping-1703"><a href="#Plot.time_damping-1703"><span class="linenos">1703</span></a>    <span class="k">def</span> <span class="nf">time_damping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Plot.time_damping-1704"><a href="#Plot.time_damping-1704"><span class="linenos">1704</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plot.time_damping-1705"><a href="#Plot.time_damping-1705"><span class="linenos">1705</span></a><span class="sd">        Shows the signal envelope with the fitted negative exponential</span>
</span><span id="Plot.time_damping-1706"><a href="#Plot.time_damping-1706"><span class="linenos">1706</span></a><span class="sd">        curve used to determine the time damping ratio of the signal.</span>
</span><span id="Plot.time_damping-1707"><a href="#Plot.time_damping-1707"><span class="linenos">1707</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plot.time_damping-1708"><a href="#Plot.time_damping-1708"><span class="linenos">1708</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Plot.time_damping-1709"><a href="#Plot.time_damping-1709"><span class="linenos">1709</span></a>        <span class="c1"># Get the envelope data</span>
</span><span id="Plot.time_damping-1710"><a href="#Plot.time_damping-1710"><span class="linenos">1710</span></a>        <span class="n">envelope</span><span class="p">,</span> <span class="n">envelope_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">envelope</span><span class="p">()</span> 
</span><span id="Plot.time_damping-1711"><a href="#Plot.time_damping-1711"><span class="linenos">1711</span></a>
</span><span id="Plot.time_damping-1712"><a href="#Plot.time_damping-1712"><span class="linenos">1712</span></a>        <span class="c1"># First point is the maximum because e^-kt is strictly decreasing</span>
</span><span id="Plot.time_damping-1713"><a href="#Plot.time_damping-1713"><span class="linenos">1713</span></a>        <span class="n">first_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">envelope</span><span class="p">)</span>
</span><span id="Plot.time_damping-1714"><a href="#Plot.time_damping-1714"><span class="linenos">1714</span></a>
</span><span id="Plot.time_damping-1715"><a href="#Plot.time_damping-1715"><span class="linenos">1715</span></a>        <span class="c1"># The second point is the first point where the signal crosses the lower_threshold line</span>
</span><span id="Plot.time_damping-1716"><a href="#Plot.time_damping-1716"><span class="linenos">1716</span></a>        <span class="n">second_point_thresh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">SP</span><span class="o">.</span><span class="n">damping</span><span class="o">.</span><span class="n">lower_threshold</span><span class="o">.</span><span class="n">value</span>
</span><span id="Plot.time_damping-1717"><a href="#Plot.time_damping-1717"><span class="linenos">1717</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Plot.time_damping-1718"><a href="#Plot.time_damping-1718"><span class="linenos">1718</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="Plot.time_damping-1719"><a href="#Plot.time_damping-1719"><span class="linenos">1719</span></a>                <span class="n">second_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flatnonzero</span><span class="p">(</span><span class="n">envelope</span><span class="p">[</span><span class="n">first_index</span><span class="p">:]</span> <span class="o">&lt;=</span> <span class="n">second_point_thresh</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Plot.time_damping-1720"><a href="#Plot.time_damping-1720"><span class="linenos">1720</span></a>                <span class="k">break</span>
</span><span id="Plot.time_damping-1721"><a href="#Plot.time_damping-1721"><span class="linenos">1721</span></a>            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
</span><span id="Plot.time_damping-1722"><a href="#Plot.time_damping-1722"><span class="linenos">1722</span></a>                <span class="n">second_point_thresh</span> <span class="o">*=</span> <span class="mi">2</span>
</span><span id="Plot.time_damping-1723"><a href="#Plot.time_damping-1723"><span class="linenos">1723</span></a>                <span class="k">if</span> <span class="n">second_point_thresh</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Plot.time_damping-1724"><a href="#Plot.time_damping-1724"><span class="linenos">1724</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid second point threshold encountered, something went wrong&quot;</span><span class="p">)</span>
</span><span id="Plot.time_damping-1725"><a href="#Plot.time_damping-1725"><span class="linenos">1725</span></a>
</span><span id="Plot.time_damping-1726"><a href="#Plot.time_damping-1726"><span class="linenos">1726</span></a>        <span class="c1"># Function to compute the residual for the exponential curve fit</span>
</span><span id="Plot.time_damping-1727"><a href="#Plot.time_damping-1727"><span class="linenos">1727</span></a>        <span class="k">def</span> <span class="nf">residual_function</span><span class="p">(</span><span class="n">zeta_w</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
</span><span id="Plot.time_damping-1728"><a href="#Plot.time_damping-1728"><span class="linenos">1728</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">zeta_w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">s</span>
</span><span id="Plot.time_damping-1729"><a href="#Plot.time_damping-1729"><span class="linenos">1729</span></a>
</span><span id="Plot.time_damping-1730"><a href="#Plot.time_damping-1730"><span class="linenos">1730</span></a>        <span class="n">zeta_guess</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">]</span>
</span><span id="Plot.time_damping-1731"><a href="#Plot.time_damping-1731"><span class="linenos">1731</span></a>
</span><span id="Plot.time_damping-1732"><a href="#Plot.time_damping-1732"><span class="linenos">1732</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">least_squares</span><span class="p">(</span><span class="n">residual_function</span><span class="p">,</span> <span class="n">zeta_guess</span><span class="p">,</span>
</span><span id="Plot.time_damping-1733"><a href="#Plot.time_damping-1733"><span class="linenos">1733</span></a>                                              <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">envelope_time</span><span class="p">[</span><span class="n">first_index</span><span class="p">:</span><span class="n">second_index</span><span class="p">],</span>
</span><span id="Plot.time_damping-1734"><a href="#Plot.time_damping-1734"><span class="linenos">1734</span></a>                                                    <span class="n">envelope</span><span class="p">[</span><span class="n">first_index</span><span class="p">:</span><span class="n">second_index</span><span class="p">]))</span>
</span><span id="Plot.time_damping-1735"><a href="#Plot.time_damping-1735"><span class="linenos">1735</span></a>        <span class="c1"># Get the zeta*omega constant</span>
</span><span id="Plot.time_damping-1736"><a href="#Plot.time_damping-1736"><span class="linenos">1736</span></a>        <span class="n">zeta_omega</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Plot.time_damping-1737"><a href="#Plot.time_damping-1737"><span class="linenos">1737</span></a>
</span><span id="Plot.time_damping-1738"><a href="#Plot.time_damping-1738"><span class="linenos">1738</span></a>        <span class="c1"># Compute the fundamental frequency in radians of the signal</span>
</span><span id="Plot.time_damping-1739"><a href="#Plot.time_damping-1739"><span class="linenos">1739</span></a>        <span class="n">wd</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fundamental</span><span class="p">()</span>
</span><span id="Plot.time_damping-1740"><a href="#Plot.time_damping-1740"><span class="linenos">1740</span></a>
</span><span id="Plot.time_damping-1741"><a href="#Plot.time_damping-1741"><span class="linenos">1741</span></a>        <span class="c1"># Plot the two points used for the regression</span>
</span><span id="Plot.time_damping-1742"><a href="#Plot.time_damping-1742"><span class="linenos">1742</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">envelope_time</span><span class="p">[[</span><span class="n">first_index</span><span class="p">,</span> <span class="n">first_index</span> <span class="o">+</span> <span class="n">second_index</span><span class="p">]],</span> 
</span><span id="Plot.time_damping-1743"><a href="#Plot.time_damping-1743"><span class="linenos">1743</span></a>                    <span class="n">envelope</span><span class="p">[[</span><span class="n">first_index</span><span class="p">,</span> <span class="n">first_index</span> <span class="o">+</span> <span class="n">second_index</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span><span id="Plot.time_damping-1744"><a href="#Plot.time_damping-1744"><span class="linenos">1744</span></a>
</span><span id="Plot.time_damping-1745"><a href="#Plot.time_damping-1745"><span class="linenos">1745</span></a>        <span class="c1"># get the current ax</span>
</span><span id="Plot.time_damping-1746"><a href="#Plot.time_damping-1746"><span class="linenos">1746</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="Plot.time_damping-1747"><a href="#Plot.time_damping-1747"><span class="linenos">1747</span></a>
</span><span id="Plot.time_damping-1748"><a href="#Plot.time_damping-1748"><span class="linenos">1748</span></a>        <span class="c1"># Plot the damping curve</span>
</span><span id="Plot.time_damping-1749"><a href="#Plot.time_damping-1749"><span class="linenos">1749</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">envelope_time</span><span class="p">[</span><span class="n">first_index</span><span class="p">:</span><span class="n">second_index</span> <span class="o">+</span> <span class="n">first_index</span><span class="p">],</span>
</span><span id="Plot.time_damping-1750"><a href="#Plot.time_damping-1750"><span class="linenos">1750</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">zeta_omega</span> <span class="o">*</span> <span class="n">envelope_time</span><span class="p">[</span><span class="n">first_index</span><span class="p">:</span><span class="n">second_index</span> <span class="o">+</span> <span class="n">first_index</span><span class="p">]),</span> 
</span><span id="Plot.time_damping-1751"><a href="#Plot.time_damping-1751"><span class="linenos">1751</span></a>                <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
</span><span id="Plot.time_damping-1752"><a href="#Plot.time_damping-1752"><span class="linenos">1752</span></a>                <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
</span><span id="Plot.time_damping-1753"><a href="#Plot.time_damping-1753"><span class="linenos">1753</span></a>
</span><span id="Plot.time_damping-1754"><a href="#Plot.time_damping-1754"><span class="linenos">1754</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</span><span id="Plot.time_damping-1755"><a href="#Plot.time_damping-1755"><span class="linenos">1755</span></a>        <span class="k">if</span> <span class="s1">&#39;alpha&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">plot_kwargs</span><span class="p">:</span>
</span><span id="Plot.time_damping-1756"><a href="#Plot.time_damping-1756"><span class="linenos">1756</span></a>            <span class="n">plot_kwargs</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.6</span>
</span><span id="Plot.time_damping-1757"><a href="#Plot.time_damping-1757"><span class="linenos">1757</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">envelope</span><span class="p">(</span><span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="Plot.time_damping-1758"><a href="#Plot.time_damping-1758"><span class="linenos">1758</span></a>
</span><span id="Plot.time_damping-1759"><a href="#Plot.time_damping-1759"><span class="linenos">1759</span></a>        <span class="k">if</span> <span class="s1">&#39;label&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">plot_kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="Plot.time_damping-1760"><a href="#Plot.time_damping-1760"><span class="linenos">1760</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;damping curve&#39;</span><span class="p">,</span> <span class="s1">&#39;signal envelope&#39;</span><span class="p">])</span>
</span><span id="Plot.time_damping-1761"><a href="#Plot.time_damping-1761"><span class="linenos">1761</span></a>
</span><span id="Plot.time_damping-1762"><a href="#Plot.time_damping-1762"><span class="linenos">1762</span></a>        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Zeta : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="o">-</span><span class="n">zeta_omega</span> <span class="o">/</span> <span class="n">wd</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; Fundamental &#39;</span> <span class="o">+</span> \
</span><span id="Plot.time_damping-1763"><a href="#Plot.time_damping-1763"><span class="linenos">1763</span></a>                <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fundamental</span><span class="p">(),</span> <span class="mi">0</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;Hz&#39;</span>
</span><span id="Plot.time_damping-1764"><a href="#Plot.time_damping-1764"><span class="linenos">1764</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Shows the signal envelope with the fitted negative exponential
curve used to determine the time damping ratio of the signal.</p>
</div>


                            </div>
                            <div id="Plot.integral" class="classattr">
                                        <input id="Plot.integral-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">integral</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Plot.integral-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Plot.integral"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Plot.integral-1766"><a href="#Plot.integral-1766"><span class="linenos">1766</span></a>    <span class="k">def</span> <span class="nf">integral</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Plot.integral-1767"><a href="#Plot.integral-1767"><span class="linenos">1767</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Plot.integral-1768"><a href="#Plot.integral-1768"><span class="linenos">1768</span></a><span class="sd">        Cumulative integral plot of the normalized signal log envelope</span>
</span><span id="Plot.integral-1769"><a href="#Plot.integral-1769"><span class="linenos">1769</span></a>
</span><span id="Plot.integral-1770"><a href="#Plot.integral-1770"><span class="linenos">1770</span></a><span class="sd">        Represents the power distribution variation in time for the signal.</span>
</span><span id="Plot.integral-1771"><a href="#Plot.integral-1771"><span class="linenos">1771</span></a><span class="sd">        This is a plot of the function $F(x)$ such as :</span>
</span><span id="Plot.integral-1772"><a href="#Plot.integral-1772"><span class="linenos">1772</span></a>
</span><span id="Plot.integral-1773"><a href="#Plot.integral-1773"><span class="linenos">1773</span></a><span class="sd">        $ F(x) = \int_0^x env(x) dx $</span>
</span><span id="Plot.integral-1774"><a href="#Plot.integral-1774"><span class="linenos">1774</span></a>
</span><span id="Plot.integral-1775"><a href="#Plot.integral-1775"><span class="linenos">1775</span></a><span class="sd">        Where e(x) is the signal envelope.</span>
</span><span id="Plot.integral-1776"><a href="#Plot.integral-1776"><span class="linenos">1776</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Plot.integral-1777"><a href="#Plot.integral-1777"><span class="linenos">1777</span></a>        <span class="c1"># sanitize the kwargs</span>
</span><span id="Plot.integral-1778"><a href="#Plot.integral-1778"><span class="linenos">1778</span></a>        <span class="n">plot_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Plot.integral-1779"><a href="#Plot.integral-1779"><span class="linenos">1779</span></a>
</span><span id="Plot.integral-1780"><a href="#Plot.integral-1780"><span class="linenos">1780</span></a>        <span class="c1"># Compute log envelope and log time</span>
</span><span id="Plot.integral-1781"><a href="#Plot.integral-1781"><span class="linenos">1781</span></a>        <span class="n">log_envelope</span><span class="p">,</span> <span class="n">log_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">log_envelope</span><span class="p">()</span>
</span><span id="Plot.integral-1782"><a href="#Plot.integral-1782"><span class="linenos">1782</span></a>
</span><span id="Plot.integral-1783"><a href="#Plot.integral-1783"><span class="linenos">1783</span></a>
</span><span id="Plot.integral-1784"><a href="#Plot.integral-1784"><span class="linenos">1784</span></a>        <span class="c1"># compute the cumulative integral</span>
</span><span id="Plot.integral-1785"><a href="#Plot.integral-1785"><span class="linenos">1785</span></a>        <span class="n">integral</span> <span class="o">=</span> <span class="p">[</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">log_envelope</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">log_time</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">log_envelope</span><span class="p">),</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="Plot.integral-1786"><a href="#Plot.integral-1786"><span class="linenos">1786</span></a>        <span class="n">integral</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span>
</span><span id="Plot.integral-1787"><a href="#Plot.integral-1787"><span class="linenos">1787</span></a>
</span><span id="Plot.integral-1788"><a href="#Plot.integral-1788"><span class="linenos">1788</span></a>        <span class="c1"># plot the integral</span>
</span><span id="Plot.integral-1789"><a href="#Plot.integral-1789"><span class="linenos">1789</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">log_time</span><span class="p">[</span><span class="mi">2</span><span class="p">:],</span> <span class="n">integral</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
</span><span id="Plot.integral-1790"><a href="#Plot.integral-1790"><span class="linenos">1790</span></a>
</span><span id="Plot.integral-1791"><a href="#Plot.integral-1791"><span class="linenos">1791</span></a>        <span class="c1"># Add labels and scale</span>
</span><span id="Plot.integral-1792"><a href="#Plot.integral-1792"><span class="linenos">1792</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
</span><span id="Plot.integral-1793"><a href="#Plot.integral-1793"><span class="linenos">1793</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;cumulative power (normalized)&#39;</span><span class="p">)</span>
</span><span id="Plot.integral-1794"><a href="#Plot.integral-1794"><span class="linenos">1794</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span><span id="Plot.integral-1795"><a href="#Plot.integral-1795"><span class="linenos">1795</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Cumulative integral plot of the normalized signal log envelope</p>

<p>Represents the power distribution variation in time for the signal.
This is a plot of the function $F(x)$ such as :</p>

<p>$ F(x) = \int_0^x env(x) dx $</p>

<p>Where e(x) is the signal envelope.</p>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value">${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>